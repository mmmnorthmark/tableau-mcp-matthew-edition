<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tableau Pulse Widget</title>
    <script type="module" crossorigin>(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();var Zw={exports:{}},lh={},eE={exports:{}},Ye={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var M5;function AG(){if(M5)return Ye;M5=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),s=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),h=Symbol.iterator;function p(P){return P===null||typeof P!="object"?null:(P=h&&P[h]||P["@@iterator"],typeof P=="function"?P:null)}var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,v={};function w(P,G,me){this.props=P,this.context=G,this.refs=v,this.updater=me||m}w.prototype.isReactComponent={},w.prototype.setState=function(P,G){if(typeof P!="object"&&typeof P!="function"&&P!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,P,G,"setState")},w.prototype.forceUpdate=function(P){this.updater.enqueueForceUpdate(this,P,"forceUpdate")};function E(){}E.prototype=w.prototype;function S(P,G,me){this.props=P,this.context=G,this.refs=v,this.updater=me||m}var A=S.prototype=new E;A.constructor=S,y(A,w.prototype),A.isPureReactComponent=!0;var C=Array.isArray,k=Object.prototype.hasOwnProperty,D={current:null},$={key:!0,ref:!0,__self:!0,__source:!0};function M(P,G,me){var _e,we={},Ie=null,et=null;if(G!=null)for(_e in G.ref!==void 0&&(et=G.ref),G.key!==void 0&&(Ie=""+G.key),G)k.call(G,_e)&&!$.hasOwnProperty(_e)&&(we[_e]=G[_e]);var Ve=arguments.length-2;if(Ve===1)we.children=me;else if(1<Ve){for(var fe=Array(Ve),Re=0;Re<Ve;Re++)fe[Re]=arguments[Re+2];we.children=fe}if(P&&P.defaultProps)for(_e in Ve=P.defaultProps,Ve)we[_e]===void 0&&(we[_e]=Ve[_e]);return{$$typeof:e,type:P,key:Ie,ref:et,props:we,_owner:D.current}}function T(P,G){return{$$typeof:e,type:P.type,key:G,ref:P.ref,props:P.props,_owner:P._owner}}function L(P){return typeof P=="object"&&P!==null&&P.$$typeof===e}function O(P){var G={"=":"=0",":":"=2"};return"$"+P.replace(/[=:]/g,function(me){return G[me]})}var X=/\/+/g;function W(P,G){return typeof P=="object"&&P!==null&&P.key!=null?O(""+P.key):G.toString(36)}function I(P,G,me,_e,we){var Ie=typeof P;(Ie==="undefined"||Ie==="boolean")&&(P=null);var et=!1;if(P===null)et=!0;else switch(Ie){case"string":case"number":et=!0;break;case"object":switch(P.$$typeof){case e:case t:et=!0}}if(et)return et=P,we=we(et),P=_e===""?"."+W(et,0):_e,C(we)?(me="",P!=null&&(me=P.replace(X,"$&/")+"/"),I(we,G,me,"",function(Re){return Re})):we!=null&&(L(we)&&(we=T(we,me+(!we.key||et&&et.key===we.key?"":(""+we.key).replace(X,"$&/")+"/")+P)),G.push(we)),1;if(et=0,_e=_e===""?".":_e+":",C(P))for(var Ve=0;Ve<P.length;Ve++){Ie=P[Ve];var fe=_e+W(Ie,Ve);et+=I(Ie,G,me,fe,we)}else if(fe=p(P),typeof fe=="function")for(P=fe.call(P),Ve=0;!(Ie=P.next()).done;)Ie=Ie.value,fe=_e+W(Ie,Ve++),et+=I(Ie,G,me,fe,we);else if(Ie==="object")throw G=String(P),Error("Objects are not valid as a React child (found: "+(G==="[object Object]"?"object with keys {"+Object.keys(P).join(", ")+"}":G)+"). If you meant to render a collection of children, use an array instead.");return et}function N(P,G,me){if(P==null)return P;var _e=[],we=0;return I(P,_e,"","",function(Ie){return G.call(me,Ie,we++)}),_e}function U(P){if(P._status===-1){var G=P._result;G=G(),G.then(function(me){(P._status===0||P._status===-1)&&(P._status=1,P._result=me)},function(me){(P._status===0||P._status===-1)&&(P._status=2,P._result=me)}),P._status===-1&&(P._status=0,P._result=G)}if(P._status===1)return P._result.default;throw P._result}var Y={current:null},j={transition:null},q={ReactCurrentDispatcher:Y,ReactCurrentBatchConfig:j,ReactCurrentOwner:D};function K(){throw Error("act(...) is not supported in production builds of React.")}return Ye.Children={map:N,forEach:function(P,G,me){N(P,function(){G.apply(this,arguments)},me)},count:function(P){var G=0;return N(P,function(){G++}),G},toArray:function(P){return N(P,function(G){return G})||[]},only:function(P){if(!L(P))throw Error("React.Children.only expected to receive a single React element child.");return P}},Ye.Component=w,Ye.Fragment=n,Ye.Profiler=i,Ye.PureComponent=S,Ye.StrictMode=r,Ye.Suspense=u,Ye.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=q,Ye.act=K,Ye.cloneElement=function(P,G,me){if(P==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+P+".");var _e=y({},P.props),we=P.key,Ie=P.ref,et=P._owner;if(G!=null){if(G.ref!==void 0&&(Ie=G.ref,et=D.current),G.key!==void 0&&(we=""+G.key),P.type&&P.type.defaultProps)var Ve=P.type.defaultProps;for(fe in G)k.call(G,fe)&&!$.hasOwnProperty(fe)&&(_e[fe]=G[fe]===void 0&&Ve!==void 0?Ve[fe]:G[fe])}var fe=arguments.length-2;if(fe===1)_e.children=me;else if(1<fe){Ve=Array(fe);for(var Re=0;Re<fe;Re++)Ve[Re]=arguments[Re+2];_e.children=Ve}return{$$typeof:e,type:P.type,key:we,ref:Ie,props:_e,_owner:et}},Ye.createContext=function(P){return P={$$typeof:s,_currentValue:P,_currentValue2:P,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},P.Provider={$$typeof:o,_context:P},P.Consumer=P},Ye.createElement=M,Ye.createFactory=function(P){var G=M.bind(null,P);return G.type=P,G},Ye.createRef=function(){return{current:null}},Ye.forwardRef=function(P){return{$$typeof:a,render:P}},Ye.isValidElement=L,Ye.lazy=function(P){return{$$typeof:f,_payload:{_status:-1,_result:P},_init:U}},Ye.memo=function(P,G){return{$$typeof:c,type:P,compare:G===void 0?null:G}},Ye.startTransition=function(P){var G=j.transition;j.transition={};try{P()}finally{j.transition=G}},Ye.unstable_act=K,Ye.useCallback=function(P,G){return Y.current.useCallback(P,G)},Ye.useContext=function(P){return Y.current.useContext(P)},Ye.useDebugValue=function(){},Ye.useDeferredValue=function(P){return Y.current.useDeferredValue(P)},Ye.useEffect=function(P,G){return Y.current.useEffect(P,G)},Ye.useId=function(){return Y.current.useId()},Ye.useImperativeHandle=function(P,G,me){return Y.current.useImperativeHandle(P,G,me)},Ye.useInsertionEffect=function(P,G){return Y.current.useInsertionEffect(P,G)},Ye.useLayoutEffect=function(P,G){return Y.current.useLayoutEffect(P,G)},Ye.useMemo=function(P,G){return Y.current.useMemo(P,G)},Ye.useReducer=function(P,G,me){return Y.current.useReducer(P,G,me)},Ye.useRef=function(P){return Y.current.useRef(P)},Ye.useState=function(P){return Y.current.useState(P)},Ye.useSyncExternalStore=function(P,G,me){return Y.current.useSyncExternalStore(P,G,me)},Ye.useTransition=function(){return Y.current.useTransition()},Ye.version="18.3.1",Ye}var T5;function pA(){return T5||(T5=1,eE.exports=AG()),eE.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var N5;function CG(){if(N5)return lh;N5=1;var e=pA(),t=Symbol.for("react.element"),n=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,i=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function s(a,u,c){var f,h={},p=null,m=null;c!==void 0&&(p=""+c),u.key!==void 0&&(p=""+u.key),u.ref!==void 0&&(m=u.ref);for(f in u)r.call(u,f)&&!o.hasOwnProperty(f)&&(h[f]=u[f]);if(a&&a.defaultProps)for(f in u=a.defaultProps,u)h[f]===void 0&&(h[f]=u[f]);return{$$typeof:t,type:a,key:p,ref:m,props:h,_owner:i.current}}return lh.Fragment=n,lh.jsx=s,lh.jsxs=s,lh}var R5;function kG(){return R5||(R5=1,Zw.exports=CG()),Zw.exports}var vi=kG(),Yc=pA(),rm={},tE={exports:{}},$r={},nE={exports:{}},rE={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var O5;function $G(){return O5||(O5=1,(function(e){function t(j,q){var K=j.length;j.push(q);e:for(;0<K;){var P=K-1>>>1,G=j[P];if(0<i(G,q))j[P]=q,j[K]=G,K=P;else break e}}function n(j){return j.length===0?null:j[0]}function r(j){if(j.length===0)return null;var q=j[0],K=j.pop();if(K!==q){j[0]=K;e:for(var P=0,G=j.length,me=G>>>1;P<me;){var _e=2*(P+1)-1,we=j[_e],Ie=_e+1,et=j[Ie];if(0>i(we,K))Ie<G&&0>i(et,we)?(j[P]=et,j[Ie]=K,P=Ie):(j[P]=we,j[_e]=K,P=_e);else if(Ie<G&&0>i(et,K))j[P]=et,j[Ie]=K,P=Ie;else break e}}return q}function i(j,q){var K=j.sortIndex-q.sortIndex;return K!==0?K:j.id-q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var s=Date,a=s.now();e.unstable_now=function(){return s.now()-a}}var u=[],c=[],f=1,h=null,p=3,m=!1,y=!1,v=!1,w=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function A(j){for(var q=n(c);q!==null;){if(q.callback===null)r(c);else if(q.startTime<=j)r(c),q.sortIndex=q.expirationTime,t(u,q);else break;q=n(c)}}function C(j){if(v=!1,A(j),!y)if(n(u)!==null)y=!0,U(k);else{var q=n(c);q!==null&&Y(C,q.startTime-j)}}function k(j,q){y=!1,v&&(v=!1,E(M),M=-1),m=!0;var K=p;try{for(A(q),h=n(u);h!==null&&(!(h.expirationTime>q)||j&&!O());){var P=h.callback;if(typeof P=="function"){h.callback=null,p=h.priorityLevel;var G=P(h.expirationTime<=q);q=e.unstable_now(),typeof G=="function"?h.callback=G:h===n(u)&&r(u),A(q)}else r(u);h=n(u)}if(h!==null)var me=!0;else{var _e=n(c);_e!==null&&Y(C,_e.startTime-q),me=!1}return me}finally{h=null,p=K,m=!1}}var D=!1,$=null,M=-1,T=5,L=-1;function O(){return!(e.unstable_now()-L<T)}function X(){if($!==null){var j=e.unstable_now();L=j;var q=!0;try{q=$(!0,j)}finally{q?W():(D=!1,$=null)}}else D=!1}var W;if(typeof S=="function")W=function(){S(X)};else if(typeof MessageChannel<"u"){var I=new MessageChannel,N=I.port2;I.port1.onmessage=X,W=function(){N.postMessage(null)}}else W=function(){w(X,0)};function U(j){$=j,D||(D=!0,W())}function Y(j,q){M=w(function(){j(e.unstable_now())},q)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(j){j.callback=null},e.unstable_continueExecution=function(){y||m||(y=!0,U(k))},e.unstable_forceFrameRate=function(j){0>j||125<j?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<j?Math.floor(1e3/j):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return n(u)},e.unstable_next=function(j){switch(p){case 1:case 2:case 3:var q=3;break;default:q=p}var K=p;p=q;try{return j()}finally{p=K}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(j,q){switch(j){case 1:case 2:case 3:case 4:case 5:break;default:j=3}var K=p;p=j;try{return q()}finally{p=K}},e.unstable_scheduleCallback=function(j,q,K){var P=e.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?P+K:P):K=P,j){case 1:var G=-1;break;case 2:G=250;break;case 5:G=1073741823;break;case 4:G=1e4;break;default:G=5e3}return G=K+G,j={id:f++,callback:q,priorityLevel:j,startTime:K,expirationTime:G,sortIndex:-1},K>P?(j.sortIndex=K,t(c,j),n(u)===null&&j===n(c)&&(v?(E(M),M=-1):v=!0,Y(C,K-P))):(j.sortIndex=G,t(u,j),y||m||(y=!0,U(k))),j},e.unstable_shouldYield=O,e.unstable_wrapCallback=function(j){var q=p;return function(){var K=p;p=q;try{return j.apply(this,arguments)}finally{p=K}}}})(rE)),rE}var P5;function FG(){return P5||(P5=1,nE.exports=$G()),nE.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var L5;function DG(){if(L5)return $r;L5=1;var e=pA(),t=FG();function n(l){for(var d="https://reactjs.org/docs/error-decoder.html?invariant="+l,g=1;g<arguments.length;g++)d+="&args[]="+encodeURIComponent(arguments[g]);return"Minified React error #"+l+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,i={};function o(l,d){s(l,d),s(l+"Capture",d)}function s(l,d){for(i[l]=d,l=0;l<d.length;l++)r.add(d[l])}var a=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,c=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},h={};function p(l){return u.call(h,l)?!0:u.call(f,l)?!1:c.test(l)?h[l]=!0:(f[l]=!0,!1)}function m(l,d,g,x){if(g!==null&&g.type===0)return!1;switch(typeof d){case"function":case"symbol":return!0;case"boolean":return x?!1:g!==null?!g.acceptsBooleans:(l=l.toLowerCase().slice(0,5),l!=="data-"&&l!=="aria-");default:return!1}}function y(l,d,g,x){if(d===null||typeof d>"u"||m(l,d,g,x))return!0;if(x)return!1;if(g!==null)switch(g.type){case 3:return!d;case 4:return d===!1;case 5:return isNaN(d);case 6:return isNaN(d)||1>d}return!1}function v(l,d,g,x,b,_,F){this.acceptsBooleans=d===2||d===3||d===4,this.attributeName=x,this.attributeNamespace=b,this.mustUseProperty=g,this.propertyName=l,this.type=d,this.sanitizeURL=_,this.removeEmptyString=F}var w={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(l){w[l]=new v(l,0,!1,l,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(l){var d=l[0];w[d]=new v(d,1,!1,l[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(l){w[l]=new v(l,2,!1,l.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(l){w[l]=new v(l,2,!1,l,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(l){w[l]=new v(l,3,!1,l.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(l){w[l]=new v(l,3,!0,l,null,!1,!1)}),["capture","download"].forEach(function(l){w[l]=new v(l,4,!1,l,null,!1,!1)}),["cols","rows","size","span"].forEach(function(l){w[l]=new v(l,6,!1,l,null,!1,!1)}),["rowSpan","start"].forEach(function(l){w[l]=new v(l,5,!1,l.toLowerCase(),null,!1,!1)});var E=/[\-:]([a-z])/g;function S(l){return l[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(l){var d=l.replace(E,S);w[d]=new v(d,1,!1,l,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(l){var d=l.replace(E,S);w[d]=new v(d,1,!1,l,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(l){var d=l.replace(E,S);w[d]=new v(d,1,!1,l,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(l){w[l]=new v(l,1,!1,l.toLowerCase(),null,!1,!1)}),w.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(l){w[l]=new v(l,1,!1,l.toLowerCase(),null,!0,!0)});function A(l,d,g,x){var b=w.hasOwnProperty(d)?w[d]:null;(b!==null?b.type!==0:x||!(2<d.length)||d[0]!=="o"&&d[0]!=="O"||d[1]!=="n"&&d[1]!=="N")&&(y(d,g,b,x)&&(g=null),x||b===null?p(d)&&(g===null?l.removeAttribute(d):l.setAttribute(d,""+g)):b.mustUseProperty?l[b.propertyName]=g===null?b.type===3?!1:"":g:(d=b.attributeName,x=b.attributeNamespace,g===null?l.removeAttribute(d):(b=b.type,g=b===3||b===4&&g===!0?"":""+g,x?l.setAttributeNS(x,d,g):l.setAttribute(d,g))))}var C=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,k=Symbol.for("react.element"),D=Symbol.for("react.portal"),$=Symbol.for("react.fragment"),M=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),L=Symbol.for("react.provider"),O=Symbol.for("react.context"),X=Symbol.for("react.forward_ref"),W=Symbol.for("react.suspense"),I=Symbol.for("react.suspense_list"),N=Symbol.for("react.memo"),U=Symbol.for("react.lazy"),Y=Symbol.for("react.offscreen"),j=Symbol.iterator;function q(l){return l===null||typeof l!="object"?null:(l=j&&l[j]||l["@@iterator"],typeof l=="function"?l:null)}var K=Object.assign,P;function G(l){if(P===void 0)try{throw Error()}catch(g){var d=g.stack.trim().match(/\n( *(at )?)/);P=d&&d[1]||""}return`
`+P+l}var me=!1;function _e(l,d){if(!l||me)return"";me=!0;var g=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(d)if(d=function(){throw Error()},Object.defineProperty(d.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(d,[])}catch(Q){var x=Q}Reflect.construct(l,[],d)}else{try{d.call()}catch(Q){x=Q}l.call(d.prototype)}else{try{throw Error()}catch(Q){x=Q}l()}}catch(Q){if(Q&&x&&typeof Q.stack=="string"){for(var b=Q.stack.split(`
`),_=x.stack.split(`
`),F=b.length-1,R=_.length-1;1<=F&&0<=R&&b[F]!==_[R];)R--;for(;1<=F&&0<=R;F--,R--)if(b[F]!==_[R]){if(F!==1||R!==1)do if(F--,R--,0>R||b[F]!==_[R]){var z=`
`+b[F].replace(" at new "," at ");return l.displayName&&z.includes("<anonymous>")&&(z=z.replace("<anonymous>",l.displayName)),z}while(1<=F&&0<=R);break}}}finally{me=!1,Error.prepareStackTrace=g}return(l=l?l.displayName||l.name:"")?G(l):""}function we(l){switch(l.tag){case 5:return G(l.type);case 16:return G("Lazy");case 13:return G("Suspense");case 19:return G("SuspenseList");case 0:case 2:case 15:return l=_e(l.type,!1),l;case 11:return l=_e(l.type.render,!1),l;case 1:return l=_e(l.type,!0),l;default:return""}}function Ie(l){if(l==null)return null;if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l;switch(l){case $:return"Fragment";case D:return"Portal";case T:return"Profiler";case M:return"StrictMode";case W:return"Suspense";case I:return"SuspenseList"}if(typeof l=="object")switch(l.$$typeof){case O:return(l.displayName||"Context")+".Consumer";case L:return(l._context.displayName||"Context")+".Provider";case X:var d=l.render;return l=l.displayName,l||(l=d.displayName||d.name||"",l=l!==""?"ForwardRef("+l+")":"ForwardRef"),l;case N:return d=l.displayName||null,d!==null?d:Ie(l.type)||"Memo";case U:d=l._payload,l=l._init;try{return Ie(l(d))}catch{}}return null}function et(l){var d=l.type;switch(l.tag){case 24:return"Cache";case 9:return(d.displayName||"Context")+".Consumer";case 10:return(d._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return l=d.render,l=l.displayName||l.name||"",d.displayName||(l!==""?"ForwardRef("+l+")":"ForwardRef");case 7:return"Fragment";case 5:return d;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ie(d);case 8:return d===M?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof d=="function")return d.displayName||d.name||null;if(typeof d=="string")return d}return null}function Ve(l){switch(typeof l){case"boolean":case"number":case"string":case"undefined":return l;case"object":return l;default:return""}}function fe(l){var d=l.type;return(l=l.nodeName)&&l.toLowerCase()==="input"&&(d==="checkbox"||d==="radio")}function Re(l){var d=fe(l)?"checked":"value",g=Object.getOwnPropertyDescriptor(l.constructor.prototype,d),x=""+l[d];if(!l.hasOwnProperty(d)&&typeof g<"u"&&typeof g.get=="function"&&typeof g.set=="function"){var b=g.get,_=g.set;return Object.defineProperty(l,d,{configurable:!0,get:function(){return b.call(this)},set:function(F){x=""+F,_.call(this,F)}}),Object.defineProperty(l,d,{enumerable:g.enumerable}),{getValue:function(){return x},setValue:function(F){x=""+F},stopTracking:function(){l._valueTracker=null,delete l[d]}}}}function We(l){l._valueTracker||(l._valueTracker=Re(l))}function le(l){if(!l)return!1;var d=l._valueTracker;if(!d)return!0;var g=d.getValue(),x="";return l&&(x=fe(l)?l.checked?"true":"false":l.value),l=x,l!==g?(d.setValue(l),!0):!1}function zt(l){if(l=l||(typeof document<"u"?document:void 0),typeof l>"u")return null;try{return l.activeElement||l.body}catch{return l.body}}function nt(l,d){var g=d.checked;return K({},d,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:g??l._wrapperState.initialChecked})}function Zt(l,d){var g=d.defaultValue==null?"":d.defaultValue,x=d.checked!=null?d.checked:d.defaultChecked;g=Ve(d.value!=null?d.value:g),l._wrapperState={initialChecked:x,initialValue:g,controlled:d.type==="checkbox"||d.type==="radio"?d.checked!=null:d.value!=null}}function qt(l,d){d=d.checked,d!=null&&A(l,"checked",d,!1)}function br(l,d){qt(l,d);var g=Ve(d.value),x=d.type;if(g!=null)x==="number"?(g===0&&l.value===""||l.value!=g)&&(l.value=""+g):l.value!==""+g&&(l.value=""+g);else if(x==="submit"||x==="reset"){l.removeAttribute("value");return}d.hasOwnProperty("value")?u2(l,d.type,g):d.hasOwnProperty("defaultValue")&&u2(l,d.type,Ve(d.defaultValue)),d.checked==null&&d.defaultChecked!=null&&(l.defaultChecked=!!d.defaultChecked)}function Fu(l,d,g){if(d.hasOwnProperty("value")||d.hasOwnProperty("defaultValue")){var x=d.type;if(!(x!=="submit"&&x!=="reset"||d.value!==void 0&&d.value!==null))return;d=""+l._wrapperState.initialValue,g||d===l.value||(l.value=d),l.defaultValue=d}g=l.name,g!==""&&(l.name=""),l.defaultChecked=!!l._wrapperState.initialChecked,g!==""&&(l.name=g)}function u2(l,d,g){(d!=="number"||zt(l.ownerDocument)!==l)&&(g==null?l.defaultValue=""+l._wrapperState.initialValue:l.defaultValue!==""+g&&(l.defaultValue=""+g))}var _d=Array.isArray;function fc(l,d,g,x){if(l=l.options,d){d={};for(var b=0;b<g.length;b++)d["$"+g[b]]=!0;for(g=0;g<l.length;g++)b=d.hasOwnProperty("$"+l[g].value),l[g].selected!==b&&(l[g].selected=b),b&&x&&(l[g].defaultSelected=!0)}else{for(g=""+Ve(g),d=null,b=0;b<l.length;b++){if(l[b].value===g){l[b].selected=!0,x&&(l[b].defaultSelected=!0);return}d!==null||l[b].disabled||(d=l[b])}d!==null&&(d.selected=!0)}}function l2(l,d){if(d.dangerouslySetInnerHTML!=null)throw Error(n(91));return K({},d,{value:void 0,defaultValue:void 0,children:""+l._wrapperState.initialValue})}function U3(l,d){var g=d.value;if(g==null){if(g=d.children,d=d.defaultValue,g!=null){if(d!=null)throw Error(n(92));if(_d(g)){if(1<g.length)throw Error(n(93));g=g[0]}d=g}d==null&&(d=""),g=d}l._wrapperState={initialValue:Ve(g)}}function j3(l,d){var g=Ve(d.value),x=Ve(d.defaultValue);g!=null&&(g=""+g,g!==l.value&&(l.value=g),d.defaultValue==null&&l.defaultValue!==g&&(l.defaultValue=g)),x!=null&&(l.defaultValue=""+x)}function W3(l){var d=l.textContent;d===l._wrapperState.initialValue&&d!==""&&d!==null&&(l.value=d)}function q3(l){switch(l){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function c2(l,d){return l==null||l==="http://www.w3.org/1999/xhtml"?q3(d):l==="http://www.w3.org/2000/svg"&&d==="foreignObject"?"http://www.w3.org/1999/xhtml":l}var Xg,H3=(function(l){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(d,g,x,b){MSApp.execUnsafeLocalFunction(function(){return l(d,g,x,b)})}:l})(function(l,d){if(l.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in l)l.innerHTML=d;else{for(Xg=Xg||document.createElement("div"),Xg.innerHTML="<svg>"+d.valueOf().toString()+"</svg>",d=Xg.firstChild;l.firstChild;)l.removeChild(l.firstChild);for(;d.firstChild;)l.appendChild(d.firstChild)}});function Ad(l,d){if(d){var g=l.firstChild;if(g&&g===l.lastChild&&g.nodeType===3){g.nodeValue=d;return}}l.textContent=d}var Cd={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Fq=["Webkit","ms","Moz","O"];Object.keys(Cd).forEach(function(l){Fq.forEach(function(d){d=d+l.charAt(0).toUpperCase()+l.substring(1),Cd[d]=Cd[l]})});function G3(l,d,g){return d==null||typeof d=="boolean"||d===""?"":g||typeof d!="number"||d===0||Cd.hasOwnProperty(l)&&Cd[l]?(""+d).trim():d+"px"}function V3(l,d){l=l.style;for(var g in d)if(d.hasOwnProperty(g)){var x=g.indexOf("--")===0,b=G3(g,d[g],x);g==="float"&&(g="cssFloat"),x?l.setProperty(g,b):l[g]=b}}var Dq=K({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function f2(l,d){if(d){if(Dq[l]&&(d.children!=null||d.dangerouslySetInnerHTML!=null))throw Error(n(137,l));if(d.dangerouslySetInnerHTML!=null){if(d.children!=null)throw Error(n(60));if(typeof d.dangerouslySetInnerHTML!="object"||!("__html"in d.dangerouslySetInnerHTML))throw Error(n(61))}if(d.style!=null&&typeof d.style!="object")throw Error(n(62))}}function d2(l,d){if(l.indexOf("-")===-1)return typeof d.is=="string";switch(l){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var h2=null;function p2(l){return l=l.target||l.srcElement||window,l.correspondingUseElement&&(l=l.correspondingUseElement),l.nodeType===3?l.parentNode:l}var g2=null,dc=null,hc=null;function Y3(l){if(l=Yd(l)){if(typeof g2!="function")throw Error(n(280));var d=l.stateNode;d&&(d=v0(d),g2(l.stateNode,l.type,d))}}function X3(l){dc?hc?hc.push(l):hc=[l]:dc=l}function Q3(){if(dc){var l=dc,d=hc;if(hc=dc=null,Y3(l),d)for(l=0;l<d.length;l++)Y3(d[l])}}function K3(l,d){return l(d)}function J3(){}var m2=!1;function Z3(l,d,g){if(m2)return l(d,g);m2=!0;try{return K3(l,d,g)}finally{m2=!1,(dc!==null||hc!==null)&&(J3(),Q3())}}function kd(l,d){var g=l.stateNode;if(g===null)return null;var x=v0(g);if(x===null)return null;g=x[d];e:switch(d){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(x=!x.disabled)||(l=l.type,x=!(l==="button"||l==="input"||l==="select"||l==="textarea")),l=!x;break e;default:l=!1}if(l)return null;if(g&&typeof g!="function")throw Error(n(231,d,typeof g));return g}var y2=!1;if(a)try{var $d={};Object.defineProperty($d,"passive",{get:function(){y2=!0}}),window.addEventListener("test",$d,$d),window.removeEventListener("test",$d,$d)}catch{y2=!1}function Mq(l,d,g,x,b,_,F,R,z){var Q=Array.prototype.slice.call(arguments,3);try{d.apply(g,Q)}catch(ie){this.onError(ie)}}var Fd=!1,Qg=null,Kg=!1,v2=null,Tq={onError:function(l){Fd=!0,Qg=l}};function Nq(l,d,g,x,b,_,F,R,z){Fd=!1,Qg=null,Mq.apply(Tq,arguments)}function Rq(l,d,g,x,b,_,F,R,z){if(Nq.apply(this,arguments),Fd){if(Fd){var Q=Qg;Fd=!1,Qg=null}else throw Error(n(198));Kg||(Kg=!0,v2=Q)}}function Du(l){var d=l,g=l;if(l.alternate)for(;d.return;)d=d.return;else{l=d;do d=l,(d.flags&4098)!==0&&(g=d.return),l=d.return;while(l)}return d.tag===3?g:null}function eD(l){if(l.tag===13){var d=l.memoizedState;if(d===null&&(l=l.alternate,l!==null&&(d=l.memoizedState)),d!==null)return d.dehydrated}return null}function tD(l){if(Du(l)!==l)throw Error(n(188))}function Oq(l){var d=l.alternate;if(!d){if(d=Du(l),d===null)throw Error(n(188));return d!==l?null:l}for(var g=l,x=d;;){var b=g.return;if(b===null)break;var _=b.alternate;if(_===null){if(x=b.return,x!==null){g=x;continue}break}if(b.child===_.child){for(_=b.child;_;){if(_===g)return tD(b),l;if(_===x)return tD(b),d;_=_.sibling}throw Error(n(188))}if(g.return!==x.return)g=b,x=_;else{for(var F=!1,R=b.child;R;){if(R===g){F=!0,g=b,x=_;break}if(R===x){F=!0,x=b,g=_;break}R=R.sibling}if(!F){for(R=_.child;R;){if(R===g){F=!0,g=_,x=b;break}if(R===x){F=!0,x=_,g=b;break}R=R.sibling}if(!F)throw Error(n(189))}}if(g.alternate!==x)throw Error(n(190))}if(g.tag!==3)throw Error(n(188));return g.stateNode.current===g?l:d}function nD(l){return l=Oq(l),l!==null?rD(l):null}function rD(l){if(l.tag===5||l.tag===6)return l;for(l=l.child;l!==null;){var d=rD(l);if(d!==null)return d;l=l.sibling}return null}var iD=t.unstable_scheduleCallback,oD=t.unstable_cancelCallback,Pq=t.unstable_shouldYield,Lq=t.unstable_requestPaint,Ht=t.unstable_now,zq=t.unstable_getCurrentPriorityLevel,x2=t.unstable_ImmediatePriority,sD=t.unstable_UserBlockingPriority,Jg=t.unstable_NormalPriority,Iq=t.unstable_LowPriority,aD=t.unstable_IdlePriority,Zg=null,bo=null;function Bq(l){if(bo&&typeof bo.onCommitFiberRoot=="function")try{bo.onCommitFiberRoot(Zg,l,void 0,(l.current.flags&128)===128)}catch{}}var Li=Math.clz32?Math.clz32:Wq,Uq=Math.log,jq=Math.LN2;function Wq(l){return l>>>=0,l===0?32:31-(Uq(l)/jq|0)|0}var e0=64,t0=4194304;function Dd(l){switch(l&-l){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return l&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return l}}function n0(l,d){var g=l.pendingLanes;if(g===0)return 0;var x=0,b=l.suspendedLanes,_=l.pingedLanes,F=g&268435455;if(F!==0){var R=F&~b;R!==0?x=Dd(R):(_&=F,_!==0&&(x=Dd(_)))}else F=g&~b,F!==0?x=Dd(F):_!==0&&(x=Dd(_));if(x===0)return 0;if(d!==0&&d!==x&&(d&b)===0&&(b=x&-x,_=d&-d,b>=_||b===16&&(_&4194240)!==0))return d;if((x&4)!==0&&(x|=g&16),d=l.entangledLanes,d!==0)for(l=l.entanglements,d&=x;0<d;)g=31-Li(d),b=1<<g,x|=l[g],d&=~b;return x}function qq(l,d){switch(l){case 1:case 2:case 4:return d+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Hq(l,d){for(var g=l.suspendedLanes,x=l.pingedLanes,b=l.expirationTimes,_=l.pendingLanes;0<_;){var F=31-Li(_),R=1<<F,z=b[F];z===-1?((R&g)===0||(R&x)!==0)&&(b[F]=qq(R,d)):z<=d&&(l.expiredLanes|=R),_&=~R}}function w2(l){return l=l.pendingLanes&-1073741825,l!==0?l:l&1073741824?1073741824:0}function uD(){var l=e0;return e0<<=1,(e0&4194240)===0&&(e0=64),l}function E2(l){for(var d=[],g=0;31>g;g++)d.push(l);return d}function Md(l,d,g){l.pendingLanes|=d,d!==536870912&&(l.suspendedLanes=0,l.pingedLanes=0),l=l.eventTimes,d=31-Li(d),l[d]=g}function Gq(l,d){var g=l.pendingLanes&~d;l.pendingLanes=d,l.suspendedLanes=0,l.pingedLanes=0,l.expiredLanes&=d,l.mutableReadLanes&=d,l.entangledLanes&=d,d=l.entanglements;var x=l.eventTimes;for(l=l.expirationTimes;0<g;){var b=31-Li(g),_=1<<b;d[b]=0,x[b]=-1,l[b]=-1,g&=~_}}function b2(l,d){var g=l.entangledLanes|=d;for(l=l.entanglements;g;){var x=31-Li(g),b=1<<x;b&d|l[x]&d&&(l[x]|=d),g&=~b}}var dt=0;function lD(l){return l&=-l,1<l?4<l?(l&268435455)!==0?16:536870912:4:1}var cD,S2,fD,dD,hD,_2=!1,r0=[],ua=null,la=null,ca=null,Td=new Map,Nd=new Map,fa=[],Vq="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function pD(l,d){switch(l){case"focusin":case"focusout":ua=null;break;case"dragenter":case"dragleave":la=null;break;case"mouseover":case"mouseout":ca=null;break;case"pointerover":case"pointerout":Td.delete(d.pointerId);break;case"gotpointercapture":case"lostpointercapture":Nd.delete(d.pointerId)}}function Rd(l,d,g,x,b,_){return l===null||l.nativeEvent!==_?(l={blockedOn:d,domEventName:g,eventSystemFlags:x,nativeEvent:_,targetContainers:[b]},d!==null&&(d=Yd(d),d!==null&&S2(d)),l):(l.eventSystemFlags|=x,d=l.targetContainers,b!==null&&d.indexOf(b)===-1&&d.push(b),l)}function Yq(l,d,g,x,b){switch(d){case"focusin":return ua=Rd(ua,l,d,g,x,b),!0;case"dragenter":return la=Rd(la,l,d,g,x,b),!0;case"mouseover":return ca=Rd(ca,l,d,g,x,b),!0;case"pointerover":var _=b.pointerId;return Td.set(_,Rd(Td.get(_)||null,l,d,g,x,b)),!0;case"gotpointercapture":return _=b.pointerId,Nd.set(_,Rd(Nd.get(_)||null,l,d,g,x,b)),!0}return!1}function gD(l){var d=Mu(l.target);if(d!==null){var g=Du(d);if(g!==null){if(d=g.tag,d===13){if(d=eD(g),d!==null){l.blockedOn=d,hD(l.priority,function(){fD(g)});return}}else if(d===3&&g.stateNode.current.memoizedState.isDehydrated){l.blockedOn=g.tag===3?g.stateNode.containerInfo:null;return}}}l.blockedOn=null}function i0(l){if(l.blockedOn!==null)return!1;for(var d=l.targetContainers;0<d.length;){var g=C2(l.domEventName,l.eventSystemFlags,d[0],l.nativeEvent);if(g===null){g=l.nativeEvent;var x=new g.constructor(g.type,g);h2=x,g.target.dispatchEvent(x),h2=null}else return d=Yd(g),d!==null&&S2(d),l.blockedOn=g,!1;d.shift()}return!0}function mD(l,d,g){i0(l)&&g.delete(d)}function Xq(){_2=!1,ua!==null&&i0(ua)&&(ua=null),la!==null&&i0(la)&&(la=null),ca!==null&&i0(ca)&&(ca=null),Td.forEach(mD),Nd.forEach(mD)}function Od(l,d){l.blockedOn===d&&(l.blockedOn=null,_2||(_2=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,Xq)))}function Pd(l){function d(b){return Od(b,l)}if(0<r0.length){Od(r0[0],l);for(var g=1;g<r0.length;g++){var x=r0[g];x.blockedOn===l&&(x.blockedOn=null)}}for(ua!==null&&Od(ua,l),la!==null&&Od(la,l),ca!==null&&Od(ca,l),Td.forEach(d),Nd.forEach(d),g=0;g<fa.length;g++)x=fa[g],x.blockedOn===l&&(x.blockedOn=null);for(;0<fa.length&&(g=fa[0],g.blockedOn===null);)gD(g),g.blockedOn===null&&fa.shift()}var pc=C.ReactCurrentBatchConfig,o0=!0;function Qq(l,d,g,x){var b=dt,_=pc.transition;pc.transition=null;try{dt=1,A2(l,d,g,x)}finally{dt=b,pc.transition=_}}function Kq(l,d,g,x){var b=dt,_=pc.transition;pc.transition=null;try{dt=4,A2(l,d,g,x)}finally{dt=b,pc.transition=_}}function A2(l,d,g,x){if(o0){var b=C2(l,d,g,x);if(b===null)W2(l,d,x,s0,g),pD(l,x);else if(Yq(b,l,d,g,x))x.stopPropagation();else if(pD(l,x),d&4&&-1<Vq.indexOf(l)){for(;b!==null;){var _=Yd(b);if(_!==null&&cD(_),_=C2(l,d,g,x),_===null&&W2(l,d,x,s0,g),_===b)break;b=_}b!==null&&x.stopPropagation()}else W2(l,d,x,null,g)}}var s0=null;function C2(l,d,g,x){if(s0=null,l=p2(x),l=Mu(l),l!==null)if(d=Du(l),d===null)l=null;else if(g=d.tag,g===13){if(l=eD(d),l!==null)return l;l=null}else if(g===3){if(d.stateNode.current.memoizedState.isDehydrated)return d.tag===3?d.stateNode.containerInfo:null;l=null}else d!==l&&(l=null);return s0=l,null}function yD(l){switch(l){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(zq()){case x2:return 1;case sD:return 4;case Jg:case Iq:return 16;case aD:return 536870912;default:return 16}default:return 16}}var da=null,k2=null,a0=null;function vD(){if(a0)return a0;var l,d=k2,g=d.length,x,b="value"in da?da.value:da.textContent,_=b.length;for(l=0;l<g&&d[l]===b[l];l++);var F=g-l;for(x=1;x<=F&&d[g-x]===b[_-x];x++);return a0=b.slice(l,1<x?1-x:void 0)}function u0(l){var d=l.keyCode;return"charCode"in l?(l=l.charCode,l===0&&d===13&&(l=13)):l=d,l===10&&(l=13),32<=l||l===13?l:0}function l0(){return!0}function xD(){return!1}function Gr(l){function d(g,x,b,_,F){this._reactName=g,this._targetInst=b,this.type=x,this.nativeEvent=_,this.target=F,this.currentTarget=null;for(var R in l)l.hasOwnProperty(R)&&(g=l[R],this[R]=g?g(_):_[R]);return this.isDefaultPrevented=(_.defaultPrevented!=null?_.defaultPrevented:_.returnValue===!1)?l0:xD,this.isPropagationStopped=xD,this}return K(d.prototype,{preventDefault:function(){this.defaultPrevented=!0;var g=this.nativeEvent;g&&(g.preventDefault?g.preventDefault():typeof g.returnValue!="unknown"&&(g.returnValue=!1),this.isDefaultPrevented=l0)},stopPropagation:function(){var g=this.nativeEvent;g&&(g.stopPropagation?g.stopPropagation():typeof g.cancelBubble!="unknown"&&(g.cancelBubble=!0),this.isPropagationStopped=l0)},persist:function(){},isPersistent:l0}),d}var gc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(l){return l.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},$2=Gr(gc),Ld=K({},gc,{view:0,detail:0}),Jq=Gr(Ld),F2,D2,zd,c0=K({},Ld,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:T2,button:0,buttons:0,relatedTarget:function(l){return l.relatedTarget===void 0?l.fromElement===l.srcElement?l.toElement:l.fromElement:l.relatedTarget},movementX:function(l){return"movementX"in l?l.movementX:(l!==zd&&(zd&&l.type==="mousemove"?(F2=l.screenX-zd.screenX,D2=l.screenY-zd.screenY):D2=F2=0,zd=l),F2)},movementY:function(l){return"movementY"in l?l.movementY:D2}}),wD=Gr(c0),Zq=K({},c0,{dataTransfer:0}),eH=Gr(Zq),tH=K({},Ld,{relatedTarget:0}),M2=Gr(tH),nH=K({},gc,{animationName:0,elapsedTime:0,pseudoElement:0}),rH=Gr(nH),iH=K({},gc,{clipboardData:function(l){return"clipboardData"in l?l.clipboardData:window.clipboardData}}),oH=Gr(iH),sH=K({},gc,{data:0}),ED=Gr(sH),aH={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},uH={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},lH={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function cH(l){var d=this.nativeEvent;return d.getModifierState?d.getModifierState(l):(l=lH[l])?!!d[l]:!1}function T2(){return cH}var fH=K({},Ld,{key:function(l){if(l.key){var d=aH[l.key]||l.key;if(d!=="Unidentified")return d}return l.type==="keypress"?(l=u0(l),l===13?"Enter":String.fromCharCode(l)):l.type==="keydown"||l.type==="keyup"?uH[l.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:T2,charCode:function(l){return l.type==="keypress"?u0(l):0},keyCode:function(l){return l.type==="keydown"||l.type==="keyup"?l.keyCode:0},which:function(l){return l.type==="keypress"?u0(l):l.type==="keydown"||l.type==="keyup"?l.keyCode:0}}),dH=Gr(fH),hH=K({},c0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),bD=Gr(hH),pH=K({},Ld,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:T2}),gH=Gr(pH),mH=K({},gc,{propertyName:0,elapsedTime:0,pseudoElement:0}),yH=Gr(mH),vH=K({},c0,{deltaX:function(l){return"deltaX"in l?l.deltaX:"wheelDeltaX"in l?-l.wheelDeltaX:0},deltaY:function(l){return"deltaY"in l?l.deltaY:"wheelDeltaY"in l?-l.wheelDeltaY:"wheelDelta"in l?-l.wheelDelta:0},deltaZ:0,deltaMode:0}),xH=Gr(vH),wH=[9,13,27,32],N2=a&&"CompositionEvent"in window,Id=null;a&&"documentMode"in document&&(Id=document.documentMode);var EH=a&&"TextEvent"in window&&!Id,SD=a&&(!N2||Id&&8<Id&&11>=Id),_D=" ",AD=!1;function CD(l,d){switch(l){case"keyup":return wH.indexOf(d.keyCode)!==-1;case"keydown":return d.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function kD(l){return l=l.detail,typeof l=="object"&&"data"in l?l.data:null}var mc=!1;function bH(l,d){switch(l){case"compositionend":return kD(d);case"keypress":return d.which!==32?null:(AD=!0,_D);case"textInput":return l=d.data,l===_D&&AD?null:l;default:return null}}function SH(l,d){if(mc)return l==="compositionend"||!N2&&CD(l,d)?(l=vD(),a0=k2=da=null,mc=!1,l):null;switch(l){case"paste":return null;case"keypress":if(!(d.ctrlKey||d.altKey||d.metaKey)||d.ctrlKey&&d.altKey){if(d.char&&1<d.char.length)return d.char;if(d.which)return String.fromCharCode(d.which)}return null;case"compositionend":return SD&&d.locale!=="ko"?null:d.data;default:return null}}var _H={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $D(l){var d=l&&l.nodeName&&l.nodeName.toLowerCase();return d==="input"?!!_H[l.type]:d==="textarea"}function FD(l,d,g,x){X3(x),d=g0(d,"onChange"),0<d.length&&(g=new $2("onChange","change",null,g,x),l.push({event:g,listeners:d}))}var Bd=null,Ud=null;function AH(l){VD(l,0)}function f0(l){var d=Ec(l);if(le(d))return l}function CH(l,d){if(l==="change")return d}var DD=!1;if(a){var R2;if(a){var O2="oninput"in document;if(!O2){var MD=document.createElement("div");MD.setAttribute("oninput","return;"),O2=typeof MD.oninput=="function"}R2=O2}else R2=!1;DD=R2&&(!document.documentMode||9<document.documentMode)}function TD(){Bd&&(Bd.detachEvent("onpropertychange",ND),Ud=Bd=null)}function ND(l){if(l.propertyName==="value"&&f0(Ud)){var d=[];FD(d,Ud,l,p2(l)),Z3(AH,d)}}function kH(l,d,g){l==="focusin"?(TD(),Bd=d,Ud=g,Bd.attachEvent("onpropertychange",ND)):l==="focusout"&&TD()}function $H(l){if(l==="selectionchange"||l==="keyup"||l==="keydown")return f0(Ud)}function FH(l,d){if(l==="click")return f0(d)}function DH(l,d){if(l==="input"||l==="change")return f0(d)}function MH(l,d){return l===d&&(l!==0||1/l===1/d)||l!==l&&d!==d}var zi=typeof Object.is=="function"?Object.is:MH;function jd(l,d){if(zi(l,d))return!0;if(typeof l!="object"||l===null||typeof d!="object"||d===null)return!1;var g=Object.keys(l),x=Object.keys(d);if(g.length!==x.length)return!1;for(x=0;x<g.length;x++){var b=g[x];if(!u.call(d,b)||!zi(l[b],d[b]))return!1}return!0}function RD(l){for(;l&&l.firstChild;)l=l.firstChild;return l}function OD(l,d){var g=RD(l);l=0;for(var x;g;){if(g.nodeType===3){if(x=l+g.textContent.length,l<=d&&x>=d)return{node:g,offset:d-l};l=x}e:{for(;g;){if(g.nextSibling){g=g.nextSibling;break e}g=g.parentNode}g=void 0}g=RD(g)}}function PD(l,d){return l&&d?l===d?!0:l&&l.nodeType===3?!1:d&&d.nodeType===3?PD(l,d.parentNode):"contains"in l?l.contains(d):l.compareDocumentPosition?!!(l.compareDocumentPosition(d)&16):!1:!1}function LD(){for(var l=window,d=zt();d instanceof l.HTMLIFrameElement;){try{var g=typeof d.contentWindow.location.href=="string"}catch{g=!1}if(g)l=d.contentWindow;else break;d=zt(l.document)}return d}function P2(l){var d=l&&l.nodeName&&l.nodeName.toLowerCase();return d&&(d==="input"&&(l.type==="text"||l.type==="search"||l.type==="tel"||l.type==="url"||l.type==="password")||d==="textarea"||l.contentEditable==="true")}function TH(l){var d=LD(),g=l.focusedElem,x=l.selectionRange;if(d!==g&&g&&g.ownerDocument&&PD(g.ownerDocument.documentElement,g)){if(x!==null&&P2(g)){if(d=x.start,l=x.end,l===void 0&&(l=d),"selectionStart"in g)g.selectionStart=d,g.selectionEnd=Math.min(l,g.value.length);else if(l=(d=g.ownerDocument||document)&&d.defaultView||window,l.getSelection){l=l.getSelection();var b=g.textContent.length,_=Math.min(x.start,b);x=x.end===void 0?_:Math.min(x.end,b),!l.extend&&_>x&&(b=x,x=_,_=b),b=OD(g,_);var F=OD(g,x);b&&F&&(l.rangeCount!==1||l.anchorNode!==b.node||l.anchorOffset!==b.offset||l.focusNode!==F.node||l.focusOffset!==F.offset)&&(d=d.createRange(),d.setStart(b.node,b.offset),l.removeAllRanges(),_>x?(l.addRange(d),l.extend(F.node,F.offset)):(d.setEnd(F.node,F.offset),l.addRange(d)))}}for(d=[],l=g;l=l.parentNode;)l.nodeType===1&&d.push({element:l,left:l.scrollLeft,top:l.scrollTop});for(typeof g.focus=="function"&&g.focus(),g=0;g<d.length;g++)l=d[g],l.element.scrollLeft=l.left,l.element.scrollTop=l.top}}var NH=a&&"documentMode"in document&&11>=document.documentMode,yc=null,L2=null,Wd=null,z2=!1;function zD(l,d,g){var x=g.window===g?g.document:g.nodeType===9?g:g.ownerDocument;z2||yc==null||yc!==zt(x)||(x=yc,"selectionStart"in x&&P2(x)?x={start:x.selectionStart,end:x.selectionEnd}:(x=(x.ownerDocument&&x.ownerDocument.defaultView||window).getSelection(),x={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset}),Wd&&jd(Wd,x)||(Wd=x,x=g0(L2,"onSelect"),0<x.length&&(d=new $2("onSelect","select",null,d,g),l.push({event:d,listeners:x}),d.target=yc)))}function d0(l,d){var g={};return g[l.toLowerCase()]=d.toLowerCase(),g["Webkit"+l]="webkit"+d,g["Moz"+l]="moz"+d,g}var vc={animationend:d0("Animation","AnimationEnd"),animationiteration:d0("Animation","AnimationIteration"),animationstart:d0("Animation","AnimationStart"),transitionend:d0("Transition","TransitionEnd")},I2={},ID={};a&&(ID=document.createElement("div").style,"AnimationEvent"in window||(delete vc.animationend.animation,delete vc.animationiteration.animation,delete vc.animationstart.animation),"TransitionEvent"in window||delete vc.transitionend.transition);function h0(l){if(I2[l])return I2[l];if(!vc[l])return l;var d=vc[l],g;for(g in d)if(d.hasOwnProperty(g)&&g in ID)return I2[l]=d[g];return l}var BD=h0("animationend"),UD=h0("animationiteration"),jD=h0("animationstart"),WD=h0("transitionend"),qD=new Map,HD="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ha(l,d){qD.set(l,d),o(d,[l])}for(var B2=0;B2<HD.length;B2++){var U2=HD[B2],RH=U2.toLowerCase(),OH=U2[0].toUpperCase()+U2.slice(1);ha(RH,"on"+OH)}ha(BD,"onAnimationEnd"),ha(UD,"onAnimationIteration"),ha(jD,"onAnimationStart"),ha("dblclick","onDoubleClick"),ha("focusin","onFocus"),ha("focusout","onBlur"),ha(WD,"onTransitionEnd"),s("onMouseEnter",["mouseout","mouseover"]),s("onMouseLeave",["mouseout","mouseover"]),s("onPointerEnter",["pointerout","pointerover"]),s("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var qd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),PH=new Set("cancel close invalid load scroll toggle".split(" ").concat(qd));function GD(l,d,g){var x=l.type||"unknown-event";l.currentTarget=g,Rq(x,d,void 0,l),l.currentTarget=null}function VD(l,d){d=(d&4)!==0;for(var g=0;g<l.length;g++){var x=l[g],b=x.event;x=x.listeners;e:{var _=void 0;if(d)for(var F=x.length-1;0<=F;F--){var R=x[F],z=R.instance,Q=R.currentTarget;if(R=R.listener,z!==_&&b.isPropagationStopped())break e;GD(b,R,Q),_=z}else for(F=0;F<x.length;F++){if(R=x[F],z=R.instance,Q=R.currentTarget,R=R.listener,z!==_&&b.isPropagationStopped())break e;GD(b,R,Q),_=z}}}if(Kg)throw l=v2,Kg=!1,v2=null,l}function _t(l,d){var g=d[X2];g===void 0&&(g=d[X2]=new Set);var x=l+"__bubble";g.has(x)||(YD(d,l,2,!1),g.add(x))}function j2(l,d,g){var x=0;d&&(x|=4),YD(g,l,x,d)}var p0="_reactListening"+Math.random().toString(36).slice(2);function Hd(l){if(!l[p0]){l[p0]=!0,r.forEach(function(g){g!=="selectionchange"&&(PH.has(g)||j2(g,!1,l),j2(g,!0,l))});var d=l.nodeType===9?l:l.ownerDocument;d===null||d[p0]||(d[p0]=!0,j2("selectionchange",!1,d))}}function YD(l,d,g,x){switch(yD(d)){case 1:var b=Qq;break;case 4:b=Kq;break;default:b=A2}g=b.bind(null,d,g,l),b=void 0,!y2||d!=="touchstart"&&d!=="touchmove"&&d!=="wheel"||(b=!0),x?b!==void 0?l.addEventListener(d,g,{capture:!0,passive:b}):l.addEventListener(d,g,!0):b!==void 0?l.addEventListener(d,g,{passive:b}):l.addEventListener(d,g,!1)}function W2(l,d,g,x,b){var _=x;if((d&1)===0&&(d&2)===0&&x!==null)e:for(;;){if(x===null)return;var F=x.tag;if(F===3||F===4){var R=x.stateNode.containerInfo;if(R===b||R.nodeType===8&&R.parentNode===b)break;if(F===4)for(F=x.return;F!==null;){var z=F.tag;if((z===3||z===4)&&(z=F.stateNode.containerInfo,z===b||z.nodeType===8&&z.parentNode===b))return;F=F.return}for(;R!==null;){if(F=Mu(R),F===null)return;if(z=F.tag,z===5||z===6){x=_=F;continue e}R=R.parentNode}}x=x.return}Z3(function(){var Q=_,ie=p2(g),ae=[];e:{var re=qD.get(l);if(re!==void 0){var be=$2,Ae=l;switch(l){case"keypress":if(u0(g)===0)break e;case"keydown":case"keyup":be=dH;break;case"focusin":Ae="focus",be=M2;break;case"focusout":Ae="blur",be=M2;break;case"beforeblur":case"afterblur":be=M2;break;case"click":if(g.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":be=wD;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":be=eH;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":be=gH;break;case BD:case UD:case jD:be=rH;break;case WD:be=yH;break;case"scroll":be=Jq;break;case"wheel":be=xH;break;case"copy":case"cut":case"paste":be=oH;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":be=bD}var Ce=(d&4)!==0,Gt=!Ce&&l==="scroll",H=Ce?re!==null?re+"Capture":null:re;Ce=[];for(var B=Q,V;B!==null;){V=B;var he=V.stateNode;if(V.tag===5&&he!==null&&(V=he,H!==null&&(he=kd(B,H),he!=null&&Ce.push(Gd(B,he,V)))),Gt)break;B=B.return}0<Ce.length&&(re=new be(re,Ae,null,g,ie),ae.push({event:re,listeners:Ce}))}}if((d&7)===0){e:{if(re=l==="mouseover"||l==="pointerover",be=l==="mouseout"||l==="pointerout",re&&g!==h2&&(Ae=g.relatedTarget||g.fromElement)&&(Mu(Ae)||Ae[ps]))break e;if((be||re)&&(re=ie.window===ie?ie:(re=ie.ownerDocument)?re.defaultView||re.parentWindow:window,be?(Ae=g.relatedTarget||g.toElement,be=Q,Ae=Ae?Mu(Ae):null,Ae!==null&&(Gt=Du(Ae),Ae!==Gt||Ae.tag!==5&&Ae.tag!==6)&&(Ae=null)):(be=null,Ae=Q),be!==Ae)){if(Ce=wD,he="onMouseLeave",H="onMouseEnter",B="mouse",(l==="pointerout"||l==="pointerover")&&(Ce=bD,he="onPointerLeave",H="onPointerEnter",B="pointer"),Gt=be==null?re:Ec(be),V=Ae==null?re:Ec(Ae),re=new Ce(he,B+"leave",be,g,ie),re.target=Gt,re.relatedTarget=V,he=null,Mu(ie)===Q&&(Ce=new Ce(H,B+"enter",Ae,g,ie),Ce.target=V,Ce.relatedTarget=Gt,he=Ce),Gt=he,be&&Ae)t:{for(Ce=be,H=Ae,B=0,V=Ce;V;V=xc(V))B++;for(V=0,he=H;he;he=xc(he))V++;for(;0<B-V;)Ce=xc(Ce),B--;for(;0<V-B;)H=xc(H),V--;for(;B--;){if(Ce===H||H!==null&&Ce===H.alternate)break t;Ce=xc(Ce),H=xc(H)}Ce=null}else Ce=null;be!==null&&XD(ae,re,be,Ce,!1),Ae!==null&&Gt!==null&&XD(ae,Gt,Ae,Ce,!0)}}e:{if(re=Q?Ec(Q):window,be=re.nodeName&&re.nodeName.toLowerCase(),be==="select"||be==="input"&&re.type==="file")var De=CH;else if($D(re))if(DD)De=DH;else{De=$H;var Le=kH}else(be=re.nodeName)&&be.toLowerCase()==="input"&&(re.type==="checkbox"||re.type==="radio")&&(De=FH);if(De&&(De=De(l,Q))){FD(ae,De,g,ie);break e}Le&&Le(l,re,Q),l==="focusout"&&(Le=re._wrapperState)&&Le.controlled&&re.type==="number"&&u2(re,"number",re.value)}switch(Le=Q?Ec(Q):window,l){case"focusin":($D(Le)||Le.contentEditable==="true")&&(yc=Le,L2=Q,Wd=null);break;case"focusout":Wd=L2=yc=null;break;case"mousedown":z2=!0;break;case"contextmenu":case"mouseup":case"dragend":z2=!1,zD(ae,g,ie);break;case"selectionchange":if(NH)break;case"keydown":case"keyup":zD(ae,g,ie)}var ze;if(N2)e:{switch(l){case"compositionstart":var Be="onCompositionStart";break e;case"compositionend":Be="onCompositionEnd";break e;case"compositionupdate":Be="onCompositionUpdate";break e}Be=void 0}else mc?CD(l,g)&&(Be="onCompositionEnd"):l==="keydown"&&g.keyCode===229&&(Be="onCompositionStart");Be&&(SD&&g.locale!=="ko"&&(mc||Be!=="onCompositionStart"?Be==="onCompositionEnd"&&mc&&(ze=vD()):(da=ie,k2="value"in da?da.value:da.textContent,mc=!0)),Le=g0(Q,Be),0<Le.length&&(Be=new ED(Be,l,null,g,ie),ae.push({event:Be,listeners:Le}),ze?Be.data=ze:(ze=kD(g),ze!==null&&(Be.data=ze)))),(ze=EH?bH(l,g):SH(l,g))&&(Q=g0(Q,"onBeforeInput"),0<Q.length&&(ie=new ED("onBeforeInput","beforeinput",null,g,ie),ae.push({event:ie,listeners:Q}),ie.data=ze))}VD(ae,d)})}function Gd(l,d,g){return{instance:l,listener:d,currentTarget:g}}function g0(l,d){for(var g=d+"Capture",x=[];l!==null;){var b=l,_=b.stateNode;b.tag===5&&_!==null&&(b=_,_=kd(l,g),_!=null&&x.unshift(Gd(l,_,b)),_=kd(l,d),_!=null&&x.push(Gd(l,_,b))),l=l.return}return x}function xc(l){if(l===null)return null;do l=l.return;while(l&&l.tag!==5);return l||null}function XD(l,d,g,x,b){for(var _=d._reactName,F=[];g!==null&&g!==x;){var R=g,z=R.alternate,Q=R.stateNode;if(z!==null&&z===x)break;R.tag===5&&Q!==null&&(R=Q,b?(z=kd(g,_),z!=null&&F.unshift(Gd(g,z,R))):b||(z=kd(g,_),z!=null&&F.push(Gd(g,z,R)))),g=g.return}F.length!==0&&l.push({event:d,listeners:F})}var LH=/\r\n?/g,zH=/\u0000|\uFFFD/g;function QD(l){return(typeof l=="string"?l:""+l).replace(LH,`
`).replace(zH,"")}function m0(l,d,g){if(d=QD(d),QD(l)!==d&&g)throw Error(n(425))}function y0(){}var q2=null,H2=null;function G2(l,d){return l==="textarea"||l==="noscript"||typeof d.children=="string"||typeof d.children=="number"||typeof d.dangerouslySetInnerHTML=="object"&&d.dangerouslySetInnerHTML!==null&&d.dangerouslySetInnerHTML.__html!=null}var V2=typeof setTimeout=="function"?setTimeout:void 0,IH=typeof clearTimeout=="function"?clearTimeout:void 0,KD=typeof Promise=="function"?Promise:void 0,BH=typeof queueMicrotask=="function"?queueMicrotask:typeof KD<"u"?function(l){return KD.resolve(null).then(l).catch(UH)}:V2;function UH(l){setTimeout(function(){throw l})}function Y2(l,d){var g=d,x=0;do{var b=g.nextSibling;if(l.removeChild(g),b&&b.nodeType===8)if(g=b.data,g==="/$"){if(x===0){l.removeChild(b),Pd(d);return}x--}else g!=="$"&&g!=="$?"&&g!=="$!"||x++;g=b}while(g);Pd(d)}function pa(l){for(;l!=null;l=l.nextSibling){var d=l.nodeType;if(d===1||d===3)break;if(d===8){if(d=l.data,d==="$"||d==="$!"||d==="$?")break;if(d==="/$")return null}}return l}function JD(l){l=l.previousSibling;for(var d=0;l;){if(l.nodeType===8){var g=l.data;if(g==="$"||g==="$!"||g==="$?"){if(d===0)return l;d--}else g==="/$"&&d++}l=l.previousSibling}return null}var wc=Math.random().toString(36).slice(2),So="__reactFiber$"+wc,Vd="__reactProps$"+wc,ps="__reactContainer$"+wc,X2="__reactEvents$"+wc,jH="__reactListeners$"+wc,WH="__reactHandles$"+wc;function Mu(l){var d=l[So];if(d)return d;for(var g=l.parentNode;g;){if(d=g[ps]||g[So]){if(g=d.alternate,d.child!==null||g!==null&&g.child!==null)for(l=JD(l);l!==null;){if(g=l[So])return g;l=JD(l)}return d}l=g,g=l.parentNode}return null}function Yd(l){return l=l[So]||l[ps],!l||l.tag!==5&&l.tag!==6&&l.tag!==13&&l.tag!==3?null:l}function Ec(l){if(l.tag===5||l.tag===6)return l.stateNode;throw Error(n(33))}function v0(l){return l[Vd]||null}var Q2=[],bc=-1;function ga(l){return{current:l}}function At(l){0>bc||(l.current=Q2[bc],Q2[bc]=null,bc--)}function bt(l,d){bc++,Q2[bc]=l.current,l.current=d}var ma={},Ln=ga(ma),Sr=ga(!1),Tu=ma;function Sc(l,d){var g=l.type.contextTypes;if(!g)return ma;var x=l.stateNode;if(x&&x.__reactInternalMemoizedUnmaskedChildContext===d)return x.__reactInternalMemoizedMaskedChildContext;var b={},_;for(_ in g)b[_]=d[_];return x&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=d,l.__reactInternalMemoizedMaskedChildContext=b),b}function _r(l){return l=l.childContextTypes,l!=null}function x0(){At(Sr),At(Ln)}function ZD(l,d,g){if(Ln.current!==ma)throw Error(n(168));bt(Ln,d),bt(Sr,g)}function eM(l,d,g){var x=l.stateNode;if(d=d.childContextTypes,typeof x.getChildContext!="function")return g;x=x.getChildContext();for(var b in x)if(!(b in d))throw Error(n(108,et(l)||"Unknown",b));return K({},g,x)}function w0(l){return l=(l=l.stateNode)&&l.__reactInternalMemoizedMergedChildContext||ma,Tu=Ln.current,bt(Ln,l),bt(Sr,Sr.current),!0}function tM(l,d,g){var x=l.stateNode;if(!x)throw Error(n(169));g?(l=eM(l,d,Tu),x.__reactInternalMemoizedMergedChildContext=l,At(Sr),At(Ln),bt(Ln,l)):At(Sr),bt(Sr,g)}var gs=null,E0=!1,K2=!1;function nM(l){gs===null?gs=[l]:gs.push(l)}function qH(l){E0=!0,nM(l)}function ya(){if(!K2&&gs!==null){K2=!0;var l=0,d=dt;try{var g=gs;for(dt=1;l<g.length;l++){var x=g[l];do x=x(!0);while(x!==null)}gs=null,E0=!1}catch(b){throw gs!==null&&(gs=gs.slice(l+1)),iD(x2,ya),b}finally{dt=d,K2=!1}}return null}var _c=[],Ac=0,b0=null,S0=0,ci=[],fi=0,Nu=null,ms=1,ys="";function Ru(l,d){_c[Ac++]=S0,_c[Ac++]=b0,b0=l,S0=d}function rM(l,d,g){ci[fi++]=ms,ci[fi++]=ys,ci[fi++]=Nu,Nu=l;var x=ms;l=ys;var b=32-Li(x)-1;x&=~(1<<b),g+=1;var _=32-Li(d)+b;if(30<_){var F=b-b%5;_=(x&(1<<F)-1).toString(32),x>>=F,b-=F,ms=1<<32-Li(d)+b|g<<b|x,ys=_+l}else ms=1<<_|g<<b|x,ys=l}function J2(l){l.return!==null&&(Ru(l,1),rM(l,1,0))}function Z2(l){for(;l===b0;)b0=_c[--Ac],_c[Ac]=null,S0=_c[--Ac],_c[Ac]=null;for(;l===Nu;)Nu=ci[--fi],ci[fi]=null,ys=ci[--fi],ci[fi]=null,ms=ci[--fi],ci[fi]=null}var Vr=null,Yr=null,Ft=!1,Ii=null;function iM(l,d){var g=gi(5,null,null,0);g.elementType="DELETED",g.stateNode=d,g.return=l,d=l.deletions,d===null?(l.deletions=[g],l.flags|=16):d.push(g)}function oM(l,d){switch(l.tag){case 5:var g=l.type;return d=d.nodeType!==1||g.toLowerCase()!==d.nodeName.toLowerCase()?null:d,d!==null?(l.stateNode=d,Vr=l,Yr=pa(d.firstChild),!0):!1;case 6:return d=l.pendingProps===""||d.nodeType!==3?null:d,d!==null?(l.stateNode=d,Vr=l,Yr=null,!0):!1;case 13:return d=d.nodeType!==8?null:d,d!==null?(g=Nu!==null?{id:ms,overflow:ys}:null,l.memoizedState={dehydrated:d,treeContext:g,retryLane:1073741824},g=gi(18,null,null,0),g.stateNode=d,g.return=l,l.child=g,Vr=l,Yr=null,!0):!1;default:return!1}}function ew(l){return(l.mode&1)!==0&&(l.flags&128)===0}function tw(l){if(Ft){var d=Yr;if(d){var g=d;if(!oM(l,d)){if(ew(l))throw Error(n(418));d=pa(g.nextSibling);var x=Vr;d&&oM(l,d)?iM(x,g):(l.flags=l.flags&-4097|2,Ft=!1,Vr=l)}}else{if(ew(l))throw Error(n(418));l.flags=l.flags&-4097|2,Ft=!1,Vr=l}}}function sM(l){for(l=l.return;l!==null&&l.tag!==5&&l.tag!==3&&l.tag!==13;)l=l.return;Vr=l}function _0(l){if(l!==Vr)return!1;if(!Ft)return sM(l),Ft=!0,!1;var d;if((d=l.tag!==3)&&!(d=l.tag!==5)&&(d=l.type,d=d!=="head"&&d!=="body"&&!G2(l.type,l.memoizedProps)),d&&(d=Yr)){if(ew(l))throw aM(),Error(n(418));for(;d;)iM(l,d),d=pa(d.nextSibling)}if(sM(l),l.tag===13){if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(n(317));e:{for(l=l.nextSibling,d=0;l;){if(l.nodeType===8){var g=l.data;if(g==="/$"){if(d===0){Yr=pa(l.nextSibling);break e}d--}else g!=="$"&&g!=="$!"&&g!=="$?"||d++}l=l.nextSibling}Yr=null}}else Yr=Vr?pa(l.stateNode.nextSibling):null;return!0}function aM(){for(var l=Yr;l;)l=pa(l.nextSibling)}function Cc(){Yr=Vr=null,Ft=!1}function nw(l){Ii===null?Ii=[l]:Ii.push(l)}var HH=C.ReactCurrentBatchConfig;function Xd(l,d,g){if(l=g.ref,l!==null&&typeof l!="function"&&typeof l!="object"){if(g._owner){if(g=g._owner,g){if(g.tag!==1)throw Error(n(309));var x=g.stateNode}if(!x)throw Error(n(147,l));var b=x,_=""+l;return d!==null&&d.ref!==null&&typeof d.ref=="function"&&d.ref._stringRef===_?d.ref:(d=function(F){var R=b.refs;F===null?delete R[_]:R[_]=F},d._stringRef=_,d)}if(typeof l!="string")throw Error(n(284));if(!g._owner)throw Error(n(290,l))}return l}function A0(l,d){throw l=Object.prototype.toString.call(d),Error(n(31,l==="[object Object]"?"object with keys {"+Object.keys(d).join(", ")+"}":l))}function uM(l){var d=l._init;return d(l._payload)}function lM(l){function d(H,B){if(l){var V=H.deletions;V===null?(H.deletions=[B],H.flags|=16):V.push(B)}}function g(H,B){if(!l)return null;for(;B!==null;)d(H,B),B=B.sibling;return null}function x(H,B){for(H=new Map;B!==null;)B.key!==null?H.set(B.key,B):H.set(B.index,B),B=B.sibling;return H}function b(H,B){return H=Aa(H,B),H.index=0,H.sibling=null,H}function _(H,B,V){return H.index=V,l?(V=H.alternate,V!==null?(V=V.index,V<B?(H.flags|=2,B):V):(H.flags|=2,B)):(H.flags|=1048576,B)}function F(H){return l&&H.alternate===null&&(H.flags|=2),H}function R(H,B,V,he){return B===null||B.tag!==6?(B=Vw(V,H.mode,he),B.return=H,B):(B=b(B,V),B.return=H,B)}function z(H,B,V,he){var De=V.type;return De===$?ie(H,B,V.props.children,he,V.key):B!==null&&(B.elementType===De||typeof De=="object"&&De!==null&&De.$$typeof===U&&uM(De)===B.type)?(he=b(B,V.props),he.ref=Xd(H,B,V),he.return=H,he):(he=X0(V.type,V.key,V.props,null,H.mode,he),he.ref=Xd(H,B,V),he.return=H,he)}function Q(H,B,V,he){return B===null||B.tag!==4||B.stateNode.containerInfo!==V.containerInfo||B.stateNode.implementation!==V.implementation?(B=Yw(V,H.mode,he),B.return=H,B):(B=b(B,V.children||[]),B.return=H,B)}function ie(H,B,V,he,De){return B===null||B.tag!==7?(B=ju(V,H.mode,he,De),B.return=H,B):(B=b(B,V),B.return=H,B)}function ae(H,B,V){if(typeof B=="string"&&B!==""||typeof B=="number")return B=Vw(""+B,H.mode,V),B.return=H,B;if(typeof B=="object"&&B!==null){switch(B.$$typeof){case k:return V=X0(B.type,B.key,B.props,null,H.mode,V),V.ref=Xd(H,null,B),V.return=H,V;case D:return B=Yw(B,H.mode,V),B.return=H,B;case U:var he=B._init;return ae(H,he(B._payload),V)}if(_d(B)||q(B))return B=ju(B,H.mode,V,null),B.return=H,B;A0(H,B)}return null}function re(H,B,V,he){var De=B!==null?B.key:null;if(typeof V=="string"&&V!==""||typeof V=="number")return De!==null?null:R(H,B,""+V,he);if(typeof V=="object"&&V!==null){switch(V.$$typeof){case k:return V.key===De?z(H,B,V,he):null;case D:return V.key===De?Q(H,B,V,he):null;case U:return De=V._init,re(H,B,De(V._payload),he)}if(_d(V)||q(V))return De!==null?null:ie(H,B,V,he,null);A0(H,V)}return null}function be(H,B,V,he,De){if(typeof he=="string"&&he!==""||typeof he=="number")return H=H.get(V)||null,R(B,H,""+he,De);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case k:return H=H.get(he.key===null?V:he.key)||null,z(B,H,he,De);case D:return H=H.get(he.key===null?V:he.key)||null,Q(B,H,he,De);case U:var Le=he._init;return be(H,B,V,Le(he._payload),De)}if(_d(he)||q(he))return H=H.get(V)||null,ie(B,H,he,De,null);A0(B,he)}return null}function Ae(H,B,V,he){for(var De=null,Le=null,ze=B,Be=B=0,dn=null;ze!==null&&Be<V.length;Be++){ze.index>Be?(dn=ze,ze=null):dn=ze.sibling;var it=re(H,ze,V[Be],he);if(it===null){ze===null&&(ze=dn);break}l&&ze&&it.alternate===null&&d(H,ze),B=_(it,B,Be),Le===null?De=it:Le.sibling=it,Le=it,ze=dn}if(Be===V.length)return g(H,ze),Ft&&Ru(H,Be),De;if(ze===null){for(;Be<V.length;Be++)ze=ae(H,V[Be],he),ze!==null&&(B=_(ze,B,Be),Le===null?De=ze:Le.sibling=ze,Le=ze);return Ft&&Ru(H,Be),De}for(ze=x(H,ze);Be<V.length;Be++)dn=be(ze,H,Be,V[Be],he),dn!==null&&(l&&dn.alternate!==null&&ze.delete(dn.key===null?Be:dn.key),B=_(dn,B,Be),Le===null?De=dn:Le.sibling=dn,Le=dn);return l&&ze.forEach(function(Ca){return d(H,Ca)}),Ft&&Ru(H,Be),De}function Ce(H,B,V,he){var De=q(V);if(typeof De!="function")throw Error(n(150));if(V=De.call(V),V==null)throw Error(n(151));for(var Le=De=null,ze=B,Be=B=0,dn=null,it=V.next();ze!==null&&!it.done;Be++,it=V.next()){ze.index>Be?(dn=ze,ze=null):dn=ze.sibling;var Ca=re(H,ze,it.value,he);if(Ca===null){ze===null&&(ze=dn);break}l&&ze&&Ca.alternate===null&&d(H,ze),B=_(Ca,B,Be),Le===null?De=Ca:Le.sibling=Ca,Le=Ca,ze=dn}if(it.done)return g(H,ze),Ft&&Ru(H,Be),De;if(ze===null){for(;!it.done;Be++,it=V.next())it=ae(H,it.value,he),it!==null&&(B=_(it,B,Be),Le===null?De=it:Le.sibling=it,Le=it);return Ft&&Ru(H,Be),De}for(ze=x(H,ze);!it.done;Be++,it=V.next())it=be(ze,H,Be,it.value,he),it!==null&&(l&&it.alternate!==null&&ze.delete(it.key===null?Be:it.key),B=_(it,B,Be),Le===null?De=it:Le.sibling=it,Le=it);return l&&ze.forEach(function(_G){return d(H,_G)}),Ft&&Ru(H,Be),De}function Gt(H,B,V,he){if(typeof V=="object"&&V!==null&&V.type===$&&V.key===null&&(V=V.props.children),typeof V=="object"&&V!==null){switch(V.$$typeof){case k:e:{for(var De=V.key,Le=B;Le!==null;){if(Le.key===De){if(De=V.type,De===$){if(Le.tag===7){g(H,Le.sibling),B=b(Le,V.props.children),B.return=H,H=B;break e}}else if(Le.elementType===De||typeof De=="object"&&De!==null&&De.$$typeof===U&&uM(De)===Le.type){g(H,Le.sibling),B=b(Le,V.props),B.ref=Xd(H,Le,V),B.return=H,H=B;break e}g(H,Le);break}else d(H,Le);Le=Le.sibling}V.type===$?(B=ju(V.props.children,H.mode,he,V.key),B.return=H,H=B):(he=X0(V.type,V.key,V.props,null,H.mode,he),he.ref=Xd(H,B,V),he.return=H,H=he)}return F(H);case D:e:{for(Le=V.key;B!==null;){if(B.key===Le)if(B.tag===4&&B.stateNode.containerInfo===V.containerInfo&&B.stateNode.implementation===V.implementation){g(H,B.sibling),B=b(B,V.children||[]),B.return=H,H=B;break e}else{g(H,B);break}else d(H,B);B=B.sibling}B=Yw(V,H.mode,he),B.return=H,H=B}return F(H);case U:return Le=V._init,Gt(H,B,Le(V._payload),he)}if(_d(V))return Ae(H,B,V,he);if(q(V))return Ce(H,B,V,he);A0(H,V)}return typeof V=="string"&&V!==""||typeof V=="number"?(V=""+V,B!==null&&B.tag===6?(g(H,B.sibling),B=b(B,V),B.return=H,H=B):(g(H,B),B=Vw(V,H.mode,he),B.return=H,H=B),F(H)):g(H,B)}return Gt}var kc=lM(!0),cM=lM(!1),C0=ga(null),k0=null,$c=null,rw=null;function iw(){rw=$c=k0=null}function ow(l){var d=C0.current;At(C0),l._currentValue=d}function sw(l,d,g){for(;l!==null;){var x=l.alternate;if((l.childLanes&d)!==d?(l.childLanes|=d,x!==null&&(x.childLanes|=d)):x!==null&&(x.childLanes&d)!==d&&(x.childLanes|=d),l===g)break;l=l.return}}function Fc(l,d){k0=l,rw=$c=null,l=l.dependencies,l!==null&&l.firstContext!==null&&((l.lanes&d)!==0&&(Ar=!0),l.firstContext=null)}function di(l){var d=l._currentValue;if(rw!==l)if(l={context:l,memoizedValue:d,next:null},$c===null){if(k0===null)throw Error(n(308));$c=l,k0.dependencies={lanes:0,firstContext:l}}else $c=$c.next=l;return d}var Ou=null;function aw(l){Ou===null?Ou=[l]:Ou.push(l)}function fM(l,d,g,x){var b=d.interleaved;return b===null?(g.next=g,aw(d)):(g.next=b.next,b.next=g),d.interleaved=g,vs(l,x)}function vs(l,d){l.lanes|=d;var g=l.alternate;for(g!==null&&(g.lanes|=d),g=l,l=l.return;l!==null;)l.childLanes|=d,g=l.alternate,g!==null&&(g.childLanes|=d),g=l,l=l.return;return g.tag===3?g.stateNode:null}var va=!1;function uw(l){l.updateQueue={baseState:l.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function dM(l,d){l=l.updateQueue,d.updateQueue===l&&(d.updateQueue={baseState:l.baseState,firstBaseUpdate:l.firstBaseUpdate,lastBaseUpdate:l.lastBaseUpdate,shared:l.shared,effects:l.effects})}function xs(l,d){return{eventTime:l,lane:d,tag:0,payload:null,callback:null,next:null}}function xa(l,d,g){var x=l.updateQueue;if(x===null)return null;if(x=x.shared,(rt&2)!==0){var b=x.pending;return b===null?d.next=d:(d.next=b.next,b.next=d),x.pending=d,vs(l,g)}return b=x.interleaved,b===null?(d.next=d,aw(x)):(d.next=b.next,b.next=d),x.interleaved=d,vs(l,g)}function $0(l,d,g){if(d=d.updateQueue,d!==null&&(d=d.shared,(g&4194240)!==0)){var x=d.lanes;x&=l.pendingLanes,g|=x,d.lanes=g,b2(l,g)}}function hM(l,d){var g=l.updateQueue,x=l.alternate;if(x!==null&&(x=x.updateQueue,g===x)){var b=null,_=null;if(g=g.firstBaseUpdate,g!==null){do{var F={eventTime:g.eventTime,lane:g.lane,tag:g.tag,payload:g.payload,callback:g.callback,next:null};_===null?b=_=F:_=_.next=F,g=g.next}while(g!==null);_===null?b=_=d:_=_.next=d}else b=_=d;g={baseState:x.baseState,firstBaseUpdate:b,lastBaseUpdate:_,shared:x.shared,effects:x.effects},l.updateQueue=g;return}l=g.lastBaseUpdate,l===null?g.firstBaseUpdate=d:l.next=d,g.lastBaseUpdate=d}function F0(l,d,g,x){var b=l.updateQueue;va=!1;var _=b.firstBaseUpdate,F=b.lastBaseUpdate,R=b.shared.pending;if(R!==null){b.shared.pending=null;var z=R,Q=z.next;z.next=null,F===null?_=Q:F.next=Q,F=z;var ie=l.alternate;ie!==null&&(ie=ie.updateQueue,R=ie.lastBaseUpdate,R!==F&&(R===null?ie.firstBaseUpdate=Q:R.next=Q,ie.lastBaseUpdate=z))}if(_!==null){var ae=b.baseState;F=0,ie=Q=z=null,R=_;do{var re=R.lane,be=R.eventTime;if((x&re)===re){ie!==null&&(ie=ie.next={eventTime:be,lane:0,tag:R.tag,payload:R.payload,callback:R.callback,next:null});e:{var Ae=l,Ce=R;switch(re=d,be=g,Ce.tag){case 1:if(Ae=Ce.payload,typeof Ae=="function"){ae=Ae.call(be,ae,re);break e}ae=Ae;break e;case 3:Ae.flags=Ae.flags&-65537|128;case 0:if(Ae=Ce.payload,re=typeof Ae=="function"?Ae.call(be,ae,re):Ae,re==null)break e;ae=K({},ae,re);break e;case 2:va=!0}}R.callback!==null&&R.lane!==0&&(l.flags|=64,re=b.effects,re===null?b.effects=[R]:re.push(R))}else be={eventTime:be,lane:re,tag:R.tag,payload:R.payload,callback:R.callback,next:null},ie===null?(Q=ie=be,z=ae):ie=ie.next=be,F|=re;if(R=R.next,R===null){if(R=b.shared.pending,R===null)break;re=R,R=re.next,re.next=null,b.lastBaseUpdate=re,b.shared.pending=null}}while(!0);if(ie===null&&(z=ae),b.baseState=z,b.firstBaseUpdate=Q,b.lastBaseUpdate=ie,d=b.shared.interleaved,d!==null){b=d;do F|=b.lane,b=b.next;while(b!==d)}else _===null&&(b.shared.lanes=0);zu|=F,l.lanes=F,l.memoizedState=ae}}function pM(l,d,g){if(l=d.effects,d.effects=null,l!==null)for(d=0;d<l.length;d++){var x=l[d],b=x.callback;if(b!==null){if(x.callback=null,x=g,typeof b!="function")throw Error(n(191,b));b.call(x)}}}var Qd={},_o=ga(Qd),Kd=ga(Qd),Jd=ga(Qd);function Pu(l){if(l===Qd)throw Error(n(174));return l}function lw(l,d){switch(bt(Jd,d),bt(Kd,l),bt(_o,Qd),l=d.nodeType,l){case 9:case 11:d=(d=d.documentElement)?d.namespaceURI:c2(null,"");break;default:l=l===8?d.parentNode:d,d=l.namespaceURI||null,l=l.tagName,d=c2(d,l)}At(_o),bt(_o,d)}function Dc(){At(_o),At(Kd),At(Jd)}function gM(l){Pu(Jd.current);var d=Pu(_o.current),g=c2(d,l.type);d!==g&&(bt(Kd,l),bt(_o,g))}function cw(l){Kd.current===l&&(At(_o),At(Kd))}var Nt=ga(0);function D0(l){for(var d=l;d!==null;){if(d.tag===13){var g=d.memoizedState;if(g!==null&&(g=g.dehydrated,g===null||g.data==="$?"||g.data==="$!"))return d}else if(d.tag===19&&d.memoizedProps.revealOrder!==void 0){if((d.flags&128)!==0)return d}else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===l)break;for(;d.sibling===null;){if(d.return===null||d.return===l)return null;d=d.return}d.sibling.return=d.return,d=d.sibling}return null}var fw=[];function dw(){for(var l=0;l<fw.length;l++)fw[l]._workInProgressVersionPrimary=null;fw.length=0}var M0=C.ReactCurrentDispatcher,hw=C.ReactCurrentBatchConfig,Lu=0,Rt=null,en=null,cn=null,T0=!1,Zd=!1,eh=0,GH=0;function zn(){throw Error(n(321))}function pw(l,d){if(d===null)return!1;for(var g=0;g<d.length&&g<l.length;g++)if(!zi(l[g],d[g]))return!1;return!0}function gw(l,d,g,x,b,_){if(Lu=_,Rt=d,d.memoizedState=null,d.updateQueue=null,d.lanes=0,M0.current=l===null||l.memoizedState===null?QH:KH,l=g(x,b),Zd){_=0;do{if(Zd=!1,eh=0,25<=_)throw Error(n(301));_+=1,cn=en=null,d.updateQueue=null,M0.current=JH,l=g(x,b)}while(Zd)}if(M0.current=O0,d=en!==null&&en.next!==null,Lu=0,cn=en=Rt=null,T0=!1,d)throw Error(n(300));return l}function mw(){var l=eh!==0;return eh=0,l}function Ao(){var l={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return cn===null?Rt.memoizedState=cn=l:cn=cn.next=l,cn}function hi(){if(en===null){var l=Rt.alternate;l=l!==null?l.memoizedState:null}else l=en.next;var d=cn===null?Rt.memoizedState:cn.next;if(d!==null)cn=d,en=l;else{if(l===null)throw Error(n(310));en=l,l={memoizedState:en.memoizedState,baseState:en.baseState,baseQueue:en.baseQueue,queue:en.queue,next:null},cn===null?Rt.memoizedState=cn=l:cn=cn.next=l}return cn}function th(l,d){return typeof d=="function"?d(l):d}function yw(l){var d=hi(),g=d.queue;if(g===null)throw Error(n(311));g.lastRenderedReducer=l;var x=en,b=x.baseQueue,_=g.pending;if(_!==null){if(b!==null){var F=b.next;b.next=_.next,_.next=F}x.baseQueue=b=_,g.pending=null}if(b!==null){_=b.next,x=x.baseState;var R=F=null,z=null,Q=_;do{var ie=Q.lane;if((Lu&ie)===ie)z!==null&&(z=z.next={lane:0,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null}),x=Q.hasEagerState?Q.eagerState:l(x,Q.action);else{var ae={lane:ie,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null};z===null?(R=z=ae,F=x):z=z.next=ae,Rt.lanes|=ie,zu|=ie}Q=Q.next}while(Q!==null&&Q!==_);z===null?F=x:z.next=R,zi(x,d.memoizedState)||(Ar=!0),d.memoizedState=x,d.baseState=F,d.baseQueue=z,g.lastRenderedState=x}if(l=g.interleaved,l!==null){b=l;do _=b.lane,Rt.lanes|=_,zu|=_,b=b.next;while(b!==l)}else b===null&&(g.lanes=0);return[d.memoizedState,g.dispatch]}function vw(l){var d=hi(),g=d.queue;if(g===null)throw Error(n(311));g.lastRenderedReducer=l;var x=g.dispatch,b=g.pending,_=d.memoizedState;if(b!==null){g.pending=null;var F=b=b.next;do _=l(_,F.action),F=F.next;while(F!==b);zi(_,d.memoizedState)||(Ar=!0),d.memoizedState=_,d.baseQueue===null&&(d.baseState=_),g.lastRenderedState=_}return[_,x]}function mM(){}function yM(l,d){var g=Rt,x=hi(),b=d(),_=!zi(x.memoizedState,b);if(_&&(x.memoizedState=b,Ar=!0),x=x.queue,xw(wM.bind(null,g,x,l),[l]),x.getSnapshot!==d||_||cn!==null&&cn.memoizedState.tag&1){if(g.flags|=2048,nh(9,xM.bind(null,g,x,b,d),void 0,null),fn===null)throw Error(n(349));(Lu&30)!==0||vM(g,d,b)}return b}function vM(l,d,g){l.flags|=16384,l={getSnapshot:d,value:g},d=Rt.updateQueue,d===null?(d={lastEffect:null,stores:null},Rt.updateQueue=d,d.stores=[l]):(g=d.stores,g===null?d.stores=[l]:g.push(l))}function xM(l,d,g,x){d.value=g,d.getSnapshot=x,EM(d)&&bM(l)}function wM(l,d,g){return g(function(){EM(d)&&bM(l)})}function EM(l){var d=l.getSnapshot;l=l.value;try{var g=d();return!zi(l,g)}catch{return!0}}function bM(l){var d=vs(l,1);d!==null&&Wi(d,l,1,-1)}function SM(l){var d=Ao();return typeof l=="function"&&(l=l()),d.memoizedState=d.baseState=l,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:th,lastRenderedState:l},d.queue=l,l=l.dispatch=XH.bind(null,Rt,l),[d.memoizedState,l]}function nh(l,d,g,x){return l={tag:l,create:d,destroy:g,deps:x,next:null},d=Rt.updateQueue,d===null?(d={lastEffect:null,stores:null},Rt.updateQueue=d,d.lastEffect=l.next=l):(g=d.lastEffect,g===null?d.lastEffect=l.next=l:(x=g.next,g.next=l,l.next=x,d.lastEffect=l)),l}function _M(){return hi().memoizedState}function N0(l,d,g,x){var b=Ao();Rt.flags|=l,b.memoizedState=nh(1|d,g,void 0,x===void 0?null:x)}function R0(l,d,g,x){var b=hi();x=x===void 0?null:x;var _=void 0;if(en!==null){var F=en.memoizedState;if(_=F.destroy,x!==null&&pw(x,F.deps)){b.memoizedState=nh(d,g,_,x);return}}Rt.flags|=l,b.memoizedState=nh(1|d,g,_,x)}function AM(l,d){return N0(8390656,8,l,d)}function xw(l,d){return R0(2048,8,l,d)}function CM(l,d){return R0(4,2,l,d)}function kM(l,d){return R0(4,4,l,d)}function $M(l,d){if(typeof d=="function")return l=l(),d(l),function(){d(null)};if(d!=null)return l=l(),d.current=l,function(){d.current=null}}function FM(l,d,g){return g=g!=null?g.concat([l]):null,R0(4,4,$M.bind(null,d,l),g)}function ww(){}function DM(l,d){var g=hi();d=d===void 0?null:d;var x=g.memoizedState;return x!==null&&d!==null&&pw(d,x[1])?x[0]:(g.memoizedState=[l,d],l)}function MM(l,d){var g=hi();d=d===void 0?null:d;var x=g.memoizedState;return x!==null&&d!==null&&pw(d,x[1])?x[0]:(l=l(),g.memoizedState=[l,d],l)}function TM(l,d,g){return(Lu&21)===0?(l.baseState&&(l.baseState=!1,Ar=!0),l.memoizedState=g):(zi(g,d)||(g=uD(),Rt.lanes|=g,zu|=g,l.baseState=!0),d)}function VH(l,d){var g=dt;dt=g!==0&&4>g?g:4,l(!0);var x=hw.transition;hw.transition={};try{l(!1),d()}finally{dt=g,hw.transition=x}}function NM(){return hi().memoizedState}function YH(l,d,g){var x=Sa(l);if(g={lane:x,action:g,hasEagerState:!1,eagerState:null,next:null},RM(l))OM(d,g);else if(g=fM(l,d,g,x),g!==null){var b=ir();Wi(g,l,x,b),PM(g,d,x)}}function XH(l,d,g){var x=Sa(l),b={lane:x,action:g,hasEagerState:!1,eagerState:null,next:null};if(RM(l))OM(d,b);else{var _=l.alternate;if(l.lanes===0&&(_===null||_.lanes===0)&&(_=d.lastRenderedReducer,_!==null))try{var F=d.lastRenderedState,R=_(F,g);if(b.hasEagerState=!0,b.eagerState=R,zi(R,F)){var z=d.interleaved;z===null?(b.next=b,aw(d)):(b.next=z.next,z.next=b),d.interleaved=b;return}}catch{}finally{}g=fM(l,d,b,x),g!==null&&(b=ir(),Wi(g,l,x,b),PM(g,d,x))}}function RM(l){var d=l.alternate;return l===Rt||d!==null&&d===Rt}function OM(l,d){Zd=T0=!0;var g=l.pending;g===null?d.next=d:(d.next=g.next,g.next=d),l.pending=d}function PM(l,d,g){if((g&4194240)!==0){var x=d.lanes;x&=l.pendingLanes,g|=x,d.lanes=g,b2(l,g)}}var O0={readContext:di,useCallback:zn,useContext:zn,useEffect:zn,useImperativeHandle:zn,useInsertionEffect:zn,useLayoutEffect:zn,useMemo:zn,useReducer:zn,useRef:zn,useState:zn,useDebugValue:zn,useDeferredValue:zn,useTransition:zn,useMutableSource:zn,useSyncExternalStore:zn,useId:zn,unstable_isNewReconciler:!1},QH={readContext:di,useCallback:function(l,d){return Ao().memoizedState=[l,d===void 0?null:d],l},useContext:di,useEffect:AM,useImperativeHandle:function(l,d,g){return g=g!=null?g.concat([l]):null,N0(4194308,4,$M.bind(null,d,l),g)},useLayoutEffect:function(l,d){return N0(4194308,4,l,d)},useInsertionEffect:function(l,d){return N0(4,2,l,d)},useMemo:function(l,d){var g=Ao();return d=d===void 0?null:d,l=l(),g.memoizedState=[l,d],l},useReducer:function(l,d,g){var x=Ao();return d=g!==void 0?g(d):d,x.memoizedState=x.baseState=d,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:d},x.queue=l,l=l.dispatch=YH.bind(null,Rt,l),[x.memoizedState,l]},useRef:function(l){var d=Ao();return l={current:l},d.memoizedState=l},useState:SM,useDebugValue:ww,useDeferredValue:function(l){return Ao().memoizedState=l},useTransition:function(){var l=SM(!1),d=l[0];return l=VH.bind(null,l[1]),Ao().memoizedState=l,[d,l]},useMutableSource:function(){},useSyncExternalStore:function(l,d,g){var x=Rt,b=Ao();if(Ft){if(g===void 0)throw Error(n(407));g=g()}else{if(g=d(),fn===null)throw Error(n(349));(Lu&30)!==0||vM(x,d,g)}b.memoizedState=g;var _={value:g,getSnapshot:d};return b.queue=_,AM(wM.bind(null,x,_,l),[l]),x.flags|=2048,nh(9,xM.bind(null,x,_,g,d),void 0,null),g},useId:function(){var l=Ao(),d=fn.identifierPrefix;if(Ft){var g=ys,x=ms;g=(x&~(1<<32-Li(x)-1)).toString(32)+g,d=":"+d+"R"+g,g=eh++,0<g&&(d+="H"+g.toString(32)),d+=":"}else g=GH++,d=":"+d+"r"+g.toString(32)+":";return l.memoizedState=d},unstable_isNewReconciler:!1},KH={readContext:di,useCallback:DM,useContext:di,useEffect:xw,useImperativeHandle:FM,useInsertionEffect:CM,useLayoutEffect:kM,useMemo:MM,useReducer:yw,useRef:_M,useState:function(){return yw(th)},useDebugValue:ww,useDeferredValue:function(l){var d=hi();return TM(d,en.memoizedState,l)},useTransition:function(){var l=yw(th)[0],d=hi().memoizedState;return[l,d]},useMutableSource:mM,useSyncExternalStore:yM,useId:NM,unstable_isNewReconciler:!1},JH={readContext:di,useCallback:DM,useContext:di,useEffect:xw,useImperativeHandle:FM,useInsertionEffect:CM,useLayoutEffect:kM,useMemo:MM,useReducer:vw,useRef:_M,useState:function(){return vw(th)},useDebugValue:ww,useDeferredValue:function(l){var d=hi();return en===null?d.memoizedState=l:TM(d,en.memoizedState,l)},useTransition:function(){var l=vw(th)[0],d=hi().memoizedState;return[l,d]},useMutableSource:mM,useSyncExternalStore:yM,useId:NM,unstable_isNewReconciler:!1};function Bi(l,d){if(l&&l.defaultProps){d=K({},d),l=l.defaultProps;for(var g in l)d[g]===void 0&&(d[g]=l[g]);return d}return d}function Ew(l,d,g,x){d=l.memoizedState,g=g(x,d),g=g==null?d:K({},d,g),l.memoizedState=g,l.lanes===0&&(l.updateQueue.baseState=g)}var P0={isMounted:function(l){return(l=l._reactInternals)?Du(l)===l:!1},enqueueSetState:function(l,d,g){l=l._reactInternals;var x=ir(),b=Sa(l),_=xs(x,b);_.payload=d,g!=null&&(_.callback=g),d=xa(l,_,b),d!==null&&(Wi(d,l,b,x),$0(d,l,b))},enqueueReplaceState:function(l,d,g){l=l._reactInternals;var x=ir(),b=Sa(l),_=xs(x,b);_.tag=1,_.payload=d,g!=null&&(_.callback=g),d=xa(l,_,b),d!==null&&(Wi(d,l,b,x),$0(d,l,b))},enqueueForceUpdate:function(l,d){l=l._reactInternals;var g=ir(),x=Sa(l),b=xs(g,x);b.tag=2,d!=null&&(b.callback=d),d=xa(l,b,x),d!==null&&(Wi(d,l,x,g),$0(d,l,x))}};function LM(l,d,g,x,b,_,F){return l=l.stateNode,typeof l.shouldComponentUpdate=="function"?l.shouldComponentUpdate(x,_,F):d.prototype&&d.prototype.isPureReactComponent?!jd(g,x)||!jd(b,_):!0}function zM(l,d,g){var x=!1,b=ma,_=d.contextType;return typeof _=="object"&&_!==null?_=di(_):(b=_r(d)?Tu:Ln.current,x=d.contextTypes,_=(x=x!=null)?Sc(l,b):ma),d=new d(g,_),l.memoizedState=d.state!==null&&d.state!==void 0?d.state:null,d.updater=P0,l.stateNode=d,d._reactInternals=l,x&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=b,l.__reactInternalMemoizedMaskedChildContext=_),d}function IM(l,d,g,x){l=d.state,typeof d.componentWillReceiveProps=="function"&&d.componentWillReceiveProps(g,x),typeof d.UNSAFE_componentWillReceiveProps=="function"&&d.UNSAFE_componentWillReceiveProps(g,x),d.state!==l&&P0.enqueueReplaceState(d,d.state,null)}function bw(l,d,g,x){var b=l.stateNode;b.props=g,b.state=l.memoizedState,b.refs={},uw(l);var _=d.contextType;typeof _=="object"&&_!==null?b.context=di(_):(_=_r(d)?Tu:Ln.current,b.context=Sc(l,_)),b.state=l.memoizedState,_=d.getDerivedStateFromProps,typeof _=="function"&&(Ew(l,d,_,g),b.state=l.memoizedState),typeof d.getDerivedStateFromProps=="function"||typeof b.getSnapshotBeforeUpdate=="function"||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(d=b.state,typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount(),d!==b.state&&P0.enqueueReplaceState(b,b.state,null),F0(l,g,b,x),b.state=l.memoizedState),typeof b.componentDidMount=="function"&&(l.flags|=4194308)}function Mc(l,d){try{var g="",x=d;do g+=we(x),x=x.return;while(x);var b=g}catch(_){b=`
Error generating stack: `+_.message+`
`+_.stack}return{value:l,source:d,stack:b,digest:null}}function Sw(l,d,g){return{value:l,source:null,stack:g??null,digest:d??null}}function _w(l,d){try{console.error(d.value)}catch(g){setTimeout(function(){throw g})}}var ZH=typeof WeakMap=="function"?WeakMap:Map;function BM(l,d,g){g=xs(-1,g),g.tag=3,g.payload={element:null};var x=d.value;return g.callback=function(){W0||(W0=!0,Iw=x),_w(l,d)},g}function UM(l,d,g){g=xs(-1,g),g.tag=3;var x=l.type.getDerivedStateFromError;if(typeof x=="function"){var b=d.value;g.payload=function(){return x(b)},g.callback=function(){_w(l,d)}}var _=l.stateNode;return _!==null&&typeof _.componentDidCatch=="function"&&(g.callback=function(){_w(l,d),typeof x!="function"&&(Ea===null?Ea=new Set([this]):Ea.add(this));var F=d.stack;this.componentDidCatch(d.value,{componentStack:F!==null?F:""})}),g}function jM(l,d,g){var x=l.pingCache;if(x===null){x=l.pingCache=new ZH;var b=new Set;x.set(d,b)}else b=x.get(d),b===void 0&&(b=new Set,x.set(d,b));b.has(g)||(b.add(g),l=hG.bind(null,l,d,g),d.then(l,l))}function WM(l){do{var d;if((d=l.tag===13)&&(d=l.memoizedState,d=d!==null?d.dehydrated!==null:!0),d)return l;l=l.return}while(l!==null);return null}function qM(l,d,g,x,b){return(l.mode&1)===0?(l===d?l.flags|=65536:(l.flags|=128,g.flags|=131072,g.flags&=-52805,g.tag===1&&(g.alternate===null?g.tag=17:(d=xs(-1,1),d.tag=2,xa(g,d,1))),g.lanes|=1),l):(l.flags|=65536,l.lanes=b,l)}var eG=C.ReactCurrentOwner,Ar=!1;function rr(l,d,g,x){d.child=l===null?cM(d,null,g,x):kc(d,l.child,g,x)}function HM(l,d,g,x,b){g=g.render;var _=d.ref;return Fc(d,b),x=gw(l,d,g,x,_,b),g=mw(),l!==null&&!Ar?(d.updateQueue=l.updateQueue,d.flags&=-2053,l.lanes&=~b,ws(l,d,b)):(Ft&&g&&J2(d),d.flags|=1,rr(l,d,x,b),d.child)}function GM(l,d,g,x,b){if(l===null){var _=g.type;return typeof _=="function"&&!Gw(_)&&_.defaultProps===void 0&&g.compare===null&&g.defaultProps===void 0?(d.tag=15,d.type=_,VM(l,d,_,x,b)):(l=X0(g.type,null,x,d,d.mode,b),l.ref=d.ref,l.return=d,d.child=l)}if(_=l.child,(l.lanes&b)===0){var F=_.memoizedProps;if(g=g.compare,g=g!==null?g:jd,g(F,x)&&l.ref===d.ref)return ws(l,d,b)}return d.flags|=1,l=Aa(_,x),l.ref=d.ref,l.return=d,d.child=l}function VM(l,d,g,x,b){if(l!==null){var _=l.memoizedProps;if(jd(_,x)&&l.ref===d.ref)if(Ar=!1,d.pendingProps=x=_,(l.lanes&b)!==0)(l.flags&131072)!==0&&(Ar=!0);else return d.lanes=l.lanes,ws(l,d,b)}return Aw(l,d,g,x,b)}function YM(l,d,g){var x=d.pendingProps,b=x.children,_=l!==null?l.memoizedState:null;if(x.mode==="hidden")if((d.mode&1)===0)d.memoizedState={baseLanes:0,cachePool:null,transitions:null},bt(Nc,Xr),Xr|=g;else{if((g&1073741824)===0)return l=_!==null?_.baseLanes|g:g,d.lanes=d.childLanes=1073741824,d.memoizedState={baseLanes:l,cachePool:null,transitions:null},d.updateQueue=null,bt(Nc,Xr),Xr|=l,null;d.memoizedState={baseLanes:0,cachePool:null,transitions:null},x=_!==null?_.baseLanes:g,bt(Nc,Xr),Xr|=x}else _!==null?(x=_.baseLanes|g,d.memoizedState=null):x=g,bt(Nc,Xr),Xr|=x;return rr(l,d,b,g),d.child}function XM(l,d){var g=d.ref;(l===null&&g!==null||l!==null&&l.ref!==g)&&(d.flags|=512,d.flags|=2097152)}function Aw(l,d,g,x,b){var _=_r(g)?Tu:Ln.current;return _=Sc(d,_),Fc(d,b),g=gw(l,d,g,x,_,b),x=mw(),l!==null&&!Ar?(d.updateQueue=l.updateQueue,d.flags&=-2053,l.lanes&=~b,ws(l,d,b)):(Ft&&x&&J2(d),d.flags|=1,rr(l,d,g,b),d.child)}function QM(l,d,g,x,b){if(_r(g)){var _=!0;w0(d)}else _=!1;if(Fc(d,b),d.stateNode===null)z0(l,d),zM(d,g,x),bw(d,g,x,b),x=!0;else if(l===null){var F=d.stateNode,R=d.memoizedProps;F.props=R;var z=F.context,Q=g.contextType;typeof Q=="object"&&Q!==null?Q=di(Q):(Q=_r(g)?Tu:Ln.current,Q=Sc(d,Q));var ie=g.getDerivedStateFromProps,ae=typeof ie=="function"||typeof F.getSnapshotBeforeUpdate=="function";ae||typeof F.UNSAFE_componentWillReceiveProps!="function"&&typeof F.componentWillReceiveProps!="function"||(R!==x||z!==Q)&&IM(d,F,x,Q),va=!1;var re=d.memoizedState;F.state=re,F0(d,x,F,b),z=d.memoizedState,R!==x||re!==z||Sr.current||va?(typeof ie=="function"&&(Ew(d,g,ie,x),z=d.memoizedState),(R=va||LM(d,g,R,x,re,z,Q))?(ae||typeof F.UNSAFE_componentWillMount!="function"&&typeof F.componentWillMount!="function"||(typeof F.componentWillMount=="function"&&F.componentWillMount(),typeof F.UNSAFE_componentWillMount=="function"&&F.UNSAFE_componentWillMount()),typeof F.componentDidMount=="function"&&(d.flags|=4194308)):(typeof F.componentDidMount=="function"&&(d.flags|=4194308),d.memoizedProps=x,d.memoizedState=z),F.props=x,F.state=z,F.context=Q,x=R):(typeof F.componentDidMount=="function"&&(d.flags|=4194308),x=!1)}else{F=d.stateNode,dM(l,d),R=d.memoizedProps,Q=d.type===d.elementType?R:Bi(d.type,R),F.props=Q,ae=d.pendingProps,re=F.context,z=g.contextType,typeof z=="object"&&z!==null?z=di(z):(z=_r(g)?Tu:Ln.current,z=Sc(d,z));var be=g.getDerivedStateFromProps;(ie=typeof be=="function"||typeof F.getSnapshotBeforeUpdate=="function")||typeof F.UNSAFE_componentWillReceiveProps!="function"&&typeof F.componentWillReceiveProps!="function"||(R!==ae||re!==z)&&IM(d,F,x,z),va=!1,re=d.memoizedState,F.state=re,F0(d,x,F,b);var Ae=d.memoizedState;R!==ae||re!==Ae||Sr.current||va?(typeof be=="function"&&(Ew(d,g,be,x),Ae=d.memoizedState),(Q=va||LM(d,g,Q,x,re,Ae,z)||!1)?(ie||typeof F.UNSAFE_componentWillUpdate!="function"&&typeof F.componentWillUpdate!="function"||(typeof F.componentWillUpdate=="function"&&F.componentWillUpdate(x,Ae,z),typeof F.UNSAFE_componentWillUpdate=="function"&&F.UNSAFE_componentWillUpdate(x,Ae,z)),typeof F.componentDidUpdate=="function"&&(d.flags|=4),typeof F.getSnapshotBeforeUpdate=="function"&&(d.flags|=1024)):(typeof F.componentDidUpdate!="function"||R===l.memoizedProps&&re===l.memoizedState||(d.flags|=4),typeof F.getSnapshotBeforeUpdate!="function"||R===l.memoizedProps&&re===l.memoizedState||(d.flags|=1024),d.memoizedProps=x,d.memoizedState=Ae),F.props=x,F.state=Ae,F.context=z,x=Q):(typeof F.componentDidUpdate!="function"||R===l.memoizedProps&&re===l.memoizedState||(d.flags|=4),typeof F.getSnapshotBeforeUpdate!="function"||R===l.memoizedProps&&re===l.memoizedState||(d.flags|=1024),x=!1)}return Cw(l,d,g,x,_,b)}function Cw(l,d,g,x,b,_){XM(l,d);var F=(d.flags&128)!==0;if(!x&&!F)return b&&tM(d,g,!1),ws(l,d,_);x=d.stateNode,eG.current=d;var R=F&&typeof g.getDerivedStateFromError!="function"?null:x.render();return d.flags|=1,l!==null&&F?(d.child=kc(d,l.child,null,_),d.child=kc(d,null,R,_)):rr(l,d,R,_),d.memoizedState=x.state,b&&tM(d,g,!0),d.child}function KM(l){var d=l.stateNode;d.pendingContext?ZD(l,d.pendingContext,d.pendingContext!==d.context):d.context&&ZD(l,d.context,!1),lw(l,d.containerInfo)}function JM(l,d,g,x,b){return Cc(),nw(b),d.flags|=256,rr(l,d,g,x),d.child}var kw={dehydrated:null,treeContext:null,retryLane:0};function $w(l){return{baseLanes:l,cachePool:null,transitions:null}}function ZM(l,d,g){var x=d.pendingProps,b=Nt.current,_=!1,F=(d.flags&128)!==0,R;if((R=F)||(R=l!==null&&l.memoizedState===null?!1:(b&2)!==0),R?(_=!0,d.flags&=-129):(l===null||l.memoizedState!==null)&&(b|=1),bt(Nt,b&1),l===null)return tw(d),l=d.memoizedState,l!==null&&(l=l.dehydrated,l!==null)?((d.mode&1)===0?d.lanes=1:l.data==="$!"?d.lanes=8:d.lanes=1073741824,null):(F=x.children,l=x.fallback,_?(x=d.mode,_=d.child,F={mode:"hidden",children:F},(x&1)===0&&_!==null?(_.childLanes=0,_.pendingProps=F):_=Q0(F,x,0,null),l=ju(l,x,g,null),_.return=d,l.return=d,_.sibling=l,d.child=_,d.child.memoizedState=$w(g),d.memoizedState=kw,l):Fw(d,F));if(b=l.memoizedState,b!==null&&(R=b.dehydrated,R!==null))return tG(l,d,F,x,R,b,g);if(_){_=x.fallback,F=d.mode,b=l.child,R=b.sibling;var z={mode:"hidden",children:x.children};return(F&1)===0&&d.child!==b?(x=d.child,x.childLanes=0,x.pendingProps=z,d.deletions=null):(x=Aa(b,z),x.subtreeFlags=b.subtreeFlags&14680064),R!==null?_=Aa(R,_):(_=ju(_,F,g,null),_.flags|=2),_.return=d,x.return=d,x.sibling=_,d.child=x,x=_,_=d.child,F=l.child.memoizedState,F=F===null?$w(g):{baseLanes:F.baseLanes|g,cachePool:null,transitions:F.transitions},_.memoizedState=F,_.childLanes=l.childLanes&~g,d.memoizedState=kw,x}return _=l.child,l=_.sibling,x=Aa(_,{mode:"visible",children:x.children}),(d.mode&1)===0&&(x.lanes=g),x.return=d,x.sibling=null,l!==null&&(g=d.deletions,g===null?(d.deletions=[l],d.flags|=16):g.push(l)),d.child=x,d.memoizedState=null,x}function Fw(l,d){return d=Q0({mode:"visible",children:d},l.mode,0,null),d.return=l,l.child=d}function L0(l,d,g,x){return x!==null&&nw(x),kc(d,l.child,null,g),l=Fw(d,d.pendingProps.children),l.flags|=2,d.memoizedState=null,l}function tG(l,d,g,x,b,_,F){if(g)return d.flags&256?(d.flags&=-257,x=Sw(Error(n(422))),L0(l,d,F,x)):d.memoizedState!==null?(d.child=l.child,d.flags|=128,null):(_=x.fallback,b=d.mode,x=Q0({mode:"visible",children:x.children},b,0,null),_=ju(_,b,F,null),_.flags|=2,x.return=d,_.return=d,x.sibling=_,d.child=x,(d.mode&1)!==0&&kc(d,l.child,null,F),d.child.memoizedState=$w(F),d.memoizedState=kw,_);if((d.mode&1)===0)return L0(l,d,F,null);if(b.data==="$!"){if(x=b.nextSibling&&b.nextSibling.dataset,x)var R=x.dgst;return x=R,_=Error(n(419)),x=Sw(_,x,void 0),L0(l,d,F,x)}if(R=(F&l.childLanes)!==0,Ar||R){if(x=fn,x!==null){switch(F&-F){case 4:b=2;break;case 16:b=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:b=32;break;case 536870912:b=268435456;break;default:b=0}b=(b&(x.suspendedLanes|F))!==0?0:b,b!==0&&b!==_.retryLane&&(_.retryLane=b,vs(l,b),Wi(x,l,b,-1))}return Hw(),x=Sw(Error(n(421))),L0(l,d,F,x)}return b.data==="$?"?(d.flags|=128,d.child=l.child,d=pG.bind(null,l),b._reactRetry=d,null):(l=_.treeContext,Yr=pa(b.nextSibling),Vr=d,Ft=!0,Ii=null,l!==null&&(ci[fi++]=ms,ci[fi++]=ys,ci[fi++]=Nu,ms=l.id,ys=l.overflow,Nu=d),d=Fw(d,x.children),d.flags|=4096,d)}function e5(l,d,g){l.lanes|=d;var x=l.alternate;x!==null&&(x.lanes|=d),sw(l.return,d,g)}function Dw(l,d,g,x,b){var _=l.memoizedState;_===null?l.memoizedState={isBackwards:d,rendering:null,renderingStartTime:0,last:x,tail:g,tailMode:b}:(_.isBackwards=d,_.rendering=null,_.renderingStartTime=0,_.last=x,_.tail=g,_.tailMode=b)}function t5(l,d,g){var x=d.pendingProps,b=x.revealOrder,_=x.tail;if(rr(l,d,x.children,g),x=Nt.current,(x&2)!==0)x=x&1|2,d.flags|=128;else{if(l!==null&&(l.flags&128)!==0)e:for(l=d.child;l!==null;){if(l.tag===13)l.memoizedState!==null&&e5(l,g,d);else if(l.tag===19)e5(l,g,d);else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===d)break e;for(;l.sibling===null;){if(l.return===null||l.return===d)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}x&=1}if(bt(Nt,x),(d.mode&1)===0)d.memoizedState=null;else switch(b){case"forwards":for(g=d.child,b=null;g!==null;)l=g.alternate,l!==null&&D0(l)===null&&(b=g),g=g.sibling;g=b,g===null?(b=d.child,d.child=null):(b=g.sibling,g.sibling=null),Dw(d,!1,b,g,_);break;case"backwards":for(g=null,b=d.child,d.child=null;b!==null;){if(l=b.alternate,l!==null&&D0(l)===null){d.child=b;break}l=b.sibling,b.sibling=g,g=b,b=l}Dw(d,!0,g,null,_);break;case"together":Dw(d,!1,null,null,void 0);break;default:d.memoizedState=null}return d.child}function z0(l,d){(d.mode&1)===0&&l!==null&&(l.alternate=null,d.alternate=null,d.flags|=2)}function ws(l,d,g){if(l!==null&&(d.dependencies=l.dependencies),zu|=d.lanes,(g&d.childLanes)===0)return null;if(l!==null&&d.child!==l.child)throw Error(n(153));if(d.child!==null){for(l=d.child,g=Aa(l,l.pendingProps),d.child=g,g.return=d;l.sibling!==null;)l=l.sibling,g=g.sibling=Aa(l,l.pendingProps),g.return=d;g.sibling=null}return d.child}function nG(l,d,g){switch(d.tag){case 3:KM(d),Cc();break;case 5:gM(d);break;case 1:_r(d.type)&&w0(d);break;case 4:lw(d,d.stateNode.containerInfo);break;case 10:var x=d.type._context,b=d.memoizedProps.value;bt(C0,x._currentValue),x._currentValue=b;break;case 13:if(x=d.memoizedState,x!==null)return x.dehydrated!==null?(bt(Nt,Nt.current&1),d.flags|=128,null):(g&d.child.childLanes)!==0?ZM(l,d,g):(bt(Nt,Nt.current&1),l=ws(l,d,g),l!==null?l.sibling:null);bt(Nt,Nt.current&1);break;case 19:if(x=(g&d.childLanes)!==0,(l.flags&128)!==0){if(x)return t5(l,d,g);d.flags|=128}if(b=d.memoizedState,b!==null&&(b.rendering=null,b.tail=null,b.lastEffect=null),bt(Nt,Nt.current),x)break;return null;case 22:case 23:return d.lanes=0,YM(l,d,g)}return ws(l,d,g)}var n5,Mw,r5,i5;n5=function(l,d){for(var g=d.child;g!==null;){if(g.tag===5||g.tag===6)l.appendChild(g.stateNode);else if(g.tag!==4&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===d)break;for(;g.sibling===null;){if(g.return===null||g.return===d)return;g=g.return}g.sibling.return=g.return,g=g.sibling}},Mw=function(){},r5=function(l,d,g,x){var b=l.memoizedProps;if(b!==x){l=d.stateNode,Pu(_o.current);var _=null;switch(g){case"input":b=nt(l,b),x=nt(l,x),_=[];break;case"select":b=K({},b,{value:void 0}),x=K({},x,{value:void 0}),_=[];break;case"textarea":b=l2(l,b),x=l2(l,x),_=[];break;default:typeof b.onClick!="function"&&typeof x.onClick=="function"&&(l.onclick=y0)}f2(g,x);var F;g=null;for(Q in b)if(!x.hasOwnProperty(Q)&&b.hasOwnProperty(Q)&&b[Q]!=null)if(Q==="style"){var R=b[Q];for(F in R)R.hasOwnProperty(F)&&(g||(g={}),g[F]="")}else Q!=="dangerouslySetInnerHTML"&&Q!=="children"&&Q!=="suppressContentEditableWarning"&&Q!=="suppressHydrationWarning"&&Q!=="autoFocus"&&(i.hasOwnProperty(Q)?_||(_=[]):(_=_||[]).push(Q,null));for(Q in x){var z=x[Q];if(R=b!=null?b[Q]:void 0,x.hasOwnProperty(Q)&&z!==R&&(z!=null||R!=null))if(Q==="style")if(R){for(F in R)!R.hasOwnProperty(F)||z&&z.hasOwnProperty(F)||(g||(g={}),g[F]="");for(F in z)z.hasOwnProperty(F)&&R[F]!==z[F]&&(g||(g={}),g[F]=z[F])}else g||(_||(_=[]),_.push(Q,g)),g=z;else Q==="dangerouslySetInnerHTML"?(z=z?z.__html:void 0,R=R?R.__html:void 0,z!=null&&R!==z&&(_=_||[]).push(Q,z)):Q==="children"?typeof z!="string"&&typeof z!="number"||(_=_||[]).push(Q,""+z):Q!=="suppressContentEditableWarning"&&Q!=="suppressHydrationWarning"&&(i.hasOwnProperty(Q)?(z!=null&&Q==="onScroll"&&_t("scroll",l),_||R===z||(_=[])):(_=_||[]).push(Q,z))}g&&(_=_||[]).push("style",g);var Q=_;(d.updateQueue=Q)&&(d.flags|=4)}},i5=function(l,d,g,x){g!==x&&(d.flags|=4)};function rh(l,d){if(!Ft)switch(l.tailMode){case"hidden":d=l.tail;for(var g=null;d!==null;)d.alternate!==null&&(g=d),d=d.sibling;g===null?l.tail=null:g.sibling=null;break;case"collapsed":g=l.tail;for(var x=null;g!==null;)g.alternate!==null&&(x=g),g=g.sibling;x===null?d||l.tail===null?l.tail=null:l.tail.sibling=null:x.sibling=null}}function In(l){var d=l.alternate!==null&&l.alternate.child===l.child,g=0,x=0;if(d)for(var b=l.child;b!==null;)g|=b.lanes|b.childLanes,x|=b.subtreeFlags&14680064,x|=b.flags&14680064,b.return=l,b=b.sibling;else for(b=l.child;b!==null;)g|=b.lanes|b.childLanes,x|=b.subtreeFlags,x|=b.flags,b.return=l,b=b.sibling;return l.subtreeFlags|=x,l.childLanes=g,d}function rG(l,d,g){var x=d.pendingProps;switch(Z2(d),d.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return In(d),null;case 1:return _r(d.type)&&x0(),In(d),null;case 3:return x=d.stateNode,Dc(),At(Sr),At(Ln),dw(),x.pendingContext&&(x.context=x.pendingContext,x.pendingContext=null),(l===null||l.child===null)&&(_0(d)?d.flags|=4:l===null||l.memoizedState.isDehydrated&&(d.flags&256)===0||(d.flags|=1024,Ii!==null&&(jw(Ii),Ii=null))),Mw(l,d),In(d),null;case 5:cw(d);var b=Pu(Jd.current);if(g=d.type,l!==null&&d.stateNode!=null)r5(l,d,g,x,b),l.ref!==d.ref&&(d.flags|=512,d.flags|=2097152);else{if(!x){if(d.stateNode===null)throw Error(n(166));return In(d),null}if(l=Pu(_o.current),_0(d)){x=d.stateNode,g=d.type;var _=d.memoizedProps;switch(x[So]=d,x[Vd]=_,l=(d.mode&1)!==0,g){case"dialog":_t("cancel",x),_t("close",x);break;case"iframe":case"object":case"embed":_t("load",x);break;case"video":case"audio":for(b=0;b<qd.length;b++)_t(qd[b],x);break;case"source":_t("error",x);break;case"img":case"image":case"link":_t("error",x),_t("load",x);break;case"details":_t("toggle",x);break;case"input":Zt(x,_),_t("invalid",x);break;case"select":x._wrapperState={wasMultiple:!!_.multiple},_t("invalid",x);break;case"textarea":U3(x,_),_t("invalid",x)}f2(g,_),b=null;for(var F in _)if(_.hasOwnProperty(F)){var R=_[F];F==="children"?typeof R=="string"?x.textContent!==R&&(_.suppressHydrationWarning!==!0&&m0(x.textContent,R,l),b=["children",R]):typeof R=="number"&&x.textContent!==""+R&&(_.suppressHydrationWarning!==!0&&m0(x.textContent,R,l),b=["children",""+R]):i.hasOwnProperty(F)&&R!=null&&F==="onScroll"&&_t("scroll",x)}switch(g){case"input":We(x),Fu(x,_,!0);break;case"textarea":We(x),W3(x);break;case"select":case"option":break;default:typeof _.onClick=="function"&&(x.onclick=y0)}x=b,d.updateQueue=x,x!==null&&(d.flags|=4)}else{F=b.nodeType===9?b:b.ownerDocument,l==="http://www.w3.org/1999/xhtml"&&(l=q3(g)),l==="http://www.w3.org/1999/xhtml"?g==="script"?(l=F.createElement("div"),l.innerHTML="<script><\/script>",l=l.removeChild(l.firstChild)):typeof x.is=="string"?l=F.createElement(g,{is:x.is}):(l=F.createElement(g),g==="select"&&(F=l,x.multiple?F.multiple=!0:x.size&&(F.size=x.size))):l=F.createElementNS(l,g),l[So]=d,l[Vd]=x,n5(l,d,!1,!1),d.stateNode=l;e:{switch(F=d2(g,x),g){case"dialog":_t("cancel",l),_t("close",l),b=x;break;case"iframe":case"object":case"embed":_t("load",l),b=x;break;case"video":case"audio":for(b=0;b<qd.length;b++)_t(qd[b],l);b=x;break;case"source":_t("error",l),b=x;break;case"img":case"image":case"link":_t("error",l),_t("load",l),b=x;break;case"details":_t("toggle",l),b=x;break;case"input":Zt(l,x),b=nt(l,x),_t("invalid",l);break;case"option":b=x;break;case"select":l._wrapperState={wasMultiple:!!x.multiple},b=K({},x,{value:void 0}),_t("invalid",l);break;case"textarea":U3(l,x),b=l2(l,x),_t("invalid",l);break;default:b=x}f2(g,b),R=b;for(_ in R)if(R.hasOwnProperty(_)){var z=R[_];_==="style"?V3(l,z):_==="dangerouslySetInnerHTML"?(z=z?z.__html:void 0,z!=null&&H3(l,z)):_==="children"?typeof z=="string"?(g!=="textarea"||z!=="")&&Ad(l,z):typeof z=="number"&&Ad(l,""+z):_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&_!=="autoFocus"&&(i.hasOwnProperty(_)?z!=null&&_==="onScroll"&&_t("scroll",l):z!=null&&A(l,_,z,F))}switch(g){case"input":We(l),Fu(l,x,!1);break;case"textarea":We(l),W3(l);break;case"option":x.value!=null&&l.setAttribute("value",""+Ve(x.value));break;case"select":l.multiple=!!x.multiple,_=x.value,_!=null?fc(l,!!x.multiple,_,!1):x.defaultValue!=null&&fc(l,!!x.multiple,x.defaultValue,!0);break;default:typeof b.onClick=="function"&&(l.onclick=y0)}switch(g){case"button":case"input":case"select":case"textarea":x=!!x.autoFocus;break e;case"img":x=!0;break e;default:x=!1}}x&&(d.flags|=4)}d.ref!==null&&(d.flags|=512,d.flags|=2097152)}return In(d),null;case 6:if(l&&d.stateNode!=null)i5(l,d,l.memoizedProps,x);else{if(typeof x!="string"&&d.stateNode===null)throw Error(n(166));if(g=Pu(Jd.current),Pu(_o.current),_0(d)){if(x=d.stateNode,g=d.memoizedProps,x[So]=d,(_=x.nodeValue!==g)&&(l=Vr,l!==null))switch(l.tag){case 3:m0(x.nodeValue,g,(l.mode&1)!==0);break;case 5:l.memoizedProps.suppressHydrationWarning!==!0&&m0(x.nodeValue,g,(l.mode&1)!==0)}_&&(d.flags|=4)}else x=(g.nodeType===9?g:g.ownerDocument).createTextNode(x),x[So]=d,d.stateNode=x}return In(d),null;case 13:if(At(Nt),x=d.memoizedState,l===null||l.memoizedState!==null&&l.memoizedState.dehydrated!==null){if(Ft&&Yr!==null&&(d.mode&1)!==0&&(d.flags&128)===0)aM(),Cc(),d.flags|=98560,_=!1;else if(_=_0(d),x!==null&&x.dehydrated!==null){if(l===null){if(!_)throw Error(n(318));if(_=d.memoizedState,_=_!==null?_.dehydrated:null,!_)throw Error(n(317));_[So]=d}else Cc(),(d.flags&128)===0&&(d.memoizedState=null),d.flags|=4;In(d),_=!1}else Ii!==null&&(jw(Ii),Ii=null),_=!0;if(!_)return d.flags&65536?d:null}return(d.flags&128)!==0?(d.lanes=g,d):(x=x!==null,x!==(l!==null&&l.memoizedState!==null)&&x&&(d.child.flags|=8192,(d.mode&1)!==0&&(l===null||(Nt.current&1)!==0?tn===0&&(tn=3):Hw())),d.updateQueue!==null&&(d.flags|=4),In(d),null);case 4:return Dc(),Mw(l,d),l===null&&Hd(d.stateNode.containerInfo),In(d),null;case 10:return ow(d.type._context),In(d),null;case 17:return _r(d.type)&&x0(),In(d),null;case 19:if(At(Nt),_=d.memoizedState,_===null)return In(d),null;if(x=(d.flags&128)!==0,F=_.rendering,F===null)if(x)rh(_,!1);else{if(tn!==0||l!==null&&(l.flags&128)!==0)for(l=d.child;l!==null;){if(F=D0(l),F!==null){for(d.flags|=128,rh(_,!1),x=F.updateQueue,x!==null&&(d.updateQueue=x,d.flags|=4),d.subtreeFlags=0,x=g,g=d.child;g!==null;)_=g,l=x,_.flags&=14680066,F=_.alternate,F===null?(_.childLanes=0,_.lanes=l,_.child=null,_.subtreeFlags=0,_.memoizedProps=null,_.memoizedState=null,_.updateQueue=null,_.dependencies=null,_.stateNode=null):(_.childLanes=F.childLanes,_.lanes=F.lanes,_.child=F.child,_.subtreeFlags=0,_.deletions=null,_.memoizedProps=F.memoizedProps,_.memoizedState=F.memoizedState,_.updateQueue=F.updateQueue,_.type=F.type,l=F.dependencies,_.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),g=g.sibling;return bt(Nt,Nt.current&1|2),d.child}l=l.sibling}_.tail!==null&&Ht()>Rc&&(d.flags|=128,x=!0,rh(_,!1),d.lanes=4194304)}else{if(!x)if(l=D0(F),l!==null){if(d.flags|=128,x=!0,g=l.updateQueue,g!==null&&(d.updateQueue=g,d.flags|=4),rh(_,!0),_.tail===null&&_.tailMode==="hidden"&&!F.alternate&&!Ft)return In(d),null}else 2*Ht()-_.renderingStartTime>Rc&&g!==1073741824&&(d.flags|=128,x=!0,rh(_,!1),d.lanes=4194304);_.isBackwards?(F.sibling=d.child,d.child=F):(g=_.last,g!==null?g.sibling=F:d.child=F,_.last=F)}return _.tail!==null?(d=_.tail,_.rendering=d,_.tail=d.sibling,_.renderingStartTime=Ht(),d.sibling=null,g=Nt.current,bt(Nt,x?g&1|2:g&1),d):(In(d),null);case 22:case 23:return qw(),x=d.memoizedState!==null,l!==null&&l.memoizedState!==null!==x&&(d.flags|=8192),x&&(d.mode&1)!==0?(Xr&1073741824)!==0&&(In(d),d.subtreeFlags&6&&(d.flags|=8192)):In(d),null;case 24:return null;case 25:return null}throw Error(n(156,d.tag))}function iG(l,d){switch(Z2(d),d.tag){case 1:return _r(d.type)&&x0(),l=d.flags,l&65536?(d.flags=l&-65537|128,d):null;case 3:return Dc(),At(Sr),At(Ln),dw(),l=d.flags,(l&65536)!==0&&(l&128)===0?(d.flags=l&-65537|128,d):null;case 5:return cw(d),null;case 13:if(At(Nt),l=d.memoizedState,l!==null&&l.dehydrated!==null){if(d.alternate===null)throw Error(n(340));Cc()}return l=d.flags,l&65536?(d.flags=l&-65537|128,d):null;case 19:return At(Nt),null;case 4:return Dc(),null;case 10:return ow(d.type._context),null;case 22:case 23:return qw(),null;case 24:return null;default:return null}}var I0=!1,Bn=!1,oG=typeof WeakSet=="function"?WeakSet:Set,Se=null;function Tc(l,d){var g=l.ref;if(g!==null)if(typeof g=="function")try{g(null)}catch(x){It(l,d,x)}else g.current=null}function Tw(l,d,g){try{g()}catch(x){It(l,d,x)}}var o5=!1;function sG(l,d){if(q2=o0,l=LD(),P2(l)){if("selectionStart"in l)var g={start:l.selectionStart,end:l.selectionEnd};else e:{g=(g=l.ownerDocument)&&g.defaultView||window;var x=g.getSelection&&g.getSelection();if(x&&x.rangeCount!==0){g=x.anchorNode;var b=x.anchorOffset,_=x.focusNode;x=x.focusOffset;try{g.nodeType,_.nodeType}catch{g=null;break e}var F=0,R=-1,z=-1,Q=0,ie=0,ae=l,re=null;t:for(;;){for(var be;ae!==g||b!==0&&ae.nodeType!==3||(R=F+b),ae!==_||x!==0&&ae.nodeType!==3||(z=F+x),ae.nodeType===3&&(F+=ae.nodeValue.length),(be=ae.firstChild)!==null;)re=ae,ae=be;for(;;){if(ae===l)break t;if(re===g&&++Q===b&&(R=F),re===_&&++ie===x&&(z=F),(be=ae.nextSibling)!==null)break;ae=re,re=ae.parentNode}ae=be}g=R===-1||z===-1?null:{start:R,end:z}}else g=null}g=g||{start:0,end:0}}else g=null;for(H2={focusedElem:l,selectionRange:g},o0=!1,Se=d;Se!==null;)if(d=Se,l=d.child,(d.subtreeFlags&1028)!==0&&l!==null)l.return=d,Se=l;else for(;Se!==null;){d=Se;try{var Ae=d.alternate;if((d.flags&1024)!==0)switch(d.tag){case 0:case 11:case 15:break;case 1:if(Ae!==null){var Ce=Ae.memoizedProps,Gt=Ae.memoizedState,H=d.stateNode,B=H.getSnapshotBeforeUpdate(d.elementType===d.type?Ce:Bi(d.type,Ce),Gt);H.__reactInternalSnapshotBeforeUpdate=B}break;case 3:var V=d.stateNode.containerInfo;V.nodeType===1?V.textContent="":V.nodeType===9&&V.documentElement&&V.removeChild(V.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(n(163))}}catch(he){It(d,d.return,he)}if(l=d.sibling,l!==null){l.return=d.return,Se=l;break}Se=d.return}return Ae=o5,o5=!1,Ae}function ih(l,d,g){var x=d.updateQueue;if(x=x!==null?x.lastEffect:null,x!==null){var b=x=x.next;do{if((b.tag&l)===l){var _=b.destroy;b.destroy=void 0,_!==void 0&&Tw(d,g,_)}b=b.next}while(b!==x)}}function B0(l,d){if(d=d.updateQueue,d=d!==null?d.lastEffect:null,d!==null){var g=d=d.next;do{if((g.tag&l)===l){var x=g.create;g.destroy=x()}g=g.next}while(g!==d)}}function Nw(l){var d=l.ref;if(d!==null){var g=l.stateNode;switch(l.tag){case 5:l=g;break;default:l=g}typeof d=="function"?d(l):d.current=l}}function s5(l){var d=l.alternate;d!==null&&(l.alternate=null,s5(d)),l.child=null,l.deletions=null,l.sibling=null,l.tag===5&&(d=l.stateNode,d!==null&&(delete d[So],delete d[Vd],delete d[X2],delete d[jH],delete d[WH])),l.stateNode=null,l.return=null,l.dependencies=null,l.memoizedProps=null,l.memoizedState=null,l.pendingProps=null,l.stateNode=null,l.updateQueue=null}function a5(l){return l.tag===5||l.tag===3||l.tag===4}function u5(l){e:for(;;){for(;l.sibling===null;){if(l.return===null||a5(l.return))return null;l=l.return}for(l.sibling.return=l.return,l=l.sibling;l.tag!==5&&l.tag!==6&&l.tag!==18;){if(l.flags&2||l.child===null||l.tag===4)continue e;l.child.return=l,l=l.child}if(!(l.flags&2))return l.stateNode}}function Rw(l,d,g){var x=l.tag;if(x===5||x===6)l=l.stateNode,d?g.nodeType===8?g.parentNode.insertBefore(l,d):g.insertBefore(l,d):(g.nodeType===8?(d=g.parentNode,d.insertBefore(l,g)):(d=g,d.appendChild(l)),g=g._reactRootContainer,g!=null||d.onclick!==null||(d.onclick=y0));else if(x!==4&&(l=l.child,l!==null))for(Rw(l,d,g),l=l.sibling;l!==null;)Rw(l,d,g),l=l.sibling}function Ow(l,d,g){var x=l.tag;if(x===5||x===6)l=l.stateNode,d?g.insertBefore(l,d):g.appendChild(l);else if(x!==4&&(l=l.child,l!==null))for(Ow(l,d,g),l=l.sibling;l!==null;)Ow(l,d,g),l=l.sibling}var _n=null,Ui=!1;function wa(l,d,g){for(g=g.child;g!==null;)l5(l,d,g),g=g.sibling}function l5(l,d,g){if(bo&&typeof bo.onCommitFiberUnmount=="function")try{bo.onCommitFiberUnmount(Zg,g)}catch{}switch(g.tag){case 5:Bn||Tc(g,d);case 6:var x=_n,b=Ui;_n=null,wa(l,d,g),_n=x,Ui=b,_n!==null&&(Ui?(l=_n,g=g.stateNode,l.nodeType===8?l.parentNode.removeChild(g):l.removeChild(g)):_n.removeChild(g.stateNode));break;case 18:_n!==null&&(Ui?(l=_n,g=g.stateNode,l.nodeType===8?Y2(l.parentNode,g):l.nodeType===1&&Y2(l,g),Pd(l)):Y2(_n,g.stateNode));break;case 4:x=_n,b=Ui,_n=g.stateNode.containerInfo,Ui=!0,wa(l,d,g),_n=x,Ui=b;break;case 0:case 11:case 14:case 15:if(!Bn&&(x=g.updateQueue,x!==null&&(x=x.lastEffect,x!==null))){b=x=x.next;do{var _=b,F=_.destroy;_=_.tag,F!==void 0&&((_&2)!==0||(_&4)!==0)&&Tw(g,d,F),b=b.next}while(b!==x)}wa(l,d,g);break;case 1:if(!Bn&&(Tc(g,d),x=g.stateNode,typeof x.componentWillUnmount=="function"))try{x.props=g.memoizedProps,x.state=g.memoizedState,x.componentWillUnmount()}catch(R){It(g,d,R)}wa(l,d,g);break;case 21:wa(l,d,g);break;case 22:g.mode&1?(Bn=(x=Bn)||g.memoizedState!==null,wa(l,d,g),Bn=x):wa(l,d,g);break;default:wa(l,d,g)}}function c5(l){var d=l.updateQueue;if(d!==null){l.updateQueue=null;var g=l.stateNode;g===null&&(g=l.stateNode=new oG),d.forEach(function(x){var b=gG.bind(null,l,x);g.has(x)||(g.add(x),x.then(b,b))})}}function ji(l,d){var g=d.deletions;if(g!==null)for(var x=0;x<g.length;x++){var b=g[x];try{var _=l,F=d,R=F;e:for(;R!==null;){switch(R.tag){case 5:_n=R.stateNode,Ui=!1;break e;case 3:_n=R.stateNode.containerInfo,Ui=!0;break e;case 4:_n=R.stateNode.containerInfo,Ui=!0;break e}R=R.return}if(_n===null)throw Error(n(160));l5(_,F,b),_n=null,Ui=!1;var z=b.alternate;z!==null&&(z.return=null),b.return=null}catch(Q){It(b,d,Q)}}if(d.subtreeFlags&12854)for(d=d.child;d!==null;)f5(d,l),d=d.sibling}function f5(l,d){var g=l.alternate,x=l.flags;switch(l.tag){case 0:case 11:case 14:case 15:if(ji(d,l),Co(l),x&4){try{ih(3,l,l.return),B0(3,l)}catch(Ce){It(l,l.return,Ce)}try{ih(5,l,l.return)}catch(Ce){It(l,l.return,Ce)}}break;case 1:ji(d,l),Co(l),x&512&&g!==null&&Tc(g,g.return);break;case 5:if(ji(d,l),Co(l),x&512&&g!==null&&Tc(g,g.return),l.flags&32){var b=l.stateNode;try{Ad(b,"")}catch(Ce){It(l,l.return,Ce)}}if(x&4&&(b=l.stateNode,b!=null)){var _=l.memoizedProps,F=g!==null?g.memoizedProps:_,R=l.type,z=l.updateQueue;if(l.updateQueue=null,z!==null)try{R==="input"&&_.type==="radio"&&_.name!=null&&qt(b,_),d2(R,F);var Q=d2(R,_);for(F=0;F<z.length;F+=2){var ie=z[F],ae=z[F+1];ie==="style"?V3(b,ae):ie==="dangerouslySetInnerHTML"?H3(b,ae):ie==="children"?Ad(b,ae):A(b,ie,ae,Q)}switch(R){case"input":br(b,_);break;case"textarea":j3(b,_);break;case"select":var re=b._wrapperState.wasMultiple;b._wrapperState.wasMultiple=!!_.multiple;var be=_.value;be!=null?fc(b,!!_.multiple,be,!1):re!==!!_.multiple&&(_.defaultValue!=null?fc(b,!!_.multiple,_.defaultValue,!0):fc(b,!!_.multiple,_.multiple?[]:"",!1))}b[Vd]=_}catch(Ce){It(l,l.return,Ce)}}break;case 6:if(ji(d,l),Co(l),x&4){if(l.stateNode===null)throw Error(n(162));b=l.stateNode,_=l.memoizedProps;try{b.nodeValue=_}catch(Ce){It(l,l.return,Ce)}}break;case 3:if(ji(d,l),Co(l),x&4&&g!==null&&g.memoizedState.isDehydrated)try{Pd(d.containerInfo)}catch(Ce){It(l,l.return,Ce)}break;case 4:ji(d,l),Co(l);break;case 13:ji(d,l),Co(l),b=l.child,b.flags&8192&&(_=b.memoizedState!==null,b.stateNode.isHidden=_,!_||b.alternate!==null&&b.alternate.memoizedState!==null||(zw=Ht())),x&4&&c5(l);break;case 22:if(ie=g!==null&&g.memoizedState!==null,l.mode&1?(Bn=(Q=Bn)||ie,ji(d,l),Bn=Q):ji(d,l),Co(l),x&8192){if(Q=l.memoizedState!==null,(l.stateNode.isHidden=Q)&&!ie&&(l.mode&1)!==0)for(Se=l,ie=l.child;ie!==null;){for(ae=Se=ie;Se!==null;){switch(re=Se,be=re.child,re.tag){case 0:case 11:case 14:case 15:ih(4,re,re.return);break;case 1:Tc(re,re.return);var Ae=re.stateNode;if(typeof Ae.componentWillUnmount=="function"){x=re,g=re.return;try{d=x,Ae.props=d.memoizedProps,Ae.state=d.memoizedState,Ae.componentWillUnmount()}catch(Ce){It(x,g,Ce)}}break;case 5:Tc(re,re.return);break;case 22:if(re.memoizedState!==null){p5(ae);continue}}be!==null?(be.return=re,Se=be):p5(ae)}ie=ie.sibling}e:for(ie=null,ae=l;;){if(ae.tag===5){if(ie===null){ie=ae;try{b=ae.stateNode,Q?(_=b.style,typeof _.setProperty=="function"?_.setProperty("display","none","important"):_.display="none"):(R=ae.stateNode,z=ae.memoizedProps.style,F=z!=null&&z.hasOwnProperty("display")?z.display:null,R.style.display=G3("display",F))}catch(Ce){It(l,l.return,Ce)}}}else if(ae.tag===6){if(ie===null)try{ae.stateNode.nodeValue=Q?"":ae.memoizedProps}catch(Ce){It(l,l.return,Ce)}}else if((ae.tag!==22&&ae.tag!==23||ae.memoizedState===null||ae===l)&&ae.child!==null){ae.child.return=ae,ae=ae.child;continue}if(ae===l)break e;for(;ae.sibling===null;){if(ae.return===null||ae.return===l)break e;ie===ae&&(ie=null),ae=ae.return}ie===ae&&(ie=null),ae.sibling.return=ae.return,ae=ae.sibling}}break;case 19:ji(d,l),Co(l),x&4&&c5(l);break;case 21:break;default:ji(d,l),Co(l)}}function Co(l){var d=l.flags;if(d&2){try{e:{for(var g=l.return;g!==null;){if(a5(g)){var x=g;break e}g=g.return}throw Error(n(160))}switch(x.tag){case 5:var b=x.stateNode;x.flags&32&&(Ad(b,""),x.flags&=-33);var _=u5(l);Ow(l,_,b);break;case 3:case 4:var F=x.stateNode.containerInfo,R=u5(l);Rw(l,R,F);break;default:throw Error(n(161))}}catch(z){It(l,l.return,z)}l.flags&=-3}d&4096&&(l.flags&=-4097)}function aG(l,d,g){Se=l,d5(l)}function d5(l,d,g){for(var x=(l.mode&1)!==0;Se!==null;){var b=Se,_=b.child;if(b.tag===22&&x){var F=b.memoizedState!==null||I0;if(!F){var R=b.alternate,z=R!==null&&R.memoizedState!==null||Bn;R=I0;var Q=Bn;if(I0=F,(Bn=z)&&!Q)for(Se=b;Se!==null;)F=Se,z=F.child,F.tag===22&&F.memoizedState!==null?g5(b):z!==null?(z.return=F,Se=z):g5(b);for(;_!==null;)Se=_,d5(_),_=_.sibling;Se=b,I0=R,Bn=Q}h5(l)}else(b.subtreeFlags&8772)!==0&&_!==null?(_.return=b,Se=_):h5(l)}}function h5(l){for(;Se!==null;){var d=Se;if((d.flags&8772)!==0){var g=d.alternate;try{if((d.flags&8772)!==0)switch(d.tag){case 0:case 11:case 15:Bn||B0(5,d);break;case 1:var x=d.stateNode;if(d.flags&4&&!Bn)if(g===null)x.componentDidMount();else{var b=d.elementType===d.type?g.memoizedProps:Bi(d.type,g.memoizedProps);x.componentDidUpdate(b,g.memoizedState,x.__reactInternalSnapshotBeforeUpdate)}var _=d.updateQueue;_!==null&&pM(d,_,x);break;case 3:var F=d.updateQueue;if(F!==null){if(g=null,d.child!==null)switch(d.child.tag){case 5:g=d.child.stateNode;break;case 1:g=d.child.stateNode}pM(d,F,g)}break;case 5:var R=d.stateNode;if(g===null&&d.flags&4){g=R;var z=d.memoizedProps;switch(d.type){case"button":case"input":case"select":case"textarea":z.autoFocus&&g.focus();break;case"img":z.src&&(g.src=z.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(d.memoizedState===null){var Q=d.alternate;if(Q!==null){var ie=Q.memoizedState;if(ie!==null){var ae=ie.dehydrated;ae!==null&&Pd(ae)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(n(163))}Bn||d.flags&512&&Nw(d)}catch(re){It(d,d.return,re)}}if(d===l){Se=null;break}if(g=d.sibling,g!==null){g.return=d.return,Se=g;break}Se=d.return}}function p5(l){for(;Se!==null;){var d=Se;if(d===l){Se=null;break}var g=d.sibling;if(g!==null){g.return=d.return,Se=g;break}Se=d.return}}function g5(l){for(;Se!==null;){var d=Se;try{switch(d.tag){case 0:case 11:case 15:var g=d.return;try{B0(4,d)}catch(z){It(d,g,z)}break;case 1:var x=d.stateNode;if(typeof x.componentDidMount=="function"){var b=d.return;try{x.componentDidMount()}catch(z){It(d,b,z)}}var _=d.return;try{Nw(d)}catch(z){It(d,_,z)}break;case 5:var F=d.return;try{Nw(d)}catch(z){It(d,F,z)}}}catch(z){It(d,d.return,z)}if(d===l){Se=null;break}var R=d.sibling;if(R!==null){R.return=d.return,Se=R;break}Se=d.return}}var uG=Math.ceil,U0=C.ReactCurrentDispatcher,Pw=C.ReactCurrentOwner,pi=C.ReactCurrentBatchConfig,rt=0,fn=null,Kt=null,An=0,Xr=0,Nc=ga(0),tn=0,oh=null,zu=0,j0=0,Lw=0,sh=null,Cr=null,zw=0,Rc=1/0,Es=null,W0=!1,Iw=null,Ea=null,q0=!1,ba=null,H0=0,ah=0,Bw=null,G0=-1,V0=0;function ir(){return(rt&6)!==0?Ht():G0!==-1?G0:G0=Ht()}function Sa(l){return(l.mode&1)===0?1:(rt&2)!==0&&An!==0?An&-An:HH.transition!==null?(V0===0&&(V0=uD()),V0):(l=dt,l!==0||(l=window.event,l=l===void 0?16:yD(l.type)),l)}function Wi(l,d,g,x){if(50<ah)throw ah=0,Bw=null,Error(n(185));Md(l,g,x),((rt&2)===0||l!==fn)&&(l===fn&&((rt&2)===0&&(j0|=g),tn===4&&_a(l,An)),kr(l,x),g===1&&rt===0&&(d.mode&1)===0&&(Rc=Ht()+500,E0&&ya()))}function kr(l,d){var g=l.callbackNode;Hq(l,d);var x=n0(l,l===fn?An:0);if(x===0)g!==null&&oD(g),l.callbackNode=null,l.callbackPriority=0;else if(d=x&-x,l.callbackPriority!==d){if(g!=null&&oD(g),d===1)l.tag===0?qH(y5.bind(null,l)):nM(y5.bind(null,l)),BH(function(){(rt&6)===0&&ya()}),g=null;else{switch(lD(x)){case 1:g=x2;break;case 4:g=sD;break;case 16:g=Jg;break;case 536870912:g=aD;break;default:g=Jg}g=A5(g,m5.bind(null,l))}l.callbackPriority=d,l.callbackNode=g}}function m5(l,d){if(G0=-1,V0=0,(rt&6)!==0)throw Error(n(327));var g=l.callbackNode;if(Oc()&&l.callbackNode!==g)return null;var x=n0(l,l===fn?An:0);if(x===0)return null;if((x&30)!==0||(x&l.expiredLanes)!==0||d)d=Y0(l,x);else{d=x;var b=rt;rt|=2;var _=x5();(fn!==l||An!==d)&&(Es=null,Rc=Ht()+500,Bu(l,d));do try{fG();break}catch(R){v5(l,R)}while(!0);iw(),U0.current=_,rt=b,Kt!==null?d=0:(fn=null,An=0,d=tn)}if(d!==0){if(d===2&&(b=w2(l),b!==0&&(x=b,d=Uw(l,b))),d===1)throw g=oh,Bu(l,0),_a(l,x),kr(l,Ht()),g;if(d===6)_a(l,x);else{if(b=l.current.alternate,(x&30)===0&&!lG(b)&&(d=Y0(l,x),d===2&&(_=w2(l),_!==0&&(x=_,d=Uw(l,_))),d===1))throw g=oh,Bu(l,0),_a(l,x),kr(l,Ht()),g;switch(l.finishedWork=b,l.finishedLanes=x,d){case 0:case 1:throw Error(n(345));case 2:Uu(l,Cr,Es);break;case 3:if(_a(l,x),(x&130023424)===x&&(d=zw+500-Ht(),10<d)){if(n0(l,0)!==0)break;if(b=l.suspendedLanes,(b&x)!==x){ir(),l.pingedLanes|=l.suspendedLanes&b;break}l.timeoutHandle=V2(Uu.bind(null,l,Cr,Es),d);break}Uu(l,Cr,Es);break;case 4:if(_a(l,x),(x&4194240)===x)break;for(d=l.eventTimes,b=-1;0<x;){var F=31-Li(x);_=1<<F,F=d[F],F>b&&(b=F),x&=~_}if(x=b,x=Ht()-x,x=(120>x?120:480>x?480:1080>x?1080:1920>x?1920:3e3>x?3e3:4320>x?4320:1960*uG(x/1960))-x,10<x){l.timeoutHandle=V2(Uu.bind(null,l,Cr,Es),x);break}Uu(l,Cr,Es);break;case 5:Uu(l,Cr,Es);break;default:throw Error(n(329))}}}return kr(l,Ht()),l.callbackNode===g?m5.bind(null,l):null}function Uw(l,d){var g=sh;return l.current.memoizedState.isDehydrated&&(Bu(l,d).flags|=256),l=Y0(l,d),l!==2&&(d=Cr,Cr=g,d!==null&&jw(d)),l}function jw(l){Cr===null?Cr=l:Cr.push.apply(Cr,l)}function lG(l){for(var d=l;;){if(d.flags&16384){var g=d.updateQueue;if(g!==null&&(g=g.stores,g!==null))for(var x=0;x<g.length;x++){var b=g[x],_=b.getSnapshot;b=b.value;try{if(!zi(_(),b))return!1}catch{return!1}}}if(g=d.child,d.subtreeFlags&16384&&g!==null)g.return=d,d=g;else{if(d===l)break;for(;d.sibling===null;){if(d.return===null||d.return===l)return!0;d=d.return}d.sibling.return=d.return,d=d.sibling}}return!0}function _a(l,d){for(d&=~Lw,d&=~j0,l.suspendedLanes|=d,l.pingedLanes&=~d,l=l.expirationTimes;0<d;){var g=31-Li(d),x=1<<g;l[g]=-1,d&=~x}}function y5(l){if((rt&6)!==0)throw Error(n(327));Oc();var d=n0(l,0);if((d&1)===0)return kr(l,Ht()),null;var g=Y0(l,d);if(l.tag!==0&&g===2){var x=w2(l);x!==0&&(d=x,g=Uw(l,x))}if(g===1)throw g=oh,Bu(l,0),_a(l,d),kr(l,Ht()),g;if(g===6)throw Error(n(345));return l.finishedWork=l.current.alternate,l.finishedLanes=d,Uu(l,Cr,Es),kr(l,Ht()),null}function Ww(l,d){var g=rt;rt|=1;try{return l(d)}finally{rt=g,rt===0&&(Rc=Ht()+500,E0&&ya())}}function Iu(l){ba!==null&&ba.tag===0&&(rt&6)===0&&Oc();var d=rt;rt|=1;var g=pi.transition,x=dt;try{if(pi.transition=null,dt=1,l)return l()}finally{dt=x,pi.transition=g,rt=d,(rt&6)===0&&ya()}}function qw(){Xr=Nc.current,At(Nc)}function Bu(l,d){l.finishedWork=null,l.finishedLanes=0;var g=l.timeoutHandle;if(g!==-1&&(l.timeoutHandle=-1,IH(g)),Kt!==null)for(g=Kt.return;g!==null;){var x=g;switch(Z2(x),x.tag){case 1:x=x.type.childContextTypes,x!=null&&x0();break;case 3:Dc(),At(Sr),At(Ln),dw();break;case 5:cw(x);break;case 4:Dc();break;case 13:At(Nt);break;case 19:At(Nt);break;case 10:ow(x.type._context);break;case 22:case 23:qw()}g=g.return}if(fn=l,Kt=l=Aa(l.current,null),An=Xr=d,tn=0,oh=null,Lw=j0=zu=0,Cr=sh=null,Ou!==null){for(d=0;d<Ou.length;d++)if(g=Ou[d],x=g.interleaved,x!==null){g.interleaved=null;var b=x.next,_=g.pending;if(_!==null){var F=_.next;_.next=b,x.next=F}g.pending=x}Ou=null}return l}function v5(l,d){do{var g=Kt;try{if(iw(),M0.current=O0,T0){for(var x=Rt.memoizedState;x!==null;){var b=x.queue;b!==null&&(b.pending=null),x=x.next}T0=!1}if(Lu=0,cn=en=Rt=null,Zd=!1,eh=0,Pw.current=null,g===null||g.return===null){tn=1,oh=d,Kt=null;break}e:{var _=l,F=g.return,R=g,z=d;if(d=An,R.flags|=32768,z!==null&&typeof z=="object"&&typeof z.then=="function"){var Q=z,ie=R,ae=ie.tag;if((ie.mode&1)===0&&(ae===0||ae===11||ae===15)){var re=ie.alternate;re?(ie.updateQueue=re.updateQueue,ie.memoizedState=re.memoizedState,ie.lanes=re.lanes):(ie.updateQueue=null,ie.memoizedState=null)}var be=WM(F);if(be!==null){be.flags&=-257,qM(be,F,R,_,d),be.mode&1&&jM(_,Q,d),d=be,z=Q;var Ae=d.updateQueue;if(Ae===null){var Ce=new Set;Ce.add(z),d.updateQueue=Ce}else Ae.add(z);break e}else{if((d&1)===0){jM(_,Q,d),Hw();break e}z=Error(n(426))}}else if(Ft&&R.mode&1){var Gt=WM(F);if(Gt!==null){(Gt.flags&65536)===0&&(Gt.flags|=256),qM(Gt,F,R,_,d),nw(Mc(z,R));break e}}_=z=Mc(z,R),tn!==4&&(tn=2),sh===null?sh=[_]:sh.push(_),_=F;do{switch(_.tag){case 3:_.flags|=65536,d&=-d,_.lanes|=d;var H=BM(_,z,d);hM(_,H);break e;case 1:R=z;var B=_.type,V=_.stateNode;if((_.flags&128)===0&&(typeof B.getDerivedStateFromError=="function"||V!==null&&typeof V.componentDidCatch=="function"&&(Ea===null||!Ea.has(V)))){_.flags|=65536,d&=-d,_.lanes|=d;var he=UM(_,R,d);hM(_,he);break e}}_=_.return}while(_!==null)}E5(g)}catch(De){d=De,Kt===g&&g!==null&&(Kt=g=g.return);continue}break}while(!0)}function x5(){var l=U0.current;return U0.current=O0,l===null?O0:l}function Hw(){(tn===0||tn===3||tn===2)&&(tn=4),fn===null||(zu&268435455)===0&&(j0&268435455)===0||_a(fn,An)}function Y0(l,d){var g=rt;rt|=2;var x=x5();(fn!==l||An!==d)&&(Es=null,Bu(l,d));do try{cG();break}catch(b){v5(l,b)}while(!0);if(iw(),rt=g,U0.current=x,Kt!==null)throw Error(n(261));return fn=null,An=0,tn}function cG(){for(;Kt!==null;)w5(Kt)}function fG(){for(;Kt!==null&&!Pq();)w5(Kt)}function w5(l){var d=_5(l.alternate,l,Xr);l.memoizedProps=l.pendingProps,d===null?E5(l):Kt=d,Pw.current=null}function E5(l){var d=l;do{var g=d.alternate;if(l=d.return,(d.flags&32768)===0){if(g=rG(g,d,Xr),g!==null){Kt=g;return}}else{if(g=iG(g,d),g!==null){g.flags&=32767,Kt=g;return}if(l!==null)l.flags|=32768,l.subtreeFlags=0,l.deletions=null;else{tn=6,Kt=null;return}}if(d=d.sibling,d!==null){Kt=d;return}Kt=d=l}while(d!==null);tn===0&&(tn=5)}function Uu(l,d,g){var x=dt,b=pi.transition;try{pi.transition=null,dt=1,dG(l,d,g,x)}finally{pi.transition=b,dt=x}return null}function dG(l,d,g,x){do Oc();while(ba!==null);if((rt&6)!==0)throw Error(n(327));g=l.finishedWork;var b=l.finishedLanes;if(g===null)return null;if(l.finishedWork=null,l.finishedLanes=0,g===l.current)throw Error(n(177));l.callbackNode=null,l.callbackPriority=0;var _=g.lanes|g.childLanes;if(Gq(l,_),l===fn&&(Kt=fn=null,An=0),(g.subtreeFlags&2064)===0&&(g.flags&2064)===0||q0||(q0=!0,A5(Jg,function(){return Oc(),null})),_=(g.flags&15990)!==0,(g.subtreeFlags&15990)!==0||_){_=pi.transition,pi.transition=null;var F=dt;dt=1;var R=rt;rt|=4,Pw.current=null,sG(l,g),f5(g,l),TH(H2),o0=!!q2,H2=q2=null,l.current=g,aG(g),Lq(),rt=R,dt=F,pi.transition=_}else l.current=g;if(q0&&(q0=!1,ba=l,H0=b),_=l.pendingLanes,_===0&&(Ea=null),Bq(g.stateNode),kr(l,Ht()),d!==null)for(x=l.onRecoverableError,g=0;g<d.length;g++)b=d[g],x(b.value,{componentStack:b.stack,digest:b.digest});if(W0)throw W0=!1,l=Iw,Iw=null,l;return(H0&1)!==0&&l.tag!==0&&Oc(),_=l.pendingLanes,(_&1)!==0?l===Bw?ah++:(ah=0,Bw=l):ah=0,ya(),null}function Oc(){if(ba!==null){var l=lD(H0),d=pi.transition,g=dt;try{if(pi.transition=null,dt=16>l?16:l,ba===null)var x=!1;else{if(l=ba,ba=null,H0=0,(rt&6)!==0)throw Error(n(331));var b=rt;for(rt|=4,Se=l.current;Se!==null;){var _=Se,F=_.child;if((Se.flags&16)!==0){var R=_.deletions;if(R!==null){for(var z=0;z<R.length;z++){var Q=R[z];for(Se=Q;Se!==null;){var ie=Se;switch(ie.tag){case 0:case 11:case 15:ih(8,ie,_)}var ae=ie.child;if(ae!==null)ae.return=ie,Se=ae;else for(;Se!==null;){ie=Se;var re=ie.sibling,be=ie.return;if(s5(ie),ie===Q){Se=null;break}if(re!==null){re.return=be,Se=re;break}Se=be}}}var Ae=_.alternate;if(Ae!==null){var Ce=Ae.child;if(Ce!==null){Ae.child=null;do{var Gt=Ce.sibling;Ce.sibling=null,Ce=Gt}while(Ce!==null)}}Se=_}}if((_.subtreeFlags&2064)!==0&&F!==null)F.return=_,Se=F;else e:for(;Se!==null;){if(_=Se,(_.flags&2048)!==0)switch(_.tag){case 0:case 11:case 15:ih(9,_,_.return)}var H=_.sibling;if(H!==null){H.return=_.return,Se=H;break e}Se=_.return}}var B=l.current;for(Se=B;Se!==null;){F=Se;var V=F.child;if((F.subtreeFlags&2064)!==0&&V!==null)V.return=F,Se=V;else e:for(F=B;Se!==null;){if(R=Se,(R.flags&2048)!==0)try{switch(R.tag){case 0:case 11:case 15:B0(9,R)}}catch(De){It(R,R.return,De)}if(R===F){Se=null;break e}var he=R.sibling;if(he!==null){he.return=R.return,Se=he;break e}Se=R.return}}if(rt=b,ya(),bo&&typeof bo.onPostCommitFiberRoot=="function")try{bo.onPostCommitFiberRoot(Zg,l)}catch{}x=!0}return x}finally{dt=g,pi.transition=d}}return!1}function b5(l,d,g){d=Mc(g,d),d=BM(l,d,1),l=xa(l,d,1),d=ir(),l!==null&&(Md(l,1,d),kr(l,d))}function It(l,d,g){if(l.tag===3)b5(l,l,g);else for(;d!==null;){if(d.tag===3){b5(d,l,g);break}else if(d.tag===1){var x=d.stateNode;if(typeof d.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(Ea===null||!Ea.has(x))){l=Mc(g,l),l=UM(d,l,1),d=xa(d,l,1),l=ir(),d!==null&&(Md(d,1,l),kr(d,l));break}}d=d.return}}function hG(l,d,g){var x=l.pingCache;x!==null&&x.delete(d),d=ir(),l.pingedLanes|=l.suspendedLanes&g,fn===l&&(An&g)===g&&(tn===4||tn===3&&(An&130023424)===An&&500>Ht()-zw?Bu(l,0):Lw|=g),kr(l,d)}function S5(l,d){d===0&&((l.mode&1)===0?d=1:(d=t0,t0<<=1,(t0&130023424)===0&&(t0=4194304)));var g=ir();l=vs(l,d),l!==null&&(Md(l,d,g),kr(l,g))}function pG(l){var d=l.memoizedState,g=0;d!==null&&(g=d.retryLane),S5(l,g)}function gG(l,d){var g=0;switch(l.tag){case 13:var x=l.stateNode,b=l.memoizedState;b!==null&&(g=b.retryLane);break;case 19:x=l.stateNode;break;default:throw Error(n(314))}x!==null&&x.delete(d),S5(l,g)}var _5;_5=function(l,d,g){if(l!==null)if(l.memoizedProps!==d.pendingProps||Sr.current)Ar=!0;else{if((l.lanes&g)===0&&(d.flags&128)===0)return Ar=!1,nG(l,d,g);Ar=(l.flags&131072)!==0}else Ar=!1,Ft&&(d.flags&1048576)!==0&&rM(d,S0,d.index);switch(d.lanes=0,d.tag){case 2:var x=d.type;z0(l,d),l=d.pendingProps;var b=Sc(d,Ln.current);Fc(d,g),b=gw(null,d,x,l,b,g);var _=mw();return d.flags|=1,typeof b=="object"&&b!==null&&typeof b.render=="function"&&b.$$typeof===void 0?(d.tag=1,d.memoizedState=null,d.updateQueue=null,_r(x)?(_=!0,w0(d)):_=!1,d.memoizedState=b.state!==null&&b.state!==void 0?b.state:null,uw(d),b.updater=P0,d.stateNode=b,b._reactInternals=d,bw(d,x,l,g),d=Cw(null,d,x,!0,_,g)):(d.tag=0,Ft&&_&&J2(d),rr(null,d,b,g),d=d.child),d;case 16:x=d.elementType;e:{switch(z0(l,d),l=d.pendingProps,b=x._init,x=b(x._payload),d.type=x,b=d.tag=yG(x),l=Bi(x,l),b){case 0:d=Aw(null,d,x,l,g);break e;case 1:d=QM(null,d,x,l,g);break e;case 11:d=HM(null,d,x,l,g);break e;case 14:d=GM(null,d,x,Bi(x.type,l),g);break e}throw Error(n(306,x,""))}return d;case 0:return x=d.type,b=d.pendingProps,b=d.elementType===x?b:Bi(x,b),Aw(l,d,x,b,g);case 1:return x=d.type,b=d.pendingProps,b=d.elementType===x?b:Bi(x,b),QM(l,d,x,b,g);case 3:e:{if(KM(d),l===null)throw Error(n(387));x=d.pendingProps,_=d.memoizedState,b=_.element,dM(l,d),F0(d,x,null,g);var F=d.memoizedState;if(x=F.element,_.isDehydrated)if(_={element:x,isDehydrated:!1,cache:F.cache,pendingSuspenseBoundaries:F.pendingSuspenseBoundaries,transitions:F.transitions},d.updateQueue.baseState=_,d.memoizedState=_,d.flags&256){b=Mc(Error(n(423)),d),d=JM(l,d,x,g,b);break e}else if(x!==b){b=Mc(Error(n(424)),d),d=JM(l,d,x,g,b);break e}else for(Yr=pa(d.stateNode.containerInfo.firstChild),Vr=d,Ft=!0,Ii=null,g=cM(d,null,x,g),d.child=g;g;)g.flags=g.flags&-3|4096,g=g.sibling;else{if(Cc(),x===b){d=ws(l,d,g);break e}rr(l,d,x,g)}d=d.child}return d;case 5:return gM(d),l===null&&tw(d),x=d.type,b=d.pendingProps,_=l!==null?l.memoizedProps:null,F=b.children,G2(x,b)?F=null:_!==null&&G2(x,_)&&(d.flags|=32),XM(l,d),rr(l,d,F,g),d.child;case 6:return l===null&&tw(d),null;case 13:return ZM(l,d,g);case 4:return lw(d,d.stateNode.containerInfo),x=d.pendingProps,l===null?d.child=kc(d,null,x,g):rr(l,d,x,g),d.child;case 11:return x=d.type,b=d.pendingProps,b=d.elementType===x?b:Bi(x,b),HM(l,d,x,b,g);case 7:return rr(l,d,d.pendingProps,g),d.child;case 8:return rr(l,d,d.pendingProps.children,g),d.child;case 12:return rr(l,d,d.pendingProps.children,g),d.child;case 10:e:{if(x=d.type._context,b=d.pendingProps,_=d.memoizedProps,F=b.value,bt(C0,x._currentValue),x._currentValue=F,_!==null)if(zi(_.value,F)){if(_.children===b.children&&!Sr.current){d=ws(l,d,g);break e}}else for(_=d.child,_!==null&&(_.return=d);_!==null;){var R=_.dependencies;if(R!==null){F=_.child;for(var z=R.firstContext;z!==null;){if(z.context===x){if(_.tag===1){z=xs(-1,g&-g),z.tag=2;var Q=_.updateQueue;if(Q!==null){Q=Q.shared;var ie=Q.pending;ie===null?z.next=z:(z.next=ie.next,ie.next=z),Q.pending=z}}_.lanes|=g,z=_.alternate,z!==null&&(z.lanes|=g),sw(_.return,g,d),R.lanes|=g;break}z=z.next}}else if(_.tag===10)F=_.type===d.type?null:_.child;else if(_.tag===18){if(F=_.return,F===null)throw Error(n(341));F.lanes|=g,R=F.alternate,R!==null&&(R.lanes|=g),sw(F,g,d),F=_.sibling}else F=_.child;if(F!==null)F.return=_;else for(F=_;F!==null;){if(F===d){F=null;break}if(_=F.sibling,_!==null){_.return=F.return,F=_;break}F=F.return}_=F}rr(l,d,b.children,g),d=d.child}return d;case 9:return b=d.type,x=d.pendingProps.children,Fc(d,g),b=di(b),x=x(b),d.flags|=1,rr(l,d,x,g),d.child;case 14:return x=d.type,b=Bi(x,d.pendingProps),b=Bi(x.type,b),GM(l,d,x,b,g);case 15:return VM(l,d,d.type,d.pendingProps,g);case 17:return x=d.type,b=d.pendingProps,b=d.elementType===x?b:Bi(x,b),z0(l,d),d.tag=1,_r(x)?(l=!0,w0(d)):l=!1,Fc(d,g),zM(d,x,b),bw(d,x,b,g),Cw(null,d,x,!0,l,g);case 19:return t5(l,d,g);case 22:return YM(l,d,g)}throw Error(n(156,d.tag))};function A5(l,d){return iD(l,d)}function mG(l,d,g,x){this.tag=l,this.key=g,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=d,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function gi(l,d,g,x){return new mG(l,d,g,x)}function Gw(l){return l=l.prototype,!(!l||!l.isReactComponent)}function yG(l){if(typeof l=="function")return Gw(l)?1:0;if(l!=null){if(l=l.$$typeof,l===X)return 11;if(l===N)return 14}return 2}function Aa(l,d){var g=l.alternate;return g===null?(g=gi(l.tag,d,l.key,l.mode),g.elementType=l.elementType,g.type=l.type,g.stateNode=l.stateNode,g.alternate=l,l.alternate=g):(g.pendingProps=d,g.type=l.type,g.flags=0,g.subtreeFlags=0,g.deletions=null),g.flags=l.flags&14680064,g.childLanes=l.childLanes,g.lanes=l.lanes,g.child=l.child,g.memoizedProps=l.memoizedProps,g.memoizedState=l.memoizedState,g.updateQueue=l.updateQueue,d=l.dependencies,g.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext},g.sibling=l.sibling,g.index=l.index,g.ref=l.ref,g}function X0(l,d,g,x,b,_){var F=2;if(x=l,typeof l=="function")Gw(l)&&(F=1);else if(typeof l=="string")F=5;else e:switch(l){case $:return ju(g.children,b,_,d);case M:F=8,b|=8;break;case T:return l=gi(12,g,d,b|2),l.elementType=T,l.lanes=_,l;case W:return l=gi(13,g,d,b),l.elementType=W,l.lanes=_,l;case I:return l=gi(19,g,d,b),l.elementType=I,l.lanes=_,l;case Y:return Q0(g,b,_,d);default:if(typeof l=="object"&&l!==null)switch(l.$$typeof){case L:F=10;break e;case O:F=9;break e;case X:F=11;break e;case N:F=14;break e;case U:F=16,x=null;break e}throw Error(n(130,l==null?l:typeof l,""))}return d=gi(F,g,d,b),d.elementType=l,d.type=x,d.lanes=_,d}function ju(l,d,g,x){return l=gi(7,l,x,d),l.lanes=g,l}function Q0(l,d,g,x){return l=gi(22,l,x,d),l.elementType=Y,l.lanes=g,l.stateNode={isHidden:!1},l}function Vw(l,d,g){return l=gi(6,l,null,d),l.lanes=g,l}function Yw(l,d,g){return d=gi(4,l.children!==null?l.children:[],l.key,d),d.lanes=g,d.stateNode={containerInfo:l.containerInfo,pendingChildren:null,implementation:l.implementation},d}function vG(l,d,g,x,b){this.tag=d,this.containerInfo=l,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=E2(0),this.expirationTimes=E2(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=E2(0),this.identifierPrefix=x,this.onRecoverableError=b,this.mutableSourceEagerHydrationData=null}function Xw(l,d,g,x,b,_,F,R,z){return l=new vG(l,d,g,R,z),d===1?(d=1,_===!0&&(d|=8)):d=0,_=gi(3,null,null,d),l.current=_,_.stateNode=l,_.memoizedState={element:x,isDehydrated:g,cache:null,transitions:null,pendingSuspenseBoundaries:null},uw(_),l}function xG(l,d,g){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:D,key:x==null?null:""+x,children:l,containerInfo:d,implementation:g}}function C5(l){if(!l)return ma;l=l._reactInternals;e:{if(Du(l)!==l||l.tag!==1)throw Error(n(170));var d=l;do{switch(d.tag){case 3:d=d.stateNode.context;break e;case 1:if(_r(d.type)){d=d.stateNode.__reactInternalMemoizedMergedChildContext;break e}}d=d.return}while(d!==null);throw Error(n(171))}if(l.tag===1){var g=l.type;if(_r(g))return eM(l,g,d)}return d}function k5(l,d,g,x,b,_,F,R,z){return l=Xw(g,x,!0,l,b,_,F,R,z),l.context=C5(null),g=l.current,x=ir(),b=Sa(g),_=xs(x,b),_.callback=d??null,xa(g,_,b),l.current.lanes=b,Md(l,b,x),kr(l,x),l}function K0(l,d,g,x){var b=d.current,_=ir(),F=Sa(b);return g=C5(g),d.context===null?d.context=g:d.pendingContext=g,d=xs(_,F),d.payload={element:l},x=x===void 0?null:x,x!==null&&(d.callback=x),l=xa(b,d,F),l!==null&&(Wi(l,b,F,_),$0(l,b,F)),F}function J0(l){if(l=l.current,!l.child)return null;switch(l.child.tag){case 5:return l.child.stateNode;default:return l.child.stateNode}}function $5(l,d){if(l=l.memoizedState,l!==null&&l.dehydrated!==null){var g=l.retryLane;l.retryLane=g!==0&&g<d?g:d}}function Qw(l,d){$5(l,d),(l=l.alternate)&&$5(l,d)}function wG(){return null}var F5=typeof reportError=="function"?reportError:function(l){console.error(l)};function Kw(l){this._internalRoot=l}Z0.prototype.render=Kw.prototype.render=function(l){var d=this._internalRoot;if(d===null)throw Error(n(409));K0(l,d,null,null)},Z0.prototype.unmount=Kw.prototype.unmount=function(){var l=this._internalRoot;if(l!==null){this._internalRoot=null;var d=l.containerInfo;Iu(function(){K0(null,l,null,null)}),d[ps]=null}};function Z0(l){this._internalRoot=l}Z0.prototype.unstable_scheduleHydration=function(l){if(l){var d=dD();l={blockedOn:null,target:l,priority:d};for(var g=0;g<fa.length&&d!==0&&d<fa[g].priority;g++);fa.splice(g,0,l),g===0&&gD(l)}};function Jw(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11)}function em(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11&&(l.nodeType!==8||l.nodeValue!==" react-mount-point-unstable "))}function D5(){}function EG(l,d,g,x,b){if(b){if(typeof x=="function"){var _=x;x=function(){var Q=J0(F);_.call(Q)}}var F=k5(d,x,l,0,null,!1,!1,"",D5);return l._reactRootContainer=F,l[ps]=F.current,Hd(l.nodeType===8?l.parentNode:l),Iu(),F}for(;b=l.lastChild;)l.removeChild(b);if(typeof x=="function"){var R=x;x=function(){var Q=J0(z);R.call(Q)}}var z=Xw(l,0,!1,null,null,!1,!1,"",D5);return l._reactRootContainer=z,l[ps]=z.current,Hd(l.nodeType===8?l.parentNode:l),Iu(function(){K0(d,z,g,x)}),z}function tm(l,d,g,x,b){var _=g._reactRootContainer;if(_){var F=_;if(typeof b=="function"){var R=b;b=function(){var z=J0(F);R.call(z)}}K0(d,F,l,b)}else F=EG(g,d,l,b,x);return J0(F)}cD=function(l){switch(l.tag){case 3:var d=l.stateNode;if(d.current.memoizedState.isDehydrated){var g=Dd(d.pendingLanes);g!==0&&(b2(d,g|1),kr(d,Ht()),(rt&6)===0&&(Rc=Ht()+500,ya()))}break;case 13:Iu(function(){var x=vs(l,1);if(x!==null){var b=ir();Wi(x,l,1,b)}}),Qw(l,1)}},S2=function(l){if(l.tag===13){var d=vs(l,134217728);if(d!==null){var g=ir();Wi(d,l,134217728,g)}Qw(l,134217728)}},fD=function(l){if(l.tag===13){var d=Sa(l),g=vs(l,d);if(g!==null){var x=ir();Wi(g,l,d,x)}Qw(l,d)}},dD=function(){return dt},hD=function(l,d){var g=dt;try{return dt=l,d()}finally{dt=g}},g2=function(l,d,g){switch(d){case"input":if(br(l,g),d=g.name,g.type==="radio"&&d!=null){for(g=l;g.parentNode;)g=g.parentNode;for(g=g.querySelectorAll("input[name="+JSON.stringify(""+d)+'][type="radio"]'),d=0;d<g.length;d++){var x=g[d];if(x!==l&&x.form===l.form){var b=v0(x);if(!b)throw Error(n(90));le(x),br(x,b)}}}break;case"textarea":j3(l,g);break;case"select":d=g.value,d!=null&&fc(l,!!g.multiple,d,!1)}},K3=Ww,J3=Iu;var bG={usingClientEntryPoint:!1,Events:[Yd,Ec,v0,X3,Q3,Ww]},uh={findFiberByHostInstance:Mu,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},SG={bundleType:uh.bundleType,version:uh.version,rendererPackageName:uh.rendererPackageName,rendererConfig:uh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:C.ReactCurrentDispatcher,findHostInstanceByFiber:function(l){return l=nD(l),l===null?null:l.stateNode},findFiberByHostInstance:uh.findFiberByHostInstance||wG,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var nm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nm.isDisabled&&nm.supportsFiber)try{Zg=nm.inject(SG),bo=nm}catch{}}return $r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=bG,$r.createPortal=function(l,d){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Jw(d))throw Error(n(200));return xG(l,d,null,g)},$r.createRoot=function(l,d){if(!Jw(l))throw Error(n(299));var g=!1,x="",b=F5;return d!=null&&(d.unstable_strictMode===!0&&(g=!0),d.identifierPrefix!==void 0&&(x=d.identifierPrefix),d.onRecoverableError!==void 0&&(b=d.onRecoverableError)),d=Xw(l,1,!1,null,null,g,!1,x,b),l[ps]=d.current,Hd(l.nodeType===8?l.parentNode:l),new Kw(d)},$r.findDOMNode=function(l){if(l==null)return null;if(l.nodeType===1)return l;var d=l._reactInternals;if(d===void 0)throw typeof l.render=="function"?Error(n(188)):(l=Object.keys(l).join(","),Error(n(268,l)));return l=nD(d),l=l===null?null:l.stateNode,l},$r.flushSync=function(l){return Iu(l)},$r.hydrate=function(l,d,g){if(!em(d))throw Error(n(200));return tm(null,l,d,!0,g)},$r.hydrateRoot=function(l,d,g){if(!Jw(l))throw Error(n(405));var x=g!=null&&g.hydratedSources||null,b=!1,_="",F=F5;if(g!=null&&(g.unstable_strictMode===!0&&(b=!0),g.identifierPrefix!==void 0&&(_=g.identifierPrefix),g.onRecoverableError!==void 0&&(F=g.onRecoverableError)),d=k5(d,null,l,1,g??null,b,!1,_,F),l[ps]=d.current,Hd(l),x)for(l=0;l<x.length;l++)g=x[l],b=g._getVersion,b=b(g._source),d.mutableSourceEagerHydrationData==null?d.mutableSourceEagerHydrationData=[g,b]:d.mutableSourceEagerHydrationData.push(g,b);return new Z0(d)},$r.render=function(l,d,g){if(!em(d))throw Error(n(200));return tm(null,l,d,!1,g)},$r.unmountComponentAtNode=function(l){if(!em(l))throw Error(n(40));return l._reactRootContainer?(Iu(function(){tm(null,null,l,!1,function(){l._reactRootContainer=null,l[ps]=null})}),!0):!1},$r.unstable_batchedUpdates=Ww,$r.unstable_renderSubtreeIntoContainer=function(l,d,g,x){if(!em(g))throw Error(n(200));if(l==null||l._reactInternals===void 0)throw Error(n(38));return tm(l,d,g,!1,x)},$r.version="18.3.1-next-f1338f8080-20240426",$r}var z5;function MG(){if(z5)return tE.exports;z5=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),tE.exports=DG(),tE.exports}var I5;function TG(){if(I5)return rm;I5=1;var e=MG();return rm.createRoot=e.createRoot,rm.hydrateRoot=e.hydrateRoot,rm}var NG=TG();const RG=/("(?:[^\\"]|\\.)*")|[:,]/g;function iE(e,t={}){const n=JSON.stringify([1],void 0,t.indent===void 0?2:t.indent).slice(2,-3),r=n===""?1/0:t.maxLength===void 0?80:t.maxLength;let{replacer:i}=t;return(function o(s,a,u){s&&typeof s.toJSON=="function"&&(s=s.toJSON());const c=JSON.stringify(s,i);if(c===void 0)return c;const f=r-a.length-u;if(c.length<=f){const h=c.replace(RG,(p,m)=>m||`${p} `);if(h.length<=f)return h}if(i!=null&&(s=JSON.parse(c),i=void 0),typeof s=="object"&&s!==null){const h=a+n,p=[];let m=0,y,v;if(Array.isArray(s)){y="[",v="]";const{length:w}=s;for(;m<w;m++)p.push(o(s[m],h,m===w-1?0:1)||"null")}else{y="{",v="}";const w=Object.keys(s),{length:E}=w;for(;m<E;m++){const S=w[m],A=`${JSON.stringify(S)}: `,C=o(s[S],h,A.length+(m===E-1?0:1));C!==void 0&&p.push(A+C)}}if(p.length>0)return[y,n+p.join(`,
${h}`),v].join(`
${a}`)}return c})(e,"",0)}function qr(e,t,n){return e.fields=t||[],e.fname=n,e}function Wt(e){return e==null?null:e.fname}function Xn(e){return e==null?null:e.fields}function D4(e){return e.length===1?OG(e[0]):PG(e)}const OG=e=>function(t){return t[e]},PG=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function te(e){throw Error(e)}function es(e){const t=[],n=e.length;let r=null,i=0,o="",s,a,u;e=e+"";function c(){t.push(o+e.substring(s,a)),o="",s=a+1}for(s=a=0;a<n;++a)if(u=e[a],u==="\\")o+=e.substring(s,a++),s=a;else if(u===r)c(),r=null,i=-1;else{if(r)continue;s===i&&u==='"'||s===i&&u==="'"?(s=a+1,r=u):u==="."&&!i?a>s?c():s=a+1:u==="["?(a>s&&c(),i=s=a+1):u==="]"&&(i||te("Access path missing open bracket: "+e),i>0&&c(),i=0,s=a+1)}return i&&te("Access path missing closing bracket: "+e),r&&te("Access path missing closing quote: "+e),a>s&&(a++,c()),t}function ki(e,t,n){const r=es(e);return e=r.length===1?r[0]:e,qr((n&&n.get||D4)(r),[e],t||e)}const eg=ki("id"),tr=qr(e=>e,[],"identity"),Pa=qr(()=>0,[],"zero"),Kf=qr(()=>1,[],"one"),$i=qr(()=>!0,[],"true"),$a=qr(()=>!1,[],"false"),gA=new Set(Object.getOwnPropertyNames(Object.prototype));function LG(e,t,n){const r=[t].concat([].slice.call(n));console[e].apply(console,r)}const M4=0,mA=1,yA=2,T4=3,N4=4;function vA(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:LG,r=e||M4;return{level(i){return arguments.length?(r=+i,this):r},error(){return r>=mA&&n(t||"error","ERROR",arguments),this},warn(){return r>=yA&&n(t||"warn","WARN",arguments),this},info(){return r>=T4&&n(t||"log","INFO",arguments),this},debug(){return r>=N4&&n(t||"log","DEBUG",arguments),this}}}var ne=Array.isArray;function ye(e){return e===Object(e)}const B5=e=>e!=="__proto__";function Jf(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((r,i)=>{for(const o in i)if(o==="signals")r.signals=zG(r.signals,i.signals);else{const s=o==="legend"?{layout:1}:o==="style"?!0:null;Zf(r,o,i[o],s)}return r},{})}function Zf(e,t,n,r){if(!B5(t))return;let i,o;if(ye(n)&&!ne(n)){o=ye(e[t])?e[t]:e[t]={};for(i in n)r&&(r===!0||r[i])?Zf(o,i,n[i]):B5(i)&&(o[i]=n[i])}else e[t]=n}function zG(e,t){if(e==null)return t;const n={},r=[];function i(o){n[o.name]||(n[o.name]=1,r.push(o))}return t.forEach(i),e.forEach(i),r}function Ze(e){return e[e.length-1]}function Vn(e){return e==null||e===""?null:+e}const R4=e=>t=>e*Math.exp(t),O4=e=>t=>Math.log(e*t),P4=e=>t=>Math.sign(t)*Math.log1p(Math.abs(t/e)),L4=e=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*e,v1=e=>t=>t<0?-Math.pow(-t,e):Math.pow(t,e);function Jy(e,t,n,r){const i=n(e[0]),o=n(Ze(e)),s=(o-i)*t;return[r(i-s),r(o-s)]}function z4(e,t){return Jy(e,t,Vn,tr)}function I4(e,t){var n=Math.sign(e[0]);return Jy(e,t,O4(n),R4(n))}function B4(e,t,n){return Jy(e,t,v1(n),v1(1/n))}function U4(e,t,n){return Jy(e,t,P4(n),L4(n))}function Zy(e,t,n,r,i){const o=r(e[0]),s=r(Ze(e)),a=t!=null?r(t):(o+s)/2;return[i(a+(o-a)*n),i(a+(s-a)*n)]}function xA(e,t,n){return Zy(e,t,n,Vn,tr)}function wA(e,t,n){const r=Math.sign(e[0]);return Zy(e,t,n,O4(r),R4(r))}function x1(e,t,n,r){return Zy(e,t,n,v1(r),v1(1/r))}function EA(e,t,n,r){return Zy(e,t,n,P4(r),L4(r))}function j4(e){return 1+~~(new Date(e).getMonth()/3)}function W4(e){return 1+~~(new Date(e).getUTCMonth()/3)}function xe(e){return e!=null?ne(e)?e:[e]:[]}function q4(e,t,n){let r=e[0],i=e[1],o;return i<r&&(o=i,i=r,r=o),o=i-r,o>=n-t?[t,n]:[r=Math.min(Math.max(r,t),n-o),r+o]}function He(e){return typeof e=="function"}const IG="descending";function bA(e,t,n){n=n||{},t=xe(t)||[];const r=[],i=[],o={},s=n.comparator||BG;return xe(e).forEach((a,u)=>{a!=null&&(r.push(t[u]===IG?-1:1),i.push(a=He(a)?a:ki(a,null,n)),(Xn(a)||[]).forEach(c=>o[c]=1))}),i.length===0?null:qr(s(i,r),Object.keys(o))}const ed=(e,t)=>(e<t||e==null)&&t!=null?-1:(e>t||t==null)&&e!=null?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t===t?-1:t!==t&&e===e?1:0),BG=(e,t)=>e.length===1?UG(e[0],t[0]):jG(e,t,e.length),UG=(e,t)=>function(n,r){return ed(e(n),e(r))*t},jG=(e,t,n)=>(t.push(0),function(r,i){let o,s=0,a=-1;for(;s===0&&++a<n;)o=e[a],s=ed(o(r),o(i));return s*t[a]});function nr(e){return He(e)?e:()=>e}function SA(e,t){let n;return r=>{n&&clearTimeout(n),n=setTimeout(()=>(t(r),n=null),e)}}function qe(e){for(let t,n,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t)e[n]=t[n]}return e}function Ho(e,t){let n=0,r,i,o,s;if(e&&(r=e.length))if(t==null){for(i=e[n];n<r&&(i==null||i!==i);i=e[++n]);for(o=s=i;n<r;++n)i=e[n],i!=null&&(i<o&&(o=i),i>s&&(s=i))}else{for(i=t(e[n]);n<r&&(i==null||i!==i);i=t(e[++n]));for(o=s=i;n<r;++n)i=t(e[n]),i!=null&&(i<o&&(o=i),i>s&&(s=i))}return[o,s]}function H4(e,t){const n=e.length;let r=-1,i,o,s,a,u;if(t==null){for(;++r<n;)if(o=e[r],o!=null&&o>=o){i=s=o;break}if(r===n)return[-1,-1];for(a=u=r;++r<n;)o=e[r],o!=null&&(i>o&&(i=o,a=r),s<o&&(s=o,u=r))}else{for(;++r<n;)if(o=t(e[r],r,e),o!=null&&o>=o){i=s=o;break}if(r===n)return[-1,-1];for(a=u=r;++r<n;)o=t(e[r],r,e),o!=null&&(i>o&&(i=o,a=r),s<o&&(s=o,u=r))}return[a,u]}function Ee(e,t){return Object.hasOwn(e,t)}const im={};function td(e){let t={},n;function r(o){return Ee(t,o)&&t[o]!==im}const i={size:0,empty:0,object:t,has:r,get(o){return r(o)?t[o]:void 0},set(o,s){return r(o)||(++i.size,t[o]===im&&--i.empty),t[o]=s,this},delete(o){return r(o)&&(--i.size,++i.empty,t[o]=im),this},clear(){i.size=i.empty=0,i.object=t={}},test(o){return arguments.length?(n=o,i):n},clean(){const o={};let s=0;for(const a in t){const u=t[a];u!==im&&(!n||!n(u))&&(o[a]=u,++s)}i.size=s,i.empty=0,i.object=t=o}};return e&&Object.keys(e).forEach(o=>{i.set(o,e[o])}),i}function G4(e,t,n,r,i,o){if(!n&&n!==0)return o;const s=+n;let a=e[0],u=Ze(e),c;u<a&&(c=a,a=u,u=c),c=Math.abs(t-a);const f=Math.abs(u-t);return c<f&&c<=s?r:f<=s?i:o}function pe(e,t,n){const r=e.prototype=Object.create(t.prototype);return Object.defineProperty(r,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),qe(r,n)}function Jc(e,t,n,r){let i=t[0],o=t[t.length-1],s;return i>o&&(s=i,i=o,o=s),n=n===void 0||n,r=r===void 0||r,(n?i<=e:i<e)&&(r?e<=o:e<o)}function hu(e){return typeof e=="boolean"}function Ga(e){return Object.prototype.toString.call(e)==="[object Date]"}function V4(e){return e&&He(e[Symbol.iterator])}function at(e){return typeof e=="number"}function _A(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function ve(e){return typeof e=="string"}function AA(e,t,n){e&&(e=t?xe(e).map(a=>a.replace(/\\(.)/g,"$1")):xe(e));const r=e&&e.length,i=n&&n.get||D4,o=a=>i(t?[a]:es(a));let s;if(!r)s=function(){return""};else if(r===1){const a=o(e[0]);s=function(u){return""+a(u)}}else{const a=e.map(o);s=function(u){let c=""+a[0](u),f=0;for(;++f<r;)c+="|"+a[f](u);return c}}return qr(s,e,"key")}function Y4(e,t){const n=e[0],r=Ze(e),i=+t;return i?i===1?r:n+i*(r-n):n}const WG=1e4;function X4(e){e=+e||WG;let t,n,r;const i=()=>{t={},n={},r=0},o=(s,a)=>(++r>e&&(n=t,t={},r=1),t[s]=a);return i(),{clear:i,has:s=>Ee(t,s)||Ee(n,s),get:s=>Ee(t,s)?t[s]:Ee(n,s)?o(s,n[s]):void 0,set:(s,a)=>Ee(t,s)?t[s]=a:o(s,a)}}function Q4(e,t,n,r){const i=t.length,o=n.length;if(!o)return t;if(!i)return n;const s=r||new t.constructor(i+o);let a=0,u=0,c=0;for(;a<i&&u<o;++c)s[c]=e(t[a],n[u])>0?n[u++]:t[a++];for(;a<i;++a,++c)s[c]=t[a];for(;u<o;++u,++c)s[c]=n[u];return s}function Oh(e,t){let n="";for(;--t>=0;)n+=e;return n}function K4(e,t,n,r){const i=n||" ",o=e+"",s=t-o.length;return s<=0?o:r==="left"?Oh(i,s)+o:r==="center"?Oh(i,~~(s/2))+o+Oh(i,Math.ceil(s/2)):o+Oh(i,s)}function tg(e){return e&&Ze(e)-e[0]||0}function de(e){return ne(e)?"["+e.map(de)+"]":ye(e)||ve(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function CA(e){return e==null||e===""?null:!e||e==="false"||e==="0"?!1:!!e}const qG=e=>at(e)||Ga(e)?e:Date.parse(e);function kA(e,t){return t=t||qG,e==null||e===""?null:t(e)}function $A(e){return e==null||e===""?null:e+""}function oo(e){const t={},n=e.length;for(let r=0;r<n;++r)t[e[r]]=!0;return t}function J4(e,t,n,r){const i=r??"…",o=e+"",s=o.length,a=Math.max(0,t-i.length);return s<=t?o:n==="left"?i+o.slice(s-a):n==="center"?o.slice(0,Math.ceil(a/2))+i+o.slice(s-~~(a/2)):o.slice(0,a)+i}function Ma(e,t,n){if(e)if(t){const r=e.length;for(let i=0;i<r;++i){const o=t(e[i]);o&&n(o,i,e)}}else e.forEach(n)}var U5={},oE={},sE=34,ch=10,aE=13;function Z4(e){return new Function("d","return {"+e.map(function(t,n){return JSON.stringify(t)+": d["+n+'] || ""'}).join(",")+"}")}function HG(e,t){var n=Z4(e);return function(r,i){return t(n(r),i,e)}}function j5(e){var t=Object.create(null),n=[];return e.forEach(function(r){for(var i in r)i in t||n.push(t[i]=i)}),n}function Fr(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function GG(e){return e<0?"-"+Fr(-e,6):e>9999?"+"+Fr(e,6):Fr(e,4)}function VG(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),r=e.getUTCSeconds(),i=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":GG(e.getUTCFullYear())+"-"+Fr(e.getUTCMonth()+1,2)+"-"+Fr(e.getUTCDate(),2)+(i?"T"+Fr(t,2)+":"+Fr(n,2)+":"+Fr(r,2)+"."+Fr(i,3)+"Z":r?"T"+Fr(t,2)+":"+Fr(n,2)+":"+Fr(r,2)+"Z":n||t?"T"+Fr(t,2)+":"+Fr(n,2)+"Z":"")}function YG(e){var t=new RegExp('["'+e+`
\r]`),n=e.charCodeAt(0);function r(h,p){var m,y,v=i(h,function(w,E){if(m)return m(w,E-1);y=w,m=p?HG(w,p):Z4(w)});return v.columns=y||[],v}function i(h,p){var m=[],y=h.length,v=0,w=0,E,S=y<=0,A=!1;h.charCodeAt(y-1)===ch&&--y,h.charCodeAt(y-1)===aE&&--y;function C(){if(S)return oE;if(A)return A=!1,U5;var D,$=v,M;if(h.charCodeAt($)===sE){for(;v++<y&&h.charCodeAt(v)!==sE||h.charCodeAt(++v)===sE;);return(D=v)>=y?S=!0:(M=h.charCodeAt(v++))===ch?A=!0:M===aE&&(A=!0,h.charCodeAt(v)===ch&&++v),h.slice($+1,D-1).replace(/""/g,'"')}for(;v<y;){if((M=h.charCodeAt(D=v++))===ch)A=!0;else if(M===aE)A=!0,h.charCodeAt(v)===ch&&++v;else if(M!==n)continue;return h.slice($,D)}return S=!0,h.slice($,y)}for(;(E=C())!==oE;){for(var k=[];E!==U5&&E!==oE;)k.push(E),E=C();p&&(k=p(k,w++))==null||m.push(k)}return m}function o(h,p){return h.map(function(m){return p.map(function(y){return f(m[y])}).join(e)})}function s(h,p){return p==null&&(p=j5(h)),[p.map(f).join(e)].concat(o(h,p)).join(`
`)}function a(h,p){return p==null&&(p=j5(h)),o(h,p).join(`
`)}function u(h){return h.map(c).join(`
`)}function c(h){return h.map(f).join(e)}function f(h){return h==null?"":h instanceof Date?VG(h):t.test(h+="")?'"'+h.replace(/"/g,'""')+'"':h}return{parse:r,parseRows:i,format:s,formatBody:a,formatRows:u,formatRow:c,formatValue:f}}function XG(e){return e}function QG(e){if(e==null)return XG;var t,n,r=e.scale[0],i=e.scale[1],o=e.translate[0],s=e.translate[1];return function(a,u){u||(t=n=0);var c=2,f=a.length,h=new Array(f);for(h[0]=(t+=a[0])*r+o,h[1]=(n+=a[1])*i+s;c<f;)h[c]=a[c],++c;return h}}function KG(e,t){for(var n,r=e.length,i=r-t;i<--r;)n=e[i],e[i++]=e[r],e[r]=n}function JG(e,t){return typeof t=="string"&&(t=e.objects[t]),t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(n){return W5(e,n)})}:W5(e,t)}function W5(e,t){var n=t.id,r=t.bbox,i=t.properties==null?{}:t.properties,o=e8(e,t);return n==null&&r==null?{type:"Feature",properties:i,geometry:o}:r==null?{type:"Feature",id:n,properties:i,geometry:o}:{type:"Feature",id:n,bbox:r,properties:i,geometry:o}}function e8(e,t){var n=QG(e.transform),r=e.arcs;function i(f,h){h.length&&h.pop();for(var p=r[f<0?~f:f],m=0,y=p.length;m<y;++m)h.push(n(p[m],m));f<0&&KG(h,y)}function o(f){return n(f)}function s(f){for(var h=[],p=0,m=f.length;p<m;++p)i(f[p],h);return h.length<2&&h.push(h[0]),h}function a(f){for(var h=s(f);h.length<4;)h.push(h[0]);return h}function u(f){return f.map(a)}function c(f){var h=f.type,p;switch(h){case"GeometryCollection":return{type:h,geometries:f.geometries.map(c)};case"Point":p=o(f.coordinates);break;case"MultiPoint":p=f.coordinates.map(o);break;case"LineString":p=s(f.arcs);break;case"MultiLineString":p=f.arcs.map(s);break;case"Polygon":p=u(f.arcs);break;case"MultiPolygon":p=f.arcs.map(u);break;default:return null}return{type:h,coordinates:p}}return c(t)}function ZG(e,t){var n={},r={},i={},o=[],s=-1;t.forEach(function(c,f){var h=e.arcs[c<0?~c:c],p;h.length<3&&!h[1][0]&&!h[1][1]&&(p=t[++s],t[s]=c,t[f]=p)}),t.forEach(function(c){var f=a(c),h=f[0],p=f[1],m,y;if(m=i[h])if(delete i[m.end],m.push(c),m.end=p,y=r[p]){delete r[y.start];var v=y===m?m:m.concat(y);r[v.start=m.start]=i[v.end=y.end]=v}else r[m.start]=i[m.end]=m;else if(m=r[p])if(delete r[m.start],m.unshift(c),m.start=h,y=i[h]){delete i[y.end];var w=y===m?m:y.concat(m);r[w.start=y.start]=i[w.end=m.end]=w}else r[m.start]=i[m.end]=m;else m=[c],r[m.start=h]=i[m.end=p]=m});function a(c){var f=e.arcs[c<0?~c:c],h=f[0],p;return e.transform?(p=[0,0],f.forEach(function(m){p[0]+=m[0],p[1]+=m[1]})):p=f[f.length-1],c<0?[p,h]:[h,p]}function u(c,f){for(var h in c){var p=c[h];delete f[p.start],delete p.start,delete p.end,p.forEach(function(m){n[m<0?~m:m]=1}),o.push(p)}}return u(i,r),u(r,i),t.forEach(function(c){n[c<0?~c:c]||o.push([c])}),o}function eV(e){return e8(e,tV.apply(this,arguments))}function tV(e,t,n){var r,i,o;if(arguments.length>1)r=nV(e,t,n);else for(i=0,r=new Array(o=e.arcs.length);i<o;++i)r[i]=i;return{type:"MultiLineString",arcs:ZG(e,r)}}function nV(e,t,n){var r=[],i=[],o;function s(h){var p=h<0?~h:h;(i[p]||(i[p]=[])).push({i:h,g:o})}function a(h){h.forEach(s)}function u(h){h.forEach(a)}function c(h){h.forEach(u)}function f(h){switch(o=h,h.type){case"GeometryCollection":h.geometries.forEach(f);break;case"LineString":a(h.arcs);break;case"MultiLineString":case"Polygon":u(h.arcs);break;case"MultiPolygon":c(h.arcs);break}}return f(t),i.forEach(n==null?function(h){r.push(h[0].i)}:function(h){n(h[0].g,h[h.length-1].g)&&r.push(h[0].i)}),r}function Is(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function rV(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function nd(e){let t,n,r;e.length!==2?(t=Is,n=(a,u)=>Is(e(a),u),r=(a,u)=>e(a)-u):(t=e===Is||e===rV?e:iV,n=e,r=e);function i(a,u,c=0,f=a.length){if(c<f){if(t(u,u)!==0)return f;do{const h=c+f>>>1;n(a[h],u)<0?c=h+1:f=h}while(c<f)}return c}function o(a,u,c=0,f=a.length){if(c<f){if(t(u,u)!==0)return f;do{const h=c+f>>>1;n(a[h],u)<=0?c=h+1:f=h}while(c<f)}return c}function s(a,u,c=0,f=a.length){const h=i(a,u,c,f-1);return h>c&&r(a[h-1],u)>-r(a[h],u)?h-1:h}return{left:i,center:s,right:o}}function iV(){return 0}function t8(e){return e===null?NaN:+e}function*oV(e,t){if(t===void 0)for(let n of e)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)(r=t(r,++n,e))!=null&&(r=+r)>=r&&(yield r)}}const n8=nd(Is),Ja=n8.right,sV=n8.left;nd(t8).center;function aV(e,t){let n=0,r,i=0,o=0;if(t===void 0)for(let s of e)s!=null&&(s=+s)>=s&&(r=s-i,i+=r/++n,o+=r*(s-i));else{let s=-1;for(let a of e)(a=t(a,++s,e))!=null&&(a=+a)>=a&&(r=a-i,i+=r/++n,o+=r*(a-i))}if(n>1)return o/(n-1)}function uV(e,t){const n=aV(e,t);return n&&Math.sqrt(n)}class gr{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const o=n[i],s=t+o,a=Math.abs(t)<Math.abs(o)?t-(s-o):o-(s-t);a&&(n[r++]=a),t=s}return n[r]=t,this._n=r+1,this}valueOf(){const t=this._partials;let n=this._n,r,i,o,s=0;if(n>0){for(s=t[--n];n>0&&(r=s,i=t[--n],s=r+i,o=i-(s-r),!o););n>0&&(o<0&&t[n-1]<0||o>0&&t[n-1]>0)&&(i=o*2,r=s+i,i==r-s&&(s=r))}return s}}class q5 extends Map{constructor(t,n=o8){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[r,i]of t)this.set(r,i)}get(t){return super.get(Kb(this,t))}has(t){return super.has(Kb(this,t))}set(t,n){return super.set(r8(this,t),n)}delete(t){return super.delete(i8(this,t))}}class w1 extends Set{constructor(t,n=o8){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const r of t)this.add(r)}has(t){return super.has(Kb(this,t))}add(t){return super.add(r8(this,t))}delete(t){return super.delete(i8(this,t))}}function Kb({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):n}function r8({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}function i8({_intern:e,_key:t},n){const r=t(n);return e.has(r)&&(n=e.get(r),e.delete(r)),n}function o8(e){return e!==null&&typeof e=="object"?e.valueOf():e}function lV(e,t){return Array.from(t,n=>e[n])}function cV(e=Is){if(e===Is)return s8;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,n)=>{const r=e(t,n);return r||r===0?r:(e(n,n)===0)-(e(t,t)===0)}}function s8(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const fV=Math.sqrt(50),dV=Math.sqrt(10),hV=Math.sqrt(2);function E1(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),o=r/Math.pow(10,i),s=o>=fV?10:o>=dV?5:o>=hV?2:1;let a,u,c;return i<0?(c=Math.pow(10,-i)/s,a=Math.round(e*c),u=Math.round(t*c),a/c<e&&++a,u/c>t&&--u,c=-c):(c=Math.pow(10,i)*s,a=Math.round(e/c),u=Math.round(t/c),a*c<e&&++a,u*c>t&&--u),u<a&&.5<=n&&n<2?E1(e,t,n*2):[a,u,c]}function Jb(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const r=t<e,[i,o,s]=r?E1(t,e,n):E1(e,t,n);if(!(o>=i))return[];const a=o-i+1,u=new Array(a);if(r)if(s<0)for(let c=0;c<a;++c)u[c]=(o-c)/-s;else for(let c=0;c<a;++c)u[c]=(o-c)*s;else if(s<0)for(let c=0;c<a;++c)u[c]=(i+c)/-s;else for(let c=0;c<a;++c)u[c]=(i+c)*s;return u}function Zb(e,t,n){return t=+t,e=+e,n=+n,E1(e,t,n)[2]}function Za(e,t,n){t=+t,e=+e,n=+n;const r=t<e,i=r?Zb(t,e,n):Zb(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}function dl(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function eS(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n>i||n===void 0&&i>=i)&&(n=i)}return n}function a8(e,t,n=0,r=1/0,i){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(e.length-1,r)),!(n<=t&&t<=r))return e;for(i=i===void 0?s8:cV(i);r>n;){if(r-n>600){const u=r-n+1,c=t-n+1,f=Math.log(u),h=.5*Math.exp(2*f/3),p=.5*Math.sqrt(f*h*(u-h)/u)*(c-u/2<0?-1:1),m=Math.max(n,Math.floor(t-c*h/u+p)),y=Math.min(r,Math.floor(t+(u-c)*h/u+p));a8(e,t,m,y,i)}const o=e[t];let s=n,a=r;for(fh(e,n,t),i(e[r],o)>0&&fh(e,n,r);s<a;){for(fh(e,s,a),++s,--a;i(e[s],o)<0;)++s;for(;i(e[a],o)>0;)--a}i(e[n],o)===0?fh(e,n,a):(++a,fh(e,a,r)),a<=t&&(n=a+1),t<=a&&(r=a-1)}return e}function fh(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function tS(e,t,n){if(e=Float64Array.from(oV(e,n)),!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return eS(e);if(t>=1)return dl(e);var r,i=(r-1)*t,o=Math.floor(i),s=dl(a8(e,o).subarray(0,o+1)),a=eS(e.subarray(o+1));return s+(a-s)*(i-o)}}function u8(e,t,n=t8){if(!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,o=Math.floor(i),s=+n(e[o],o,e),a=+n(e[o+1],o+1,e);return s+(a-s)*(i-o)}}function pV(e,t){let n=0,r=0;if(t===void 0)for(let i of e)i!=null&&(i=+i)>=i&&(++n,r+=i);else{let i=-1;for(let o of e)(o=t(o,++i,e))!=null&&(o=+o)>=o&&(++n,r+=o)}if(n)return r/n}function l8(e,t){return tS(e,.5,t)}function*gV(e){for(const t of e)yield*t}function c8(e){return Array.from(gV(e))}function ei(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,o=new Array(i);++r<i;)o[r]=e+r*n;return o}function f8(e,t){let n=0;for(let r of e)(r=+r)&&(n+=r);return n}function mV(e,...t){e=new w1(e),t=t.map(yV);e:for(const n of e)for(const r of t)if(!r.has(n)){e.delete(n);continue e}return e}function yV(e){return e instanceof w1?e:new w1(e)}function vV(...e){const t=new w1;for(const n of e)for(const r of n)t.add(r);return t}function xV(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function b1(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function mf(e){return e=b1(Math.abs(e)),e?e[1]:NaN}function wV(e,t){return function(n,r){for(var i=n.length,o=[],s=0,a=e[0],u=0;i>0&&a>0&&(u+a+1>r&&(a=Math.max(1,r-u)),o.push(n.substring(i-=a,i+a)),!((u+=a+1)>r));)a=e[s=(s+1)%e.length];return o.reverse().join(t)}}function EV(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var bV=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function bl(e){if(!(t=bV.exec(e)))throw new Error("invalid format: "+e);var t;return new FA({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}bl.prototype=FA.prototype;function FA(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}FA.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function SV(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(i+1):e}var d8;function _V(e,t){var n=b1(e,t);if(!n)return e+"";var r=n[0],i=n[1],o=i-(d8=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,s=r.length;return o===s?r:o>s?r+new Array(o-s+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+b1(e,Math.max(0,t+o-1))[0]}function H5(e,t){var n=b1(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const G5={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:xV,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>H5(e*100,t),r:H5,s:_V,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function V5(e){return e}var Y5=Array.prototype.map,X5=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function h8(e){var t=e.grouping===void 0||e.thousands===void 0?V5:wV(Y5.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",o=e.numerals===void 0?V5:EV(Y5.call(e.numerals,String)),s=e.percent===void 0?"%":e.percent+"",a=e.minus===void 0?"−":e.minus+"",u=e.nan===void 0?"NaN":e.nan+"";function c(h){h=bl(h);var p=h.fill,m=h.align,y=h.sign,v=h.symbol,w=h.zero,E=h.width,S=h.comma,A=h.precision,C=h.trim,k=h.type;k==="n"?(S=!0,k="g"):G5[k]||(A===void 0&&(A=12),C=!0,k="g"),(w||p==="0"&&m==="=")&&(w=!0,p="0",m="=");var D=v==="$"?n:v==="#"&&/[boxX]/.test(k)?"0"+k.toLowerCase():"",$=v==="$"?r:/[%p]/.test(k)?s:"",M=G5[k],T=/[defgprs%]/.test(k);A=A===void 0?6:/[gprs]/.test(k)?Math.max(1,Math.min(21,A)):Math.max(0,Math.min(20,A));function L(O){var X=D,W=$,I,N,U;if(k==="c")W=M(O)+W,O="";else{O=+O;var Y=O<0||1/O<0;if(O=isNaN(O)?u:M(Math.abs(O),A),C&&(O=SV(O)),Y&&+O==0&&y!=="+"&&(Y=!1),X=(Y?y==="("?y:a:y==="-"||y==="("?"":y)+X,W=(k==="s"?X5[8+d8/3]:"")+W+(Y&&y==="("?")":""),T){for(I=-1,N=O.length;++I<N;)if(U=O.charCodeAt(I),48>U||U>57){W=(U===46?i+O.slice(I+1):O.slice(I))+W,O=O.slice(0,I);break}}}S&&!w&&(O=t(O,1/0));var j=X.length+O.length+W.length,q=j<E?new Array(E-j+1).join(p):"";switch(S&&w&&(O=t(q+O,q.length?E-W.length:1/0),q=""),m){case"<":O=X+O+W+q;break;case"=":O=X+q+O+W;break;case"^":O=q.slice(0,j=q.length>>1)+X+O+W+q.slice(j);break;default:O=q+X+O+W;break}return o(O)}return L.toString=function(){return h+""},L}function f(h,p){var m=c((h=bl(h),h.type="f",h)),y=Math.max(-8,Math.min(8,Math.floor(mf(p)/3)))*3,v=Math.pow(10,-y),w=X5[8+y/3];return function(E){return m(v*E)+w}}return{format:c,formatPrefix:f}}var om,ev,DA;AV({thousands:",",grouping:[3],currency:["$",""]});function AV(e){return om=h8(e),ev=om.format,DA=om.formatPrefix,om}function p8(e){return Math.max(0,-mf(Math.abs(e)))}function g8(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(mf(t)/3)))*3-mf(Math.abs(e)))}function m8(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,mf(t)-mf(e))+1}const uE=new Date,lE=new Date;function un(e,t,n,r){function i(o){return e(o=arguments.length===0?new Date:new Date(+o)),o}return i.floor=o=>(e(o=new Date(+o)),o),i.ceil=o=>(e(o=new Date(o-1)),t(o,1),e(o),o),i.round=o=>{const s=i(o),a=i.ceil(o);return o-s<a-o?s:a},i.offset=(o,s)=>(t(o=new Date(+o),s==null?1:Math.floor(s)),o),i.range=(o,s,a)=>{const u=[];if(o=i.ceil(o),a=a==null?1:Math.floor(a),!(o<s)||!(a>0))return u;let c;do u.push(c=new Date(+o)),t(o,a),e(o);while(c<o&&o<s);return u},i.filter=o=>un(s=>{if(s>=s)for(;e(s),!o(s);)s.setTime(s-1)},(s,a)=>{if(s>=s)if(a<0)for(;++a<=0;)for(;t(s,-1),!o(s););else for(;--a>=0;)for(;t(s,1),!o(s););}),n&&(i.count=(o,s)=>(uE.setTime(+o),lE.setTime(+s),e(uE),e(lE),Math.floor(n(uE,lE))),i.every=o=>(o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?i.filter(r?s=>r(s)%o===0:s=>i.count(0,s)%o===0):i)),i}const yf=un(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);yf.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?un(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):yf);yf.range;const Ns=1e3,Ei=Ns*60,Rs=Ei*60,Vs=Rs*24,MA=Vs*7,Q5=Vs*30,cE=Vs*365,Os=un(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Ns)},(e,t)=>(t-e)/Ns,e=>e.getUTCSeconds());Os.range;const tv=un(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ns)},(e,t)=>{e.setTime(+e+t*Ei)},(e,t)=>(t-e)/Ei,e=>e.getMinutes());tv.range;const nv=un(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Ei)},(e,t)=>(t-e)/Ei,e=>e.getUTCMinutes());nv.range;const rv=un(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ns-e.getMinutes()*Ei)},(e,t)=>{e.setTime(+e+t*Rs)},(e,t)=>(t-e)/Rs,e=>e.getHours());rv.range;const iv=un(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Rs)},(e,t)=>(t-e)/Rs,e=>e.getUTCHours());iv.range;const Bs=un(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Ei)/Vs,e=>e.getDate()-1);Bs.range;const Va=un(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Vs,e=>e.getUTCDate()-1);Va.range;const y8=un(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Vs,e=>Math.floor(e/Vs));y8.range;function Gl(e){return un(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Ei)/MA)}const rd=Gl(0),S1=Gl(1),CV=Gl(2),kV=Gl(3),vf=Gl(4),$V=Gl(5),FV=Gl(6);rd.range;S1.range;CV.range;kV.range;vf.range;$V.range;FV.range;function Vl(e){return un(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/MA)}const id=Vl(0),_1=Vl(1),DV=Vl(2),MV=Vl(3),xf=Vl(4),TV=Vl(5),NV=Vl(6);id.range;_1.range;DV.range;MV.range;xf.range;TV.range;NV.range;const Ep=un(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());Ep.range;const bp=un(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());bp.range;const Go=un(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Go.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:un(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});Go.range;const Vo=un(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Vo.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:un(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});Vo.range;function v8(e,t,n,r,i,o){const s=[[Os,1,Ns],[Os,5,5*Ns],[Os,15,15*Ns],[Os,30,30*Ns],[o,1,Ei],[o,5,5*Ei],[o,15,15*Ei],[o,30,30*Ei],[i,1,Rs],[i,3,3*Rs],[i,6,6*Rs],[i,12,12*Rs],[r,1,Vs],[r,2,2*Vs],[n,1,MA],[t,1,Q5],[t,3,3*Q5],[e,1,cE]];function a(c,f,h){const p=f<c;p&&([c,f]=[f,c]);const m=h&&typeof h.range=="function"?h:u(c,f,h),y=m?m.range(c,+f+1):[];return p?y.reverse():y}function u(c,f,h){const p=Math.abs(f-c)/h,m=nd(([,,w])=>w).right(s,p);if(m===s.length)return e.every(Za(c/cE,f/cE,h));if(m===0)return yf.every(Math.max(Za(c,f,h),1));const[y,v]=s[p/s[m-1][2]<s[m][2]/p?m-1:m];return y.every(v)}return[a,u]}const[RV,OV]=v8(Vo,bp,id,y8,iv,nv),[PV,LV]=v8(Go,Ep,rd,Bs,rv,tv),Nn="year",zr="quarter",Qn="month",on="week",Ir="date",Gn="day",Yo="dayofyear",si="hours",ai="minutes",Fi="seconds",so="milliseconds",TA=[Nn,zr,Qn,on,Ir,Gn,Yo,si,ai,Fi,so],fE=TA.reduce((e,t,n)=>(e[t]=1+n,e),{});function NA(e){const t=xe(e).slice(),n={};return t.length||te("Missing time unit."),t.forEach(i=>{Ee(fE,i)?n[i]=1:te(`Invalid time unit: ${i}.`)}),(n[on]||n[Gn]?1:0)+(n[zr]||n[Qn]||n[Ir]?1:0)+(n[Yo]?1:0)>1&&te(`Incompatible time units: ${e}`),t.sort((i,o)=>fE[i]-fE[o]),t}const zV={[Nn]:"%Y ",[zr]:"Q%q ",[Qn]:"%b ",[Ir]:"%d ",[on]:"W%U ",[Gn]:"%a ",[Yo]:"%j ",[si]:"%H:00",[ai]:"00:%M",[Fi]:":%S",[so]:".%L",[`${Nn}-${Qn}`]:"%Y-%m ",[`${Nn}-${Qn}-${Ir}`]:"%Y-%m-%d ",[`${si}-${ai}`]:"%H:%M"};function x8(e,t){const n=qe({},zV,t),r=NA(e),i=r.length;let o="",s=0,a,u;for(s=0;s<i;)for(a=r.length;a>s;--a)if(u=r.slice(s,a).join("-"),n[u]!=null){o+=n[u],s=a;break}return o.trim()}const rl=new Date;function RA(e){return rl.setFullYear(e),rl.setMonth(0),rl.setDate(1),rl.setHours(0,0,0,0),rl}function w8(e){return b8(new Date(e))}function E8(e){return nS(new Date(e))}function b8(e){return Bs.count(RA(e.getFullYear())-1,e)}function nS(e){return rd.count(RA(e.getFullYear())-1,e)}function rS(e){return RA(e).getDay()}function IV(e,t,n,r,i,o,s){if(0<=e&&e<100){const a=new Date(-1,t,n,r,i,o,s);return a.setFullYear(e),a}return new Date(e,t,n,r,i,o,s)}function S8(e){return A8(new Date(e))}function _8(e){return iS(new Date(e))}function A8(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return Va.count(t-1,e)}function iS(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return id.count(t-1,e)}function oS(e){return rl.setTime(Date.UTC(e,0,1)),rl.getUTCDay()}function BV(e,t,n,r,i,o,s){if(0<=e&&e<100){const a=new Date(Date.UTC(-1,t,n,r,i,o,s));return a.setUTCFullYear(n.y),a}return new Date(Date.UTC(e,t,n,r,i,o,s))}function C8(e,t,n,r,i){const o=t||1,s=Ze(e),a=(E,S,A)=>(A=A||E,UV(n[A],r[A],E===s&&o,S)),u=new Date,c=oo(e),f=c[Nn]?a(Nn):nr(2012),h=c[Qn]?a(Qn):c[zr]?a(zr):Pa,p=c[on]&&c[Gn]?a(Gn,1,on+Gn):c[on]?a(on,1):c[Gn]?a(Gn,1):c[Ir]?a(Ir,1):c[Yo]?a(Yo,1):Kf,m=c[si]?a(si):Pa,y=c[ai]?a(ai):Pa,v=c[Fi]?a(Fi):Pa,w=c[so]?a(so):Pa;return function(E){u.setTime(+E);const S=f(u);return i(S,h(u),p(u,S),m(u),y(u),v(u),w(u))}}function UV(e,t,n,r){const i=n<=1?e:r?(o,s)=>r+n*Math.floor((e(o,s)-r)/n):(o,s)=>n*Math.floor(e(o,s)/n);return t?(o,s)=>t(i(o,s),s):i}function wf(e,t,n){return t+e*7-(n+6)%7}const jV={[Nn]:e=>e.getFullYear(),[zr]:e=>Math.floor(e.getMonth()/3),[Qn]:e=>e.getMonth(),[Ir]:e=>e.getDate(),[si]:e=>e.getHours(),[ai]:e=>e.getMinutes(),[Fi]:e=>e.getSeconds(),[so]:e=>e.getMilliseconds(),[Yo]:e=>b8(e),[on]:e=>nS(e),[on+Gn]:(e,t)=>wf(nS(e),e.getDay(),rS(t)),[Gn]:(e,t)=>wf(1,e.getDay(),rS(t))},WV={[zr]:e=>3*e,[on]:(e,t)=>wf(e,0,rS(t))};function k8(e,t){return C8(e,t||1,jV,WV,IV)}const qV={[Nn]:e=>e.getUTCFullYear(),[zr]:e=>Math.floor(e.getUTCMonth()/3),[Qn]:e=>e.getUTCMonth(),[Ir]:e=>e.getUTCDate(),[si]:e=>e.getUTCHours(),[ai]:e=>e.getUTCMinutes(),[Fi]:e=>e.getUTCSeconds(),[so]:e=>e.getUTCMilliseconds(),[Yo]:e=>A8(e),[on]:e=>iS(e),[Gn]:(e,t)=>wf(1,e.getUTCDay(),oS(t)),[on+Gn]:(e,t)=>wf(iS(e),e.getUTCDay(),oS(t))},HV={[zr]:e=>3*e,[on]:(e,t)=>wf(e,0,oS(t))};function $8(e,t){return C8(e,t||1,qV,HV,BV)}const GV={[Nn]:Go,[zr]:Ep.every(3),[Qn]:Ep,[on]:rd,[Ir]:Bs,[Gn]:Bs,[Yo]:Bs,[si]:rv,[ai]:tv,[Fi]:Os,[so]:yf},VV={[Nn]:Vo,[zr]:bp.every(3),[Qn]:bp,[on]:id,[Ir]:Va,[Gn]:Va,[Yo]:Va,[si]:iv,[ai]:nv,[Fi]:Os,[so]:yf};function od(e){return GV[e]}function sd(e){return VV[e]}function F8(e,t,n){return e?e.offset(t,n):void 0}function D8(e,t,n){return F8(od(e),t,n)}function M8(e,t,n){return F8(sd(e),t,n)}function T8(e,t,n,r){return e?e.range(t,n,r):void 0}function N8(e,t,n,r){return T8(od(e),t,n,r)}function R8(e,t,n,r){return T8(sd(e),t,n,r)}const Ph=1e3,Lh=Ph*60,zh=Lh*60,ov=zh*24,YV=ov*7,K5=ov*30,sS=ov*365,O8=[Nn,Qn,Ir,si,ai,Fi,so],Ih=O8.slice(0,-1),Bh=Ih.slice(0,-1),Uh=Bh.slice(0,-1),XV=Uh.slice(0,-1),QV=[Nn,on],J5=[Nn,Qn],P8=[Nn],dh=[[Ih,1,Ph],[Ih,5,5*Ph],[Ih,15,15*Ph],[Ih,30,30*Ph],[Bh,1,Lh],[Bh,5,5*Lh],[Bh,15,15*Lh],[Bh,30,30*Lh],[Uh,1,zh],[Uh,3,3*zh],[Uh,6,6*zh],[Uh,12,12*zh],[XV,1,ov],[QV,1,YV],[J5,1,K5],[J5,3,3*K5],[P8,1,sS]];function L8(e){const t=e.extent,n=e.maxbins||40,r=Math.abs(tg(t))/n;let i=nd(a=>a[2]).right(dh,r),o,s;return i===dh.length?(o=P8,s=Za(t[0]/sS,t[1]/sS,n)):i?(i=dh[r/dh[i-1][2]<dh[i][2]/r?i-1:i],o=i[0],s=i[1]):(o=O8,s=Math.max(Za(t[0],t[1],n),1)),{units:o,step:s}}function dE(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function hE(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function hh(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function z8(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,o=e.days,s=e.shortDays,a=e.months,u=e.shortMonths,c=ph(i),f=gh(i),h=ph(o),p=gh(o),m=ph(s),y=gh(s),v=ph(a),w=gh(a),E=ph(u),S=gh(u),A={a:Y,A:j,b:q,B:K,c:null,d:iT,e:iT,f:xY,g:FY,G:MY,H:mY,I:yY,j:vY,L:I8,m:wY,M:EY,p:P,q:G,Q:aT,s:uT,S:bY,u:SY,U:_Y,V:AY,w:CY,W:kY,x:null,X:null,y:$Y,Y:DY,Z:TY,"%":sT},C={a:me,A:_e,b:we,B:Ie,c:null,d:oT,e:oT,f:PY,g:GY,G:YY,H:NY,I:RY,j:OY,L:U8,m:LY,M:zY,p:et,q:Ve,Q:aT,s:uT,S:IY,u:BY,U:UY,V:jY,w:WY,W:qY,x:null,X:null,y:HY,Y:VY,Z:XY,"%":sT},k={a:L,A:O,b:X,B:W,c:I,d:nT,e:nT,f:dY,g:tT,G:eT,H:rT,I:rT,j:uY,L:fY,m:aY,M:lY,p:T,q:sY,Q:pY,s:gY,S:cY,u:tY,U:nY,V:rY,w:eY,W:iY,x:N,X:U,y:tT,Y:eT,Z:oY,"%":hY};A.x=D(n,A),A.X=D(r,A),A.c=D(t,A),C.x=D(n,C),C.X=D(r,C),C.c=D(t,C);function D(fe,Re){return function(We){var le=[],zt=-1,nt=0,Zt=fe.length,qt,br,Fu;for(We instanceof Date||(We=new Date(+We));++zt<Zt;)fe.charCodeAt(zt)===37&&(le.push(fe.slice(nt,zt)),(br=Z5[qt=fe.charAt(++zt)])!=null?qt=fe.charAt(++zt):br=qt==="e"?" ":"0",(Fu=Re[qt])&&(qt=Fu(We,br)),le.push(qt),nt=zt+1);return le.push(fe.slice(nt,zt)),le.join("")}}function $(fe,Re){return function(We){var le=hh(1900,void 0,1),zt=M(le,fe,We+="",0),nt,Zt;if(zt!=We.length)return null;if("Q"in le)return new Date(le.Q);if("s"in le)return new Date(le.s*1e3+("L"in le?le.L:0));if(Re&&!("Z"in le)&&(le.Z=0),"p"in le&&(le.H=le.H%12+le.p*12),le.m===void 0&&(le.m="q"in le?le.q:0),"V"in le){if(le.V<1||le.V>53)return null;"w"in le||(le.w=1),"Z"in le?(nt=hE(hh(le.y,0,1)),Zt=nt.getUTCDay(),nt=Zt>4||Zt===0?_1.ceil(nt):_1(nt),nt=Va.offset(nt,(le.V-1)*7),le.y=nt.getUTCFullYear(),le.m=nt.getUTCMonth(),le.d=nt.getUTCDate()+(le.w+6)%7):(nt=dE(hh(le.y,0,1)),Zt=nt.getDay(),nt=Zt>4||Zt===0?S1.ceil(nt):S1(nt),nt=Bs.offset(nt,(le.V-1)*7),le.y=nt.getFullYear(),le.m=nt.getMonth(),le.d=nt.getDate()+(le.w+6)%7)}else("W"in le||"U"in le)&&("w"in le||(le.w="u"in le?le.u%7:"W"in le?1:0),Zt="Z"in le?hE(hh(le.y,0,1)).getUTCDay():dE(hh(le.y,0,1)).getDay(),le.m=0,le.d="W"in le?(le.w+6)%7+le.W*7-(Zt+5)%7:le.w+le.U*7-(Zt+6)%7);return"Z"in le?(le.H+=le.Z/100|0,le.M+=le.Z%100,hE(le)):dE(le)}}function M(fe,Re,We,le){for(var zt=0,nt=Re.length,Zt=We.length,qt,br;zt<nt;){if(le>=Zt)return-1;if(qt=Re.charCodeAt(zt++),qt===37){if(qt=Re.charAt(zt++),br=k[qt in Z5?Re.charAt(zt++):qt],!br||(le=br(fe,We,le))<0)return-1}else if(qt!=We.charCodeAt(le++))return-1}return le}function T(fe,Re,We){var le=c.exec(Re.slice(We));return le?(fe.p=f.get(le[0].toLowerCase()),We+le[0].length):-1}function L(fe,Re,We){var le=m.exec(Re.slice(We));return le?(fe.w=y.get(le[0].toLowerCase()),We+le[0].length):-1}function O(fe,Re,We){var le=h.exec(Re.slice(We));return le?(fe.w=p.get(le[0].toLowerCase()),We+le[0].length):-1}function X(fe,Re,We){var le=E.exec(Re.slice(We));return le?(fe.m=S.get(le[0].toLowerCase()),We+le[0].length):-1}function W(fe,Re,We){var le=v.exec(Re.slice(We));return le?(fe.m=w.get(le[0].toLowerCase()),We+le[0].length):-1}function I(fe,Re,We){return M(fe,t,Re,We)}function N(fe,Re,We){return M(fe,n,Re,We)}function U(fe,Re,We){return M(fe,r,Re,We)}function Y(fe){return s[fe.getDay()]}function j(fe){return o[fe.getDay()]}function q(fe){return u[fe.getMonth()]}function K(fe){return a[fe.getMonth()]}function P(fe){return i[+(fe.getHours()>=12)]}function G(fe){return 1+~~(fe.getMonth()/3)}function me(fe){return s[fe.getUTCDay()]}function _e(fe){return o[fe.getUTCDay()]}function we(fe){return u[fe.getUTCMonth()]}function Ie(fe){return a[fe.getUTCMonth()]}function et(fe){return i[+(fe.getUTCHours()>=12)]}function Ve(fe){return 1+~~(fe.getUTCMonth()/3)}return{format:function(fe){var Re=D(fe+="",A);return Re.toString=function(){return fe},Re},parse:function(fe){var Re=$(fe+="",!1);return Re.toString=function(){return fe},Re},utcFormat:function(fe){var Re=D(fe+="",C);return Re.toString=function(){return fe},Re},utcParse:function(fe){var Re=$(fe+="",!0);return Re.toString=function(){return fe},Re}}}var Z5={"-":"",_:" ",0:"0"},bn=/^\s*\d+/,KV=/^%/,JV=/[\\^$*+?|[\]().{}]/g;function ut(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(t)+i:i)}function ZV(e){return e.replace(JV,"\\$&")}function ph(e){return new RegExp("^(?:"+e.map(ZV).join("|")+")","i")}function gh(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function eY(e,t,n){var r=bn.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function tY(e,t,n){var r=bn.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function nY(e,t,n){var r=bn.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function rY(e,t,n){var r=bn.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function iY(e,t,n){var r=bn.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function eT(e,t,n){var r=bn.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function tT(e,t,n){var r=bn.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function oY(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function sY(e,t,n){var r=bn.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function aY(e,t,n){var r=bn.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function nT(e,t,n){var r=bn.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function uY(e,t,n){var r=bn.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function rT(e,t,n){var r=bn.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function lY(e,t,n){var r=bn.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function cY(e,t,n){var r=bn.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function fY(e,t,n){var r=bn.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function dY(e,t,n){var r=bn.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function hY(e,t,n){var r=KV.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function pY(e,t,n){var r=bn.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function gY(e,t,n){var r=bn.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function iT(e,t){return ut(e.getDate(),t,2)}function mY(e,t){return ut(e.getHours(),t,2)}function yY(e,t){return ut(e.getHours()%12||12,t,2)}function vY(e,t){return ut(1+Bs.count(Go(e),e),t,3)}function I8(e,t){return ut(e.getMilliseconds(),t,3)}function xY(e,t){return I8(e,t)+"000"}function wY(e,t){return ut(e.getMonth()+1,t,2)}function EY(e,t){return ut(e.getMinutes(),t,2)}function bY(e,t){return ut(e.getSeconds(),t,2)}function SY(e){var t=e.getDay();return t===0?7:t}function _Y(e,t){return ut(rd.count(Go(e)-1,e),t,2)}function B8(e){var t=e.getDay();return t>=4||t===0?vf(e):vf.ceil(e)}function AY(e,t){return e=B8(e),ut(vf.count(Go(e),e)+(Go(e).getDay()===4),t,2)}function CY(e){return e.getDay()}function kY(e,t){return ut(S1.count(Go(e)-1,e),t,2)}function $Y(e,t){return ut(e.getFullYear()%100,t,2)}function FY(e,t){return e=B8(e),ut(e.getFullYear()%100,t,2)}function DY(e,t){return ut(e.getFullYear()%1e4,t,4)}function MY(e,t){var n=e.getDay();return e=n>=4||n===0?vf(e):vf.ceil(e),ut(e.getFullYear()%1e4,t,4)}function TY(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+ut(t/60|0,"0",2)+ut(t%60,"0",2)}function oT(e,t){return ut(e.getUTCDate(),t,2)}function NY(e,t){return ut(e.getUTCHours(),t,2)}function RY(e,t){return ut(e.getUTCHours()%12||12,t,2)}function OY(e,t){return ut(1+Va.count(Vo(e),e),t,3)}function U8(e,t){return ut(e.getUTCMilliseconds(),t,3)}function PY(e,t){return U8(e,t)+"000"}function LY(e,t){return ut(e.getUTCMonth()+1,t,2)}function zY(e,t){return ut(e.getUTCMinutes(),t,2)}function IY(e,t){return ut(e.getUTCSeconds(),t,2)}function BY(e){var t=e.getUTCDay();return t===0?7:t}function UY(e,t){return ut(id.count(Vo(e)-1,e),t,2)}function j8(e){var t=e.getUTCDay();return t>=4||t===0?xf(e):xf.ceil(e)}function jY(e,t){return e=j8(e),ut(xf.count(Vo(e),e)+(Vo(e).getUTCDay()===4),t,2)}function WY(e){return e.getUTCDay()}function qY(e,t){return ut(_1.count(Vo(e)-1,e),t,2)}function HY(e,t){return ut(e.getUTCFullYear()%100,t,2)}function GY(e,t){return e=j8(e),ut(e.getUTCFullYear()%100,t,2)}function VY(e,t){return ut(e.getUTCFullYear()%1e4,t,4)}function YY(e,t){var n=e.getUTCDay();return e=n>=4||n===0?xf(e):xf.ceil(e),ut(e.getUTCFullYear()%1e4,t,4)}function XY(){return"+0000"}function sT(){return"%"}function aT(e){return+e}function uT(e){return Math.floor(+e/1e3)}var Pc,OA,W8,PA,q8;QY({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function QY(e){return Pc=z8(e),OA=Pc.format,W8=Pc.parse,PA=Pc.utcFormat,q8=Pc.utcParse,Pc}function jh(e){const t={};return n=>t[n]||(t[n]=e(n))}function KY(e,t){return n=>{const r=e(n),i=r.indexOf(t);if(i<0)return r;let o=JY(r,i);const s=o<r.length?r.slice(o):"";for(;--o>i;)if(r[o]!=="0"){++o;break}return r.slice(0,o)+s}}function JY(e,t){let n=e.lastIndexOf("e"),r;if(n>0)return n;for(n=e.length;--n>t;)if(r=e.charCodeAt(n),r>=48&&r<=57)return n+1}function H8(e){const t=jh(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(r){const i=bl(r||",");if(i.precision==null){switch(i.precision=12,i.type){case"%":i.precision-=2;break;case"e":i.precision-=1;break}return KY(t(i),t(".1f")(1)[1])}else return t(i)},formatSpan(r,i,o,s){s=bl(s??",f");const a=Za(r,i,o),u=Math.max(Math.abs(r),Math.abs(i));let c;if(s.precision==null)switch(s.type){case"s":return isNaN(c=g8(a,u))||(s.precision=c),n(s,u);case"":case"e":case"g":case"p":case"r":{isNaN(c=m8(a,u))||(s.precision=c-(s.type==="e"));break}case"f":case"%":{isNaN(c=p8(a))||(s.precision=c-(s.type==="%")*2);break}}return t(s)}}}let aS;G8();function G8(){return aS=H8({format:ev,formatPrefix:DA})}function V8(e){return H8(h8(e))}function A1(e){return arguments.length?aS=V8(e):aS}function lT(e,t,n){n=n||{},ye(n)||te(`Invalid time multi-format specifier: ${n}`);const r=t(Fi),i=t(ai),o=t(si),s=t(Ir),a=t(on),u=t(Qn),c=t(zr),f=t(Nn),h=e(n[so]||".%L"),p=e(n[Fi]||":%S"),m=e(n[ai]||"%I:%M"),y=e(n[si]||"%I %p"),v=e(n[Ir]||n[Gn]||"%a %d"),w=e(n[on]||"%b %d"),E=e(n[Qn]||"%B"),S=e(n[zr]||"%B"),A=e(n[Nn]||"%Y");return C=>(r(C)<C?h:i(C)<C?p:o(C)<C?m:s(C)<C?y:u(C)<C?a(C)<C?v:w:f(C)<C?c(C)<C?E:S:A)(C)}function Y8(e){const t=jh(e.format),n=jh(e.utcFormat);return{timeFormat:r=>ve(r)?t(r):lT(t,od,r),utcFormat:r=>ve(r)?n(r):lT(n,sd,r),timeParse:jh(e.parse),utcParse:jh(e.utcParse)}}let uS;X8();function X8(){return uS=Y8({format:OA,parse:W8,utcFormat:PA,utcParse:q8})}function Q8(e){return Y8(z8(e))}function Sp(e){return arguments.length?uS=Q8(e):uS}const lS=(e,t)=>qe({},e,t);function K8(e,t){const n=e?V8(e):A1(),r=t?Q8(t):Sp();return lS(n,r)}function LA(e,t){const n=arguments.length;return n&&n!==2&&te("defaultLocale expects either zero or two arguments."),n?lS(A1(e),Sp(t)):lS(A1(),Sp())}function ZY(){return G8(),X8(),LA()}const eX=/^(data:|([A-Za-z]+:)?\/\/)/,tX=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,nX=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,cT="file://";function rX(e,t){return n=>({options:n||{},sanitize:oX,load:iX,fileAccess:!1,file:sX(),http:uX(e)})}async function iX(e,t){const n=await this.sanitize(e,t),r=n.href;return n.localFile?this.file(r):this.http(r,t)}async function oX(e,t){t=qe({},this.options,t);const n=this.fileAccess,r={href:null};let i,o,s;const a=tX.test(e.replace(nX,""));(e==null||typeof e!="string"||!a)&&te("Sanitize failure, invalid URI: "+de(e));const u=eX.test(e);return(s=t.baseURL)&&!u&&(!e.startsWith("/")&&!s.endsWith("/")&&(e="/"+e),e=s+e),o=(i=e.startsWith(cT))||t.mode==="file"||t.mode!=="http"&&!u&&n,i?e=e.slice(cT.length):e.startsWith("//")&&(t.defaultProtocol==="file"?(e=e.slice(2),o=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(r,"localFile",{value:!!o}),r.href=e,t.target&&(r.target=t.target+""),t.rel&&(r.rel=t.rel+""),t.context==="image"&&t.crossOrigin&&(r.crossOrigin=t.crossOrigin+""),r}function sX(e){return aX}async function aX(){te("No file system access.")}function uX(e){return e?async function(t,n){const r=qe({},this.options.http,n),i=n&&n.response,o=await e(t,r);return o.ok?He(o[i])?o[i]():o.text():te(o.status+""+o.statusText)}:lX}async function lX(){te("No HTTP fetch method available.")}const cX=e=>e!=null&&e===e,fX=e=>e==="true"||e==="false"||e===!0||e===!1,dX=e=>!Number.isNaN(Date.parse(e)),J8=e=>!Number.isNaN(+e)&&!(e instanceof Date),hX=e=>J8(e)&&Number.isInteger(+e),cS={boolean:CA,integer:Vn,number:Vn,date:kA,string:$A,unknown:tr},sm=[fX,hX,J8,dX],pX=["boolean","integer","number","date"];function Z8(e,t){if(!e||!e.length)return"unknown";const n=e.length,r=sm.length,i=sm.map((o,s)=>s+1);for(let o=0,s=0,a,u;o<n;++o)for(u=t?e[o][t]:e[o],a=0;a<r;++a)if(i[a]&&cX(u)&&!sm[a](u)&&(i[a]=0,++s,s===sm.length))return"string";return pX[i.reduce((o,s)=>o===0?s:o,0)-1]}function eP(e,t){return t.reduce((n,r)=>(n[r]=Z8(e,r),n),{})}function fT(e){const t=function(n,r){const i={delimiter:e};return zA(n,r?qe(r,i):i)};return t.responseType="text",t}function zA(e,t){return t.header&&(e=t.header.map(de).join(t.delimiter)+`
`+e),YG(t.delimiter).parse(e+"")}zA.responseType="text";function gX(e){return typeof Buffer=="function"&&He(Buffer.isBuffer)?Buffer.isBuffer(e):!1}function IA(e,t){const n=t&&t.property?ki(t.property):tr;return ye(e)&&!gX(e)?mX(n(e),t):n(JSON.parse(e))}IA.responseType="json";function mX(e,t){return!ne(e)&&V4(e)&&(e=[...e]),t&&t.copy?JSON.parse(JSON.stringify(e)):e}const yX={interior:(e,t)=>e!==t,exterior:(e,t)=>e===t};function tP(e,t){let n,r,i,o;return e=IA(e,t),t&&t.feature?(n=JG,i=t.feature):t&&t.mesh?(n=eV,i=t.mesh,o=yX[t.filter]):te("Missing TopoJSON feature or mesh parameter."),r=(r=e.objects[i])?n(e,r,o):te("Invalid TopoJSON object: "+i),r&&r.features||[r]}tP.responseType="json";const Hm={dsv:zA,csv:fT(","),tsv:fT("	"),json:IA,topojson:tP};function BA(e,t){return arguments.length>1?(Hm[e]=t,this):Ee(Hm,e)?Hm[e]:null}function nP(e){const t=BA(e);return t&&t.responseType||"text"}function rP(e,t,n,r){t=t||{};const i=BA(t.type||"json");return i||te("Unknown data format type: "+t.type),e=i(e,t),t.parse&&vX(e,t.parse,n,r),Ee(e,"columns")&&delete e.columns,e}function vX(e,t,n,r){if(!e.length)return;const i=Sp();n=n||i.timeParse,r=r||i.utcParse;let o=e.columns||Object.keys(e[0]),s,a,u,c,f,h;t==="auto"&&(t=eP(e,o)),o=Object.keys(t);const p=o.map(m=>{const y=t[m];let v,w;if(y&&(y.startsWith("date:")||y.startsWith("utc:")))return v=y.split(/:(.+)?/,2),w=v[1],(w[0]==="'"&&w[w.length-1]==="'"||w[0]==='"'&&w[w.length-1]==='"')&&(w=w.slice(1,-1)),(v[0]==="utc"?r:n)(w);if(!cS[y])throw Error("Illegal format pattern: "+m+":"+y);return cS[y]});for(u=0,f=e.length,h=o.length;u<f;++u)for(s=e[u],c=0;c<h;++c)a=o[c],s[a]=p[c](s[a])}const sv=rX(typeof fetch<"u"&&fetch);function av(e){const t=e||tr,n=[],r={};return n.add=i=>{const o=t(i);return r[o]||(r[o]=1,n.push(i)),n},n.remove=i=>{const o=t(i);if(r[o]){r[o]=0;const s=n.indexOf(i);s>=0&&n.splice(s,1)}return n},n}async function Gm(e,t){try{await t(e)}catch(n){e.error(n)}}const iP=Symbol("vega_id");let xX=1;function uv(e){return!!(e&&Te(e))}function Te(e){return e[iP]}function oP(e,t){return e[iP]=t,e}function ct(e){const t=e===Object(e)?e:{data:e};return Te(t)?t:oP(t,xX++)}function UA(e){return lv(e,ct({}))}function lv(e,t){for(const n in e)t[n]=e[n];return t}function sP(e,t){return oP(t,Te(e))}function Yl(e,t){return e?t?(n,r)=>e(n,r)||Te(t(n))-Te(t(r)):(n,r)=>e(n,r)||Te(n)-Te(r):null}function aP(e){return e&&e.constructor===Xl}function Xl(){const e=[],t=[],n=[],r=[],i=[];let o=null,s=!1;return{constructor:Xl,insert(a){const u=xe(a),c=u.length;for(let f=0;f<c;++f)e.push(u[f]);return this},remove(a){const u=He(a)?r:t,c=xe(a),f=c.length;for(let h=0;h<f;++h)u.push(c[h]);return this},modify(a,u,c){const f={field:u,value:nr(c)};return He(a)?(f.filter=a,i.push(f)):(f.tuple=a,n.push(f)),this},encode(a,u){return He(a)?i.push({filter:a,field:u}):n.push({tuple:a,field:u}),this},clean(a){return o=a,this},reflow(){return s=!0,this},pulse(a,u){const c={},f={};let h,p,m,y,v,w;for(h=0,p=u.length;h<p;++h)c[Te(u[h])]=1;for(h=0,p=t.length;h<p;++h)v=t[h],c[Te(v)]=-1;for(h=0,p=r.length;h<p;++h)y=r[h],u.forEach(S=>{y(S)&&(c[Te(S)]=-1)});for(h=0,p=e.length;h<p;++h)v=e[h],w=Te(v),c[w]?c[w]=1:a.add.push(ct(e[h]));for(h=0,p=u.length;h<p;++h)v=u[h],c[Te(v)]<0&&a.rem.push(v);function E(S,A,C){C?S[A]=C(S):a.encode=A,s||(f[Te(S)]=S)}for(h=0,p=n.length;h<p;++h)m=n[h],v=m.tuple,y=m.field,w=c[Te(v)],w>0&&(E(v,y,m.value),a.modifies(y));for(h=0,p=i.length;h<p;++h)m=i[h],y=m.filter,u.forEach(S=>{y(S)&&c[Te(S)]>0&&E(S,m.field,m.value)}),a.modifies(m.field);if(s)a.mod=t.length||r.length?u.filter(S=>c[Te(S)]>0):u.slice();else for(w in f)a.mod.push(f[w]);return(o||o==null&&(t.length||r.length))&&a.clean(!0),a}}}const Vm="_:mod:_";function cv(){Object.defineProperty(this,Vm,{writable:!0,value:{}})}cv.prototype={set(e,t,n,r){const i=this,o=i[e],s=i[Vm];return t!=null&&t>=0?(o[t]!==n||r)&&(o[t]=n,s[t+":"+e]=-1,s[e]=-1):(o!==n||r)&&(i[e]=n,s[e]=ne(n)?1+n.length:-1),i},modified(e,t){const n=this[Vm];if(arguments.length){if(ne(e)){for(let r=0;r<e.length;++r)if(n[e[r]])return!0;return!1}}else{for(const r in n)if(n[r])return!0;return!1}return t!=null&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]},clear(){return this[Vm]={},this}};let wX=0;const EX="pulse",bX=new cv,SX=1,_X=2;function Et(e,t,n,r){this.id=++wX,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,t&&(this._update=t),n&&this.parameters(n,r)}function dT(e){return function(t){const n=this.flags;return arguments.length===0?!!(n&e):(this.flags=t?n|e:n&~e,this)}}Et.prototype={targets(){return this._targets||(this._targets=av(eg))},set(e){return this.value!==e?(this.value=e,1):0},skip:dT(SX),modified:dT(_X),parameters(e,t,n){t=t!==!1;const r=this._argval=this._argval||new cv,i=this._argops=this._argops||[],o=[];let s,a,u,c;const f=(h,p,m)=>{m instanceof Et?(m!==this&&(t&&m.targets().add(this),o.push(m)),i.push({op:m,name:h,index:p})):r.set(h,p,m)};for(s in e)if(a=e[s],s===EX)xe(a).forEach(h=>{h instanceof Et?h!==this&&(h.targets().add(this),o.push(h)):te("Pulse parameters must be operator instances.")}),this.source=a;else if(ne(a))for(r.set(s,-1,Array(u=a.length)),c=0;c<u;++c)f(s,c,a[c]);else f(s,-1,a);return this.marshall().clear(),n&&(i.initonly=!0),o},marshall(e){const t=this._argval||bX,n=this._argops;let r,i,o,s;if(n){const a=n.length;for(i=0;i<a;++i)r=n[i],o=r.op,s=o.modified()&&o.stamp===e,t.set(r.name,r.index,o.value,s);if(n.initonly){for(i=0;i<a;++i)r=n[i],r.op.targets().remove(this);this._argops=null,this._update=null}}return t},detach(){const e=this._argops;let t,n,r,i;if(e)for(t=0,n=e.length;t<n;++t)r=e[t],i=r.op,i._targets&&i._targets.remove(this);this.pulse=null,this.source=null},evaluate(e){const t=this._update;if(t){const n=this.marshall(e.stamp),r=t.call(this,n,e);if(n.clear(),r!==this.value)this.value=r;else if(!this.modified())return e.StopPropagation}},run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?(this.skip(!1),t=0):t=this.evaluate(e),this.pulse=t||e}};function AX(e,t,n,r){let i=1,o;return e instanceof Et?o=e:e&&e.prototype instanceof Et?o=new e:He(e)?o=new Et(null,e):(i=0,o=new Et(e,t)),this.rank(o),i&&(r=n,n=t),n&&this.connect(o,o.parameters(n,r)),this.touch(o),o}function CX(e,t){const n=e.rank,r=t.length;for(let i=0;i<r;++i)if(n<t[i].rank){this.rerank(e);return}}let kX=0;function fv(e,t,n){this.id=++kX,this.value=null,n&&(this.receive=n),e&&(this._filter=e),t&&(this._apply=t)}function Fa(e,t,n){return new fv(e,t,n)}fv.prototype={_filter:$i,_apply:tr,targets(){return this._targets||(this._targets=av(eg))},consume(e){return arguments.length?(this._consume=!!e,this):!!this._consume},receive(e){if(this._filter(e)){const t=this.value=this._apply(e),n=this._targets,r=n?n.length:0;for(let i=0;i<r;++i)n[i].receive(t);this._consume&&(e.preventDefault(),e.stopPropagation())}},filter(e){const t=Fa(e);return this.targets().add(t),t},apply(e){const t=Fa(null,e);return this.targets().add(t),t},merge(){const e=Fa();this.targets().add(e);for(let t=0,n=arguments.length;t<n;++t)arguments[t].targets().add(e);return e},throttle(e){let t=-1;return this.filter(()=>{const n=Date.now();return n-t>e?(t=n,1):0})},debounce(e){const t=Fa();return this.targets().add(Fa(null,null,SA(e,n=>{const r=n.dataflow;t.receive(n),r&&r.run&&r.run()}))),t},between(e,t){let n=!1;return e.targets().add(Fa(null,null,()=>n=!0)),t.targets().add(Fa(null,null,()=>n=!1)),this.filter(()=>n)},detach(){this._filter=$i,this._targets=null}};function $X(e,t,n,r){const i=this,o=Fa(n,r),s=function(c){c.dataflow=i;try{o.receive(c)}catch(f){i.error(f)}finally{i.run()}};let a;typeof e=="string"&&typeof document<"u"?a=document.querySelectorAll(e):a=xe(e);const u=a.length;for(let c=0;c<u;++c)a[c].addEventListener(t,s);return o}function FX(e,t){const n=this.locale();return rP(e,t,n.timeParse,n.utcParse)}function DX(e,t,n){return t=this.parse(t,n),this.pulse(e,this.changeset().insert(t))}async function MX(e,t){const n=this;let r=0,i;try{i=await n.loader().load(e,{context:"dataflow",response:nP(t&&t.type)});try{i=n.parse(i,t)}catch(o){r=-2,n.warn("Data ingestion failed",e,o)}}catch(o){r=-1,n.warn("Loading failed",e,o)}return{data:i,status:r}}async function TX(e,t,n){const r=this,i=r._pending||NX(r);i.requests+=1;const o=await r.request(t,n);return r.pulse(e,r.changeset().remove($i).insert(o.data||[])),i.done(),o}function NX(e){let t;const n=new Promise(r=>t=r);return n.requests=0,n.done=()=>{--n.requests===0&&(e._pending=null,t(e))},e._pending=n}const RX={skip:!0};function OX(e,t,n,r,i){return(e instanceof Et?LX:PX)(this,e,t,n,r,i),this}function PX(e,t,n,r,i,o){const s=qe({},o,RX);let a,u;He(n)||(n=nr(n)),r===void 0?a=c=>e.touch(n(c)):He(r)?(u=new Et(null,r,i,!1),a=c=>{u.evaluate(c);const f=n(c),h=u.value;aP(h)?e.pulse(f,h,o):e.update(f,h,s)}):a=c=>e.update(n(c),r,s),t.apply(a)}function LX(e,t,n,r,i,o){if(r===void 0)t.targets().add(n);else{const s=o||{},a=new Et(null,zX(n,r),i,!1);a.modified(s.force),a.rank=t.rank,t.targets().add(a),n&&(a.skip(!0),a.value=n.value,a.targets().add(n),e.connect(n,[a]))}}function zX(e,t){return t=He(t)?t:nr(t),e?function(n,r){const i=t(n,r);return e.skip()||(e.skip(i!==this.value).value=i),i}:t}function IX(e){e.rank=++this._rank}function BX(e){const t=[e];let n,r,i;for(;t.length;)if(this.rank(n=t.pop()),r=n._targets)for(i=r.length;--i>=0;)t.push(n=r[i]),n===e&&te("Cycle detected in dataflow graph.")}const C1={},Mo=1,Ta=2,ks=4,UX=Mo|Ta,hT=Mo|ks,Lc=Mo|Ta|ks,pT=8,mh=16,gT=32,mT=64;function Ya(e,t,n){this.dataflow=e,this.stamp=t??-1,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function pE(e,t){const n=[];return Ma(e,t,r=>n.push(r)),n}function yT(e,t){const n={};return e.visit(t,r=>{n[Te(r)]=1}),r=>n[Te(r)]?null:r}function am(e,t){return e?(n,r)=>e(n,r)&&t(n,r):t}Ya.prototype={StopPropagation:C1,ADD:Mo,REM:Ta,MOD:ks,ADD_REM:UX,ADD_MOD:hT,ALL:Lc,REFLOW:pT,SOURCE:mh,NO_SOURCE:gT,NO_FIELDS:mT,fork(e){return new Ya(this.dataflow).init(this,e)},clone(){const e=this.fork(Lc);return e.add=e.add.slice(),e.rem=e.rem.slice(),e.mod=e.mod.slice(),e.source&&(e.source=e.source.slice()),e.materialize(Lc|mh)},addAll(){let e=this;return!e.source||e.add===e.rem||!e.rem.length&&e.source.length===e.add.length||(e=new Ya(this.dataflow).init(this),e.add=e.source,e.rem=[]),e},init(e,t){const n=this;return n.stamp=e.stamp,n.encode=e.encode,e.fields&&!(t&mT)&&(n.fields=e.fields),t&Mo?(n.addF=e.addF,n.add=e.add):(n.addF=null,n.add=[]),t&Ta?(n.remF=e.remF,n.rem=e.rem):(n.remF=null,n.rem=[]),t&ks?(n.modF=e.modF,n.mod=e.mod):(n.modF=null,n.mod=[]),t&gT?(n.srcF=null,n.source=null):(n.srcF=e.srcF,n.source=e.source,e.cleans&&(n.cleans=e.cleans)),n},runAfter(e){this.dataflow.runAfter(e)},changed(e){const t=e||Lc;return t&Mo&&this.add.length||t&Ta&&this.rem.length||t&ks&&this.mod.length},reflow(e){if(e)return this.fork(Lc).reflow();const t=this.add.length,n=this.source&&this.source.length;return n&&n!==t&&(this.mod=this.source,t&&this.filter(ks,yT(this,Mo))),this},clean(e){return arguments.length?(this.cleans=!!e,this):this.cleans},modifies(e){const t=this.fields||(this.fields={});return ne(e)?e.forEach(n=>t[n]=!0):t[e]=!0,this},modified(e,t){const n=this.fields;return(t||this.mod.length)&&n?arguments.length?ne(e)?e.some(r=>n[r]):n[e]:!!n:!1},filter(e,t){const n=this;return e&Mo&&(n.addF=am(n.addF,t)),e&Ta&&(n.remF=am(n.remF,t)),e&ks&&(n.modF=am(n.modF,t)),e&mh&&(n.srcF=am(n.srcF,t)),n},materialize(e){e=e||Lc;const t=this;return e&Mo&&t.addF&&(t.add=pE(t.add,t.addF),t.addF=null),e&Ta&&t.remF&&(t.rem=pE(t.rem,t.remF),t.remF=null),e&ks&&t.modF&&(t.mod=pE(t.mod,t.modF),t.modF=null),e&mh&&t.srcF&&(t.source=t.source.filter(t.srcF),t.srcF=null),t},visit(e,t){const n=this,r=t;if(e&mh)return Ma(n.source,n.srcF,r),n;e&Mo&&Ma(n.add,n.addF,r),e&Ta&&Ma(n.rem,n.remF,r),e&ks&&Ma(n.mod,n.modF,r);const i=n.source;if(e&pT&&i){const o=n.add.length+n.mod.length;o===i.length||(o?Ma(i,yT(n,hT),r):Ma(i,n.srcF,r))}return n}};function jA(e,t,n,r){const i=this;let o=0;this.dataflow=e,this.stamp=t,this.fields=null,this.encode=r||null,this.pulses=n;for(const s of n)if(s.stamp===t){if(s.fields){const a=i.fields||(i.fields={});for(const u in s.fields)a[u]=1}s.changed(i.ADD)&&(o|=i.ADD),s.changed(i.REM)&&(o|=i.REM),s.changed(i.MOD)&&(o|=i.MOD)}this.changes=o}pe(jA,Ya,{fork(e){const t=new Ya(this.dataflow).init(this,e&this.NO_FIELDS);return e!==void 0&&(e&t.ADD&&this.visit(t.ADD,n=>t.add.push(n)),e&t.REM&&this.visit(t.REM,n=>t.rem.push(n)),e&t.MOD&&this.visit(t.MOD,n=>t.mod.push(n))),t},changed(e){return this.changes&e},modified(e){const t=this,n=t.fields;return n&&t.changes&t.MOD?ne(e)?e.some(r=>n[r]):n[e]:0},filter(){te("MultiPulse does not support filtering.")},materialize(){te("MultiPulse does not support materialization.")},visit(e,t){const n=this,r=n.pulses,i=r.length;let o=0;if(e&n.SOURCE)for(;o<i;++o)r[o].visit(e,t);else for(;o<i;++o)r[o].stamp===n.stamp&&r[o].visit(e,t);return n}});async function jX(e,t,n){const r=this,i=[];if(r._pulse)return uP(r);if(r._pending&&await r._pending,t&&await Gm(r,t),!r._touched.length)return r.debug("Dataflow invoked, but nothing to do."),r;const o=++r._clock;r._pulse=new Ya(r,o,e),r._touched.forEach(f=>r._enqueue(f,!0)),r._touched=av(eg);let s=0,a,u,c;try{for(;r._heap.size()>0;){if(a=r._heap.pop(),a.rank!==a.qrank){r._enqueue(a,!0);continue}u=a.run(r._getPulse(a,e)),u.then?u=await u:u.async&&(i.push(u.async),u=C1),u!==C1&&a._targets&&a._targets.forEach(f=>r._enqueue(f)),++s}}catch(f){r._heap.clear(),c=f}if(r._input={},r._pulse=null,r.debug(`Pulse ${o}: ${s} operators`),c&&(r._postrun=[],r.error(c)),r._postrun.length){const f=r._postrun.sort((h,p)=>p.priority-h.priority);r._postrun=[];for(let h=0;h<f.length;++h)await Gm(r,f[h].callback)}return n&&await Gm(r,n),i.length&&Promise.all(i).then(f=>r.runAsync(null,()=>{f.forEach(h=>{try{h(r)}catch(p){r.error(p)}})})),r}async function WX(e,t,n){for(;this._running;)await this._running;const r=()=>this._running=null;return(this._running=this.evaluate(e,t,n)).then(r,r),this._running}function qX(e,t,n){return this._pulse?uP(this):(this.evaluate(e,t,n),this)}function HX(e,t,n){if(this._pulse||t)this._postrun.push({priority:n||0,callback:e});else try{e(this)}catch(r){this.error(r)}}function uP(e){return e.error("Dataflow already running. Use runAsync() to chain invocations."),e}function GX(e,t){const n=e.stamp<this._clock;n&&(e.stamp=this._clock),(n||t)&&(e.qrank=e.rank,this._heap.push(e))}function VX(e,t){const n=e.source,r=this._clock;return n&&ne(n)?new jA(this,r,n.map(i=>i.pulse),t):this._input[e.id]||YX(this._pulse,n&&n.pulse)}function YX(e,t){return t&&t.stamp===e.stamp?t:(e=e.fork(),t&&t!==C1&&(e.source=t.source),e)}const WA={skip:!1,force:!1};function XX(e,t){const n=t||WA;return this._pulse?this._enqueue(e):this._touched.add(e),n.skip&&e.skip(!0),this}function QX(e,t,n){const r=n||WA;return(e.set(t)||r.force)&&this.touch(e,r),this}function KX(e,t,n){this.touch(e,n||WA);const r=new Ya(this,this._clock+(this._pulse?0:1)),i=e.pulse&&e.pulse.source||[];return r.target=e,this._input[e.id]=t.pulse(r,i),this}function JX(e){let t=[];return{clear:()=>t=[],size:()=>t.length,peek:()=>t[0],push:n=>(t.push(n),lP(t,0,t.length-1,e)),pop:()=>{const n=t.pop();let r;return t.length?(r=t[0],t[0]=n,ZX(t,0,e)):r=n,r}}}function lP(e,t,n,r){let i,o;const s=e[n];for(;n>t;){if(o=n-1>>1,i=e[o],r(s,i)<0){e[n]=i,n=o;continue}break}return e[n]=s}function ZX(e,t,n){const r=t,i=e.length,o=e[t];let s=(t<<1)+1,a;for(;s<i;)a=s+1,a<i&&n(e[s],e[a])>=0&&(s=a),e[t]=e[s],t=s,s=(t<<1)+1;return e[t]=o,lP(e,r,t,n)}function sf(){this.logger(vA()),this.logLevel(mA),this._clock=0,this._rank=0,this._locale=LA();try{this._loader=sv()}catch{}this._touched=av(eg),this._input={},this._pulse=null,this._heap=JX((e,t)=>e.qrank-t.qrank),this._postrun=[]}function yh(e){return function(){return this._log[e].apply(this,arguments)}}sf.prototype={stamp(){return this._clock},loader(e){return arguments.length?(this._loader=e,this):this._loader},locale(e){return arguments.length?(this._locale=e,this):this._locale},logger(e){return arguments.length?(this._log=e,this):this._log},error:yh("error"),warn:yh("warn"),info:yh("info"),debug:yh("debug"),logLevel:yh("level"),cleanThreshold:1e4,add:AX,connect:CX,rank:IX,rerank:BX,pulse:KX,touch:XX,update:QX,changeset:Xl,ingest:DX,parse:FX,preload:TX,request:MX,events:$X,on:OX,evaluate:jX,run:qX,runAsync:WX,runAfter:HX,_enqueue:GX,_getPulse:VX};function J(e,t){Et.call(this,e,null,t)}pe(J,Et,{run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?this.skip(!1):t=this.evaluate(e),t=t||e,t.then?t=t.then(n=>this.pulse=n):t!==e.StopPropagation&&(this.pulse=t),t},evaluate(e){const t=this.marshall(e.stamp),n=this.transform(t,e);return t.clear(),n},transform(){}});const Ef={};function cP(e){const t=fP(e);return t&&t.Definition||null}function fP(e){return e=e&&e.toLowerCase(),Ee(Ef,e)?Ef[e]:null}function*dP(e,t){if(t==null)for(let n of e)n!=null&&n!==""&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)r=t(r,++n,e),r!=null&&r!==""&&(r=+r)>=r&&(yield r)}}function qA(e,t,n){const r=Float64Array.from(dP(e,n));return r.sort(Is),t.map(i=>u8(r,i))}function HA(e,t){return qA(e,[.25,.5,.75],t)}function GA(e,t){const n=e.length,r=uV(e,t),i=HA(e,t),o=(i[2]-i[0])/1.34;return 1.06*(Math.min(r,o)||r||Math.abs(i[0])||1)*Math.pow(n,-.2)}function hP(e){const t=e.maxbins||20,n=e.base||10,r=Math.log(n),i=e.divide||[5,2];let o=e.extent[0],s=e.extent[1],a,u,c,f,h,p;const m=e.span||s-o||Math.abs(o)||1;if(e.step)a=e.step;else if(e.steps){for(f=m/t,h=0,p=e.steps.length;h<p&&e.steps[h]<f;++h);a=e.steps[Math.max(0,h-1)]}else{for(u=Math.ceil(Math.log(t)/r),c=e.minstep||0,a=Math.max(c,Math.pow(n,Math.round(Math.log(m)/r)-u));Math.ceil(m/a)>t;)a*=n;for(h=0,p=i.length;h<p;++h)f=a/i[h],f>=c&&m/f<=t&&(a=f)}f=Math.log(a);const y=f>=0?0:~~(-f/r)+1,v=Math.pow(n,-y-1);return(e.nice||e.nice===void 0)&&(f=Math.floor(o/a+v)*a,o=o<f?f-a:f,s=Math.ceil(s/a)*a),{start:o,stop:s===o?o+a:s,step:a}}var Di=Math.random;function eQ(e){Di=e}function pP(e,t,n,r){if(!e.length)return[void 0,void 0];const i=Float64Array.from(dP(e,r)),o=i.length,s=t;let a,u,c,f;for(c=0,f=Array(s);c<s;++c){for(a=0,u=0;u<o;++u)a+=i[~~(Di()*o)];f[c]=a/o}return f.sort(Is),[tS(f,n/2),tS(f,1-n/2)]}function gP(e,t,n,r){r=r||(p=>p);const i=e.length,o=new Float64Array(i);let s=0,a=1,u=r(e[0]),c=u,f=u+t,h;for(;a<i;++a){if(h=r(e[a]),h>=f){for(c=(u+c)/2;s<a;++s)o[s]=c;f=h+t,u=h}c=h}for(c=(u+c)/2;s<a;++s)o[s]=c;return n?tQ(o,t+t/4):o}function tQ(e,t){const n=e.length;let r=0,i=1,o,s;for(;e[r]===e[i];)++i;for(;i<n;){for(o=i+1;e[i]===e[o];)++o;if(e[i]-e[i-1]<t){for(s=i+(r+o-i-i>>1);s<i;)e[s++]=e[i];for(;s>i;)e[s--]=e[r]}r=i,i=o}return e}function nQ(e){return function(){return e=(1103515245*e+12345)%2147483647,e/2147483647}}function rQ(e,t){t==null&&(t=e,e=0);let n,r,i;const o={min(s){return arguments.length?(n=s||0,i=r-n,o):n},max(s){return arguments.length?(r=s||0,i=r-n,o):r},sample(){return n+Math.floor(i*Di())},pdf(s){return s===Math.floor(s)&&s>=n&&s<r?1/i:0},cdf(s){const a=Math.floor(s);return a<n?0:a>=r?1:(a-n+1)/i},icdf(s){return s>=0&&s<=1?n-1+Math.floor(s*i):NaN}};return o.min(e).max(t)}const mP=Math.sqrt(2*Math.PI),iQ=Math.SQRT2;let vh=NaN;function dv(e,t){e=e||0,t=t??1;let n=0,r=0,i,o;if(vh===vh)n=vh,vh=NaN;else{do n=Di()*2-1,r=Di()*2-1,i=n*n+r*r;while(i===0||i>1);o=Math.sqrt(-2*Math.log(i)/i),n*=o,vh=r*o}return e+n*t}function VA(e,t,n){n=n??1;const r=(e-(t||0))/n;return Math.exp(-.5*r*r)/(n*mP)}function hv(e,t,n){t=t||0,n=n??1;const r=(e-t)/n,i=Math.abs(r);let o;if(i>37)o=0;else{const s=Math.exp(-i*i/2);let a;i<7.07106781186547?(a=.0352624965998911*i+.700383064443688,a=a*i+6.37396220353165,a=a*i+33.912866078383,a=a*i+112.079291497871,a=a*i+221.213596169931,a=a*i+220.206867912376,o=s*a,a=.0883883476483184*i+1.75566716318264,a=a*i+16.064177579207,a=a*i+86.7807322029461,a=a*i+296.564248779674,a=a*i+637.333633378831,a=a*i+793.826512519948,a=a*i+440.413735824752,o=o/a):(a=i+.65,a=i+4/a,a=i+3/a,a=i+2/a,a=i+1/a,o=s/a/2.506628274631)}return r>0?1-o:o}function pv(e,t,n){return e<0||e>1?NaN:(t||0)+(n??1)*iQ*oQ(2*e-1)}function oQ(e){let t=-Math.log((1-e)*(1+e)),n;return t<6.25?(t-=3.125,n=-364441206401782e-35,n=-16850591381820166e-35+n*t,n=128584807152564e-32+n*t,n=11157877678025181e-33+n*t,n=-1333171662854621e-31+n*t,n=20972767875968562e-33+n*t,n=6637638134358324e-30+n*t,n=-4054566272975207e-29+n*t,n=-8151934197605472e-29+n*t,n=26335093153082323e-28+n*t,n=-12975133253453532e-27+n*t,n=-5415412054294628e-26+n*t,n=10512122733215323e-25+n*t,n=-4112633980346984e-24+n*t,n=-29070369957882005e-24+n*t,n=42347877827932404e-23+n*t,n=-13654692000834679e-22+n*t,n=-13882523362786469e-21+n*t,n=.00018673420803405714+n*t,n=-.000740702534166267+n*t,n=-.006033670871430149+n*t,n=.24015818242558962+n*t,n=1.6536545626831027+n*t):t<16?(t=Math.sqrt(t)-3.25,n=22137376921775787e-25,n=9075656193888539e-23+n*t,n=-27517406297064545e-23+n*t,n=18239629214389228e-24+n*t,n=15027403968909828e-22+n*t,n=-4013867526981546e-21+n*t,n=29234449089955446e-22+n*t,n=12475304481671779e-21+n*t,n=-47318229009055734e-21+n*t,n=6828485145957318e-20+n*t,n=24031110387097894e-21+n*t,n=-.0003550375203628475+n*t,n=.0009532893797373805+n*t,n=-.0016882755560235047+n*t,n=.002491442096107851+n*t,n=-.003751208507569241+n*t,n=.005370914553590064+n*t,n=1.0052589676941592+n*t,n=3.0838856104922208+n*t):Number.isFinite(t)?(t=Math.sqrt(t)-5,n=-27109920616438573e-27,n=-2555641816996525e-25+n*t,n=15076572693500548e-25+n*t,n=-3789465440126737e-24+n*t,n=761570120807834e-23+n*t,n=-1496002662714924e-23+n*t,n=2914795345090108e-23+n*t,n=-6771199775845234e-23+n*t,n=22900482228026655e-23+n*t,n=-99298272942317e-20+n*t,n=4526062597223154e-21+n*t,n=-1968177810553167e-20+n*t,n=7599527703001776e-20+n*t,n=-.00021503011930044477+n*t,n=-.00013871931833623122+n*t,n=1.0103004648645344+n*t,n=4.849906401408584+n*t):n=1/0,n*e}function YA(e,t){let n,r;const i={mean(o){return arguments.length?(n=o||0,i):n},stdev(o){return arguments.length?(r=o??1,i):r},sample:()=>dv(n,r),pdf:o=>VA(o,n,r),cdf:o=>hv(o,n,r),icdf:o=>pv(o,n,r)};return i.mean(e).stdev(t)}function XA(e,t){const n=YA();let r=0;const i={data(o){return arguments.length?(e=o,r=o?o.length:0,i.bandwidth(t)):e},bandwidth(o){return arguments.length?(t=o,!t&&e&&(t=GA(e)),i):t},sample(){return e[~~(Di()*r)]+t*n.sample()},pdf(o){let s=0,a=0;for(;a<r;++a)s+=n.pdf((o-e[a])/t);return s/t/r},cdf(o){let s=0,a=0;for(;a<r;++a)s+=n.cdf((o-e[a])/t);return s/r},icdf(){throw Error("KDE icdf not supported.")}};return i.data(e)}function QA(e,t){return e=e||0,t=t??1,Math.exp(e+dv()*t)}function KA(e,t,n){if(e<=0)return 0;t=t||0,n=n??1;const r=(Math.log(e)-t)/n;return Math.exp(-.5*r*r)/(n*mP*e)}function JA(e,t,n){return hv(Math.log(e),t,n)}function ZA(e,t,n){return Math.exp(pv(e,t,n))}function yP(e,t){let n,r;const i={mean(o){return arguments.length?(n=o||0,i):n},stdev(o){return arguments.length?(r=o??1,i):r},sample:()=>QA(n,r),pdf:o=>KA(o,n,r),cdf:o=>JA(o,n,r),icdf:o=>ZA(o,n,r)};return i.mean(e).stdev(t)}function vP(e,t){let n=0,r;function i(s){const a=[];let u=0,c;for(c=0;c<n;++c)u+=a[c]=s[c]==null?1:+s[c];for(c=0;c<n;++c)a[c]/=u;return a}const o={weights(s){return arguments.length?(r=i(t=s||[]),o):t},distributions(s){return arguments.length?(s?(n=s.length,e=s):(n=0,e=[]),o.weights(t)):e},sample(){const s=Di();let a=e[n-1],u=r[0],c=0;for(;c<n-1;u+=r[++c])if(s<u){a=e[c];break}return a.sample()},pdf(s){let a=0,u=0;for(;u<n;++u)a+=r[u]*e[u].pdf(s);return a},cdf(s){let a=0,u=0;for(;u<n;++u)a+=r[u]*e[u].cdf(s);return a},icdf(){throw Error("Mixture icdf not supported.")}};return o.distributions(e).weights(t)}function eC(e,t){return t==null&&(t=e??1,e=0),e+(t-e)*Di()}function tC(e,t,n){return n==null&&(n=t??1,t=0),e>=t&&e<=n?1/(n-t):0}function nC(e,t,n){return n==null&&(n=t??1,t=0),e<t?0:e>n?1:(e-t)/(n-t)}function rC(e,t,n){return n==null&&(n=t??1,t=0),e>=0&&e<=1?t+e*(n-t):NaN}function xP(e,t){let n,r;const i={min(o){return arguments.length?(n=o||0,i):n},max(o){return arguments.length?(r=o??1,i):r},sample:()=>eC(n,r),pdf:o=>tC(o,n,r),cdf:o=>nC(o,n,r),icdf:o=>rC(o,n,r)};return t==null&&(t=e??1,e=0),i.min(e).max(t)}function iC(e,t,n){let r=0,i=0;for(const o of e){const s=n(o);t(o)==null||s==null||isNaN(s)||(r+=(s-r)/++i)}return{coef:[r],predict:()=>r,rSquared:0}}function ng(e,t,n,r){const i=r-e*e,o=Math.abs(i)<1e-24?0:(n-e*t)/i;return[t-o*e,o]}function gv(e,t,n,r){e=e.filter(m=>{let y=t(m),v=n(m);return y!=null&&(y=+y)>=y&&v!=null&&(v=+v)>=v}),r&&e.sort((m,y)=>t(m)-t(y));const i=e.length,o=new Float64Array(i),s=new Float64Array(i);let a=0,u=0,c=0,f,h,p;for(p of e)o[a]=f=+t(p),s[a]=h=+n(p),++a,u+=(f-u)/a,c+=(h-c)/a;for(a=0;a<i;++a)o[a]-=u,s[a]-=c;return[o,s,u,c]}function rg(e,t,n,r){let i=-1,o,s;for(const a of e)o=t(a),s=n(a),o!=null&&(o=+o)>=o&&s!=null&&(s=+s)>=s&&r(o,s,++i)}function ad(e,t,n,r,i){let o=0,s=0;return rg(e,t,n,(a,u)=>{const c=u-i(a),f=u-r;o+=c*c,s+=f*f}),1-o/s}function oC(e,t,n){let r=0,i=0,o=0,s=0,a=0;rg(e,t,n,(f,h)=>{++a,r+=(f-r)/a,i+=(h-i)/a,o+=(f*h-o)/a,s+=(f*f-s)/a});const u=ng(r,i,o,s),c=f=>u[0]+u[1]*f;return{coef:u,predict:c,rSquared:ad(e,t,n,i,c)}}function wP(e,t,n){let r=0,i=0,o=0,s=0,a=0;rg(e,t,n,(f,h)=>{++a,f=Math.log(f),r+=(f-r)/a,i+=(h-i)/a,o+=(f*h-o)/a,s+=(f*f-s)/a});const u=ng(r,i,o,s),c=f=>u[0]+u[1]*Math.log(f);return{coef:u,predict:c,rSquared:ad(e,t,n,i,c)}}function EP(e,t,n){const[r,i,o,s]=gv(e,t,n);let a=0,u=0,c=0,f=0,h=0,p,m,y;rg(e,t,n,(S,A)=>{p=r[h++],m=Math.log(A),y=p*A,a+=(A*m-a)/h,u+=(y-u)/h,c+=(y*m-c)/h,f+=(p*y-f)/h});const[v,w]=ng(u/s,a/s,c/s,f/s),E=S=>Math.exp(v+w*(S-o));return{coef:[Math.exp(v-w*o),w],predict:E,rSquared:ad(e,t,n,s,E)}}function bP(e,t,n){let r=0,i=0,o=0,s=0,a=0,u=0;rg(e,t,n,(h,p)=>{const m=Math.log(h),y=Math.log(p);++u,r+=(m-r)/u,i+=(y-i)/u,o+=(m*y-o)/u,s+=(m*m-s)/u,a+=(p-a)/u});const c=ng(r,i,o,s),f=h=>c[0]*Math.pow(h,c[1]);return c[0]=Math.exp(c[0]),{coef:c,predict:f,rSquared:ad(e,t,n,a,f)}}function sC(e,t,n){const[r,i,o,s]=gv(e,t,n),a=r.length;let u=0,c=0,f=0,h=0,p=0,m,y,v,w;for(m=0;m<a;)y=r[m],v=i[m++],w=y*y,u+=(w-u)/m,c+=(w*y-c)/m,f+=(w*w-f)/m,h+=(y*v-h)/m,p+=(w*v-p)/m;const E=f-u*u,S=u*E-c*c,A=(p*u-h*c)/S,C=(h*E-p*c)/S,k=-A*u,D=$=>($=$-o,A*$*$+C*$+k+s);return{coef:[k-C*o+A*o*o+s,C-2*A*o,A],predict:D,rSquared:ad(e,t,n,s,D)}}function SP(e,t,n,r){if(r===0)return iC(e,t,n);if(r===1)return oC(e,t,n);if(r===2)return sC(e,t,n);const[i,o,s,a]=gv(e,t,n),u=i.length,c=[],f=[],h=r+1;let p,m,y,v,w;for(p=0;p<h;++p){for(y=0,v=0;y<u;++y)v+=Math.pow(i[y],p)*o[y];for(c.push(v),w=new Float64Array(h),m=0;m<h;++m){for(y=0,v=0;y<u;++y)v+=Math.pow(i[y],p+m);w[m]=v}f.push(w)}f.push(c);const E=aQ(f),S=A=>{A-=s;let C=a+E[0]+E[1]*A+E[2]*A*A;for(p=3;p<h;++p)C+=E[p]*Math.pow(A,p);return C};return{coef:sQ(h,E,-s,a),predict:S,rSquared:ad(e,t,n,a,S)}}function sQ(e,t,n,r){const i=Array(e);let o,s,a,u;for(o=0;o<e;++o)i[o]=0;for(o=e-1;o>=0;--o)for(a=t[o],u=1,i[o]+=a,s=1;s<=o;++s)u*=(o+1-s)/s,i[o-s]+=a*Math.pow(n,s)*u;return i[0]+=r,i}function aQ(e){const t=e.length-1,n=[];let r,i,o,s,a;for(r=0;r<t;++r){for(s=r,i=r+1;i<t;++i)Math.abs(e[r][i])>Math.abs(e[r][s])&&(s=i);for(o=r;o<t+1;++o)a=e[o][r],e[o][r]=e[o][s],e[o][s]=a;for(i=r+1;i<t;++i)for(o=t;o>=r;o--)e[o][i]-=e[o][r]*e[r][i]/e[r][r]}for(i=t-1;i>=0;--i){for(a=0,o=i+1;o<t;++o)a+=e[o][i]*n[o];n[i]=(e[t][i]-a)/e[i][i]}return n}const vT=2,xT=1e-12;function _P(e,t,n,r){const[i,o,s,a]=gv(e,t,n,!0),u=i.length,c=Math.max(2,~~(r*u)),f=new Float64Array(u),h=new Float64Array(u),p=new Float64Array(u).fill(1);for(let m=-1;++m<=vT;){const y=[0,c-1];for(let w=0;w<u;++w){const E=i[w],S=y[0],A=y[1],C=E-i[S]>i[A]-E?S:A;let k=0,D=0,$=0,M=0,T=0;const L=1/Math.abs(i[C]-E||1);for(let W=S;W<=A;++W){const I=i[W],N=o[W],U=uQ(Math.abs(E-I)*L)*p[W],Y=I*U;k+=U,D+=Y,$+=N*U,M+=N*Y,T+=I*Y}const[O,X]=ng(D/k,$/k,M/k,T/k);f[w]=O+X*E,h[w]=Math.abs(o[w]-f[w]),lQ(i,w+1,y)}if(m===vT)break;const v=l8(h);if(Math.abs(v)<xT)break;for(let w=0,E,S;w<u;++w)E=h[w]/(6*v),p[w]=E>=1?xT:(S=1-E*E)*S}return cQ(i,f,s,a)}function uQ(e){return(e=1-e*e*e)*e*e}function lQ(e,t,n){const r=e[t];let i=n[0],o=n[1]+1;if(!(o>=e.length))for(;t>i&&e[o]-r<=r-e[i];)n[0]=++i,n[1]=o,++o}function cQ(e,t,n,r){const i=e.length,o=[];let s=0,a=0,u=[],c;for(;s<i;++s)c=e[s]+n,u[0]===c?u[1]+=(t[s]-u[1])/++a:(a=0,u[1]+=r,u=[c,t[s]],o.push(u));return u[1]+=r,o}const fQ=.5*Math.PI/180;function mv(e,t,n,r){n=n||25,r=Math.max(n,r||200);const i=v=>[v,e(v)],o=t[0],s=t[1],a=s-o,u=a/r,c=[i(o)],f=[];if(n===r){for(let v=1;v<r;++v)c.push(i(o+v/n*a));return c.push(i(s)),c}else{f.push(i(s));for(let v=n;--v>0;)f.push(i(o+v/n*a))}let h=c[0],p=f[f.length-1];const m=1/a,y=dQ(h[1],f);for(;p;){const v=i((h[0]+p[0])/2);v[0]-h[0]>=u&&hQ(h,v,p,m,y)>fQ?f.push(v):(h=p,c.push(p),f.pop()),p=f[f.length-1]}return c}function dQ(e,t){let n=e,r=e;const i=t.length;for(let o=0;o<i;++o){const s=t[o][1];s<n&&(n=s),s>r&&(r=s)}return 1/(r-n)}function hQ(e,t,n,r,i){const o=Math.atan2(i*(n[1]-e[1]),r*(n[0]-e[0])),s=Math.atan2(i*(t[1]-e[1]),r*(t[0]-e[0]));return Math.abs(o-s)}function pQ(e){return t=>{const n=e.length;let r=1,i=String(e[0](t));for(;r<n;++r)i+="|"+e[r](t);return i}}function fS(e){return!e||!e.length?function(){return""}:e.length===1?e[0]:pQ(e)}function AP(e,t,n){return n||e+(t?"_"+t:"")}const gE=()=>{},gQ={init:gE,add:gE,rem:gE,idx:0},_p={values:{init:e=>e.cell.store=!0,value:e=>e.cell.data.values(),idx:-1},count:{value:e=>e.cell.num},__count__:{value:e=>e.missing+e.valid},missing:{value:e=>e.missing},valid:{value:e=>e.valid},sum:{init:e=>e.sum=0,value:e=>e.valid?e.sum:void 0,add:(e,t)=>e.sum+=+t,rem:(e,t)=>e.sum-=t},product:{init:e=>e.product=1,value:e=>e.valid?e.product:void 0,add:(e,t)=>e.product*=t,rem:(e,t)=>e.product/=t},mean:{init:e=>e.mean=0,value:e=>e.valid?e.mean:void 0,add:(e,t)=>(e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid),rem:(e,t)=>(e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean)},average:{value:e=>e.valid?e.mean:void 0,req:["mean"],idx:1},variance:{init:e=>e.dev=0,value:e=>e.valid>1?e.dev/(e.valid-1):void 0,add:(e,t)=>e.dev+=e.mean_d*(t-e.mean),rem:(e,t)=>e.dev-=e.mean_d*(t-e.mean),req:["mean"],idx:1},variancep:{value:e=>e.valid>1?e.dev/e.valid:void 0,req:["variance"],idx:2},stdev:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:e=>e.valid>1?Math.sqrt(e.dev/e.valid):void 0,req:["variance"],idx:2},stderr:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid*(e.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:e=>e.cell.data.distinct(e.get),req:["values"],idx:3},ci0:{value:e=>e.cell.data.ci0(e.get),req:["values"],idx:3},ci1:{value:e=>e.cell.data.ci1(e.get),req:["values"],idx:3},median:{value:e=>e.cell.data.q2(e.get),req:["values"],idx:3},q1:{value:e=>e.cell.data.q1(e.get),req:["values"],idx:3},q3:{value:e=>e.cell.data.q3(e.get),req:["values"],idx:3},min:{init:e=>e.min=void 0,value:e=>e.min=Number.isNaN(e.min)?e.cell.data.min(e.get):e.min,add:(e,t)=>{(t<e.min||e.min===void 0)&&(e.min=t)},rem:(e,t)=>{t<=e.min&&(e.min=NaN)},req:["values"],idx:4},max:{init:e=>e.max=void 0,value:e=>e.max=Number.isNaN(e.max)?e.cell.data.max(e.get):e.max,add:(e,t)=>{(t>e.max||e.max===void 0)&&(e.max=t)},rem:(e,t)=>{t>=e.max&&(e.max=NaN)},req:["values"],idx:4},argmin:{init:e=>e.argmin=void 0,value:e=>e.argmin||e.cell.data.argmin(e.get),add:(e,t,n)=>{t<e.min&&(e.argmin=n)},rem:(e,t)=>{t<=e.min&&(e.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:e=>e.argmax=void 0,value:e=>e.argmax||e.cell.data.argmax(e.get),add:(e,t,n)=>{t>e.max&&(e.argmax=n)},rem:(e,t)=>{t>=e.max&&(e.argmax=void 0)},req:["max","values"],idx:3},exponential:{init:(e,t)=>{e.exp=0,e.exp_r=t},value:e=>e.valid?e.exp*(1-e.exp_r)/(1-e.exp_r**e.valid):void 0,add:(e,t)=>e.exp=e.exp_r*e.exp+t,rem:(e,t)=>e.exp=(e.exp-t/e.exp_r**(e.valid-1))/e.exp_r},exponentialb:{value:e=>e.valid?e.exp*(1-e.exp_r):void 0,req:["exponential"],idx:1}},ig=Object.keys(_p).filter(e=>e!=="__count__");function mQ(e,t){return(n,r)=>qe({name:e,aggregate_param:r,out:n||e},gQ,t)}[...ig,"__count__"].forEach(e=>{_p[e]=mQ(e,_p[e])});function CP(e,t,n){return _p[e](n,t)}function kP(e,t){return e.idx-t.idx}function yQ(e){const t={};e.forEach(r=>t[r.name]=r);const n=r=>{r.req&&r.req.forEach(i=>{t[i]||n(t[i]=_p[i]())})};return e.forEach(n),Object.values(t).sort(kP)}function vQ(){this.valid=0,this.missing=0,this._ops.forEach(e=>e.aggregate_param==null?e.init(this):e.init(this,e.aggregate_param))}function xQ(e,t){if(e==null||e===""){++this.missing;return}e===e&&(++this.valid,this._ops.forEach(n=>n.add(this,e,t)))}function wQ(e,t){if(e==null||e===""){--this.missing;return}e===e&&(--this.valid,this._ops.forEach(n=>n.rem(this,e,t)))}function EQ(e){return this._out.forEach(t=>e[t.out]=t.value(this)),e}function $P(e,t){const n=t||tr,r=yQ(e),i=e.slice().sort(kP);function o(s){this._ops=r,this._out=i,this.cell=s,this.init()}return o.prototype.init=vQ,o.prototype.add=xQ,o.prototype.rem=wQ,o.prototype.set=EQ,o.prototype.get=n,o.fields=e.map(s=>s.out),o}function aC(e){this._key=e?ki(e):Te,this.reset()}const Pn=aC.prototype;Pn.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null};Pn.add=function(e){this._add.push(e)};Pn.rem=function(e){this._rem.push(e)};Pn.values=function(){if(this._get=null,this._rem.length===0)return this._add;const e=this._add,t=this._rem,n=this._key,r=e.length,i=t.length,o=Array(r-i),s={};let a,u,c;for(a=0;a<i;++a)s[n(t[a])]=1;for(a=0,u=0;a<r;++a)s[n(c=e[a])]?s[n(c)]=0:o[u++]=c;return this._rem=[],this._add=o};Pn.distinct=function(e){const t=this.values(),n={};let r=t.length,i=0,o;for(;--r>=0;)o=e(t[r])+"",Ee(n,o)||(n[o]=1,++i);return i};Pn.extent=function(e){if(this._get!==e||!this._ext){const t=this.values(),n=H4(t,e);this._ext=[t[n[0]],t[n[1]]],this._get=e}return this._ext};Pn.argmin=function(e){return this.extent(e)[0]||{}};Pn.argmax=function(e){return this.extent(e)[1]||{}};Pn.min=function(e){const t=this.extent(e)[0];return t!=null?e(t):void 0};Pn.max=function(e){const t=this.extent(e)[1];return t!=null?e(t):void 0};Pn.quartile=function(e){return(this._get!==e||!this._q)&&(this._q=HA(this.values(),e),this._get=e),this._q};Pn.q1=function(e){return this.quartile(e)[0]};Pn.q2=function(e){return this.quartile(e)[1]};Pn.q3=function(e){return this.quartile(e)[2]};Pn.ci=function(e){return(this._get!==e||!this._ci)&&(this._ci=pP(this.values(),1e3,.05,e),this._get=e),this._ci};Pn.ci0=function(e){return this.ci(e)[0]};Pn.ci1=function(e){return this.ci(e)[1]};function eu(e){J.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}eu.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:ig},{name:"aggregate_params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]};pe(eu,J,{transform(e,t){const n=this,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.modified();return n.stamp=r.stamp,n.value&&(i||t.modified(n._inputs,!0))?(n._prev=n.value,n.value=i?n.init(e):Object.create(null),t.visit(t.SOURCE,o=>n.add(o))):(n.value=n.value||n.init(e),t.visit(t.REM,o=>n.rem(o)),t.visit(t.ADD,o=>n.add(o))),r.modifies(n._outputs),n._drop=e.drop!==!1,e.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),t.clean()&&n._drop&&r.clean(!0).runAfter(()=>this.clean()),n.changes(r)},cross(){const e=this,t=e.value,n=e._dnames,r=n.map(()=>({})),i=n.length;function o(a){let u,c,f,h;for(u in a)for(f=a[u].tuple,c=0;c<i;++c)r[c][h=f[n[c]]]=h}o(e._prev),o(t);function s(a,u,c){const f=n[c],h=r[c++];for(const p in h){const m=a?a+"|"+p:p;u[f]=h[p],c<i?s(m,u,c):t[m]||e.cell(m,u)}}s("",{},0)},init(e){const t=this._inputs=[],n=this._outputs=[],r={};function i(S){const A=xe(Xn(S)),C=A.length;let k=0,D;for(;k<C;++k)r[D=A[k]]||(r[D]=1,t.push(D))}this._dims=xe(e.groupby),this._dnames=this._dims.map(S=>{const A=Wt(S);return i(S),n.push(A),A}),this.cellkey=e.key?e.key:fS(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];const o=e.fields||[null],s=e.ops||["count"],a=e.aggregate_params||[null],u=e.as||[],c=o.length,f={};let h,p,m,y,v,w,E;for(c!==s.length&&te("Unmatched number of fields and aggregate ops."),E=0;E<c;++E){if(h=o[E],p=s[E],m=a[E]||null,h==null&&p!=="count"&&te("Null aggregate field specified."),v=Wt(h),w=AP(p,v,u[E]),n.push(w),p==="count"){this._counts.push(w);continue}y=f[v],y||(i(h),y=f[v]=[],y.field=h,this._measures.push(y)),p!=="count"&&(this._countOnly=!1),y.push(CP(p,m,w))}return this._measures=this._measures.map(S=>$P(S,S.field)),Object.create(null)},cellkey:fS(),cell(e,t){let n=this.value[e];return n?n.num===0&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[e]=this.newcell(e,t),this._adds[this._alen++]=n),n},newcell(e,t){const n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){const r=this._measures,i=r.length;n.agg=Array(i);for(let o=0;o<i;++o)n.agg[o]=new r[o](n)}return n.store&&(n.data=new aC),n},newtuple(e,t){const n=this._dnames,r=this._dims,i=r.length,o={};for(let s=0;s<i;++s)o[n[s]]=r[s](e);return t?sP(t.tuple,o):ct(o)},clean(){const e=this.value;for(const t in e)e[t].num===0&&delete e[t]},add(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(e);const r=n.agg;for(let i=0,o=r.length;i<o;++i)r[i].add(r[i].get(e),e)},rem(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(e);const r=n.agg;for(let i=0,o=r.length;i<o;++i)r[i].rem(r[i].get(e),e)},celltuple(e){const t=e.tuple,n=this._counts;e.store&&e.data.values();for(let r=0,i=n.length;r<i;++r)t[n[r]]=e.num;if(!this._countOnly){const r=e.agg;for(let i=0,o=r.length;i<o;++i)r[i].set(t)}return t},changes(e){const t=this._adds,n=this._mods,r=this._prev,i=this._drop,o=e.add,s=e.rem,a=e.mod;let u,c,f,h;if(r)for(c in r)u=r[c],(!i||u.num)&&s.push(u.tuple);for(f=0,h=this._alen;f<h;++f)o.push(this.celltuple(t[f])),t[f]=null;for(f=0,h=this._mlen;f<h;++f)u=n[f],(u.num===0&&i?s:a).push(this.celltuple(u)),n[f]=null;return this._alen=this._mlen=0,this._prev=null,e}});const bQ=1e-14;function uC(e){J.call(this,null,e)}uC.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]};pe(uC,J,{transform(e,t){const n=e.interval!==!1,r=this._bins(e),i=r.start,o=r.step,s=e.as||["bin0","bin1"],a=s[0],u=s[1];let c;return e.modified()?(t=t.reflow(!0),c=t.SOURCE):c=t.modified(Xn(e.field))?t.ADD_MOD:t.ADD,t.visit(c,n?f=>{const h=r(f);f[a]=h,f[u]=h==null?null:i+o*(1+(h-i)/o)}:f=>f[a]=r(f)),t.modifies(n?s:a)},_bins(e){if(this.value&&!e.modified())return this.value;const t=e.field,n=hP(e),r=n.step;let i=n.start,o=i+Math.ceil((n.stop-i)/r)*r,s,a;(s=e.anchor)!=null&&(a=s-(i+r*Math.floor((s-i)/r)),i+=a,o+=a);const u=function(c){let f=Vn(t(c));return f==null?null:f<i?-1/0:f>o?1/0:(f=Math.max(i,Math.min(f,o-r)),i+r*Math.floor(bQ+(f-i)/r))};return u.start=i,u.stop=n.stop,u.step=r,this.value=qr(u,Xn(t),e.name||"bin_"+Wt(t))}});function FP(e,t,n){const r=e;let i=t||[],o=n||[],s={},a=0;return{add:u=>o.push(u),remove:u=>s[r(u)]=++a,size:()=>i.length,data:(u,c)=>(a&&(i=i.filter(f=>!s[r(f)]),s={},a=0),c&&u&&i.sort(u),o.length&&(i=u?Q4(u,i,o.sort(u)):i.concat(o),o=[]),i)}}function lC(e){J.call(this,[],e)}lC.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]};pe(lC,J,{transform(e,t){const n=t.fork(t.ALL),r=FP(Te,this.value,n.materialize(n.ADD).add),i=e.sort,o=t.changed()||i&&(e.modified("sort")||t.modified(i.fields));return n.visit(n.REM,r.remove),this.modified(o),this.value=n.source=r.data(Yl(i),o),t.source&&t.source.root&&(this.value.root=t.source.root),n}});function DP(e){Et.call(this,null,SQ,e)}pe(DP,Et);function SQ(e){return this.value&&!e.modified()?this.value:bA(e.fields,e.orders)}function cC(e){J.call(this,null,e)}cC.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]};function _Q(e,t,n){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase();break}return e.match(n)}pe(cC,J,{transform(e,t){const n=h=>p=>{for(var m=_Q(a(p),e.case,o)||[],y,v=0,w=m.length;v<w;++v)s.test(y=m[v])||h(y)},r=this._parameterCheck(e,t),i=this._counts,o=this._match,s=this._stop,a=e.field,u=e.as||["text","count"],c=n(h=>i[h]=1+(i[h]||0)),f=n(h=>i[h]-=1);return r?t.visit(t.SOURCE,c):(t.visit(t.ADD,c),t.visit(t.REM,f)),this._finish(t,u)},_parameterCheck(e,t){let n=!1;return(e.modified("stopwords")||!this._stop)&&(this._stop=new RegExp("^"+(e.stopwords||"")+"$","i"),n=!0),(e.modified("pattern")||!this._match)&&(this._match=new RegExp(e.pattern||"[\\w']+","g"),n=!0),(e.modified("field")||t.modified(e.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish(e,t){const n=this._counts,r=this._tuples||(this._tuples={}),i=t[0],o=t[1],s=e.fork(e.NO_SOURCE|e.NO_FIELDS);let a,u,c;for(a in n)u=r[a],c=n[a]||0,!u&&c?(r[a]=u=ct({}),u[i]=a,u[o]=c,s.add.push(u)):c===0?(u&&s.rem.push(u),n[a]=null,r[a]=null):u[o]!==c&&(u[o]=c,s.mod.push(u));return s.modifies(t)}});function fC(e){J.call(this,null,e)}fC.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]};pe(fC,J,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.as||["a","b"],i=r[0],o=r[1],s=!this.value||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter");let a=this.value;return s?(a&&(n.rem=a),a=t.materialize(t.SOURCE).source,n.add=this.value=AQ(a,i,o,e.filter||$i)):n.mod=a,n.source=this.value,n.modifies(r)}});function AQ(e,t,n,r){for(var i=[],o={},s=e.length,a=0,u,c;a<s;++a)for(o[t]=c=e[a],u=0;u<s;++u)o[n]=e[u],r(o)&&(i.push(ct(o)),o={},o[t]=c);return i}const wT={kde:XA,mixture:vP,normal:YA,lognormal:yP,uniform:xP},CQ="distributions",ET="function",kQ="field";function MP(e,t){const n=e[ET];Ee(wT,n)||te("Unknown distribution function: "+n);const r=wT[n]();for(const i in e)i===kQ?r.data((e.from||t()).map(e[i])):i===CQ?r[i](e[i].map(o=>MP(o,t))):typeof r[i]===ET&&r[i](e[i]);return r}function dC(e){J.call(this,null,e)}const TP=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],$Q={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:TP},{name:"weights",type:"number",array:!0}]};dC.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:TP.concat($Q)},{name:"as",type:"string",array:!0,default:["value","density"]}]};pe(dC,J,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=MP(e.distribution,FQ(t)),i=e.steps||e.minsteps||25,o=e.steps||e.maxsteps||200;let s=e.method||"pdf";s!=="pdf"&&s!=="cdf"&&te("Invalid density method: "+s),!e.extent&&!r.data&&te("Missing density extent parameter."),s=r[s];const a=e.as||["value","density"],u=e.extent||Ho(r.data()),c=mv(s,u,i,o).map(f=>{const h={};return h[a[0]]=f[0],h[a[1]]=f[1],ct(h)});this.value&&(n.rem=this.value),this.value=n.add=n.source=c}return n}});function FQ(e){return()=>e.materialize(e.SOURCE).source}function NP(e,t){return e?e.map((n,r)=>t[r]||Wt(n)):null}function hC(e,t,n){const r=[],i=h=>h(u);let o,s,a,u,c,f;if(t==null)r.push(e.map(n));else for(o={},s=0,a=e.length;s<a;++s)u=e[s],c=t.map(i),f=o[c],f||(o[c]=f=[],f.dims=c,r.push(f)),f.push(n(u));return r}const RP="bin";function pC(e){J.call(this,null,e)}pC.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:RP}]};const DQ=(e,t)=>tg(Ho(e,t))/30;pe(pC,J,{transform(e,t){if(this.value&&!(e.modified()||t.changed()))return t;const n=t.materialize(t.SOURCE).source,r=hC(t.source,e.groupby,tr),i=e.smooth||!1,o=e.field,s=e.step||DQ(n,o),a=Yl((y,v)=>o(y)-o(v)),u=e.as||RP,c=r.length;let f=1/0,h=-1/0,p=0,m;for(;p<c;++p){const y=r[p].sort(a);m=-1;for(const v of gP(y,s,i,o))v<f&&(f=v),v>h&&(h=v),y[++m][u]=v}return this.value={start:f,stop:h,step:s},t.reflow(!0).modifies(u)}});function OP(e){Et.call(this,null,MQ,e),this.modified(!0)}pe(OP,Et);function MQ(e){const t=e.expr;return this.value&&!e.modified("expr")?this.value:qr(n=>t(n,e),Xn(t),Wt(t))}function gC(e){J.call(this,[void 0,void 0],e)}gC.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]};pe(gC,J,{transform(e,t){const n=this.value,r=e.field,i=t.changed()||t.modified(r.fields)||e.modified("field");let o=n[0],s=n[1];if((i||o==null)&&(o=1/0,s=-1/0),t.visit(i?t.SOURCE:t.ADD,a=>{const u=Vn(r(a));u!=null&&(u<o&&(o=u),u>s&&(s=u))}),!Number.isFinite(o)||!Number.isFinite(s)){let a=Wt(r);a&&(a=` for field "${a}"`),t.dataflow.warn(`Infinite extent${a}: [${o}, ${s}]`),o=s=void 0}this.value=[o,s]}});function mC(e,t){Et.call(this,e),this.parent=t,this.count=0}pe(mC,Et,{connect(e){return this.detachSubflow=e.detachSubflow,this.targets().add(e),e.source=this},add(e){this.count+=1,this.value.add.push(e)},rem(e){this.count-=1,this.value.rem.push(e)},mod(e){this.value.mod.push(e)},init(e){this.value.init(e,e.NO_SOURCE)},evaluate(){return this.value}});function yv(e){J.call(this,{},e),this._keys=td();const t=this._targets=[];t.active=0,t.forEach=n=>{for(let r=0,i=t.active;r<i;++r)n(t[r],r,t)}}pe(yv,J,{activate(e){this._targets[this._targets.active++]=e},subflow(e,t,n,r){const i=this.value;let o=Ee(i,e)&&i[e],s,a;return o?o.value.stamp<n.stamp&&(o.init(n),this.activate(o)):(a=r||(a=this._group[e])&&a.tuple,s=n.dataflow,o=new mC(n.fork(n.NO_SOURCE),this),s.add(o).connect(t(s,e,a)),i[e]=o,this.activate(o)),o},clean(){const e=this.value;let t=0;for(const n in e)if(e[n].count===0){const r=e[n].detachSubflow;r&&r(),delete e[n],++t}if(t){const n=this._targets.filter(r=>r&&r.count>0);this.initTargets(n)}},initTargets(e){const t=this._targets,n=t.length,r=e?e.length:0;let i=0;for(;i<r;++i)t[i]=e[i];for(;i<n&&t[i]!=null;++i)t[i]=null;t.active=r},transform(e,t){const n=t.dataflow,r=e.key,i=e.subflow,o=this._keys,s=e.modified("key"),a=u=>this.subflow(u,i,t);return this._group=e.group||{},this.initTargets(),t.visit(t.REM,u=>{const c=Te(u),f=o.get(c);f!==void 0&&(o.delete(c),a(f).rem(u))}),t.visit(t.ADD,u=>{const c=r(u);o.set(Te(u),c),a(c).add(u)}),s||t.modified(r.fields)?t.visit(t.MOD,u=>{const c=Te(u),f=o.get(c),h=r(u);f===h?a(h).mod(u):(o.set(c,h),a(f).rem(u),a(h).add(u))}):t.changed(t.MOD)&&t.visit(t.MOD,u=>{a(o.get(Te(u))).mod(u)}),s&&t.visit(t.REFLOW,u=>{const c=Te(u),f=o.get(c),h=r(u);f!==h&&(o.set(c,h),a(f).rem(u),a(h).add(u))}),t.clean()?n.runAfter(()=>{this.clean(),o.clean()}):o.empty>n.cleanThreshold&&n.runAfter(o.clean),t}});function PP(e){Et.call(this,null,TQ,e)}pe(PP,Et);function TQ(e){return this.value&&!e.modified()?this.value:ne(e.name)?xe(e.name).map(t=>ki(t)):ki(e.name,e.as)}function yC(e){J.call(this,td(),e)}yC.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]};pe(yC,J,{transform(e,t){const n=t.dataflow,r=this.value,i=t.fork(),o=i.add,s=i.rem,a=i.mod,u=e.expr;let c=!0;t.visit(t.REM,h=>{const p=Te(h);r.has(p)?r.delete(p):s.push(h)}),t.visit(t.ADD,h=>{u(h,e)?o.push(h):r.set(Te(h),1)});function f(h){const p=Te(h),m=u(h,e),y=r.get(p);m&&y?(r.delete(p),o.push(h)):!m&&!y?(r.set(p,1),s.push(h)):c&&m&&!y&&a.push(h)}return t.visit(t.MOD,f),e.modified()&&(c=!1,t.visit(t.REFLOW,f)),r.empty>n.cleanThreshold&&n.runAfter(r.clean),i}});function vC(e){J.call(this,[],e)}vC.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]};pe(vC,J,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=NP(r,e.as||[]),o=e.index||null,s=i.length;return n.rem=this.value,t.visit(t.SOURCE,a=>{const u=r.map(y=>y(a)),c=u.reduce((y,v)=>Math.max(y,v.length),0);let f=0,h,p,m;for(;f<c;++f){for(p=UA(a),h=0;h<s;++h)p[i[h]]=(m=u[h][f])==null?null:m;o&&(p[o]=f),n.add.push(p)}}),this.value=n.source=n.add,o&&n.modifies(o),n.modifies(i)}});function xC(e){J.call(this,[],e)}xC.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]};pe(xC,J,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=r.map(Wt),o=e.as||["key","value"],s=o[0],a=o[1],u=r.length;return n.rem=this.value,t.visit(t.SOURCE,c=>{for(let f=0,h;f<u;++f)h=UA(c),h[s]=i[f],h[a]=r[f](c),n.add.push(h)}),this.value=n.source=n.add,n.modifies(o)}});function wC(e){J.call(this,null,e)}wC.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]};pe(wC,J,{transform(e,t){const n=e.expr,r=e.as,i=e.modified(),o=e.initonly?t.ADD:i?t.SOURCE:t.modified(n.fields)||t.modified(r)?t.ADD_MOD:t.ADD;return i&&(t=t.materialize().reflow(!0)),e.initonly||t.modifies(r),t.visit(o,s=>s[r]=n(s,e))}});function LP(e){J.call(this,[],e)}pe(LP,J,{transform(e,t){const n=t.fork(t.ALL),r=e.generator;let i=this.value,o=e.size-i.length,s,a,u;if(o>0){for(s=[];--o>=0;)s.push(u=ct(r(e))),i.push(u);n.add=n.add.length?n.materialize(n.ADD).add.concat(s):s}else a=i.slice(0,-o),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(a):a,i=i.slice(-o);return n.source=this.value=i,n}});const um={value:"value",median:l8,mean:pV,min:eS,max:dl},NQ=[];function EC(e){J.call(this,[],e)}EC.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]};function RQ(e){var t=e.method||um.value,n;if(um[t]==null)te("Unrecognized imputation method: "+t);else return t===um.value?(n=e.value!==void 0?e.value:0,()=>n):um[t]}function OQ(e){const t=e.field;return n=>n?t(n):NaN}pe(EC,J,{transform(e,t){var n=t.fork(t.ALL),r=RQ(e),i=OQ(e),o=Wt(e.field),s=Wt(e.key),a=(e.groupby||[]).map(Wt),u=PQ(t.source,e.groupby,e.key,e.keyvals),c=[],f=this.value,h=u.domain.length,p,m,y,v,w,E,S,A,C,k;for(w=0,A=u.length;w<A;++w)for(p=u[w],y=p.values,m=NaN,S=0;S<h;++S)if(p[S]==null){for(v=u.domain[S],k={_impute:!0},E=0,C=y.length;E<C;++E)k[a[E]]=y[E];k[s]=v,k[o]=Number.isNaN(m)?m=r(p,i):m,c.push(ct(k))}return c.length&&(n.add=n.materialize(n.ADD).add.concat(c)),f.length&&(n.rem=n.materialize(n.REM).rem.concat(f)),this.value=c,n}});function PQ(e,t,n,r){var i=E=>E(w),o=[],s=r?r.slice():[],a={},u={},c,f,h,p,m,y,v,w;for(s.forEach((E,S)=>a[E]=S+1),p=0,v=e.length;p<v;++p)w=e[p],y=n(w),m=a[y]||(a[y]=s.push(y)),f=(c=t?t.map(i):NQ)+"",(h=u[f])||(h=u[f]=[],o.push(h),h.values=c),h[m-1]=w;return o.domain=s,o}function bC(e){eu.call(this,e)}bC.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:ig},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]};pe(bC,eu,{transform(e,t){const n=this,r=e.modified();let i;return n.value&&(r||t.modified(n._inputs,!0))?(i=n.value=r?n.init(e):{},t.visit(t.SOURCE,o=>n.add(o))):(i=n.value=n.value||this.init(e),t.visit(t.REM,o=>n.rem(o)),t.visit(t.ADD,o=>n.add(o))),n.changes(),t.visit(t.SOURCE,o=>{qe(o,i[n.cellkey(o)].tuple)}),t.reflow(r).modifies(this._outputs)},changes(){const e=this._adds,t=this._mods;let n,r;for(n=0,r=this._alen;n<r;++n)this.celltuple(e[n]),e[n]=null;for(n=0,r=this._mlen;n<r;++n)this.celltuple(t[n]),t[n]=null;this._alen=this._mlen=0}});function SC(e){J.call(this,null,e)}SC.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]};pe(SC,J,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=t.materialize(t.SOURCE).source,i=hC(r,e.groupby,e.field),o=(e.groupby||[]).map(Wt),s=e.bandwidth,a=e.cumulative?"cdf":"pdf",u=e.as||["value","density"],c=[];let f=e.extent,h=e.steps||e.minsteps||25,p=e.steps||e.maxsteps||200;a!=="pdf"&&a!=="cdf"&&te("Invalid density method: "+a),e.resolve==="shared"&&(f||(f=Ho(r,e.field)),h=p=e.steps||p),i.forEach(m=>{const y=XA(m,s)[a],v=e.counts?m.length:1,w=f||Ho(m);mv(y,w,h,p).forEach(E=>{const S={};for(let A=0;A<o.length;++A)S[o[A]]=m.dims[A];S[u[0]]=E[0],S[u[1]]=E[1]*v,c.push(ct(S))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=c}return n}});function zP(e){Et.call(this,null,LQ,e)}pe(zP,Et);function LQ(e){return this.value&&!e.modified()?this.value:AA(e.fields,e.flat)}function IP(e){J.call(this,[],e),this._pending=null}pe(IP,J,{transform(e,t){const n=t.dataflow;return this._pending?mE(this,t,this._pending):zQ(e)?t.StopPropagation:e.values?mE(this,t,n.parse(e.values,e.format)):e.async?{async:n.request(e.url,e.format).then(i=>(this._pending=xe(i.data),o=>o.touch(this)))}:n.request(e.url,e.format).then(r=>mE(this,t,xe(r.data)))}});function zQ(e){return e.modified("async")&&!(e.modified("values")||e.modified("url")||e.modified("format"))}function mE(e,t,n){n.forEach(ct);const r=t.fork(t.NO_FIELDS&t.NO_SOURCE);return r.rem=e.value,e.value=r.source=r.add=n,e._pending=null,r.rem.length&&r.clean(!0),r}function _C(e){J.call(this,{},e)}_C.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]};pe(_C,J,{transform(e,t){const n=e.fields,r=e.index,i=e.values,o=e.default==null?null:e.default,s=e.modified(),a=n.length;let u=s?t.SOURCE:t.ADD,c=t,f=e.as,h,p,m;return i?(p=i.length,a>1&&!f&&te('Multi-field lookup requires explicit "as" parameter.'),f&&f.length!==a*p&&te('The "as" parameter has too few output field names.'),f=f||i.map(Wt),h=function(y){for(var v=0,w=0,E,S;v<a;++v)if(S=r.get(n[v](y)),S==null)for(E=0;E<p;++E,++w)y[f[w]]=o;else for(E=0;E<p;++E,++w)y[f[w]]=i[E](S)}):(f||te("Missing output field names."),h=function(y){for(var v=0,w;v<a;++v)w=r.get(n[v](y)),y[f[v]]=w??o}),s?c=t.reflow(!0):(m=n.some(y=>t.modified(y.fields)),u|=m?t.MOD:0),t.visit(u,h),c.modifies(f)}});function BP(e){Et.call(this,null,IQ,e)}pe(BP,Et);function IQ(e){if(this.value&&!e.modified())return this.value;const t=e.extents,n=t.length;let r=1/0,i=-1/0,o,s;for(o=0;o<n;++o)s=t[o],s[0]<r&&(r=s[0]),s[1]>i&&(i=s[1]);return[r,i]}function UP(e){Et.call(this,null,BQ,e)}pe(UP,Et);function BQ(e){return this.value&&!e.modified()?this.value:e.values.reduce((t,n)=>t.concat(n),[])}function jP(e){J.call(this,null,e)}pe(jP,J,{transform(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function AC(e){eu.call(this,e)}AC.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:ig,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]};pe(AC,eu,{_transform:eu.prototype.transform,transform(e,t){return this._transform(UQ(e,t),t)}});function UQ(e,t){const n=e.field,r=e.value,i=(e.op==="count"?"__count__":e.op)||"sum",o=Xn(n).concat(Xn(r)),s=WQ(n,e.limit||0,t);return t.changed()&&e.set("__pivot__",null,null,!0),{key:e.key,groupby:e.groupby,ops:s.map(()=>i),fields:s.map(a=>jQ(a,n,r,o)),as:s.map(a=>a+""),modified:e.modified.bind(e)}}function jQ(e,t,n,r){return qr(i=>t(i)===e?n(i):NaN,r,e+"")}function WQ(e,t,n){const r={},i=[];return n.visit(n.SOURCE,o=>{const s=e(o);r[s]||(r[s]=1,i.push(s))}),i.sort(ed),t?i.slice(0,t):i}function WP(e){yv.call(this,e)}pe(WP,yv,{transform(e,t){const n=e.subflow,r=e.field,i=o=>this.subflow(Te(o),n,t,o);return(e.modified("field")||r&&t.modified(Xn(r)))&&te("PreFacet does not support field modification."),this.initTargets(),r?(t.visit(t.MOD,o=>{const s=i(o);r(o).forEach(a=>s.mod(a))}),t.visit(t.ADD,o=>{const s=i(o);r(o).forEach(a=>s.add(ct(a)))}),t.visit(t.REM,o=>{const s=i(o);r(o).forEach(a=>s.rem(a))})):(t.visit(t.MOD,o=>i(o).mod(o)),t.visit(t.ADD,o=>i(o).add(o)),t.visit(t.REM,o=>i(o).rem(o))),t.clean()&&t.runAfter(()=>this.clean()),t}});function CC(e){J.call(this,null,e)}CC.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]};pe(CC,J,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=NP(e.fields,e.as||[]),o=r?(a,u)=>qQ(a,u,r,i):lv;let s;return this.value?s=this.value:(t=t.addAll(),s=this.value={}),t.visit(t.REM,a=>{const u=Te(a);n.rem.push(s[u]),s[u]=null}),t.visit(t.ADD,a=>{const u=o(a,ct({}));s[Te(a)]=u,n.add.push(u)}),t.visit(t.MOD,a=>{n.mod.push(o(a,s[Te(a)]))}),n}});function qQ(e,t,n,r){for(let i=0,o=n.length;i<o;++i)t[r[i]]=n[i](e);return t}function qP(e){J.call(this,null,e)}pe(qP,J,{transform(e,t){return this.value=e.value,e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function kC(e){J.call(this,null,e)}kC.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};const HQ=1e-14;pe(kC,J,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.as||["prob","value"];if(this.value&&!e.modified()&&!t.changed())return n.source=this.value,n;const i=t.materialize(t.SOURCE).source,o=hC(i,e.groupby,e.field),s=(e.groupby||[]).map(Wt),a=[],u=e.step||.01,c=e.probs||ei(u/2,1-HQ,u),f=c.length;return o.forEach(h=>{const p=qA(h,c);for(let m=0;m<f;++m){const y={};for(let v=0;v<s.length;++v)y[s[v]]=h.dims[v];y[r[0]]=c[m],y[r[1]]=p[m],a.push(ct(y))}}),this.value&&(n.rem=this.value),this.value=n.add=n.source=a,n}});function HP(e){J.call(this,null,e)}pe(HP,J,{transform(e,t){let n,r;return this.value?r=this.value:(n=t=t.addAll(),r=this.value={}),e.derive&&(n=t.fork(t.NO_SOURCE),t.visit(t.REM,i=>{const o=Te(i);n.rem.push(r[o]),r[o]=null}),t.visit(t.ADD,i=>{const o=UA(i);r[Te(i)]=o,n.add.push(o)}),t.visit(t.MOD,i=>{const o=r[Te(i)];for(const s in i)o[s]=i[s],n.modifies(s);n.mod.push(o)})),n}});function $C(e){J.call(this,[],e),this.count=0}$C.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]};pe($C,J,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.modified("size"),i=e.size,o=this.value.reduce((f,h)=>(f[Te(h)]=1,f),{});let s=this.value,a=this.count,u=0;function c(f){let h,p;s.length<i?s.push(f):(p=~~((a+1)*Di()),p<s.length&&p>=u&&(h=s[p],o[Te(h)]&&n.rem.push(h),s[p]=f)),++a}if(t.rem.length&&(t.visit(t.REM,f=>{const h=Te(f);o[h]&&(o[h]=-1,n.rem.push(f)),--a}),s=s.filter(f=>o[Te(f)]!==-1)),(t.rem.length||r)&&s.length<i&&t.source&&(u=a=s.length,t.visit(t.SOURCE,f=>{o[Te(f)]||c(f)}),u=-1),r&&s.length>i){const f=s.length-i;for(let h=0;h<f;++h)o[Te(s[h])]=-1,n.rem.push(s[h]);s=s.slice(f)}return t.mod.length&&t.visit(t.MOD,f=>{o[Te(f)]&&n.mod.push(f)}),t.add.length&&t.visit(t.ADD,c),(t.add.length||u<0)&&(n.add=s.filter(f=>!o[Te(f)])),this.count=a,this.value=n.source=s,n}});function FC(e){J.call(this,null,e)}FC.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]};pe(FC,J,{transform(e,t){if(this.value&&!e.modified())return;const n=t.materialize().fork(t.MOD),r=e.as||"data";return n.rem=this.value?t.rem.concat(this.value):t.rem,this.value=ei(e.start,e.stop,e.step||1).map(i=>{const o={};return o[r]=i,ct(o)}),n.add=t.add.concat(this.value),n}});function GP(e){J.call(this,null,e),this.modified(!0)}pe(GP,J,{transform(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function DC(e){J.call(this,null,e)}const VP=["unit0","unit1"];DC.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:TA,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:VP}]};pe(DC,J,{transform(e,t){const n=e.field,r=e.interval!==!1,i=e.timezone==="utc",o=this._floor(e,t),s=(i?sd:od)(o.unit).offset,a=e.as||VP,u=a[0],c=a[1],f=o.step;let h=o.start||1/0,p=o.stop||-1/0,m=t.ADD;return(e.modified()||t.changed(t.REM)||t.modified(Xn(n)))&&(t=t.reflow(!0),m=t.SOURCE,h=1/0,p=-1/0),t.visit(m,y=>{const v=n(y);let w,E;v==null?(y[u]=null,r&&(y[c]=null)):(y[u]=w=E=o(v),r&&(y[c]=E=s(w,f)),w<h&&(h=w),E>p&&(p=E))}),o.start=h,o.stop=p,t.modifies(r?a:u)},_floor(e,t){const n=e.timezone==="utc",{units:r,step:i}=e.units?{units:e.units,step:e.step||1}:L8({extent:e.extent||Ho(t.materialize(t.SOURCE).source,e.field),maxbins:e.maxbins}),o=NA(r),s=this.value||{},a=(n?$8:k8)(o,i);return a.unit=Ze(o),a.units=o,a.step=i,a.start=s.start,a.stop=s.stop,this.value=a}});function YP(e){J.call(this,td(),e)}pe(YP,J,{transform(e,t){const n=t.dataflow,r=e.field,i=this.value,o=a=>i.set(r(a),a);let s=!0;return e.modified("field")||t.modified(r.fields)?(i.clear(),t.visit(t.SOURCE,o)):t.changed()?(t.visit(t.REM,a=>i.delete(r(a))),t.visit(t.ADD,o)):s=!1,this.modified(s),i.empty>n.cleanThreshold&&n.runAfter(i.clean),t.fork()}});function XP(e){J.call(this,null,e)}pe(XP,J,{transform(e,t){(!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields))&&(this.value=(e.sort?t.source.slice().sort(Yl(e.sort)):t.source).map(e.field))}});function GQ(e,t,n,r){const i=Ap[e](t,n);return{init:i.init||Pa,update:function(o,s){s[r]=i.next(o)}}}const Ap={row_number:function(){return{next:e=>e.index+1}},rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?e=n+1:e}}},dense_rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?++e:e}}},percent_rank:function(){const e=Ap.rank(),t=e.next;return{init:e.init,next:n=>(t(n)-1)/(n.data.length-1)}},cume_dist:function(){let e;return{init:()=>e=0,next:t=>{const n=t.data,r=t.compare;let i=t.index;if(e<i){for(;i+1<n.length&&!r(n[i],n[i+1]);)++i;e=i}return(1+e)/n.length}}},ntile:function(e,t){t=+t,t>0||te("ntile num must be greater than zero.");const n=Ap.cume_dist(),r=n.next;return{init:n.init,next:i=>Math.ceil(t*r(i))}},lag:function(e,t){return t=+t||1,{next:n=>{const r=n.index-t;return r>=0?e(n.data[r]):null}}},lead:function(e,t){return t=+t||1,{next:n=>{const r=n.index+t,i=n.data;return r<i.length?e(i[r]):null}}},first_value:function(e){return{next:t=>e(t.data[t.i0])}},last_value:function(e){return{next:t=>e(t.data[t.i1-1])}},nth_value:function(e,t){return t=+t,t>0||te("nth_value nth must be greater than zero."),{next:n=>{const r=n.i0+(t-1);return r<n.i1?e(n.data[r]):null}}},prev_value:function(e){let t;return{init:()=>t=null,next:n=>{const r=e(n.data[n.index]);return r!=null?t=r:t}}},next_value:function(e){let t,n;return{init:()=>(t=null,n=-1),next:r=>{const i=r.data;return r.index<=n?t:(n=VQ(e,i,r.index))<0?(n=i.length,t=null):t=e(i[n])}}}};function VQ(e,t,n){for(let r=t.length;n<r;++n)if(e(t[n])!=null)return n;return-1}const YQ=Object.keys(Ap);function QP(e){const t=xe(e.ops),n=xe(e.fields),r=xe(e.params),i=xe(e.aggregate_params),o=xe(e.as),s=this.outputs=[],a=this.windows=[],u={},c={},f=[],h=[];let p=!0;function m(y){xe(Xn(y)).forEach(v=>u[v]=1)}m(e.sort),t.forEach((y,v)=>{const w=n[v],E=r[v],S=i[v]||null,A=Wt(w),C=AP(y,A,o[v]);if(m(w),s.push(C),Ee(Ap,y))a.push(GQ(y,w,E,C));else{if(w==null&&y!=="count"&&te("Null aggregate field specified."),y==="count"){f.push(C);return}p=!1;let k=c[A];k||(k=c[A]=[],k.field=w,h.push(k)),k.push(CP(y,S,C))}}),(f.length||h.length)&&(this.cell=XQ(h,f,p)),this.inputs=Object.keys(u)}const KP=QP.prototype;KP.init=function(){this.windows.forEach(e=>e.init()),this.cell&&this.cell.init()};KP.update=function(e,t){const n=this.cell,r=this.windows,i=e.data,o=r&&r.length;let s;if(n){for(s=e.p0;s<e.i0;++s)n.rem(i[s]);for(s=e.p1;s<e.i1;++s)n.add(i[s]);n.set(t)}for(s=0;s<o;++s)r[s].update(e,t)};function XQ(e,t,n){e=e.map(u=>$P(u,u.field));const r={num:0,agg:null,store:!1,count:t};if(!n)for(var i=e.length,o=r.agg=Array(i),s=0;s<i;++s)o[s]=new e[s](r);if(r.store)var a=r.data=new aC;return r.add=function(u){if(r.num+=1,!n){a&&a.add(u);for(let c=0;c<i;++c)o[c].add(o[c].get(u),u)}},r.rem=function(u){if(r.num-=1,!n){a&&a.rem(u);for(let c=0;c<i;++c)o[c].rem(o[c].get(u),u)}},r.set=function(u){let c,f;for(a&&a.values(),c=0,f=t.length;c<f;++c)u[t[c]]=r.num;if(!n)for(c=0,f=o.length;c<f;++c)o[c].set(u)},r.init=function(){r.num=0,a&&a.reset();for(let u=0;u<i;++u)o[u].init()},r}function MC(e){J.call(this,{},e),this._mlen=0,this._mods=[]}MC.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:YQ.concat(ig)},{name:"params",type:"number",null:!0,array:!0},{name:"aggregate_params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]};pe(MC,J,{transform(e,t){this.stamp=t.stamp;const n=e.modified(),r=Yl(e.sort),i=fS(e.groupby),o=a=>this.group(i(a));let s=this.state;(!s||n)&&(s=this.state=new QP(e)),n||t.modified(s.inputs)?(this.value={},t.visit(t.SOURCE,a=>o(a).add(a))):(t.visit(t.REM,a=>o(a).remove(a)),t.visit(t.ADD,a=>o(a).add(a)));for(let a=0,u=this._mlen;a<u;++a)QQ(this._mods[a],s,r,e);return this._mlen=0,this._mods=[],t.reflow(n).modifies(s.outputs)},group(e){let t=this.value[e];return t||(t=this.value[e]=FP(Te),t.stamp=-1),t.stamp<this.stamp&&(t.stamp=this.stamp,this._mods[this._mlen++]=t),t}});function QQ(e,t,n,r){const i=r.sort,o=i&&!r.ignorePeers,s=r.frame||[null,0],a=e.data(n),u=a.length,c=o?nd(i):null,f={i0:0,i1:0,p0:0,p1:0,index:0,data:a,compare:i||nr(-1)};t.init();for(let h=0;h<u;++h)KQ(f,s,h,u),o&&JQ(f,c),t.update(f,a[h])}function KQ(e,t,n,r){e.p0=e.i0,e.p1=e.i1,e.i0=t[0]==null?0:Math.max(0,n-Math.abs(t[0])),e.i1=t[1]==null?r:Math.min(r,n+Math.abs(t[1])+1),e.index=n}function JQ(e,t){const n=e.i0,r=e.i1-1,i=e.compare,o=e.data,s=o.length-1;n>0&&!i(o[n],o[n-1])&&(e.i0=t.left(o,o[n])),r<s&&!i(o[r],o[r+1])&&(e.i1=t.right(o,o[r]))}const ZQ=Object.freeze(Object.defineProperty({__proto__:null,aggregate:eu,bin:uC,collect:lC,compare:DP,countpattern:cC,cross:fC,density:dC,dotbin:pC,expression:OP,extent:gC,facet:yv,field:PP,filter:yC,flatten:vC,fold:xC,formula:wC,generate:LP,impute:EC,joinaggregate:bC,kde:SC,key:zP,load:IP,lookup:_C,multiextent:BP,multivalues:UP,params:jP,pivot:AC,prefacet:WP,project:CC,proxy:qP,quantile:kC,relay:HP,sample:$C,sequence:FC,sieve:GP,subflow:mC,timeunit:DC,tupleindex:YP,values:XP,window:MC},Symbol.toStringTag,{value:"Module"}));function ft(e){return function(){return e}}const bT=Math.abs,Un=Math.atan2,Wu=Math.cos,eK=Math.max,yE=Math.min,ko=Math.sin,ul=Math.sqrt,Wn=1e-12,bf=Math.PI,k1=bf/2,JP=2*bf;function tK(e){return e>1?0:e<-1?bf:Math.acos(e)}function ST(e){return e>=1?k1:e<=-1?-k1:Math.asin(e)}const dS=Math.PI,hS=2*dS,el=1e-6,nK=hS-el;function ZP(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function rK(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return ZP;const n=10**t;return function(r){this._+=r[0];for(let i=1,o=r.length;i<o;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}let TC=class{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?ZP:rK(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,r,i){this._append`Q${+t},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(t,n,r,i,o,s){this._append`C${+t},${+n},${+r},${+i},${this._x1=+o},${this._y1=+s}`}arcTo(t,n,r,i,o){if(t=+t,n=+n,r=+r,i=+i,o=+o,o<0)throw new Error(`negative radius: ${o}`);let s=this._x1,a=this._y1,u=r-t,c=i-n,f=s-t,h=a-n,p=f*f+h*h;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(p>el)if(!(Math.abs(h*u-c*f)>el)||!o)this._append`L${this._x1=t},${this._y1=n}`;else{let m=r-s,y=i-a,v=u*u+c*c,w=m*m+y*y,E=Math.sqrt(v),S=Math.sqrt(p),A=o*Math.tan((dS-Math.acos((v+p-w)/(2*E*S)))/2),C=A/S,k=A/E;Math.abs(C-1)>el&&this._append`L${t+C*f},${n+C*h}`,this._append`A${o},${o},0,0,${+(h*m>f*y)},${this._x1=t+k*u},${this._y1=n+k*c}`}}arc(t,n,r,i,o,s){if(t=+t,n=+n,r=+r,s=!!s,r<0)throw new Error(`negative radius: ${r}`);let a=r*Math.cos(i),u=r*Math.sin(i),c=t+a,f=n+u,h=1^s,p=s?i-o:o-i;this._x1===null?this._append`M${c},${f}`:(Math.abs(this._x1-c)>el||Math.abs(this._y1-f)>el)&&this._append`L${c},${f}`,r&&(p<0&&(p=p%hS+hS),p>nK?this._append`A${r},${r},0,1,${h},${t-a},${n-u}A${r},${r},0,1,${h},${this._x1=c},${this._y1=f}`:p>el&&this._append`A${r},${r},0,${+(p>=dS)},${h},${this._x1=t+r*Math.cos(o)},${this._y1=n+r*Math.sin(o)}`)}rect(t,n,r,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}};function vv(){return new TC}vv.prototype=TC.prototype;function xv(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);t=r}return e},()=>new TC(t)}function iK(e){return e.innerRadius}function oK(e){return e.outerRadius}function sK(e){return e.startAngle}function aK(e){return e.endAngle}function uK(e){return e&&e.padAngle}function lK(e,t,n,r,i,o,s,a){var u=n-e,c=r-t,f=s-i,h=a-o,p=h*u-f*c;if(!(p*p<Wn))return p=(f*(t-o)-h*(e-i))/p,[e+p*u,t+p*c]}function lm(e,t,n,r,i,o,s){var a=e-n,u=t-r,c=(s?o:-o)/ul(a*a+u*u),f=c*u,h=-c*a,p=e+f,m=t+h,y=n+f,v=r+h,w=(p+y)/2,E=(m+v)/2,S=y-p,A=v-m,C=S*S+A*A,k=i-o,D=p*v-y*m,$=(A<0?-1:1)*ul(eK(0,k*k*C-D*D)),M=(D*A-S*$)/C,T=(-D*S-A*$)/C,L=(D*A+S*$)/C,O=(-D*S+A*$)/C,X=M-w,W=T-E,I=L-w,N=O-E;return X*X+W*W>I*I+N*N&&(M=L,T=O),{cx:M,cy:T,x01:-f,y01:-h,x11:M*(i/k-1),y11:T*(i/k-1)}}function cK(){var e=iK,t=oK,n=ft(0),r=null,i=sK,o=aK,s=uK,a=null,u=xv(c);function c(){var f,h,p=+e.apply(this,arguments),m=+t.apply(this,arguments),y=i.apply(this,arguments)-k1,v=o.apply(this,arguments)-k1,w=bT(v-y),E=v>y;if(a||(a=f=u()),m<p&&(h=m,m=p,p=h),!(m>Wn))a.moveTo(0,0);else if(w>JP-Wn)a.moveTo(m*Wu(y),m*ko(y)),a.arc(0,0,m,y,v,!E),p>Wn&&(a.moveTo(p*Wu(v),p*ko(v)),a.arc(0,0,p,v,y,E));else{var S=y,A=v,C=y,k=v,D=w,$=w,M=s.apply(this,arguments)/2,T=M>Wn&&(r?+r.apply(this,arguments):ul(p*p+m*m)),L=yE(bT(m-p)/2,+n.apply(this,arguments)),O=L,X=L,W,I;if(T>Wn){var N=ST(T/p*ko(M)),U=ST(T/m*ko(M));(D-=N*2)>Wn?(N*=E?1:-1,C+=N,k-=N):(D=0,C=k=(y+v)/2),($-=U*2)>Wn?(U*=E?1:-1,S+=U,A-=U):($=0,S=A=(y+v)/2)}var Y=m*Wu(S),j=m*ko(S),q=p*Wu(k),K=p*ko(k);if(L>Wn){var P=m*Wu(A),G=m*ko(A),me=p*Wu(C),_e=p*ko(C),we;if(w<bf)if(we=lK(Y,j,me,_e,P,G,q,K)){var Ie=Y-we[0],et=j-we[1],Ve=P-we[0],fe=G-we[1],Re=1/ko(tK((Ie*Ve+et*fe)/(ul(Ie*Ie+et*et)*ul(Ve*Ve+fe*fe)))/2),We=ul(we[0]*we[0]+we[1]*we[1]);O=yE(L,(p-We)/(Re-1)),X=yE(L,(m-We)/(Re+1))}else O=X=0}$>Wn?X>Wn?(W=lm(me,_e,Y,j,m,X,E),I=lm(P,G,q,K,m,X,E),a.moveTo(W.cx+W.x01,W.cy+W.y01),X<L?a.arc(W.cx,W.cy,X,Un(W.y01,W.x01),Un(I.y01,I.x01),!E):(a.arc(W.cx,W.cy,X,Un(W.y01,W.x01),Un(W.y11,W.x11),!E),a.arc(0,0,m,Un(W.cy+W.y11,W.cx+W.x11),Un(I.cy+I.y11,I.cx+I.x11),!E),a.arc(I.cx,I.cy,X,Un(I.y11,I.x11),Un(I.y01,I.x01),!E))):(a.moveTo(Y,j),a.arc(0,0,m,S,A,!E)):a.moveTo(Y,j),!(p>Wn)||!(D>Wn)?a.lineTo(q,K):O>Wn?(W=lm(q,K,P,G,p,-O,E),I=lm(Y,j,me,_e,p,-O,E),a.lineTo(W.cx+W.x01,W.cy+W.y01),O<L?a.arc(W.cx,W.cy,O,Un(W.y01,W.x01),Un(I.y01,I.x01),!E):(a.arc(W.cx,W.cy,O,Un(W.y01,W.x01),Un(W.y11,W.x11),!E),a.arc(0,0,p,Un(W.cy+W.y11,W.cx+W.x11),Un(I.cy+I.y11,I.cx+I.x11),E),a.arc(I.cx,I.cy,O,Un(I.y11,I.x11),Un(I.y01,I.x01),!E))):a.arc(0,0,p,k,C,E)}if(a.closePath(),f)return a=null,f+""||null}return c.centroid=function(){var f=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,h=(+i.apply(this,arguments)+ +o.apply(this,arguments))/2-bf/2;return[Wu(h)*f,ko(h)*f]},c.innerRadius=function(f){return arguments.length?(e=typeof f=="function"?f:ft(+f),c):e},c.outerRadius=function(f){return arguments.length?(t=typeof f=="function"?f:ft(+f),c):t},c.cornerRadius=function(f){return arguments.length?(n=typeof f=="function"?f:ft(+f),c):n},c.padRadius=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:ft(+f),c):r},c.startAngle=function(f){return arguments.length?(i=typeof f=="function"?f:ft(+f),c):i},c.endAngle=function(f){return arguments.length?(o=typeof f=="function"?f:ft(+f),c):o},c.padAngle=function(f){return arguments.length?(s=typeof f=="function"?f:ft(+f),c):s},c.context=function(f){return arguments.length?(a=f??null,c):a},c}function e9(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function t9(e){this._context=e}t9.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function NC(e){return new t9(e)}function n9(e){return e[0]}function r9(e){return e[1]}function i9(e,t){var n=ft(!0),r=null,i=NC,o=null,s=xv(a);e=typeof e=="function"?e:e===void 0?n9:ft(e),t=typeof t=="function"?t:t===void 0?r9:ft(t);function a(u){var c,f=(u=e9(u)).length,h,p=!1,m;for(r==null&&(o=i(m=s())),c=0;c<=f;++c)!(c<f&&n(h=u[c],c,u))===p&&((p=!p)?o.lineStart():o.lineEnd()),p&&o.point(+e(h,c,u),+t(h,c,u));if(m)return o=null,m+""||null}return a.x=function(u){return arguments.length?(e=typeof u=="function"?u:ft(+u),a):e},a.y=function(u){return arguments.length?(t=typeof u=="function"?u:ft(+u),a):t},a.defined=function(u){return arguments.length?(n=typeof u=="function"?u:ft(!!u),a):n},a.curve=function(u){return arguments.length?(i=u,r!=null&&(o=i(r)),a):i},a.context=function(u){return arguments.length?(u==null?r=o=null:o=i(r=u),a):r},a}function o9(e,t,n){var r=null,i=ft(!0),o=null,s=NC,a=null,u=xv(c);e=typeof e=="function"?e:e===void 0?n9:ft(+e),t=typeof t=="function"?t:ft(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?r9:ft(+n);function c(h){var p,m,y,v=(h=e9(h)).length,w,E=!1,S,A=new Array(v),C=new Array(v);for(o==null&&(a=s(S=u())),p=0;p<=v;++p){if(!(p<v&&i(w=h[p],p,h))===E)if(E=!E)m=p,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),y=p-1;y>=m;--y)a.point(A[y],C[y]);a.lineEnd(),a.areaEnd()}E&&(A[p]=+e(w,p,h),C[p]=+t(w,p,h),a.point(r?+r(w,p,h):A[p],n?+n(w,p,h):C[p]))}if(S)return a=null,S+""||null}function f(){return i9().defined(i).curve(s).context(o)}return c.x=function(h){return arguments.length?(e=typeof h=="function"?h:ft(+h),r=null,c):e},c.x0=function(h){return arguments.length?(e=typeof h=="function"?h:ft(+h),c):e},c.x1=function(h){return arguments.length?(r=h==null?null:typeof h=="function"?h:ft(+h),c):r},c.y=function(h){return arguments.length?(t=typeof h=="function"?h:ft(+h),n=null,c):t},c.y0=function(h){return arguments.length?(t=typeof h=="function"?h:ft(+h),c):t},c.y1=function(h){return arguments.length?(n=h==null?null:typeof h=="function"?h:ft(+h),c):n},c.lineX0=c.lineY0=function(){return f().x(e).y(t)},c.lineY1=function(){return f().x(e).y(n)},c.lineX1=function(){return f().x(r).y(t)},c.defined=function(h){return arguments.length?(i=typeof h=="function"?h:ft(!!h),c):i},c.curve=function(h){return arguments.length?(s=h,o!=null&&(a=s(o)),c):s},c.context=function(h){return arguments.length?(h==null?o=a=null:a=s(o=h),c):o},c}const fK={draw(e,t){const n=ul(t/bf);e.moveTo(n,0),e.arc(0,0,n,0,JP)}};function dK(e,t){let n=null,r=xv(i);e=typeof e=="function"?e:ft(e||fK),t=typeof t=="function"?t:ft(t===void 0?64:+t);function i(){let o;if(n||(n=o=r()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),o)return n=null,o+""||null}return i.type=function(o){return arguments.length?(e=typeof o=="function"?o:ft(o),i):e},i.size=function(o){return arguments.length?(t=typeof o=="function"?o:ft(+o),i):t},i.context=function(o){return arguments.length?(n=o??null,i):n},i}function tu(){}function $1(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function wv(e){this._context=e}wv.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:$1(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:$1(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function hK(e){return new wv(e)}function s9(e){this._context=e}s9.prototype={areaStart:tu,areaEnd:tu,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:$1(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function pK(e){return new s9(e)}function a9(e){this._context=e}a9.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:$1(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function gK(e){return new a9(e)}function u9(e,t){this._basis=new wv(e),this._beta=t}u9.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r=e[0],i=t[0],o=e[n]-r,s=t[n]-i,a=-1,u;++a<=n;)u=a/n,this._basis.point(this._beta*e[a]+(1-this._beta)*(r+u*o),this._beta*t[a]+(1-this._beta)*(i+u*s));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};const mK=(function e(t){function n(r){return t===1?new wv(r):new u9(r,t)}return n.beta=function(r){return e(+r)},n})(.85);function F1(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function RC(e,t){this._context=e,this._k=(1-t)/6}RC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:F1(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:F1(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const yK=(function e(t){function n(r){return new RC(r,t)}return n.tension=function(r){return e(+r)},n})(0);function OC(e,t){this._context=e,this._k=(1-t)/6}OC.prototype={areaStart:tu,areaEnd:tu,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:F1(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const vK=(function e(t){function n(r){return new OC(r,t)}return n.tension=function(r){return e(+r)},n})(0);function PC(e,t){this._context=e,this._k=(1-t)/6}PC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:F1(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const xK=(function e(t){function n(r){return new PC(r,t)}return n.tension=function(r){return e(+r)},n})(0);function LC(e,t,n){var r=e._x1,i=e._y1,o=e._x2,s=e._y2;if(e._l01_a>Wn){var a=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,u=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*a-e._x0*e._l12_2a+e._x2*e._l01_2a)/u,i=(i*a-e._y0*e._l12_2a+e._y2*e._l01_2a)/u}if(e._l23_a>Wn){var c=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,f=3*e._l23_a*(e._l23_a+e._l12_a);o=(o*c+e._x1*e._l23_2a-t*e._l12_2a)/f,s=(s*c+e._y1*e._l23_2a-n*e._l12_2a)/f}e._context.bezierCurveTo(r,i,o,s,e._x2,e._y2)}function l9(e,t){this._context=e,this._alpha=t}l9.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:LC(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const wK=(function e(t){function n(r){return t?new l9(r,t):new RC(r,0)}return n.alpha=function(r){return e(+r)},n})(.5);function c9(e,t){this._context=e,this._alpha=t}c9.prototype={areaStart:tu,areaEnd:tu,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:LC(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const EK=(function e(t){function n(r){return t?new c9(r,t):new OC(r,0)}return n.alpha=function(r){return e(+r)},n})(.5);function f9(e,t){this._context=e,this._alpha=t}f9.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:LC(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const bK=(function e(t){function n(r){return t?new f9(r,t):new PC(r,0)}return n.alpha=function(r){return e(+r)},n})(.5);function d9(e){this._context=e}d9.prototype={areaStart:tu,areaEnd:tu,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function SK(e){return new d9(e)}function _T(e){return e<0?-1:1}function AT(e,t,n){var r=e._x1-e._x0,i=t-e._x1,o=(e._y1-e._y0)/(r||i<0&&-0),s=(n-e._y1)/(i||r<0&&-0),a=(o*i+s*r)/(r+i);return(_T(o)+_T(s))*Math.min(Math.abs(o),Math.abs(s),.5*Math.abs(a))||0}function CT(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function vE(e,t,n){var r=e._x0,i=e._y0,o=e._x1,s=e._y1,a=(o-r)/3;e._context.bezierCurveTo(r+a,i+a*t,o-a,s-a*n,o,s)}function D1(e){this._context=e}D1.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:vE(this,this._t0,CT(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,vE(this,CT(this,n=AT(this,e,t)),n);break;default:vE(this,this._t0,n=AT(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function h9(e){this._context=new p9(e)}(h9.prototype=Object.create(D1.prototype)).point=function(e,t){D1.prototype.point.call(this,t,e)};function p9(e){this._context=e}p9.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,o){this._context.bezierCurveTo(t,e,r,n,o,i)}};function _K(e){return new D1(e)}function AK(e){return new h9(e)}function g9(e){this._context=e}g9.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=kT(e),i=kT(t),o=0,s=1;s<n;++o,++s)this._context.bezierCurveTo(r[0][o],i[0][o],r[1][o],i[1][o],e[s],t[s]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function kT(e){var t,n=e.length-1,r,i=new Array(n),o=new Array(n),s=new Array(n);for(i[0]=0,o[0]=2,s[0]=e[0]+2*e[1],t=1;t<n-1;++t)i[t]=1,o[t]=4,s[t]=4*e[t]+2*e[t+1];for(i[n-1]=2,o[n-1]=7,s[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=i[t]/o[t-1],o[t]-=r,s[t]-=r*s[t-1];for(i[n-1]=s[n-1]/o[n-1],t=n-2;t>=0;--t)i[t]=(s[t]-i[t+1])/o[t];for(o[n-1]=(e[n]+i[n-1])/2,t=0;t<n-1;++t)o[t]=2*e[t+1]-i[t+1];return[i,o]}function CK(e){return new g9(e)}function Ev(e,t){this._context=e,this._t=t}Ev.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function kK(e){return new Ev(e,.5)}function $K(e){return new Ev(e,0)}function FK(e){return new Ev(e,1)}function Xa(e,t){if(typeof document<"u"&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext)return n.width=e,n.height=t,n}return null}const DK=()=>typeof Image<"u"?Image:null;function ts(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function pu(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const pS=Symbol("implicit");function zC(){var e=new q5,t=[],n=[],r=pS;function i(o){let s=e.get(o);if(s===void 0){if(r!==pS)return r;e.set(o,s=t.push(o)-1)}return n[s%n.length]}return i.domain=function(o){if(!arguments.length)return t.slice();t=[],e=new q5;for(const s of o)e.has(s)||e.set(s,t.push(s)-1);return i},i.range=function(o){return arguments.length?(n=Array.from(o),i):n.slice()},i.unknown=function(o){return arguments.length?(r=o,i):r},i.copy=function(){return zC(t,n).unknown(r)},ts.apply(i,arguments),i}function ud(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function og(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function gu(){}var Sl=.7,Sf=1/Sl,af="\\s*([+-]?\\d+)\\s*",Cp="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Io="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",MK=/^#([0-9a-f]{3,8})$/,TK=new RegExp(`^rgb\\(${af},${af},${af}\\)$`),NK=new RegExp(`^rgb\\(${Io},${Io},${Io}\\)$`),RK=new RegExp(`^rgba\\(${af},${af},${af},${Cp}\\)$`),OK=new RegExp(`^rgba\\(${Io},${Io},${Io},${Cp}\\)$`),PK=new RegExp(`^hsl\\(${Cp},${Io},${Io}\\)$`),LK=new RegExp(`^hsla\\(${Cp},${Io},${Io},${Cp}\\)$`),$T={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};ud(gu,kp,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:FT,formatHex:FT,formatHex8:zK,formatHsl:IK,formatRgb:DT,toString:DT});function FT(){return this.rgb().formatHex()}function zK(){return this.rgb().formatHex8()}function IK(){return m9(this).formatHsl()}function DT(){return this.rgb().formatRgb()}function kp(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=MK.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?MT(t):n===3?new pn(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?cm(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?cm(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=TK.exec(e))?new pn(t[1],t[2],t[3],1):(t=NK.exec(e))?new pn(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=RK.exec(e))?cm(t[1],t[2],t[3],t[4]):(t=OK.exec(e))?cm(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=PK.exec(e))?RT(t[1],t[2]/100,t[3]/100,1):(t=LK.exec(e))?RT(t[1],t[2]/100,t[3]/100,t[4]):$T.hasOwnProperty(e)?MT($T[e]):e==="transparent"?new pn(NaN,NaN,NaN,0):null}function MT(e){return new pn(e>>16&255,e>>8&255,e&255,1)}function cm(e,t,n,r){return r<=0&&(e=t=n=NaN),new pn(e,t,n,r)}function IC(e){return e instanceof gu||(e=kp(e)),e?(e=e.rgb(),new pn(e.r,e.g,e.b,e.opacity)):new pn}function nu(e,t,n,r){return arguments.length===1?IC(e):new pn(e,t,n,r??1)}function pn(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}ud(pn,nu,og(gu,{brighter(e){return e=e==null?Sf:Math.pow(Sf,e),new pn(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Sl:Math.pow(Sl,e),new pn(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new pn(hl(this.r),hl(this.g),hl(this.b),M1(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:TT,formatHex:TT,formatHex8:BK,formatRgb:NT,toString:NT}));function TT(){return`#${ll(this.r)}${ll(this.g)}${ll(this.b)}`}function BK(){return`#${ll(this.r)}${ll(this.g)}${ll(this.b)}${ll((isNaN(this.opacity)?1:this.opacity)*255)}`}function NT(){const e=M1(this.opacity);return`${e===1?"rgb(":"rgba("}${hl(this.r)}, ${hl(this.g)}, ${hl(this.b)}${e===1?")":`, ${e})`}`}function M1(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function hl(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function ll(e){return e=hl(e),(e<16?"0":"")+e.toString(16)}function RT(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Ki(e,t,n,r)}function m9(e){if(e instanceof Ki)return new Ki(e.h,e.s,e.l,e.opacity);if(e instanceof gu||(e=kp(e)),!e)return new Ki;if(e instanceof Ki)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),s=NaN,a=o-i,u=(o+i)/2;return a?(t===o?s=(n-r)/a+(n<r)*6:n===o?s=(r-t)/a+2:s=(t-n)/a+4,a/=u<.5?o+i:2-o-i,s*=60):a=u>0&&u<1?0:s,new Ki(s,a,u,e.opacity)}function T1(e,t,n,r){return arguments.length===1?m9(e):new Ki(e,t,n,r??1)}function Ki(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}ud(Ki,T1,og(gu,{brighter(e){return e=e==null?Sf:Math.pow(Sf,e),new Ki(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Sl:Math.pow(Sl,e),new Ki(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new pn(xE(e>=240?e-240:e+120,i,r),xE(e,i,r),xE(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new Ki(OT(this.h),fm(this.s),fm(this.l),M1(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=M1(this.opacity);return`${e===1?"hsl(":"hsla("}${OT(this.h)}, ${fm(this.s)*100}%, ${fm(this.l)*100}%${e===1?")":`, ${e})`}`}}));function OT(e){return e=(e||0)%360,e<0?e+360:e}function fm(e){return Math.max(0,Math.min(1,e||0))}function xE(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const y9=Math.PI/180,v9=180/Math.PI,N1=18,x9=.96422,w9=1,E9=.82521,b9=4/29,uf=6/29,S9=3*uf*uf,UK=uf*uf*uf;function _9(e){if(e instanceof Bo)return new Bo(e.l,e.a,e.b,e.opacity);if(e instanceof Ps)return A9(e);e instanceof pn||(e=IC(e));var t=SE(e.r),n=SE(e.g),r=SE(e.b),i=wE((.2225045*t+.7168786*n+.0606169*r)/w9),o,s;return t===n&&n===r?o=s=i:(o=wE((.4360747*t+.3850649*n+.1430804*r)/x9),s=wE((.0139322*t+.0971045*n+.7141733*r)/E9)),new Bo(116*i-16,500*(o-i),200*(i-s),e.opacity)}function R1(e,t,n,r){return arguments.length===1?_9(e):new Bo(e,t,n,r??1)}function Bo(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}ud(Bo,R1,og(gu,{brighter(e){return new Bo(this.l+N1*(e??1),this.a,this.b,this.opacity)},darker(e){return new Bo(this.l-N1*(e??1),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=x9*EE(t),e=w9*EE(e),n=E9*EE(n),new pn(bE(3.1338561*t-1.6168667*e-.4906146*n),bE(-.9787684*t+1.9161415*e+.033454*n),bE(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function wE(e){return e>UK?Math.pow(e,1/3):e/S9+b9}function EE(e){return e>uf?e*e*e:S9*(e-b9)}function bE(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function SE(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function jK(e){if(e instanceof Ps)return new Ps(e.h,e.c,e.l,e.opacity);if(e instanceof Bo||(e=_9(e)),e.a===0&&e.b===0)return new Ps(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*v9;return new Ps(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function O1(e,t,n,r){return arguments.length===1?jK(e):new Ps(e,t,n,r??1)}function Ps(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function A9(e){if(isNaN(e.h))return new Bo(e.l,0,0,e.opacity);var t=e.h*y9;return new Bo(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}ud(Ps,O1,og(gu,{brighter(e){return new Ps(this.h,this.c,this.l+N1*(e??1),this.opacity)},darker(e){return new Ps(this.h,this.c,this.l-N1*(e??1),this.opacity)},rgb(){return A9(this).rgb()}}));var C9=-.14861,BC=1.78277,UC=-.29227,bv=-.90649,$p=1.97294,PT=$p*bv,LT=$p*BC,zT=BC*UC-bv*C9;function WK(e){if(e instanceof pl)return new pl(e.h,e.s,e.l,e.opacity);e instanceof pn||(e=IC(e));var t=e.r/255,n=e.g/255,r=e.b/255,i=(zT*r+PT*t-LT*n)/(zT+PT-LT),o=r-i,s=($p*(n-i)-UC*o)/bv,a=Math.sqrt(s*s+o*o)/($p*i*(1-i)),u=a?Math.atan2(s,o)*v9-120:NaN;return new pl(u<0?u+360:u,a,i,e.opacity)}function gS(e,t,n,r){return arguments.length===1?WK(e):new pl(e,t,n,r??1)}function pl(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}ud(pl,gS,og(gu,{brighter(e){return e=e==null?Sf:Math.pow(Sf,e),new pl(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Sl:Math.pow(Sl,e),new pl(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*y9,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new pn(255*(t+n*(C9*r+BC*i)),255*(t+n*(UC*r+bv*i)),255*(t+n*($p*r)),this.opacity)}}));function k9(e,t,n,r,i){var o=e*e,s=o*e;return((1-3*e+3*o-s)*t+(4-6*o+3*s)*n+(1+3*e+3*o-3*s)*r+s*i)/6}function $9(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],o=e[r+1],s=r>0?e[r-1]:2*i-o,a=r<t-1?e[r+2]:2*o-i;return k9((n-r/t)*t,s,i,o,a)}}function F9(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],o=e[r%t],s=e[(r+1)%t],a=e[(r+2)%t];return k9((n-r/t)*t,i,o,s,a)}}const Sv=e=>()=>e;function D9(e,t){return function(n){return e+n*t}}function qK(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function _v(e,t){var n=t-e;return n?D9(e,n>180||n<-180?n-360*Math.round(n/360):n):Sv(isNaN(e)?t:e)}function HK(e){return(e=+e)==1?gn:function(t,n){return n-t?qK(t,n,e):Sv(isNaN(t)?n:t)}}function gn(e,t){var n=t-e;return n?D9(e,n):Sv(isNaN(e)?t:e)}const mS=(function e(t){var n=HK(t);function r(i,o){var s=n((i=nu(i)).r,(o=nu(o)).r),a=n(i.g,o.g),u=n(i.b,o.b),c=gn(i.opacity,o.opacity);return function(f){return i.r=s(f),i.g=a(f),i.b=u(f),i.opacity=c(f),i+""}}return r.gamma=e,r})(1);function M9(e){return function(t){var n=t.length,r=new Array(n),i=new Array(n),o=new Array(n),s,a;for(s=0;s<n;++s)a=nu(t[s]),r[s]=a.r||0,i[s]=a.g||0,o[s]=a.b||0;return r=e(r),i=e(i),o=e(o),a.opacity=1,function(u){return a.r=r(u),a.g=i(u),a.b=o(u),a+""}}}var GK=M9($9),VK=M9(F9);function jC(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),i;return function(o){for(i=0;i<n;++i)r[i]=e[i]*(1-o)+t[i]*o;return r}}function T9(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function YK(e,t){return(T9(t)?jC:N9)(e,t)}function N9(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,i=new Array(r),o=new Array(n),s;for(s=0;s<r;++s)i[s]=mu(e[s],t[s]);for(;s<n;++s)o[s]=t[s];return function(a){for(s=0;s<r;++s)o[s]=i[s](a);return o}}function R9(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function Xi(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function O9(e,t){var n={},r={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?n[i]=mu(e[i],t[i]):r[i]=t[i];return function(o){for(i in n)r[i]=n[i](o);return r}}var yS=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,_E=new RegExp(yS.source,"g");function XK(e){return function(){return e}}function QK(e){return function(t){return e(t)+""}}function P9(e,t){var n=yS.lastIndex=_E.lastIndex=0,r,i,o,s=-1,a=[],u=[];for(e=e+"",t=t+"";(r=yS.exec(e))&&(i=_E.exec(t));)(o=i.index)>n&&(o=t.slice(n,o),a[s]?a[s]+=o:a[++s]=o),(r=r[0])===(i=i[0])?a[s]?a[s]+=i:a[++s]=i:(a[++s]=null,u.push({i:s,x:Xi(r,i)})),n=_E.lastIndex;return n<t.length&&(o=t.slice(n),a[s]?a[s]+=o:a[++s]=o),a.length<2?u[0]?QK(u[0].x):XK(t):(t=u.length,function(c){for(var f=0,h;f<t;++f)a[(h=u[f]).i]=h.x(c);return a.join("")})}function mu(e,t){var n=typeof t,r;return t==null||n==="boolean"?Sv(t):(n==="number"?Xi:n==="string"?(r=kp(t))?(t=r,mS):P9:t instanceof kp?mS:t instanceof Date?R9:T9(t)?jC:Array.isArray(t)?N9:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?O9:Xi)(e,t)}function KK(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function JK(e,t){var n=_v(+e,+t);return function(r){var i=n(r);return i-360*Math.floor(i/360)}}function sg(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var IT=180/Math.PI,vS={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function L9(e,t,n,r,i,o){var s,a,u;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(u=e*n+t*r)&&(n-=e*u,r-=t*u),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,u/=a),e*r<t*n&&(e=-e,t=-t,u=-u,s=-s),{translateX:i,translateY:o,rotate:Math.atan2(t,e)*IT,skewX:Math.atan(u)*IT,scaleX:s,scaleY:a}}var dm;function ZK(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?vS:L9(t.a,t.b,t.c,t.d,t.e,t.f)}function eJ(e){return e==null||(dm||(dm=document.createElementNS("http://www.w3.org/2000/svg","g")),dm.setAttribute("transform",e),!(e=dm.transform.baseVal.consolidate()))?vS:(e=e.matrix,L9(e.a,e.b,e.c,e.d,e.e,e.f))}function z9(e,t,n,r){function i(c){return c.length?c.pop()+" ":""}function o(c,f,h,p,m,y){if(c!==h||f!==p){var v=m.push("translate(",null,t,null,n);y.push({i:v-4,x:Xi(c,h)},{i:v-2,x:Xi(f,p)})}else(h||p)&&m.push("translate("+h+t+p+n)}function s(c,f,h,p){c!==f?(c-f>180?f+=360:f-c>180&&(c+=360),p.push({i:h.push(i(h)+"rotate(",null,r)-2,x:Xi(c,f)})):f&&h.push(i(h)+"rotate("+f+r)}function a(c,f,h,p){c!==f?p.push({i:h.push(i(h)+"skewX(",null,r)-2,x:Xi(c,f)}):f&&h.push(i(h)+"skewX("+f+r)}function u(c,f,h,p,m,y){if(c!==h||f!==p){var v=m.push(i(m)+"scale(",null,",",null,")");y.push({i:v-4,x:Xi(c,h)},{i:v-2,x:Xi(f,p)})}else(h!==1||p!==1)&&m.push(i(m)+"scale("+h+","+p+")")}return function(c,f){var h=[],p=[];return c=e(c),f=e(f),o(c.translateX,c.translateY,f.translateX,f.translateY,h,p),s(c.rotate,f.rotate,h,p),a(c.skewX,f.skewX,h,p),u(c.scaleX,c.scaleY,f.scaleX,f.scaleY,h,p),c=f=null,function(m){for(var y=-1,v=p.length,w;++y<v;)h[(w=p[y]).i]=w.x(m);return h.join("")}}}var tJ=z9(ZK,"px, ","px)","deg)"),nJ=z9(eJ,", ",")",")"),rJ=1e-12;function BT(e){return((e=Math.exp(e))+1/e)/2}function iJ(e){return((e=Math.exp(e))-1/e)/2}function oJ(e){return((e=Math.exp(2*e))-1)/(e+1)}const sJ=(function e(t,n,r){function i(o,s){var a=o[0],u=o[1],c=o[2],f=s[0],h=s[1],p=s[2],m=f-a,y=h-u,v=m*m+y*y,w,E;if(v<rJ)E=Math.log(p/c)/t,w=function($){return[a+$*m,u+$*y,c*Math.exp(t*$*E)]};else{var S=Math.sqrt(v),A=(p*p-c*c+r*v)/(2*c*n*S),C=(p*p-c*c-r*v)/(2*p*n*S),k=Math.log(Math.sqrt(A*A+1)-A),D=Math.log(Math.sqrt(C*C+1)-C);E=(D-k)/t,w=function($){var M=$*E,T=BT(k),L=c/(n*S)*(T*oJ(t*M+k)-iJ(k));return[a+L*m,u+L*y,c*T/BT(t*M+k)]}}return w.duration=E*1e3*t/Math.SQRT2,w}return i.rho=function(o){var s=Math.max(.001,+o),a=s*s,u=a*a;return e(s,a,u)},i})(Math.SQRT2,2,4);function I9(e){return function(t,n){var r=e((t=T1(t)).h,(n=T1(n)).h),i=gn(t.s,n.s),o=gn(t.l,n.l),s=gn(t.opacity,n.opacity);return function(a){return t.h=r(a),t.s=i(a),t.l=o(a),t.opacity=s(a),t+""}}}const aJ=I9(_v);var uJ=I9(gn);function lJ(e,t){var n=gn((e=R1(e)).l,(t=R1(t)).l),r=gn(e.a,t.a),i=gn(e.b,t.b),o=gn(e.opacity,t.opacity);return function(s){return e.l=n(s),e.a=r(s),e.b=i(s),e.opacity=o(s),e+""}}function B9(e){return function(t,n){var r=e((t=O1(t)).h,(n=O1(n)).h),i=gn(t.c,n.c),o=gn(t.l,n.l),s=gn(t.opacity,n.opacity);return function(a){return t.h=r(a),t.c=i(a),t.l=o(a),t.opacity=s(a),t+""}}}const cJ=B9(_v);var fJ=B9(gn);function U9(e){return(function t(n){n=+n;function r(i,o){var s=e((i=gS(i)).h,(o=gS(o)).h),a=gn(i.s,o.s),u=gn(i.l,o.l),c=gn(i.opacity,o.opacity);return function(f){return i.h=s(f),i.s=a(f),i.l=u(Math.pow(f,n)),i.opacity=c(f),i+""}}return r.gamma=t,r})(1)}const dJ=U9(_v);var hJ=U9(gn);function WC(e,t){t===void 0&&(t=e,e=mu);for(var n=0,r=t.length-1,i=t[0],o=new Array(r<0?0:r);n<r;)o[n]=e(i,i=t[++n]);return function(s){var a=Math.max(0,Math.min(r-1,Math.floor(s*=r)));return o[a](s-a)}}function pJ(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n}const gJ=Object.freeze(Object.defineProperty({__proto__:null,interpolate:mu,interpolateArray:YK,interpolateBasis:$9,interpolateBasisClosed:F9,interpolateCubehelix:dJ,interpolateCubehelixLong:hJ,interpolateDate:R9,interpolateDiscrete:KK,interpolateHcl:cJ,interpolateHclLong:fJ,interpolateHsl:aJ,interpolateHslLong:uJ,interpolateHue:JK,interpolateLab:lJ,interpolateNumber:Xi,interpolateNumberArray:jC,interpolateObject:O9,interpolateRgb:mS,interpolateRgbBasis:GK,interpolateRgbBasisClosed:VK,interpolateRound:sg,interpolateString:P9,interpolateTransformCss:tJ,interpolateTransformSvg:nJ,interpolateZoom:sJ,piecewise:WC,quantize:pJ},Symbol.toStringTag,{value:"Module"}));function mJ(e){return function(){return e}}function xS(e){return+e}var UT=[0,1];function Or(e){return e}function wS(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:mJ(isNaN(t)?NaN:.5)}function yJ(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function vJ(e,t,n){var r=e[0],i=e[1],o=t[0],s=t[1];return i<r?(r=wS(i,r),o=n(s,o)):(r=wS(r,i),o=n(o,s)),function(a){return o(r(a))}}function xJ(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),o=new Array(r),s=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<r;)i[s]=wS(e[s],e[s+1]),o[s]=n(t[s],t[s+1]);return function(a){var u=Ja(e,a,1,r)-1;return o[u](i[u](a))}}function ag(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Av(){var e=UT,t=UT,n=mu,r,i,o,s=Or,a,u,c;function f(){var p=Math.min(e.length,t.length);return s!==Or&&(s=yJ(e[0],e[p-1])),a=p>2?xJ:vJ,u=c=null,h}function h(p){return p==null||isNaN(p=+p)?o:(u||(u=a(e.map(r),t,n)))(r(s(p)))}return h.invert=function(p){return s(i((c||(c=a(t,e.map(r),Xi)))(p)))},h.domain=function(p){return arguments.length?(e=Array.from(p,xS),f()):e.slice()},h.range=function(p){return arguments.length?(t=Array.from(p),f()):t.slice()},h.rangeRound=function(p){return t=Array.from(p),n=sg,f()},h.clamp=function(p){return arguments.length?(s=p?!0:Or,f()):s!==Or},h.interpolate=function(p){return arguments.length?(n=p,f()):n},h.unknown=function(p){return arguments.length?(o=p,h):o},function(p,m){return r=p,i=m,f()}}function j9(){return Av()(Or,Or)}function W9(e,t,n,r){var i=Za(e,t,n),o;switch(r=bl(r??",f"),r.type){case"s":{var s=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(o=g8(i,s))&&(r.precision=o),DA(r,s)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(o=m8(i,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=o-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(o=p8(i))&&(r.precision=o-(r.type==="%")*2);break}}return ev(r)}function Ql(e){var t=e.domain;return e.ticks=function(n){var r=t();return Jb(r[0],r[r.length-1],n??10)},e.tickFormat=function(n,r){var i=t();return W9(i[0],i[i.length-1],n??10,r)},e.nice=function(n){n==null&&(n=10);var r=t(),i=0,o=r.length-1,s=r[i],a=r[o],u,c,f=10;for(a<s&&(c=s,s=a,a=c,c=i,i=o,o=c);f-- >0;){if(c=Zb(s,a,n),c===u)return r[i]=s,r[o]=a,t(r);if(c>0)s=Math.floor(s/c)*c,a=Math.ceil(a/c)*c;else if(c<0)s=Math.ceil(s*c)/c,a=Math.floor(a*c)/c;else break;u=c}return e},e}function q9(){var e=j9();return e.copy=function(){return ag(e,q9())},ts.apply(e,arguments),Ql(e)}function H9(e){var t;function n(r){return r==null||isNaN(r=+r)?t:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(e=Array.from(r,xS),n):e.slice()},n.unknown=function(r){return arguments.length?(t=r,n):t},n.copy=function(){return H9(e).unknown(t)},e=arguments.length?Array.from(e,xS):[0,1],Ql(n)}function G9(e,t){e=e.slice();var n=0,r=e.length-1,i=e[n],o=e[r],s;return o<i&&(s=n,n=r,r=s,s=i,i=o,o=s),e[n]=t.floor(i),e[r]=t.ceil(o),e}function jT(e){return Math.log(e)}function WT(e){return Math.exp(e)}function wJ(e){return-Math.log(-e)}function EJ(e){return-Math.exp(-e)}function bJ(e){return isFinite(e)?+("1e"+e):e<0?0:e}function SJ(e){return e===10?bJ:e===Math.E?Math.exp:t=>Math.pow(e,t)}function _J(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function qT(e){return(t,n)=>-e(-t,n)}function qC(e){const t=e(jT,WT),n=t.domain;let r=10,i,o;function s(){return i=_J(r),o=SJ(r),n()[0]<0?(i=qT(i),o=qT(o),e(wJ,EJ)):e(jT,WT),t}return t.base=function(a){return arguments.length?(r=+a,s()):r},t.domain=function(a){return arguments.length?(n(a),s()):n()},t.ticks=a=>{const u=n();let c=u[0],f=u[u.length-1];const h=f<c;h&&([c,f]=[f,c]);let p=i(c),m=i(f),y,v;const w=a==null?10:+a;let E=[];if(!(r%1)&&m-p<w){if(p=Math.floor(p),m=Math.ceil(m),c>0){for(;p<=m;++p)for(y=1;y<r;++y)if(v=p<0?y/o(-p):y*o(p),!(v<c)){if(v>f)break;E.push(v)}}else for(;p<=m;++p)for(y=r-1;y>=1;--y)if(v=p>0?y/o(-p):y*o(p),!(v<c)){if(v>f)break;E.push(v)}E.length*2<w&&(E=Jb(c,f,w))}else E=Jb(p,m,Math.min(m-p,w)).map(o);return h?E.reverse():E},t.tickFormat=(a,u)=>{if(a==null&&(a=10),u==null&&(u=r===10?"s":","),typeof u!="function"&&(!(r%1)&&(u=bl(u)).precision==null&&(u.trim=!0),u=ev(u)),a===1/0)return u;const c=Math.max(1,r*a/t.ticks().length);return f=>{let h=f/o(Math.round(i(f)));return h*r<r-.5&&(h*=r),h<=c?u(f):""}},t.nice=()=>n(G9(n(),{floor:a=>o(Math.floor(i(a))),ceil:a=>o(Math.ceil(i(a)))})),t}function V9(){const e=qC(Av()).domain([1,10]);return e.copy=()=>ag(e,V9()).base(e.base()),ts.apply(e,arguments),e}function HT(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function GT(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function HC(e){var t=1,n=e(HT(t),GT(t));return n.constant=function(r){return arguments.length?e(HT(t=+r),GT(t)):t},Ql(n)}function Y9(){var e=HC(Av());return e.copy=function(){return ag(e,Y9()).constant(e.constant())},ts.apply(e,arguments)}function VT(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function AJ(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function CJ(e){return e<0?-e*e:e*e}function GC(e){var t=e(Or,Or),n=1;function r(){return n===1?e(Or,Or):n===.5?e(AJ,CJ):e(VT(n),VT(1/n))}return t.exponent=function(i){return arguments.length?(n=+i,r()):n},Ql(t)}function VC(){var e=GC(Av());return e.copy=function(){return ag(e,VC()).exponent(e.exponent())},ts.apply(e,arguments),e}function kJ(){return VC.apply(null,arguments).exponent(.5)}function X9(){var e=[],t=[],n=[],r;function i(){var s=0,a=Math.max(1,t.length);for(n=new Array(a-1);++s<a;)n[s-1]=u8(e,s/a);return o}function o(s){return s==null||isNaN(s=+s)?r:t[Ja(n,s)]}return o.invertExtent=function(s){var a=t.indexOf(s);return a<0?[NaN,NaN]:[a>0?n[a-1]:e[0],a<n.length?n[a]:e[e.length-1]]},o.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let a of s)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(Is),i()},o.range=function(s){return arguments.length?(t=Array.from(s),i()):t.slice()},o.unknown=function(s){return arguments.length?(r=s,o):r},o.quantiles=function(){return n.slice()},o.copy=function(){return X9().domain(e).range(t).unknown(r)},ts.apply(o,arguments)}function Q9(){var e=0,t=1,n=1,r=[.5],i=[0,1],o;function s(u){return u!=null&&u<=u?i[Ja(r,u,0,n)]:o}function a(){var u=-1;for(r=new Array(n);++u<n;)r[u]=((u+1)*t-(u-n)*e)/(n+1);return s}return s.domain=function(u){return arguments.length?([e,t]=u,e=+e,t=+t,a()):[e,t]},s.range=function(u){return arguments.length?(n=(i=Array.from(u)).length-1,a()):i.slice()},s.invertExtent=function(u){var c=i.indexOf(u);return c<0?[NaN,NaN]:c<1?[e,r[0]]:c>=n?[r[n-1],t]:[r[c-1],r[c]]},s.unknown=function(u){return arguments.length&&(o=u),s},s.thresholds=function(){return r.slice()},s.copy=function(){return Q9().domain([e,t]).range(i).unknown(o)},ts.apply(Ql(s),arguments)}function K9(){var e=[.5],t=[0,1],n,r=1;function i(o){return o!=null&&o<=o?t[Ja(e,o,0,r)]:n}return i.domain=function(o){return arguments.length?(e=Array.from(o),r=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(o){return arguments.length?(t=Array.from(o),r=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(o){var s=t.indexOf(o);return[e[s-1],e[s]]},i.unknown=function(o){return arguments.length?(n=o,i):n},i.copy=function(){return K9().domain(e).range(t).unknown(n)},ts.apply(i,arguments)}function $J(e){return new Date(e)}function FJ(e){return e instanceof Date?+e:+new Date(+e)}function YC(e,t,n,r,i,o,s,a,u,c){var f=j9(),h=f.invert,p=f.domain,m=c(".%L"),y=c(":%S"),v=c("%I:%M"),w=c("%I %p"),E=c("%a %d"),S=c("%b %d"),A=c("%B"),C=c("%Y");function k(D){return(u(D)<D?m:a(D)<D?y:s(D)<D?v:o(D)<D?w:r(D)<D?i(D)<D?E:S:n(D)<D?A:C)(D)}return f.invert=function(D){return new Date(h(D))},f.domain=function(D){return arguments.length?p(Array.from(D,FJ)):p().map($J)},f.ticks=function(D){var $=p();return e($[0],$[$.length-1],D??10)},f.tickFormat=function(D,$){return $==null?k:c($)},f.nice=function(D){var $=p();return(!D||typeof D.range!="function")&&(D=t($[0],$[$.length-1],D??10)),D?p(G9($,D)):f},f.copy=function(){return ag(f,YC(e,t,n,r,i,o,s,a,u,c))},f}function DJ(){return ts.apply(YC(PV,LV,Go,Ep,rd,Bs,rv,tv,Os,OA).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function MJ(){return ts.apply(YC(RV,OV,Vo,bp,id,Va,iv,nv,Os,PA).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Cv(){var e=0,t=1,n,r,i,o,s=Or,a=!1,u;function c(h){return h==null||isNaN(h=+h)?u:s(i===0?.5:(h=(o(h)-n)*i,a?Math.max(0,Math.min(1,h)):h))}c.domain=function(h){return arguments.length?([e,t]=h,n=o(e=+e),r=o(t=+t),i=n===r?0:1/(r-n),c):[e,t]},c.clamp=function(h){return arguments.length?(a=!!h,c):a},c.interpolator=function(h){return arguments.length?(s=h,c):s};function f(h){return function(p){var m,y;return arguments.length?([m,y]=p,s=h(m,y),c):[s(0),s(1)]}}return c.range=f(mu),c.rangeRound=f(sg),c.unknown=function(h){return arguments.length?(u=h,c):u},function(h){return o=h,n=h(e),r=h(t),i=n===r?0:1/(r-n),c}}function yu(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function XC(){var e=Ql(Cv()(Or));return e.copy=function(){return yu(e,XC())},pu.apply(e,arguments)}function J9(){var e=qC(Cv()).domain([1,10]);return e.copy=function(){return yu(e,J9()).base(e.base())},pu.apply(e,arguments)}function Z9(){var e=HC(Cv());return e.copy=function(){return yu(e,Z9()).constant(e.constant())},pu.apply(e,arguments)}function QC(){var e=GC(Cv());return e.copy=function(){return yu(e,QC()).exponent(e.exponent())},pu.apply(e,arguments)}function TJ(){return QC.apply(null,arguments).exponent(.5)}function kv(){var e=0,t=.5,n=1,r=1,i,o,s,a,u,c=Or,f,h=!1,p;function m(v){return isNaN(v=+v)?p:(v=.5+((v=+f(v))-o)*(r*v<r*o?a:u),c(h?Math.max(0,Math.min(1,v)):v))}m.domain=function(v){return arguments.length?([e,t,n]=v,i=f(e=+e),o=f(t=+t),s=f(n=+n),a=i===o?0:.5/(o-i),u=o===s?0:.5/(s-o),r=o<i?-1:1,m):[e,t,n]},m.clamp=function(v){return arguments.length?(h=!!v,m):h},m.interpolator=function(v){return arguments.length?(c=v,m):c};function y(v){return function(w){var E,S,A;return arguments.length?([E,S,A]=w,c=WC(v,[E,S,A]),m):[c(0),c(.5),c(1)]}}return m.range=y(mu),m.rangeRound=y(sg),m.unknown=function(v){return arguments.length?(p=v,m):p},function(v){return f=v,i=v(e),o=v(t),s=v(n),a=i===o?0:.5/(o-i),u=o===s?0:.5/(s-o),r=o<i?-1:1,m}}function eL(){var e=Ql(kv()(Or));return e.copy=function(){return yu(e,eL())},pu.apply(e,arguments)}function tL(){var e=qC(kv()).domain([.1,1,10]);return e.copy=function(){return yu(e,tL()).base(e.base())},pu.apply(e,arguments)}function nL(){var e=HC(kv());return e.copy=function(){return yu(e,nL()).constant(e.constant())},pu.apply(e,arguments)}function KC(){var e=GC(kv());return e.copy=function(){return yu(e,KC()).exponent(e.exponent())},pu.apply(e,arguments)}function NJ(){return KC.apply(null,arguments).exponent(.5)}function ns(e){for(var t=e.length/6|0,n=new Array(t),r=0;r<t;)n[r]="#"+e.slice(r*6,++r*6);return n}const RJ=ns("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),OJ=ns("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),PJ=ns("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),LJ=ns("4269d0efb118ff725c6cc5b03ca951ff8ab7a463f297bbf59c6b4e9498a0"),zJ=ns("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),IJ=ns("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),BJ=ns("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),UJ=ns("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),jJ=ns("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),WJ=ns("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f");function JC(e,t,n){const r=e-t+n*2;return e?r>0?r:1:0}const qJ="identity",_f="linear",Ys="log",ug="pow",lg="sqrt",$v="symlog",_l="time",Al="utc",Uo="sequential",ld="diverging",Af="quantile",Fv="quantize",Dv="threshold",ZC="ordinal",ES="point",rL="band",ek="bin-ordinal",ln="continuous",cg="discrete",fg="discretizing",Ri="interpolating",tk="temporal";function HJ(e){return function(t){let n=t[0],r=t[1],i;return r<n&&(i=n,n=r,r=i),[e.invert(n),e.invert(r)]}}function GJ(e){return function(t){const n=e.range();let r=t[0],i=t[1],o=-1,s,a,u,c;for(i<r&&(a=r,r=i,i=a),u=0,c=n.length;u<c;++u)n[u]>=r&&n[u]<=i&&(o<0&&(o=u),s=u);if(!(o<0))return r=e.invertExtent(n[o]),i=e.invertExtent(n[s]),[r[0]===void 0?r[1]:r[0],i[1]===void 0?i[0]:i[1]]}}function nk(){const e=zC().unknown(void 0),t=e.domain,n=e.range;let r=[0,1],i,o,s=!1,a=0,u=0,c=.5;delete e.unknown;function f(){const h=t().length,p=r[1]<r[0],m=r[1-p],y=JC(h,a,u);let v=r[p-0];i=(m-v)/(y||1),s&&(i=Math.floor(i)),v+=(m-v-i*(h-a))*c,o=i*(1-a),s&&(v=Math.round(v),o=Math.round(o));const w=ei(h).map(E=>v+i*E);return n(p?w.reverse():w)}return e.domain=function(h){return arguments.length?(t(h),f()):t()},e.range=function(h){return arguments.length?(r=[+h[0],+h[1]],f()):r.slice()},e.rangeRound=function(h){return r=[+h[0],+h[1]],s=!0,f()},e.bandwidth=function(){return o},e.step=function(){return i},e.round=function(h){return arguments.length?(s=!!h,f()):s},e.padding=function(h){return arguments.length?(u=Math.max(0,Math.min(1,h)),a=u,f()):a},e.paddingInner=function(h){return arguments.length?(a=Math.max(0,Math.min(1,h)),f()):a},e.paddingOuter=function(h){return arguments.length?(u=Math.max(0,Math.min(1,h)),f()):u},e.align=function(h){return arguments.length?(c=Math.max(0,Math.min(1,h)),f()):c},e.invertRange=function(h){if(h[0]==null||h[1]==null)return;const p=r[1]<r[0],m=p?n().reverse():n(),y=m.length-1;let v=+h[0],w=+h[1],E,S,A;if(!(v!==v||w!==w)&&(w<v&&(A=v,v=w,w=A),!(w<m[0]||v>r[1-p])))return E=Math.max(0,Ja(m,v)-1),S=v===w?E:Ja(m,w)-1,v-m[E]>o+1e-10&&++E,p&&(A=E,E=y-S,S=y-A),E>S?void 0:t().slice(E,S+1)},e.invert=function(h){const p=e.invertRange([h,h]);return p&&p[0]},e.copy=function(){return nk().domain(t()).range(r).round(s).paddingInner(a).paddingOuter(u).align(c)},f()}function iL(e){const t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return iL(t())},e}function VJ(){return iL(nk().paddingInner(1))}var YJ=Array.prototype.map;function XJ(e){return YJ.call(e,Vn)}const QJ=Array.prototype.slice;function oL(){let e=[],t=[];function n(r){return r==null||r!==r?void 0:t[(Ja(e,r)-1)%t.length]}return n.domain=function(r){return arguments.length?(e=XJ(r),n):e.slice()},n.range=function(r){return arguments.length?(t=QJ.call(r),n):t.slice()},n.tickFormat=function(r,i){return W9(e[0],Ze(e),r??10,i)},n.copy=function(){return oL().domain(n.domain()).range(n.range())},n}const P1=new Map,sL=Symbol("vega_scale");function aL(e){return e[sL]=!0,e}function YT(e){return e&&e[sL]===!0}function KJ(e,t,n){const r=function(){const o=t();return o.invertRange||(o.invertRange=o.invert?HJ(o):o.invertExtent?GJ(o):void 0),o.type=e,aL(o)};return r.metadata=oo(xe(n)),r}function lt(e,t,n){return arguments.length>1?(P1.set(e,KJ(e,t,n)),this):uL(e)?P1.get(e):void 0}lt(qJ,H9);lt(_f,q9,ln);lt(Ys,V9,[ln,Ys]);lt(ug,VC,ln);lt(lg,kJ,ln);lt($v,Y9,ln);lt(_l,DJ,[ln,tk]);lt(Al,MJ,[ln,tk]);lt(Uo,XC,[ln,Ri]);lt(`${Uo}-${_f}`,XC,[ln,Ri]);lt(`${Uo}-${Ys}`,J9,[ln,Ri,Ys]);lt(`${Uo}-${ug}`,QC,[ln,Ri]);lt(`${Uo}-${lg}`,TJ,[ln,Ri]);lt(`${Uo}-${$v}`,Z9,[ln,Ri]);lt(`${ld}-${_f}`,eL,[ln,Ri]);lt(`${ld}-${Ys}`,tL,[ln,Ri,Ys]);lt(`${ld}-${ug}`,KC,[ln,Ri]);lt(`${ld}-${lg}`,NJ,[ln,Ri]);lt(`${ld}-${$v}`,nL,[ln,Ri]);lt(Af,X9,[fg,Af]);lt(Fv,Q9,fg);lt(Dv,K9,fg);lt(ek,oL,[cg,fg]);lt(ZC,zC,cg);lt(rL,nk,cg);lt(ES,VJ,cg);function uL(e){return P1.has(e)}function Kl(e,t){const n=P1.get(e);return n&&n.metadata[t]}function rk(e){return Kl(e,ln)}function Cf(e){return Kl(e,cg)}function bS(e){return Kl(e,fg)}function lL(e){return Kl(e,Ys)}function JJ(e){return Kl(e,tk)}function cL(e){return Kl(e,Ri)}function fL(e){return Kl(e,Af)}const ZJ=["clamp","base","constant","exponent"];function dL(e,t){const n=t[0],r=Ze(t)-n;return function(i){return e(n+i*r)}}function Mv(e,t,n){return WC(ik(t||"rgb",n),e)}function hL(e,t){const n=new Array(t),r=t+1;for(let i=0;i<t;)n[i]=e(++i/r);return n}function pL(e,t,n){const r=n-t;let i,o,s;return!r||!Number.isFinite(r)?nr(.5):(i=(o=e.type).indexOf("-"),o=i<0?o:o.slice(i+1),s=lt(o)().domain([t,n]).range([0,1]),ZJ.forEach(a=>e[a]?s[a](e[a]()):0),s)}function ik(e,t){const n=gJ[eZ(e)];return t!=null&&n&&n.gamma?n.gamma(t):n}function eZ(e){return"interpolate"+e.toLowerCase().split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}const tZ={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},nZ={accent:OJ,category10:RJ,category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",dark2:PJ,observable10:LJ,paired:zJ,pastel1:IJ,pastel2:BJ,set1:UJ,set2:jJ,set3:WJ,tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5"};function gL(e){if(ne(e))return e;const t=e.length/6|0,n=new Array(t);for(let r=0;r<t;)n[r]="#"+e.slice(r*6,++r*6);return n}function mL(e,t){for(const n in e)ok(n,t(e[n]))}const XT={};mL(nZ,gL);mL(tZ,e=>Mv(gL(e)));function ok(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(XT[e]=t,this):XT[e]}const Ym="symbol",rZ="discrete",iZ="gradient",oZ=e=>ne(e)?e.map(t=>String(t)):String(e),sZ=(e,t)=>e[1]-t[1],aZ=(e,t)=>t[1]-e[1];function sk(e,t,n){let r;return at(t)&&(e.bins&&(t=Math.max(t,e.bins.length)),n!=null&&(t=Math.min(t,Math.floor(tg(e.domain())/n||1)+1))),ye(t)&&(r=t.step,t=t.interval),ve(t)&&(t=e.type===_l?od(t):e.type==Al?sd(t):te("Only time and utc scales accept interval strings."),r&&(t=t.every(r))),t}function yL(e,t,n){let r=e.range(),i=r[0],o=Ze(r),s=sZ;if(i>o&&(r=o,o=i,i=r,s=aZ),i=Math.floor(i),o=Math.ceil(o),t=t.map(a=>[a,e(a)]).filter(a=>i<=a[1]&&a[1]<=o).sort(s).map(a=>a[0]),n>0&&t.length>1){const a=[t[0],Ze(t)];for(;t.length>n&&t.length>=3;)t=t.filter((u,c)=>!(c%2));t.length<3&&(t=a)}return t}function ak(e,t){return e.bins?yL(e,e.bins,t):e.ticks?e.ticks(t):e.domain()}function vL(e,t,n,r,i,o){const s=t.type;let a=oZ;if(s===_l||i===_l)a=e.timeFormat(r);else if(s===Al||i===Al)a=e.utcFormat(r);else if(lL(s)){const u=e.formatFloat(r);if(o||t.bins)a=u;else{const c=xL(t,n,!1);a=f=>c(f)?u(f):""}}else if(t.tickFormat){const u=t.domain();a=e.formatSpan(u[0],u[u.length-1],n,r)}else r&&(a=e.format(r));return a}function xL(e,t,n){const r=ak(e,t),i=e.base(),o=Math.log(i),s=Math.max(1,i*t/r.length),a=u=>{let c=u/Math.pow(i,Math.round(Math.log(u)/o));return c*i<i-.5&&(c*=i),c<=s};return n?r.filter(a):a}const SS={[Af]:"quantiles",[Fv]:"thresholds",[Dv]:"domain"},wL={[Af]:"quantiles",[Fv]:"domain"};function EL(e,t){return e.bins?cZ(e.bins):e.type===Ys?xL(e,t,!0):SS[e.type]?lZ(e[SS[e.type]]()):ak(e,t)}function uZ(e,t,n){const r=t[wL[t.type]](),i=r.length;let o=i>1?r[1]-r[0]:r[0],s;for(s=1;s<i;++s)o=Math.min(o,r[s]-r[s-1]);return e.formatSpan(0,o,30,n)}function lZ(e){const t=[-1/0].concat(e);return t.max=1/0,t}function cZ(e){const t=e.slice(0,-1);return t.max=Ze(e),t}const fZ=e=>SS[e.type]||e.bins;function bL(e,t,n,r,i,o,s){const a=wL[t.type]&&o!==_l&&o!==Al?uZ(e,t,i):vL(e,t,n,i,o,s);return r===Ym&&fZ(t)?dZ(a):r===rZ?hZ(a):pZ(a)}const dZ=e=>(t,n,r)=>{const i=QT(r[n+1],QT(r.max,1/0)),o=KT(t,e),s=KT(i,e);return o&&s?o+" – "+s:s?"< "+s:"≥ "+o},QT=(e,t)=>e??t,hZ=e=>(t,n)=>n?e(t):null,pZ=e=>t=>e(t),KT=(e,t)=>Number.isFinite(e)?t(e):null;function gZ(e){const t=e.domain(),n=t.length-1;let r=+t[0],i=+Ze(t),o=i-r;if(e.type===Dv){const s=n?o/n:.1;r-=s,i+=s,o=i-r}return s=>(s-r)/o}function mZ(e,t,n,r){const i=r||t.type;return ve(n)&&JJ(i)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),!n&&i===_l?e.timeFormat("%A, %d %B %Y, %X"):!n&&i===Al?e.utcFormat("%A, %d %B %Y, %X UTC"):bL(e,t,5,null,n,r,!0)}function SL(e,t,n){n=n||{};const r=Math.max(3,n.maxlen||7),i=mZ(e,t,n.format,n.formatType);if(bS(t.type)){const o=EL(t).slice(1).map(i),s=o.length;return`${s} boundar${s===1?"y":"ies"}: ${o.join(", ")}`}else if(Cf(t.type)){const o=t.domain(),s=o.length,a=s>r?o.slice(0,r-2).map(i).join(", ")+", ending with "+o.slice(-1).map(i):o.map(i).join(", ");return`${s} value${s===1?"":"s"}: ${a}`}else{const o=t.domain();return`values from ${i(o[0])} to ${i(Ze(o))}`}}let _L=0;function yZ(){_L=0}const L1="p_";function uk(e){return e&&e.gradient}function AL(e,t,n){const r=e.gradient;let i=e.id,o=r==="radial"?L1:"";return i||(i=e.id="gradient_"+_L++,r==="radial"?(e.x1=$o(e.x1,.5),e.y1=$o(e.y1,.5),e.r1=$o(e.r1,0),e.x2=$o(e.x2,.5),e.y2=$o(e.y2,.5),e.r2=$o(e.r2,.5),o=L1):(e.x1=$o(e.x1,0),e.y1=$o(e.y1,0),e.x2=$o(e.x2,1),e.y2=$o(e.y2,0))),t[i]=e,"url("+(n||"")+"#"+o+i+")"}function $o(e,t){return e??t}function CL(e,t){var n=[],r;return r={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:n,stop:function(i,o){return n.push({offset:i,color:o}),r}}}const JT={basis:{curve:hK},"basis-closed":{curve:pK},"basis-open":{curve:gK},bundle:{curve:mK,tension:"beta",value:.85},cardinal:{curve:yK,tension:"tension",value:0},"cardinal-open":{curve:xK,tension:"tension",value:0},"cardinal-closed":{curve:vK,tension:"tension",value:0},"catmull-rom":{curve:wK,tension:"alpha",value:.5},"catmull-rom-closed":{curve:EK,tension:"alpha",value:.5},"catmull-rom-open":{curve:bK,tension:"alpha",value:.5},linear:{curve:NC},"linear-closed":{curve:SK},monotone:{horizontal:AK,vertical:_K},natural:{curve:CK},step:{curve:kK},"step-after":{curve:FK},"step-before":{curve:$K}};function lk(e,t,n){var r=Ee(JT,e)&&JT[e],i=null;return r&&(i=r.curve||r[t||"vertical"],r.tension&&n!=null&&(i=i[r.tension](n))),i}const vZ={m:2,l:2,h:1,v:1,z:0,c:6,s:4,q:4,t:2,a:7},xZ=/[mlhvzcsqta]([^mlhvzcsqta]+|$)/gi,wZ=/^[+-]?(([0-9]*\.[0-9]+)|([0-9]+\.)|([0-9]+))([eE][+-]?[0-9]+)?/,EZ=/^((\s+,?\s*)|(,\s*))/,bZ=/^[01]/;function kf(e){const t=[];return(e.match(xZ)||[]).forEach(r=>{let i=r[0];const o=i.toLowerCase(),s=vZ[o],a=SZ(o,s,r.slice(1).trim()),u=a.length;if(u<s||u&&u%s!==0)throw Error("Invalid SVG path, incorrect parameter count");if(t.push([i,...a.slice(0,s)]),u!==s){o==="m"&&(i=i==="M"?"L":"l");for(let c=s;c<u;c+=s)t.push([i,...a.slice(c,c+s)])}}),t}function SZ(e,t,n){const r=[];for(let i=0;t&&i<n.length;)for(let o=0;o<t;++o){const s=e==="a"&&(o===3||o===4)?bZ:wZ,a=n.slice(i).match(s);if(a===null)throw Error("Invalid SVG path, incorrect parameter type");i+=a[0].length,r.push(+a[0]);const u=n.slice(i).match(EZ);u!==null&&(i+=u[0].length)}return r}const ru=Math.PI/180,_Z=1e-14,il=Math.PI/2,Ro=Math.PI*2,zc=Math.sqrt(3)/2;var AE={},CE={},kL=[].join;function AZ(e,t,n,r,i,o,s,a,u){const c=kL.call(arguments);if(AE[c])return AE[c];const f=s*ru,h=Math.sin(f),p=Math.cos(f);n=Math.abs(n),r=Math.abs(r);const m=p*(a-e)*.5+h*(u-t)*.5,y=p*(u-t)*.5-h*(a-e)*.5;let v=m*m/(n*n)+y*y/(r*r);v>1&&(v=Math.sqrt(v),n*=v,r*=v);const w=p/n,E=h/n,S=-h/r,A=p/r,C=w*a+E*u,k=S*a+A*u,D=w*e+E*t,$=S*e+A*t;let T=1/((D-C)*(D-C)+($-k)*($-k))-.25;T<0&&(T=0);let L=Math.sqrt(T);o==i&&(L=-L);const O=.5*(C+D)-L*($-k),X=.5*(k+$)+L*(D-C),W=Math.atan2(k-X,C-O);let N=Math.atan2($-X,D-O)-W;N<0&&o===1?N+=Ro:N>0&&o===0&&(N-=Ro);const U=Math.ceil(Math.abs(N/(il+.001))),Y=[];for(let j=0;j<U;++j){const q=W+j*N/U,K=W+(j+1)*N/U;Y[j]=[O,X,q,K,n,r,h,p]}return AE[c]=Y}function CZ(e){const t=kL.call(e);if(CE[t])return CE[t];var n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],u=e[6],c=e[7];const f=c*s,h=-u*a,p=u*s,m=c*a,y=Math.cos(i),v=Math.sin(i),w=Math.cos(o),E=Math.sin(o),S=.5*(o-i),A=Math.sin(S*.5),C=8/3*A*A/Math.sin(S),k=n+y-C*v,D=r+v+C*y,$=n+w,M=r+E,T=$+C*E,L=M-C*w;return CE[t]=[f*k+h*D,p*k+m*D,f*T+h*L,p*T+m*L,f*$+h*M,p*$+m*M]}const mi=["l",0,0,0,0,0,0,0];function kZ(e,t,n){const r=mi[0]=e[0];if(r==="a"||r==="A")mi[1]=t*e[1],mi[2]=n*e[2],mi[3]=e[3],mi[4]=e[4],mi[5]=e[5],mi[6]=t*e[6],mi[7]=n*e[7];else if(r==="h"||r==="H")mi[1]=t*e[1];else if(r==="v"||r==="V")mi[1]=n*e[1];else for(var i=1,o=e.length;i<o;++i)mi[i]=(i%2==1?t:n)*e[i];return mi}function Fp(e,t,n,r,i,o){var s,a=null,u=0,c=0,f=0,h=0,p,m,y,v,w=0,E=0;n==null&&(n=0),r==null&&(r=0),i==null&&(i=1),o==null&&(o=i),e.beginPath&&e.beginPath();for(var S=0,A=t.length;S<A;++S){switch(s=t[S],(i!==1||o!==1)&&(s=kZ(s,i,o)),s[0]){case"l":u+=s[1],c+=s[2],e.lineTo(u+n,c+r);break;case"L":u=s[1],c=s[2],e.lineTo(u+n,c+r);break;case"h":u+=s[1],e.lineTo(u+n,c+r);break;case"H":u=s[1],e.lineTo(u+n,c+r);break;case"v":c+=s[1],e.lineTo(u+n,c+r);break;case"V":c=s[1],e.lineTo(u+n,c+r);break;case"m":u+=s[1],c+=s[2],w=u,E=c,e.moveTo(u+n,c+r);break;case"M":u=s[1],c=s[2],w=u,E=c,e.moveTo(u+n,c+r);break;case"c":p=u+s[5],m=c+s[6],f=u+s[3],h=c+s[4],e.bezierCurveTo(u+s[1]+n,c+s[2]+r,f+n,h+r,p+n,m+r),u=p,c=m;break;case"C":u=s[5],c=s[6],f=s[3],h=s[4],e.bezierCurveTo(s[1]+n,s[2]+r,f+n,h+r,u+n,c+r);break;case"s":p=u+s[3],m=c+s[4],f=2*u-f,h=2*c-h,e.bezierCurveTo(f+n,h+r,u+s[1]+n,c+s[2]+r,p+n,m+r),f=u+s[1],h=c+s[2],u=p,c=m;break;case"S":p=s[3],m=s[4],f=2*u-f,h=2*c-h,e.bezierCurveTo(f+n,h+r,s[1]+n,s[2]+r,p+n,m+r),u=p,c=m,f=s[1],h=s[2];break;case"q":p=u+s[3],m=c+s[4],f=u+s[1],h=c+s[2],e.quadraticCurveTo(f+n,h+r,p+n,m+r),u=p,c=m;break;case"Q":p=s[3],m=s[4],e.quadraticCurveTo(s[1]+n,s[2]+r,p+n,m+r),u=p,c=m,f=s[1],h=s[2];break;case"t":p=u+s[1],m=c+s[2],a[0].match(/[QqTt]/)===null?(f=u,h=c):a[0]==="t"?(f=2*u-y,h=2*c-v):a[0]==="q"&&(f=2*u-f,h=2*c-h),y=f,v=h,e.quadraticCurveTo(f+n,h+r,p+n,m+r),u=p,c=m,f=u+s[1],h=c+s[2];break;case"T":p=s[1],m=s[2],f=2*u-f,h=2*c-h,e.quadraticCurveTo(f+n,h+r,p+n,m+r),u=p,c=m;break;case"a":ZT(e,u+n,c+r,[s[1],s[2],s[3],s[4],s[5],s[6]+u+n,s[7]+c+r]),u+=s[6],c+=s[7];break;case"A":ZT(e,u+n,c+r,[s[1],s[2],s[3],s[4],s[5],s[6]+n,s[7]+r]),u=s[6],c=s[7];break;case"z":case"Z":u=w,c=E,e.closePath();break}a=s}}function ZT(e,t,n,r){const i=AZ(r[5],r[6],r[0],r[1],r[3],r[4],r[2],t,n);for(let o=0;o<i.length;++o){const s=CZ(i[o]);e.bezierCurveTo(s[0],s[1],s[2],s[3],s[4],s[5])}}const eN=.5773502691896257,tN={circle:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,Ro)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/2.5;e.moveTo(-n,-r),e.lineTo(-n,r),e.lineTo(-r,r),e.lineTo(-r,n),e.lineTo(r,n),e.lineTo(r,r),e.lineTo(n,r),e.lineTo(n,-r),e.lineTo(r,-r),e.lineTo(r,-n),e.lineTo(-r,-n),e.lineTo(-r,-r),e.closePath()}},diamond:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),r=-n/2;e.rect(r,r,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/7,i=n/2.5,o=n/8;e.moveTo(-r,n),e.lineTo(r,n),e.lineTo(r,-o),e.lineTo(i,-o),e.lineTo(0,-n),e.lineTo(-i,-o),e.lineTo(-r,-o),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,r=zc*n,i=r-n*eN,o=n/4;e.moveTo(0,-r-i),e.lineTo(-o,r-i),e.lineTo(o,r-i),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,r=zc*n,i=r-n*eN;e.moveTo(0,-r-i),e.lineTo(-n,r-i),e.lineTo(n,r-i),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,r=zc*n;e.moveTo(0,-r),e.lineTo(-n,r),e.lineTo(n,r),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,r=zc*n;e.moveTo(0,r),e.lineTo(-n,-r),e.lineTo(n,-r),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,r=zc*n;e.moveTo(r,0),e.lineTo(-r,-n),e.lineTo(-r,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,r=zc*n;e.moveTo(-r,0),e.lineTo(r,-n),e.lineTo(r,n),e.closePath()}},stroke:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function $L(e){return Ee(tN,e)?tN[e]:$Z(e)}var kE={};function $Z(e){if(!Ee(kE,e)){const t=kf(e);kE[e]={draw:function(n,r){Fp(n,t,0,0,Math.sqrt(r)/2)}}}return kE[e]}const ka=.448084975506;function FZ(e){return e.x}function DZ(e){return e.y}function MZ(e){return e.width}function TZ(e){return e.height}function bs(e){return typeof e=="function"?e:()=>+e}function hm(e,t,n){return Math.max(t,Math.min(e,n))}function FL(){var e=FZ,t=DZ,n=MZ,r=TZ,i=bs(0),o=i,s=i,a=i,u=null;function c(f,h,p){var m,y=h??+e.call(this,f),v=p??+t.call(this,f),w=+n.call(this,f),E=+r.call(this,f),S=Math.min(w,E)/2,A=hm(+i.call(this,f),0,S),C=hm(+o.call(this,f),0,S),k=hm(+s.call(this,f),0,S),D=hm(+a.call(this,f),0,S);if(u||(u=m=vv()),A<=0&&C<=0&&k<=0&&D<=0)u.rect(y,v,w,E);else{var $=y+w,M=v+E;u.moveTo(y+A,v),u.lineTo($-C,v),u.bezierCurveTo($-ka*C,v,$,v+ka*C,$,v+C),u.lineTo($,M-D),u.bezierCurveTo($,M-ka*D,$-ka*D,M,$-D,M),u.lineTo(y+k,M),u.bezierCurveTo(y+ka*k,M,y,M-ka*k,y,M-k),u.lineTo(y,v+A),u.bezierCurveTo(y,v+ka*A,y+ka*A,v,y+A,v),u.closePath()}if(m)return u=null,m+""||null}return c.x=function(f){return arguments.length?(e=bs(f),c):e},c.y=function(f){return arguments.length?(t=bs(f),c):t},c.width=function(f){return arguments.length?(n=bs(f),c):n},c.height=function(f){return arguments.length?(r=bs(f),c):r},c.cornerRadius=function(f,h,p,m){return arguments.length?(i=bs(f),o=h!=null?bs(h):i,a=p!=null?bs(p):i,s=m!=null?bs(m):o,c):i},c.context=function(f){return arguments.length?(u=f??null,c):u},c}function DL(){var e,t,n,r,i=null,o,s,a,u;function c(h,p,m){const y=m/2;if(o){var v=a-p,w=h-s;if(v||w){var E=Math.hypot(v,w),S=(v/=E)*u,A=(w/=E)*u,C=Math.atan2(w,v);i.moveTo(s-S,a-A),i.lineTo(h-v*y,p-w*y),i.arc(h,p,y,C-Math.PI,C),i.lineTo(s+S,a+A),i.arc(s,a,u,C,C+Math.PI)}else i.arc(h,p,y,0,Ro);i.closePath()}else o=1;s=h,a=p,u=y}function f(h){var p,m=h.length,y,v=!1,w;for(i==null&&(i=w=vv()),p=0;p<=m;++p)!(p<m&&r(y=h[p],p,h))===v&&(v=!v)&&(o=0),v&&c(+e(y,p,h),+t(y,p,h),+n(y,p,h));if(w)return i=null,w+""||null}return f.x=function(h){return arguments.length?(e=h,f):e},f.y=function(h){return arguments.length?(t=h,f):t},f.size=function(h){return arguments.length?(n=h,f):n},f.defined=function(h){return arguments.length?(r=h,f):r},f.context=function(h){return arguments.length?(h==null?i=null:i=h,f):i},f}function dg(e,t){return e??t}const hg=e=>e.x||0,pg=e=>e.y||0,NZ=e=>e.width||0,RZ=e=>e.height||0,OZ=e=>(e.x||0)+(e.width||0),PZ=e=>(e.y||0)+(e.height||0),LZ=e=>e.startAngle||0,zZ=e=>e.endAngle||0,IZ=e=>e.padAngle||0,BZ=e=>e.innerRadius||0,UZ=e=>e.outerRadius||0,jZ=e=>e.cornerRadius||0,WZ=e=>dg(e.cornerRadiusTopLeft,e.cornerRadius)||0,qZ=e=>dg(e.cornerRadiusTopRight,e.cornerRadius)||0,HZ=e=>dg(e.cornerRadiusBottomRight,e.cornerRadius)||0,GZ=e=>dg(e.cornerRadiusBottomLeft,e.cornerRadius)||0,VZ=e=>dg(e.size,64),YZ=e=>e.size||1,Tv=e=>e.defined!==!1,XZ=e=>$L(e.shape||"circle"),QZ=cK().startAngle(LZ).endAngle(zZ).padAngle(IZ).innerRadius(BZ).outerRadius(UZ).cornerRadius(jZ),KZ=o9().x(hg).y1(pg).y0(PZ).defined(Tv),JZ=o9().y(pg).x1(hg).x0(OZ).defined(Tv),ZZ=i9().x(hg).y(pg).defined(Tv),eee=FL().x(hg).y(pg).width(NZ).height(RZ).cornerRadius(WZ,qZ,HZ,GZ),tee=dK().type(XZ).size(VZ),nee=DL().x(hg).y(pg).defined(Tv).size(YZ);function ck(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function ree(e,t){return QZ.context(e)(t)}function iee(e,t){const n=t[0],r=n.interpolate||"linear";return(n.orient==="horizontal"?JZ:KZ).curve(lk(r,n.orient,n.tension)).context(e)(t)}function oee(e,t){const n=t[0],r=n.interpolate||"linear";return ZZ.curve(lk(r,n.orient,n.tension)).context(e)(t)}function cd(e,t,n,r){return eee.context(e)(t,n,r)}function see(e,t){return(t.mark.shape||t.shape).context(e)(t)}function aee(e,t){return tee.context(e)(t)}function uee(e,t){return nee.context(e)(t)}var ML=1;function TL(){ML=1}function fk(e,t,n){var r=t.clip,i=e._defs,o=t.clip_id||(t.clip_id="clip"+ML++),s=i.clipping[o]||(i.clipping[o]={id:o});return He(r)?s.path=r(null):ck(n)?s.path=cd(null,n,0,0):(s.width=n.width||0,s.height=n.height||0),"url(#"+o+")"}function Jt(e){this.clear(),e&&this.union(e)}Jt.prototype={clone(){return new Jt(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set(e,t,n,r){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),r<t?(this.y2=t,this.y1=r):(this.y1=t,this.y2=r),this},add(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate(e,t,n){const r=this.rotatedPoints(e,t,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints(e,t,n){var{x1:r,y1:i,x2:o,y2:s}=this,a=Math.cos(e),u=Math.sin(e),c=t-t*a+n*u,f=n-t*u-n*a;return[a*r-u*i+c,u*r+a*i+f,a*r-u*s+c,u*r+a*s+f,a*o-u*i+c,u*o+a*i+f,a*o-u*s+c,u*o+a*s+f]},union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}};function Nv(e){this.mark=e,this.bounds=this.bounds||new Jt}function Rv(e){Nv.call(this,e),this.items=this.items||[]}pe(Rv,Nv);class NL{constructor(t){this._pending=0,this._loader=t||sv()}pending(){return this._pending}sanitizeURL(t){const n=this;return nN(n),n._loader.sanitize(t,{context:"href"}).then(r=>(xh(n),r)).catch(()=>(xh(n),null))}loadImage(t){const n=this,r=DK();return nN(n),n._loader.sanitize(t,{context:"image"}).then(i=>{const o=i.href;if(!o||!r)throw{url:o};const s=new r,a=Ee(i,"crossOrigin")?i.crossOrigin:"anonymous";return a!=null&&(s.crossOrigin=a),s.onload=()=>xh(n),s.onerror=()=>xh(n),s.src=o,s}).catch(i=>(xh(n),{complete:!1,width:0,height:0,src:i&&i.url||""}))}ready(){const t=this;return new Promise(n=>{function r(i){t.pending()?setTimeout(()=>{r(!0)},10):n(i)}r(!1)})}}function nN(e){e._pending+=1}function xh(e){e._pending-=1}function Zs(e,t,n){if(t.stroke&&t.opacity!==0&&t.strokeOpacity!==0){const r=t.strokeWidth!=null?+t.strokeWidth:1;e.expand(r+(n?lee(t,r):0))}return e}function lee(e,t){return e.strokeJoin&&e.strokeJoin!=="miter"?0:t}const cee=Ro-1e-8;let Ov,Xm,Qm,cl,_S,Km,AS,CS;const La=(e,t)=>Ov.add(e,t),Jm=(e,t)=>La(Xm=e,Qm=t),rN=e=>La(e,Ov.y1),iN=e=>La(Ov.x1,e),ol=(e,t)=>_S*e+AS*t,sl=(e,t)=>Km*e+CS*t,$E=(e,t)=>La(ol(e,t),sl(e,t)),FE=(e,t)=>Jm(ol(e,t),sl(e,t));function gg(e,t){return Ov=e,t?(cl=t*ru,_S=CS=Math.cos(cl),Km=Math.sin(cl),AS=-Km):(_S=CS=1,cl=Km=AS=0),fee}const fee={beginPath(){},closePath(){},moveTo:FE,lineTo:FE,rect(e,t,n,r){cl?($E(e+n,t),$E(e+n,t+r),$E(e,t+r),FE(e,t)):(La(e+n,t+r),Jm(e,t))},quadraticCurveTo(e,t,n,r){const i=ol(e,t),o=sl(e,t),s=ol(n,r),a=sl(n,r);oN(Xm,i,s,rN),oN(Qm,o,a,iN),Jm(s,a)},bezierCurveTo(e,t,n,r,i,o){const s=ol(e,t),a=sl(e,t),u=ol(n,r),c=sl(n,r),f=ol(i,o),h=sl(i,o);sN(Xm,s,u,f,rN),sN(Qm,a,c,h,iN),Jm(f,h)},arc(e,t,n,r,i,o){if(r+=cl,i+=cl,Xm=n*Math.cos(i)+e,Qm=n*Math.sin(i)+t,Math.abs(i-r)>cee)La(e-n,t-n),La(e+n,t+n);else{const s=c=>La(n*Math.cos(c)+e,n*Math.sin(c)+t);let a,u;if(s(r),s(i),i!==r)if(r=r%Ro,r<0&&(r+=Ro),i=i%Ro,i<0&&(i+=Ro),i<r&&(o=!o,a=r,r=i,i=a),o)for(i-=Ro,a=r-r%il,u=0;u<4&&a>i;++u,a-=il)s(a);else for(a=r-r%il+il,u=0;u<4&&a<i;++u,a=a+il)s(a)}}};function oN(e,t,n,r){const i=(e-t)/(e+n-2*t);0<i&&i<1&&r(e+(t-e)*i)}function sN(e,t,n,r,i){const o=r-e+3*t-3*n,s=e+n-2*t,a=e-t;let u=0,c=0,f;Math.abs(o)>_Z?(f=s*s+a*o,f>=0&&(f=Math.sqrt(f),u=(-s+f)/o,c=(-s-f)/o)):u=.5*a/s,0<u&&u<1&&i(aN(u,e,t,n,r)),0<c&&c<1&&i(aN(c,e,t,n,r))}function aN(e,t,n,r,i){const o=1-e,s=o*o,a=e*e;return s*o*t+3*s*e*n+3*o*a*r+a*e*i}var Qa=(Qa=Xa(1,1))?Qa.getContext("2d"):null;const kS=new Jt;function dk(e){return function(t,n){if(!Qa)return!0;e(Qa,t),kS.clear().union(t.bounds).intersect(n).round();const{x1:r,y1:i,x2:o,y2:s}=kS;for(let a=i;a<=s;++a)for(let u=r;u<=o;++u)if(Qa.isPointInPath(u,a))return!0;return!1}}function hk(e,t){return t.contains(e.x||0,e.y||0)}function RL(e,t){const n=e.x||0,r=e.y||0,i=e.width||0,o=e.height||0;return t.intersects(kS.set(n,r,n+i,r+o))}function OL(e,t){const n=e.x||0,r=e.y||0,i=e.x2!=null?e.x2:n,o=e.y2!=null?e.y2:r;return Zc(t,n,r,i,o)}function Zc(e,t,n,r,i){const{x1:o,y1:s,x2:a,y2:u}=e,c=r-t,f=i-n;let h=0,p=1,m,y,v,w;for(w=0;w<4;++w){if(w===0&&(m=-c,y=-(o-t)),w===1&&(m=c,y=a-t),w===2&&(m=-f,y=-(s-n)),w===3&&(m=f,y=u-n),Math.abs(m)<1e-10&&y<0)return!1;if(v=y/m,m<0){if(v>p)return!1;v>h&&(h=v)}else if(m>0){if(v<h)return!1;v<p&&(p=v)}}return!0}function $f(e,t){e.globalCompositeOperation=t.blend||"source-over"}function Hi(e,t){return e??t}function uN(e,t){const n=t.length;for(let r=0;r<n;++r)e.addColorStop(t[r].offset,t[r].color);return e}function dee(e,t,n){const r=n.width(),i=n.height();let o;if(t.gradient==="radial")o=e.createRadialGradient(n.x1+Hi(t.x1,.5)*r,n.y1+Hi(t.y1,.5)*i,Math.max(r,i)*Hi(t.r1,0),n.x1+Hi(t.x2,.5)*r,n.y1+Hi(t.y2,.5)*i,Math.max(r,i)*Hi(t.r2,.5));else{const s=Hi(t.x1,0),a=Hi(t.y1,0),u=Hi(t.x2,1),c=Hi(t.y2,0);if(s===u||a===c||r===i)o=e.createLinearGradient(n.x1+s*r,n.y1+a*i,n.x1+u*r,n.y1+c*i);else{const f=Xa(Math.ceil(r),Math.ceil(i)),h=f.getContext("2d");return h.scale(r,i),h.fillStyle=uN(h.createLinearGradient(s,a,u,c),t.stops),h.fillRect(0,0,r,i),e.createPattern(f,"no-repeat")}}return uN(o,t.stops)}function PL(e,t,n){return uk(n)?dee(e,n,t.bounds):n}function z1(e,t,n){return n*=t.fillOpacity==null?1:t.fillOpacity,n>0?(e.globalAlpha=n,e.fillStyle=PL(e,t,t.fill),!0):!1}var hee=[];function Ff(e,t,n){var r=(r=t.strokeWidth)!=null?r:1;return r<=0?!1:(n*=t.strokeOpacity==null?1:t.strokeOpacity,n>0?(e.globalAlpha=n,e.strokeStyle=PL(e,t,t.stroke),e.lineWidth=r,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||hee),e.lineDashOffset=t.strokeDashOffset||0),!0):!1)}function pee(e,t){return e.zindex-t.zindex||e.index-t.index}function pk(e){if(!e.zdirty)return e.zitems;var t=e.items,n=[],r,i,o;for(i=0,o=t.length;i<o;++i)r=t[i],r.index=i,r.zindex&&n.push(r);return e.zdirty=!1,e.zitems=n.sort(pee)}function ao(e,t){var n=e.items,r,i;if(!n||!n.length)return;const o=pk(e);if(o&&o.length){for(r=0,i=n.length;r<i;++r)n[r].zindex||t(n[r]);n=o}for(r=0,i=n.length;r<i;++r)t(n[r])}function I1(e,t){var n=e.items,r,i;if(!n||!n.length)return null;const o=pk(e);for(o&&o.length&&(n=o),i=n.length;--i>=0;)if(r=t(n[i]))return r;if(n===o){for(n=e.items,i=n.length;--i>=0;)if(!n[i].zindex&&(r=t(n[i])))return r}return null}function gk(e){return function(t,n,r){ao(n,i=>{(!r||r.intersects(i.bounds))&&LL(e,t,i,i)})}}function gee(e){return function(t,n,r){n.items.length&&(!r||r.intersects(n.bounds))&&LL(e,t,n.items[0],n.items)}}function LL(e,t,n,r){var i=n.opacity==null?1:n.opacity;i!==0&&(e(t,r)||($f(t,n),n.fill&&z1(t,n,i)&&t.fill(),n.stroke&&Ff(t,n,i)&&t.stroke()))}function Pv(e){return e=e||$i,function(t,n,r,i,o,s){return r*=t.pixelRatio,i*=t.pixelRatio,I1(n,a=>{const u=a.bounds;if(!(u&&!u.contains(o,s)||!u)&&e(t,a,r,i,o,s))return a})}}function mg(e,t){return function(n,r,i,o){var s=Array.isArray(r)?r[0]:r,a=t??s.fill,u=s.stroke&&n.isPointInStroke,c,f;return u&&(c=s.strokeWidth,f=s.strokeCap,n.lineWidth=c??1,n.lineCap=f??"butt"),e(n,r)?!1:a&&n.isPointInPath(i,o)||u&&n.isPointInStroke(i,o)}}function mk(e){return Pv(mg(e))}function gl(e,t){return"translate("+e+","+t+")"}function yk(e){return"rotate("+e+")"}function mee(e,t){return"scale("+e+","+t+")"}function zL(e){return gl(e.x||0,e.y||0)}function yee(e){return gl(e.x||0,e.y||0)+(e.angle?" "+yk(e.angle):"")}function vee(e){return gl(e.x||0,e.y||0)+(e.angle?" "+yk(e.angle):"")+(e.scaleX||e.scaleY?" "+mee(e.scaleX||1,e.scaleY||1):"")}function vk(e,t,n){function r(s,a){s("transform",yee(a)),s("d",t(null,a))}function i(s,a){return t(gg(s,a.angle),a),Zs(s,a).translate(a.x||0,a.y||0)}function o(s,a){var u=a.x||0,c=a.y||0,f=a.angle||0;s.translate(u,c),f&&s.rotate(f*=ru),s.beginPath(),t(s,a),f&&s.rotate(-f),s.translate(-u,-c)}return{type:e,tag:"path",nested:!1,attr:r,bound:i,draw:gk(o),pick:mk(o),isect:n||dk(o)}}var xee=vk("arc",ree);function wee(e,t){for(var n=e[0].orient==="horizontal"?t[1]:t[0],r=e[0].orient==="horizontal"?"y":"x",i=e.length,o=1/0,s,a;--i>=0;)e[i].defined!==!1&&(a=Math.abs(e[i][r]-n),a<o&&(o=a,s=e[i]));return s}function Eee(e,t){for(var n=Math.pow(e[0].strokeWidth||1,2),r=e.length,i,o,s;--r>=0;)if(e[r].defined!==!1&&(i=e[r].x-t[0],o=e[r].y-t[1],s=i*i+o*o,s<n))return e[r];return null}function bee(e,t){for(var n=e.length,r,i,o;--n>=0;)if(e[n].defined!==!1&&(r=e[n].x-t[0],i=e[n].y-t[1],o=r*r+i*i,r=e[n].size||1,o<r*r))return e[n];return null}function xk(e,t,n){function r(u,c){var f=c.mark.items;f.length&&u("d",t(null,f))}function i(u,c){var f=c.items;return f.length===0?u:(t(gg(u),f),Zs(u,f[0]))}function o(u,c){u.beginPath(),t(u,c)}const s=mg(o);function a(u,c,f,h,p,m){var y=c.items,v=c.bounds;return!y||!y.length||v&&!v.contains(p,m)?null:(f*=u.pixelRatio,h*=u.pixelRatio,s(u,y,f,h)?y[0]:null)}return{type:e,tag:"path",nested:!0,attr:r,bound:i,draw:gee(o),pick:a,isect:hk,tip:n}}var See=xk("area",iee,wee);function _ee(e,t){var n=t.clip;e.save(),He(n)?(e.beginPath(),n(e),e.clip()):IL(e,t.group)}function IL(e,t){e.beginPath(),ck(t)?cd(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function BL(e){const t=Hi(e.strokeWidth,1);return e.strokeOffset!=null?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function Aee(e,t){e("transform",zL(t))}function UL(e,t){const n=BL(t);e("d",cd(null,t,n,n))}function Cee(e,t){e("class","background"),e("aria-hidden",!0),UL(e,t)}function kee(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?UL(e,t):e("d","")}function $ee(e,t,n){const r=t.clip?fk(n,t,t):null;e("clip-path",r)}function Fee(e,t){if(!t.clip&&t.items){const n=t.items,r=n.length;for(let i=0;i<r;++i)e.union(n[i].bounds)}return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),Zs(e,t),e.translate(t.x||0,t.y||0)}function Dp(e,t,n,r){const i=BL(t);e.beginPath(),cd(e,t,(n||0)+i,(r||0)+i)}const Dee=mg(Dp),Mee=mg(Dp,!1),Tee=mg(Dp,!0);function Nee(e,t,n,r){ao(t,i=>{const o=i.x||0,s=i.y||0,a=i.strokeForeground,u=i.opacity==null?1:i.opacity;(i.stroke||i.fill)&&u&&(Dp(e,i,o,s),$f(e,i),i.fill&&z1(e,i,u)&&e.fill(),i.stroke&&!a&&Ff(e,i,u)&&e.stroke()),e.save(),e.translate(o,s),i.clip&&IL(e,i),n&&n.translate(-o,-s),ao(i,c=>{(c.marktype==="group"||r==null||r.includes(c.marktype))&&this.draw(e,c,n,r)}),n&&n.translate(o,s),e.restore(),a&&i.stroke&&u&&(Dp(e,i,o,s),$f(e,i),Ff(e,i,u)&&e.stroke())})}function Ree(e,t,n,r,i,o){if(t.bounds&&!t.bounds.contains(i,o)||!t.items)return null;const s=n*e.pixelRatio,a=r*e.pixelRatio;return I1(t,u=>{let c,f,h;const p=u.bounds;if(p&&!p.contains(i,o))return;f=u.x||0,h=u.y||0;const m=f+(u.width||0),y=h+(u.height||0),v=u.clip;if(v&&(i<f||i>m||o<h||o>y))return;if(e.save(),e.translate(f,h),f=i-f,h=o-h,v&&ck(u)&&!Tee(e,u,s,a))return e.restore(),null;const w=u.strokeForeground,E=t.interactive!==!1;return E&&w&&u.stroke&&Mee(e,u,s,a)?(e.restore(),u):(c=I1(u,S=>Oee(S,f,h)?this.pick(S,n,r,f,h):null),!c&&E&&(u.fill||!w&&u.stroke)&&Dee(e,u,s,a)&&(c=u),e.restore(),c||null)})}function Oee(e,t,n){return(e.interactive!==!1||e.marktype==="group")&&e.bounds&&e.bounds.contains(t,n)}var Pee={type:"group",tag:"g",nested:!1,attr:Aee,bound:Fee,draw:Nee,pick:Ree,isect:RL,content:$ee,background:Cee,foreground:kee},Mp={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function wk(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then(r=>{e.image=r,e.image.url=e.url})),n}function Ek(e,t){return e.width!=null?e.width:!t||!t.width?0:e.aspect!==!1&&e.height?e.height*t.width/t.height:t.width}function bk(e,t){return e.height!=null?e.height:!t||!t.height?0:e.aspect!==!1&&e.width?e.width*t.height/t.width:t.height}function Lv(e,t){return e==="center"?t/2:e==="right"?t:0}function zv(e,t){return e==="middle"?t/2:e==="bottom"?t:0}function Lee(e,t,n){const r=wk(t,n),i=Ek(t,r),o=bk(t,r),s=(t.x||0)-Lv(t.align,i),a=(t.y||0)-zv(t.baseline,o),u=!r.src&&r.toDataURL?r.toDataURL():r.src||"";e("href",u,Mp["xmlns:xlink"],"xlink:href"),e("transform",gl(s,a)),e("width",i),e("height",o),e("preserveAspectRatio",t.aspect===!1?"none":"xMidYMid")}function zee(e,t){const n=t.image,r=Ek(t,n),i=bk(t,n),o=(t.x||0)-Lv(t.align,r),s=(t.y||0)-zv(t.baseline,i);return e.set(o,s,o+r,s+i)}function Iee(e,t,n){ao(t,r=>{if(n&&!n.intersects(r.bounds))return;const i=wk(r,this);let o=Ek(r,i),s=bk(r,i);if(o===0||s===0)return;let a=(r.x||0)-Lv(r.align,o),u=(r.y||0)-zv(r.baseline,s),c,f,h,p;r.aspect!==!1&&(f=i.width/i.height,h=r.width/r.height,f===f&&h===h&&f!==h&&(h<f?(p=o/f,u+=(s-p)/2,s=p):(p=s*f,a+=(o-p)/2,o=p))),(i.complete||i.toDataURL)&&($f(e,r),e.globalAlpha=(c=r.opacity)!=null?c:1,e.imageSmoothingEnabled=r.smooth!==!1,e.drawImage(i,a,u,o,s))})}var Bee={type:"image",tag:"image",nested:!1,attr:Lee,bound:zee,draw:Iee,pick:Pv(),isect:$i,get:wk,xOffset:Lv,yOffset:zv},Uee=xk("line",oee,Eee);function jee(e,t){var n=t.scaleX||1,r=t.scaleY||1;(n!==1||r!==1)&&e("vector-effect","non-scaling-stroke"),e("transform",vee(t)),e("d",t.path)}function Zm(e,t){var n=t.path;if(n==null)return!0;var r=t.x||0,i=t.y||0,o=t.scaleX||1,s=t.scaleY||1,a=(t.angle||0)*ru,u=t.pathCache;(!u||u.path!==n)&&((t.pathCache=u=kf(n)).path=n),a&&e.rotate&&e.translate?(e.translate(r,i),e.rotate(a),Fp(e,u,0,0,o,s),e.rotate(-a),e.translate(-r,-i)):Fp(e,u,r,i,o,s)}function Wee(e,t){return Zm(gg(e,t.angle),t)?e.set(0,0,0,0):Zs(e,t,!0)}var qee={type:"path",tag:"path",nested:!1,attr:jee,bound:Wee,draw:gk(Zm),pick:mk(Zm),isect:dk(Zm)};function Hee(e,t){e("d",cd(null,t))}function Gee(e,t){var n,r;return Zs(e.set(n=t.x||0,r=t.y||0,n+t.width||0,r+t.height||0),t)}function lN(e,t){e.beginPath(),cd(e,t)}var Vee={type:"rect",tag:"path",nested:!1,attr:Hee,bound:Gee,draw:gk(lN),pick:mk(lN),isect:RL};function Yee(e,t){e("transform",zL(t)),e("x2",t.x2!=null?t.x2-(t.x||0):0),e("y2",t.y2!=null?t.y2-(t.y||0):0)}function Xee(e,t){var n,r;return Zs(e.set(n=t.x||0,r=t.y||0,t.x2!=null?t.x2:n,t.y2!=null?t.y2:r),t)}function jL(e,t,n){var r,i,o,s;return t.stroke&&Ff(e,t,n)?(r=t.x||0,i=t.y||0,o=t.x2!=null?t.x2:r,s=t.y2!=null?t.y2:i,e.beginPath(),e.moveTo(r,i),e.lineTo(o,s),!0):!1}function Qee(e,t,n){ao(t,r=>{if(!(n&&!n.intersects(r.bounds))){var i=r.opacity==null?1:r.opacity;i&&jL(e,r,i)&&($f(e,r),e.stroke())}})}function Kee(e,t,n,r){return e.isPointInStroke?jL(e,t,1)&&e.isPointInStroke(n,r):!1}var Jee={type:"rule",tag:"line",nested:!1,attr:Yee,bound:Xee,draw:Qee,pick:Pv(Kee),isect:OL},Zee=vk("shape",see),ete=vk("symbol",aee,hk);const cN=X4();var ri={height:rs,measureWidth:Sk,estimateWidth:B1,width:B1,canvas:WL};WL(!0);function WL(e){ri.width=e&&Qa?Sk:B1}function B1(e,t){return qL(ou(e,t),rs(e))}function qL(e,t){return~~(.8*e.length*t)}function Sk(e,t){return rs(e)<=0||!(t=ou(e,t))?0:HL(t,Iv(e))}function HL(e,t){const n=`(${t}) ${e}`;let r=cN.get(n);return r===void 0&&(Qa.font=t,r=Qa.measureText(e).width,cN.set(n,r)),r}function rs(e){return e.fontSize!=null?+e.fontSize||0:11}function iu(e){return e.lineHeight!=null?e.lineHeight:rs(e)+2}function tte(e){return ne(e)?e.length>1?e:e[0]:e}function yg(e){return tte(e.lineBreak&&e.text&&!ne(e.text)?e.text.split(e.lineBreak):e.text)}function _k(e){const t=yg(e);return(ne(t)?t.length-1:0)*iu(e)}function ou(e,t){const n=t==null?"":(t+"").trim();return e.limit>0&&n.length?rte(e,n):n}function nte(e){if(ri.width===Sk){const t=Iv(e);return n=>HL(n,t)}else if(ri.width===B1){const t=rs(e);return n=>qL(n,t)}else return t=>ri.width(e,t)}function rte(e,t){var n=+e.limit,r=nte(e);if(r(t)<n)return t;var i=e.ellipsis||"…",o=e.dir==="rtl",s=0,a=t.length,u;if(n-=r(i),o){for(;s<a;)u=s+a>>>1,r(t.slice(u))>n?s=u+1:a=u;return i+t.slice(s)}else{for(;s<a;)u=1+(s+a>>>1),r(t.slice(0,u))<n?s=u:a=u-1;return t.slice(0,s)+i}}function vg(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function Iv(e,t){return(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+rs(e)+"px "+vg(e,t)}function Ak(e){var t=e.baseline,n=rs(e);return Math.round(t==="top"?.79*n:t==="middle"?.3*n:t==="bottom"?-.21*n:t==="line-top"?.29*n+.5*iu(e):t==="line-bottom"?.29*n-.5*iu(e):0)}const ite={left:"start",center:"middle",right:"end"},sp=new Jt;function Bv(e){var t=e.x||0,n=e.y||0,r=e.radius||0,i;return r&&(i=(e.theta||0)-il,t+=r*Math.cos(i),n+=r*Math.sin(i)),sp.x1=t,sp.y1=n,sp}function ote(e,t){var n=t.dx||0,r=(t.dy||0)+Ak(t),i=Bv(t),o=i.x1,s=i.y1,a=t.angle||0,u;e("text-anchor",ite[t.align]||"start"),a?(u=gl(o,s)+" "+yk(a),(n||r)&&(u+=" "+gl(n,r))):u=gl(o+n,s+r),e("transform",u)}function Ck(e,t,n){var r=ri.height(t),i=t.align,o=Bv(t),s=o.x1,a=o.y1,u=t.dx||0,c=(t.dy||0)+Ak(t)-Math.round(.8*r),f=yg(t),h;if(ne(f)?(r+=iu(t)*(f.length-1),h=f.reduce((p,m)=>Math.max(p,ri.width(t,m)),0)):h=ri.width(t,f),i==="center"?u-=h/2:i==="right"&&(u-=h),e.set(u+=s,c+=a,u+h,c+r),t.angle&&!n)e.rotate(t.angle*ru,s,a);else if(n===2)return e.rotatedPoints(t.angle*ru,s,a);return e}function ste(e,t,n){ao(t,r=>{var i=r.opacity==null?1:r.opacity,o,s,a,u,c,f,h;if(!(n&&!n.intersects(r.bounds)||i===0||r.fontSize<=0||r.text==null||r.text.length===0)){if(e.font=Iv(r),e.textAlign=r.align||"left",o=Bv(r),s=o.x1,a=o.y1,r.angle&&(e.save(),e.translate(s,a),e.rotate(r.angle*ru),s=a=0),s+=r.dx||0,a+=(r.dy||0)+Ak(r),f=yg(r),$f(e,r),ne(f))for(c=iu(r),u=0;u<f.length;++u)h=ou(r,f[u]),r.fill&&z1(e,r,i)&&e.fillText(h,s,a),r.stroke&&Ff(e,r,i)&&e.strokeText(h,s,a),a+=c;else h=ou(r,f),r.fill&&z1(e,r,i)&&e.fillText(h,s,a),r.stroke&&Ff(e,r,i)&&e.strokeText(h,s,a);r.angle&&e.restore()}})}function ate(e,t,n,r,i,o){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var s=Bv(t),a=s.x1,u=s.y1,c=Ck(sp,t,1),f=-t.angle*ru,h=Math.cos(f),p=Math.sin(f),m=h*i-p*o+(a-h*a+p*u),y=p*i+h*o+(u-p*a-h*u);return c.contains(m,y)}function ute(e,t){const n=Ck(sp,e,2);return Zc(t,n[0],n[1],n[2],n[3])||Zc(t,n[0],n[1],n[4],n[5])||Zc(t,n[4],n[5],n[6],n[7])||Zc(t,n[2],n[3],n[6],n[7])}var lte={type:"text",tag:"text",nested:!1,attr:ote,bound:Ck,draw:ste,pick:Pv(ate),isect:ute},cte=xk("trail",uee,bee),ui={arc:xee,area:See,group:Pee,image:Bee,line:Uee,path:qee,rect:Vee,rule:Jee,shape:Zee,symbol:ete,text:lte,trail:cte};function $S(e,t,n){var r=ui[e.mark.marktype],i=t||r.bound;return r.nested&&(e=e.mark),i(e.bounds||(e.bounds=new Jt),e,n)}var fN={mark:null};function GL(e,t,n){var r=ui[e.marktype],i=r.bound,o=e.items,s=o&&o.length,a,u,c,f;if(r.nested)return s?c=o[0]:(fN.mark=e,c=fN),f=$S(c,i,n),t=t&&t.union(f)||f,t;if(t=t||e.bounds&&e.bounds.clear()||new Jt,s)for(a=0,u=o.length;a<u;++a)t.union($S(o[a],i,n));return e.bounds=t}const fte=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function VL(e,t){return JSON.stringify(e,fte,t)}function YL(e){const t=typeof e=="string"?JSON.parse(e):e;return XL(t)}function XL(e){var t=e.marktype,n=e.items,r,i,o;if(n)for(i=0,o=n.length;i<o;++i)r=t?"mark":"group",n[i][r]=e,n[i].zindex&&(n[i][r].zdirty=!0),(t||r)==="group"&&XL(n[i]);return t&&GL(e),e}class QL{constructor(t){arguments.length?this.root=YL(t):(this.root=dN({marktype:"group",name:"root",role:"frame"}),this.root.items=[new Rv(this.root)])}toJSON(t){return VL(this.root,t||0)}mark(t,n,r){n=n||this.root.items[0];const i=dN(t,n);return n.items[r]=i,i.zindex&&(i.group.zdirty=!0),i}}function dN(e,t){const n={bounds:new Jt,clip:!!e.clip,group:t,interactive:e.interactive!==!1,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0};return e.aria!=null&&(n.aria=e.aria),e.description&&(n.description=e.description),n}function za(e,t,n){return!e&&typeof document<"u"&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function kk(e,t){t=t.toLowerCase();for(var n=e.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===t)return n[r]}function rn(e,t,n,r){var i=e.childNodes[t],o;return(!i||i.tagName.toLowerCase()!==n.toLowerCase())&&(o=i||null,i=za(e.ownerDocument,n,r),e.insertBefore(i,o)),i}function xi(e,t){for(var n=e.childNodes,r=n.length;r>t;)e.removeChild(n[--r]);return e}function KL(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function Uv(e,t){const n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function dte(e,t,n,r){var i=e&&e.mark,o,s;if(i&&(o=ui[i.marktype]).tip){for(s=Uv(t,n),s[0]-=r[0],s[1]-=r[1];e=e.mark.group;)s[0]-=e.x||0,s[1]-=e.y||0;e=o.tip(i.items,s)}return e}let $k=class{constructor(t,n){this._active=null,this._handlers={},this._loader=t||sv(),this._tooltip=n||hte}initialize(t,n,r){return this._el=t,this._obj=r||null,this.origin(n)}element(){return this._el}canvas(){return this._el&&this._el.firstChild}origin(t){return arguments.length?(this._origin=t||[0,0],this):this._origin.slice()}scene(t){return arguments.length?(this._scene=t,this):this._scene}on(){}off(){}_handlerIndex(t,n,r){for(let i=t?t.length:0;--i>=0;)if(t[i].type===n&&(!r||t[i].handler===r))return i;return-1}handlers(t){const n=this._handlers,r=[];if(t)r.push(...n[this.eventName(t)]);else for(const i in n)r.push(...n[i]);return r}eventName(t){const n=t.indexOf(".");return n<0?t:t.slice(0,n)}handleHref(t,n,r){this._loader.sanitize(r,{context:"href"}).then(i=>{const o=new MouseEvent(t.type,t),s=za(null,"a");for(const a in i)s.setAttribute(a,i[a]);s.dispatchEvent(o)}).catch(()=>{})}handleTooltip(t,n,r){if(n&&n.tooltip!=null){n=dte(n,t,this.canvas(),this._origin);const i=r&&n&&n.tooltip||null;this._tooltip.call(this._obj,this,t,n,i)}}getItemBoundingClientRect(t){const n=this.canvas();if(!n)return;const r=n.getBoundingClientRect(),i=this._origin,o=t.bounds,s=o.width(),a=o.height();let u=o.x1+i[0]+r.left,c=o.y1+i[1]+r.top;for(;t.mark&&(t=t.mark.group);)u+=t.x||0,c+=t.y||0;return{x:u,y:c,width:s,height:a,left:u,top:c,right:u+s,bottom:c+a}}};function hte(e,t,n,r){e.element().setAttribute("title",r||"")}class xg{constructor(t){this._el=null,this._bgcolor=null,this._loader=new NL(t)}initialize(t,n,r,i,o){return this._el=t,this.resize(n,r,i,o)}element(){return this._el}canvas(){return this._el&&this._el.firstChild}background(t){return arguments.length===0?this._bgcolor:(this._bgcolor=t,this)}resize(t,n,r,i){return this._width=t,this._height=n,this._origin=r||[0,0],this._scale=i||1,this}dirty(){}render(t,n){const r=this;return r._call=function(){r._render(t,n)},r._call(),r._call=null,r}_render(){}renderAsync(t,n){const r=this.render(t,n);return this._ready?this._ready.then(()=>r):Promise.resolve(r)}_load(t,n){var r=this,i=r._loader[t](n);if(!r._ready){const o=r._call;r._ready=r._loader.ready().then(s=>{s&&o(),r._ready=null})}return i}sanitizeURL(t){return this._load("sanitizeURL",t)}loadImage(t){return this._load("loadImage",t)}}const pte="keydown",gte="keypress",mte="keyup",JL="dragenter",e1="dragleave",ZL="dragover",FS="pointerdown",yte="pointerup",U1="pointermove",t1="pointerout",e7="pointerover",DS="mousedown",vte="mouseup",t7="mousemove",j1="mouseout",n7="mouseover",W1="click",xte="dblclick",wte="wheel",r7="mousewheel",q1="touchstart",H1="touchmove",G1="touchend",Ete=[pte,gte,mte,JL,e1,ZL,FS,yte,U1,t1,e7,DS,vte,t7,j1,n7,W1,xte,wte,r7,q1,H1,G1],MS=U1,ap=j1,TS=W1;class wg extends $k{constructor(t,n){super(t,n),this._down=null,this._touch=null,this._first=!0,this._events={},this.events=Ete,this.pointermove=pN([U1,t7],[e7,n7],[t1,j1]),this.dragover=pN([ZL],[JL],[e1]),this.pointerout=gN([t1,j1]),this.dragleave=gN([e1])}initialize(t,n,r){return this._canvas=t&&kk(t,"canvas"),[W1,DS,FS,U1,t1,e1].forEach(i=>hN(this,i)),super.initialize(t,n,r)}canvas(){return this._canvas}context(){return this._canvas.getContext("2d")}DOMMouseScroll(t){this.fire(r7,t)}pointerdown(t){this._down=this._active,this.fire(FS,t)}mousedown(t){this._down=this._active,this.fire(DS,t)}click(t){this._down===this._active&&(this.fire(W1,t),this._down=null)}touchstart(t){this._touch=this.pickEvent(t.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(q1,t,!0)}touchmove(t){this.fire(H1,t,!0)}touchend(t){this.fire(G1,t,!0),this._touch=null}fire(t,n,r){const i=r?this._touch:this._active,o=this._handlers[t];if(n.vegaType=t,t===TS&&i&&i.href?this.handleHref(n,i,i.href):(t===MS||t===ap)&&this.handleTooltip(n,i,t!==ap),o)for(let s=0,a=o.length;s<a;++s)o[s].handler.call(this._obj,n,i)}on(t,n){const r=this.eventName(t),i=this._handlers;return this._handlerIndex(i[r],t,n)<0&&(hN(this,t),(i[r]||(i[r]=[])).push({type:t,handler:n})),this}off(t,n){const r=this.eventName(t),i=this._handlers[r],o=this._handlerIndex(i,t,n);return o>=0&&i.splice(o,1),this}pickEvent(t){const n=Uv(t,this._canvas),r=this._origin;return this.pick(this._scene,n[0],n[1],n[0]-r[0],n[1]-r[1])}pick(t,n,r,i,o){const s=this.context();return ui[t.marktype].pick.call(this,s,t,n,r,i,o)}}const bte=e=>e===q1||e===H1||e===G1?[q1,H1,G1]:[e];function hN(e,t){bte(t).forEach(n=>Ste(e,n))}function Ste(e,t){const n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?r=>e[t](r):r=>e.fire(t,r)))}function Wh(e,t,n){t.forEach(r=>e.fire(r,n))}function pN(e,t,n){return function(r){const i=this._active,o=this.pickEvent(r);o===i?Wh(this,e,r):((!i||!i.exit)&&Wh(this,n,r),this._active=o,Wh(this,t,r),Wh(this,e,r))}}function gN(e){return function(t){Wh(this,e,t),this._active=null}}function _te(){return typeof window<"u"&&window.devicePixelRatio||1}function Ate(e,t,n,r,i,o){const s=typeof HTMLElement<"u"&&e instanceof HTMLElement&&e.parentNode!=null,a=e.getContext("2d"),u=s?_te():i;e.width=t*u,e.height=n*u;for(const c in o)a[c]=o[c];return s&&u!==1&&(e.style.width=t+"px",e.style.height=n+"px"),a.pixelRatio=u,a.setTransform(u,0,0,u,u*r[0],u*r[1]),e}class V1 extends xg{constructor(t){super(t),this._options={},this._redraw=!1,this._dirty=new Jt,this._tempb=new Jt}initialize(t,n,r,i,o,s){return this._options=s||{},this._canvas=this._options.externalContext?null:Xa(1,1,this._options.type),t&&this._canvas&&(xi(t,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),super.initialize(t,n,r,i,o)}resize(t,n,r,i){if(super.resize(t,n,r,i),this._canvas)Ate(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const o=this._options.externalContext;o||te("CanvasRenderer is missing a valid canvas or context"),o.scale(this._scale,this._scale),o.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this}canvas(){return this._canvas}context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)}dirty(t){const n=this._tempb.clear().union(t.bounds);let r=t.mark.group;for(;r;)n.translate(r.x||0,r.y||0),r=r.mark.group;this._dirty.union(n)}_render(t,n){const r=this.context(),i=this._origin,o=this._width,s=this._height,a=this._dirty,u=Cte(i,o,s);r.save();const c=this._redraw||a.empty()?(this._redraw=!1,u.expand(1)):kte(r,u.intersect(a),i);return this.clear(-i[0],-i[1],o,s),this.draw(r,t,c,n),r.restore(),a.clear(),this}draw(t,n,r,i){if(n.marktype!=="group"&&i!=null&&!i.includes(n.marktype))return;const o=ui[n.marktype];n.clip&&_ee(t,n),o.draw.call(this,t,n,r,i),n.clip&&t.restore()}clear(t,n,r,i){const o=this._options,s=this.context();o.type!=="pdf"&&!o.externalContext&&s.clearRect(t,n,r,i),this._bgcolor!=null&&(s.fillStyle=this._bgcolor,s.fillRect(t,n,r,i))}}const Cte=(e,t,n)=>new Jt().set(0,0,t,n).translate(-e[0],-e[1]);function kte(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-(n[0]%1),-(n[1]%1)),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}class i7 extends $k{constructor(t,n){super(t,n);const r=this;r._hrefHandler=DE(r,(i,o)=>{o&&o.href&&r.handleHref(i,o,o.href)}),r._tooltipHandler=DE(r,(i,o)=>{r.handleTooltip(i,o,i.type!==ap)})}initialize(t,n,r){let i=this._svg;return i&&(i.removeEventListener(TS,this._hrefHandler),i.removeEventListener(MS,this._tooltipHandler),i.removeEventListener(ap,this._tooltipHandler)),this._svg=i=t&&kk(t,"svg"),i&&(i.addEventListener(TS,this._hrefHandler),i.addEventListener(MS,this._tooltipHandler),i.addEventListener(ap,this._tooltipHandler)),super.initialize(t,n,r)}canvas(){return this._svg}on(t,n){const r=this.eventName(t),i=this._handlers;if(this._handlerIndex(i[r],t,n)<0){const s={type:t,handler:n,listener:DE(this,n)};(i[r]||(i[r]=[])).push(s),this._svg&&this._svg.addEventListener(r,s.listener)}return this}off(t,n){const r=this.eventName(t),i=this._handlers[r],o=this._handlerIndex(i,t,n);return o>=0&&(this._svg&&this._svg.removeEventListener(r,i[o].listener),i.splice(o,1)),this}}const DE=(e,t)=>n=>{let r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,t.call(e._obj,n,r)},o7="aria-hidden",Fk="aria-label",Dk="role",Mk="aria-roledescription",s7="graphics-object",Tk="graphics-symbol",a7=(e,t,n)=>({[Dk]:e,[Mk]:t,[Fk]:n||void 0}),$te=oo(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),mN={axis:{desc:"axis",caption:Mte},legend:{desc:"legend",caption:Tte},"title-text":{desc:"title",caption:e=>`Title text '${vN(e)}'`},"title-subtitle":{desc:"subtitle",caption:e=>`Subtitle text '${vN(e)}'`}},yN={ariaRole:Dk,ariaRoleDescription:Mk,description:Fk};function u7(e,t){const n=t.aria===!1;if(e(o7,n||void 0),n||t.description==null)for(const r in yN)e(yN[r],void 0);else{const r=t.mark.marktype;e(Fk,t.description),e(Dk,t.ariaRole||(r==="group"?s7:Tk)),e(Mk,t.ariaRoleDescription||`${r} mark`)}}function l7(e){return e.aria===!1?{[o7]:!0}:$te[e.role]?null:mN[e.role]?Dte(e,mN[e.role]):Fte(e)}function Fte(e){const t=e.marktype,n=t==="group"||t==="text"||e.items.some(r=>r.description!=null&&r.aria!==!1);return a7(n?s7:Tk,`${t} mark container`,e.description)}function Dte(e,t){try{const n=e.items[0],r=t.caption||(()=>"");return a7(t.role||Tk,t.desc,n.description||r(n))}catch{return null}}function vN(e){return xe(e.text).join(" ")}function Mte(e){const t=e.datum,n=e.orient,r=t.title?c7(e):null,i=e.context,o=i.scales[t.scale].value,s=i.dataflow.locale(),a=o.type;return`${n==="left"||n==="right"?"Y":"X"}-axis`+(r?` titled '${r}'`:"")+` for a ${Cf(a)?"discrete":a} scale with ${SL(s,o,e)}`}function Tte(e){const t=e.datum,n=t.title?c7(e):null,r=`${t.type||""} legend`.trim(),i=t.scales,o=Object.keys(i),s=e.context,a=s.scales[i[o[0]]].value,u=s.dataflow.locale();return Rte(r)+(n?` titled '${n}'`:"")+` for ${Nte(o)} with ${SL(u,a,e)}`}function c7(e){try{return xe(Ze(e.items).items[0].text).join(" ")}catch{return null}}function Nte(e){return e=e.map(t=>t+(t==="fill"||t==="stroke"?" color":"")),e.length<2?e[0]:e.slice(0,-1).join(", ")+" and "+Ze(e)}function Rte(e){return e.length?e[0].toUpperCase()+e.slice(1):e}const f7=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),Ote=e=>f7(e).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;");function Nk(){let e="",t="",n="";const r=[],i=()=>t=n="",o=u=>{t&&(e+=`${t}>${n}`,i()),r.push(u)},s=(u,c)=>(c!=null&&(t+=` ${u}="${Ote(c)}"`),a),a={open(u){o(u),t="<"+u;for(var c=arguments.length,f=new Array(c>1?c-1:0),h=1;h<c;h++)f[h-1]=arguments[h];for(const p of f)for(const m in p)s(m,p[m]);return a},close(){const u=r.pop();return t?e+=t+(n?`>${n}</${u}>`:"/>"):e+=`</${u}>`,i(),a},attr:s,text:u=>(n+=f7(u),a),toString:()=>e};return a}const d7=e=>h7(Nk(),e)+"";function h7(e,t){if(e.open(t.tagName),t.hasAttributes()){const n=t.attributes,r=n.length;for(let i=0;i<r;++i)e.attr(n[i].name,n[i].value)}if(t.hasChildNodes()){const n=t.childNodes;for(const r of n)r.nodeType===3?e.text(r.nodeValue):h7(e,r)}return e.close()}const Y1={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"},X1={blend:"mix-blend-mode"},p7={fill:"none","stroke-miterlimit":10},wh=0,xN="http://www.w3.org/2000/xmlns/",nn=Mp.xmlns;class Rk extends xg{constructor(t){super(t),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}initialize(t,n,r,i,o){return this._defs={},this._clearDefs(),t&&(this._svg=rn(t,0,"svg",nn),this._svg.setAttributeNS(xN,"xmlns",nn),this._svg.setAttributeNS(xN,"xmlns:xlink",Mp["xmlns:xlink"]),this._svg.setAttribute("version",Mp.version),this._svg.setAttribute("class","marks"),xi(t,1),this._root=rn(this._svg,wh,"g",nn),Ia(this._root,p7),xi(this._svg,wh+1)),this.background(this._bgcolor),super.initialize(t,n,r,i,o)}background(t){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",t),super.background(...arguments)}resize(t,n,r,i){return super.resize(t,n,r,i),this._svg&&(Ia(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this}canvas(){return this._svg}svg(){const t=this._svg,n=this._bgcolor;if(!t)return null;let r;n&&(t.removeAttribute("style"),r=rn(t,wh,"rect",nn),Ia(r,{width:this._width,height:this._height,fill:n}));const i=d7(t);return n&&(t.removeChild(r),this._svg.style.setProperty("background-color",n)),i}_render(t,n){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,t,void 0,n),xi(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this}dirty(t){t.dirty!==this._dirtyID&&(t.dirty=this._dirtyID,this._dirty.push(t))}isDirty(t){return this._dirtyAll||!t._svg||!t._svg.ownerSVGElement||t.dirty===this._dirtyID}_dirtyCheck(){this._dirtyAll=!0;const t=this._dirty;if(!t.length||!this._dirtyID)return!0;const n=++this._dirtyID;let r,i,o,s,a,u,c;for(a=0,u=t.length;a<u;++a)if(r=t[a],i=r.mark,i.marktype!==o&&(o=i.marktype,s=ui[o]),i.zdirty&&i.dirty!==n&&(this._dirtyAll=!1,wN(r,n),i.items.forEach(f=>{f.dirty=n})),!i.zdirty){if(r.exit){s.nested&&i.items.length?(c=i.items[0],c._svg&&this._update(s,c._svg,c)):r._svg&&(c=r._svg.parentNode,c&&c.removeChild(r._svg)),r._svg=null;continue}r=s.nested?i.items[0]:r,r._update!==n&&(!r._svg||!r._svg.ownerSVGElement?(this._dirtyAll=!1,wN(r,n)):this._update(s,r._svg,r),r._update=n)}return!this._dirtyAll}mark(t,n,r,i){if(!this.isDirty(n))return n._svg;const o=this._svg,s=n.marktype,a=ui[s],u=n.interactive===!1?"none":null,c=a.tag==="g",f=EN(n,t,r,"g",o);if(s!=="group"&&i!=null&&!i.includes(s))return xi(f,0),n._svg;f.setAttribute("class",KL(n));const h=l7(n);for(const v in h)ar(f,v,h[v]);c||ar(f,"pointer-events",u),ar(f,"clip-path",n.clip?fk(this,n,n.group):null);let p=null,m=0;const y=v=>{const w=this.isDirty(v),E=EN(v,f,p,a.tag,o);w&&(this._update(a,E,v),c&&zte(this,E,v,i)),p=E,++m};return a.nested?n.items.length&&y(n.items[0]):ao(n,y),xi(f,m),f}_update(t,n,r){Ls=n,Hn=n.__values__,u7(up,r),t.attr(up,r,this);const i=Bte[t.type];i&&i.call(this,t,n,r),Ls&&this.style(Ls,r)}style(t,n){if(n!=null){for(const r in Y1){let i=r==="font"?vg(n):n[r];if(i===Hn[r])continue;const o=Y1[r];i==null?t.removeAttribute(o):(uk(i)&&(i=AL(i,this._defs.gradient,g7())),t.setAttribute(o,i+"")),Hn[r]=i}for(const r in X1)n1(t,X1[r],n[r])}}defs(){const t=this._svg,n=this._defs;let r=n.el,i=0;for(const o in n.gradient)r||(n.el=r=rn(t,wh+1,"defs",nn)),i=Pte(r,n.gradient[o],i);for(const o in n.clipping)r||(n.el=r=rn(t,wh+1,"defs",nn)),i=Lte(r,n.clipping[o],i);r&&(i===0?(t.removeChild(r),n.el=null):xi(r,i))}_clearDefs(){const t=this._defs;t.gradient={},t.clipping={}}}function wN(e,t){for(;e&&e.dirty!==t;e=e.mark.group)if(e.dirty=t,e.mark&&e.mark.dirty!==t)e.mark.dirty=t;else return}function Pte(e,t,n){let r,i,o;if(t.gradient==="radial"){let s=rn(e,n++,"pattern",nn);Ia(s,{id:L1+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),s=rn(s,0,"rect",nn),Ia(s,{width:1,height:1,fill:`url(${g7()}#${t.id})`}),e=rn(e,n++,"radialGradient",nn),Ia(e,{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else e=rn(e,n++,"linearGradient",nn),Ia(e,{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(r=0,i=t.stops.length;r<i;++r)o=rn(e,r,"stop",nn),o.setAttribute("offset",t.stops[r].offset),o.setAttribute("stop-color",t.stops[r].color);return xi(e,r),n}function Lte(e,t,n){let r;return e=rn(e,n,"clipPath",nn),e.setAttribute("id",t.id),t.path?(r=rn(e,0,"path",nn),r.setAttribute("d",t.path)):(r=rn(e,0,"rect",nn),Ia(r,{x:0,y:0,width:t.width,height:t.height})),xi(e,1),n+1}function zte(e,t,n,r){t=t.lastChild.previousSibling;let i,o=0;ao(n,s=>{i=e.mark(t,s,i,r),++o}),xi(t,1+o)}function EN(e,t,n,r,i){let o=e._svg,s;if(!o&&(s=t.ownerDocument,o=za(s,r,nn),e._svg=o,e.mark&&(o.__data__=e,o.__values__={fill:"default"},r==="g"))){const a=za(s,"path",nn);o.appendChild(a),a.__data__=e;const u=za(s,"g",nn);o.appendChild(u),u.__data__=e;const c=za(s,"path",nn);o.appendChild(c),c.__data__=e,c.__values__={fill:"default"}}return(o.ownerSVGElement!==i||Ite(o,n))&&t.insertBefore(o,n?n.nextSibling:t.firstChild),o}function Ite(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}let Ls=null,Hn=null;const Bte={group(e,t,n){const r=Ls=t.childNodes[2];Hn=r.__values__,e.foreground(up,n,this),Hn=t.__values__,Ls=t.childNodes[1],e.content(up,n,this);const i=Ls=t.childNodes[0];e.background(up,n,this);const o=n.mark.interactive===!1?"none":null;if(o!==Hn.events&&(ar(r,"pointer-events",o),ar(i,"pointer-events",o),Hn.events=o),n.strokeForeground&&n.stroke){const s=n.fill;ar(r,"display",null),this.style(i,n),ar(i,"stroke",null),s&&(n.fill=null),Hn=r.__values__,this.style(r,n),s&&(n.fill=s),Ls=null}else ar(r,"display","none")},image(e,t,n){n.smooth===!1?(n1(t,"image-rendering","optimizeSpeed"),n1(t,"image-rendering","pixelated")):n1(t,"image-rendering",null)},text(e,t,n){const r=yg(n);let i,o,s,a;ne(r)?(o=r.map(u=>ou(n,u)),i=o.join(`
`),i!==Hn.text&&(xi(t,0),s=t.ownerDocument,a=iu(n),o.forEach((u,c)=>{const f=za(s,"tspan",nn);f.__data__=n,f.textContent=u,c&&(f.setAttribute("x",0),f.setAttribute("dy",a)),t.appendChild(f)}),Hn.text=i)):(o=ou(n,r),o!==Hn.text&&(t.textContent=o,Hn.text=o)),ar(t,"font-family",vg(n)),ar(t,"font-size",rs(n)+"px"),ar(t,"font-style",n.fontStyle),ar(t,"font-variant",n.fontVariant),ar(t,"font-weight",n.fontWeight)}};function up(e,t,n){t!==Hn[e]&&(n?Ute(Ls,e,t,n):ar(Ls,e,t),Hn[e]=t)}function n1(e,t,n){n!==Hn[t]&&(n==null?e.style.removeProperty(t):e.style.setProperty(t,n+""),Hn[t]=n)}function Ia(e,t){for(const n in t)ar(e,n,t[n])}function ar(e,t,n){n!=null?e.setAttribute(t,n):e.removeAttribute(t)}function Ute(e,t,n,r){n!=null?e.setAttributeNS(r,t,n):e.removeAttributeNS(r,t)}function g7(){let e;return typeof window>"u"?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}class m7 extends xg{constructor(t){super(t),this._text=null,this._defs={gradient:{},clipping:{}}}svg(){return this._text}_render(t){const n=Nk();n.open("svg",qe({},Mp,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));const r=this._bgcolor;return r&&r!=="transparent"&&r!=="none"&&n.open("rect",{width:this._width,height:this._height,fill:r}).close(),n.open("g",p7,{transform:"translate("+this._origin+")"}),this.mark(n,t),n.close(),this.defs(n),this._text=n.close()+"",this}mark(t,n){const r=ui[n.marktype],i=r.tag,o=[u7,r.attr];t.open("g",{class:KL(n),"clip-path":n.clip?fk(this,n,n.group):null},l7(n),{"pointer-events":i!=="g"&&n.interactive===!1?"none":null});const s=a=>{const u=this.href(a);if(u&&t.open("a",u),t.open(i,this.attr(n,a,o,i!=="g"?i:null)),i==="text"){const c=yg(a);if(ne(c)){const f={x:0,dy:iu(a)};for(let h=0;h<c.length;++h)t.open("tspan",h?f:null).text(ou(a,c[h])).close()}else t.text(ou(a,c))}else if(i==="g"){const c=a.strokeForeground,f=a.fill,h=a.stroke;c&&h&&(a.stroke=null),t.open("path",this.attr(n,a,r.background,"bgrect")).close(),t.open("g",this.attr(n,a,r.content)),ao(a,p=>this.mark(t,p)),t.close(),c&&h?(f&&(a.fill=null),a.stroke=h,t.open("path",this.attr(n,a,r.foreground,"bgrect")).close(),f&&(a.fill=f)):t.open("path",this.attr(n,a,r.foreground,"bgfore")).close()}t.close(),u&&t.close()};return r.nested?n.items&&n.items.length&&s(n.items[0]):ao(n,s),t.close()}href(t){const n=t.href;let r;if(n){if(r=this._hrefs&&this._hrefs[n])return r;this.sanitizeURL(n).then(i=>{i["xlink:href"]=i.href,i.href=null,(this._hrefs||(this._hrefs={}))[n]=i})}return null}attr(t,n,r,i){const o={},s=(a,u,c,f)=>{o[f||a]=u};return Array.isArray(r)?r.forEach(a=>a(s,n,this)):r(s,n,this),i&&jte(o,n,t,i,this._defs),o}defs(t){const n=this._defs.gradient,r=this._defs.clipping;if(Object.keys(n).length+Object.keys(r).length!==0){t.open("defs");for(const o in n){const s=n[o],a=s.stops;s.gradient==="radial"?(t.open("pattern",{id:L1+o,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),t.open("rect",{width:"1",height:"1",fill:"url(#"+o+")"}).close(),t.close(),t.open("radialGradient",{id:o,fx:s.x1,fy:s.y1,fr:s.r1,cx:s.x2,cy:s.y2,r:s.r2})):t.open("linearGradient",{id:o,x1:s.x1,x2:s.x2,y1:s.y1,y2:s.y2});for(let u=0;u<a.length;++u)t.open("stop",{offset:a[u].offset,"stop-color":a[u].color}).close();t.close()}for(const o in r){const s=r[o];t.open("clipPath",{id:o}),s.path?t.open("path",{d:s.path}).close():t.open("rect",{x:0,y:0,width:s.width,height:s.height}).close(),t.close()}t.close()}}}function jte(e,t,n,r,i){let o;if(t==null||(r==="bgrect"&&n.interactive===!1&&(e["pointer-events"]="none"),r==="bgfore"&&(n.interactive===!1&&(e["pointer-events"]="none"),e.display="none",t.fill!==null)))return e;r==="image"&&t.smooth===!1&&(o=["image-rendering: optimizeSpeed;","image-rendering: pixelated;"]),r==="text"&&(e["font-family"]=vg(t),e["font-size"]=rs(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(const s in Y1){let a=t[s];const u=Y1[s];a==="transparent"&&(u==="fill"||u==="stroke")||a!=null&&(uk(a)&&(a=AL(a,i.gradient,"")),e[u]=a)}for(const s in X1){const a=t[s];a!=null&&(o=o||[],o.push(`${X1[s]}: ${a};`))}return o&&(e.style=o.join(" ")),e}const Vi={svgMarkTypes:["text"],svgOnTop:!0,debug:!1};function Wte(e){Vi.svgMarkTypes=e.svgMarkTypes??["text"],Vi.svgOnTop=e.svgOnTop??!0,Vi.debug=e.debug??!1}class NS extends xg{constructor(t){super(t),this._svgRenderer=new Rk(t),this._canvasRenderer=new V1(t)}initialize(t,n,r,i,o){this._root_el=rn(t,0,"div");const s=rn(this._root_el,0,"div"),a=rn(this._root_el,1,"div");return this._root_el.style.position="relative",Vi.debug||(s.style.height="100%",a.style.position="absolute",a.style.top="0",a.style.left="0",a.style.height="100%",a.style.width="100%"),this._svgEl=Vi.svgOnTop?a:s,this._canvasEl=Vi.svgOnTop?s:a,this._svgEl.style.pointerEvents="none",this._canvasRenderer.initialize(this._canvasEl,n,r,i,o),this._svgRenderer.initialize(this._svgEl,n,r,i,o),super.initialize(t,n,r,i,o)}dirty(t){return Vi.svgMarkTypes.includes(t.mark.marktype)?this._svgRenderer.dirty(t):this._canvasRenderer.dirty(t),this}_render(t,n){const i=(n??["arc","area","image","line","path","rect","rule","shape","symbol","text","trail"]).filter(o=>!Vi.svgMarkTypes.includes(o));this._svgRenderer.render(t,Vi.svgMarkTypes),this._canvasRenderer.render(t,i)}resize(t,n,r,i){return super.resize(t,n,r,i),this._svgRenderer.resize(t,n,r,i),this._canvasRenderer.resize(t,n,r,i),this}background(t){return Vi.svgOnTop?this._canvasRenderer.background(t):this._svgRenderer.background(t),this}}class y7 extends wg{constructor(t,n){super(t,n)}initialize(t,n,r){const i=rn(rn(t,0,"div"),Vi.svgOnTop?0:1,"div");return super.initialize(i,n,r)}}const v7="canvas",x7="hybrid",w7="png",E7="svg",b7="none",Ba={Canvas:v7,PNG:w7,SVG:E7,Hybrid:x7,None:b7},Cl={};Cl[v7]=Cl[w7]={renderer:V1,headless:V1,handler:wg};Cl[E7]={renderer:Rk,headless:m7,handler:i7};Cl[x7]={renderer:NS,headless:NS,handler:y7};Cl[b7]={};function jv(e,t){return e=String(e||"").toLowerCase(),arguments.length>1?(Cl[e]=t,this):Cl[e]}function S7(e,t,n){const r=[],i=new Jt().union(t),o=e.marktype;return o?_7(e,i,n,r):o==="group"?A7(e,i,n,r):te("Intersect scene must be mark node or group item.")}function _7(e,t,n,r){if(qte(e,t,n)){const i=e.items,o=e.marktype,s=i.length;let a=0;if(o==="group")for(;a<s;++a)A7(i[a],t,n,r);else for(const u=ui[o].isect;a<s;++a){const c=i[a];C7(c,t,u)&&r.push(c)}}return r}function qte(e,t,n){return e.bounds&&t.intersects(e.bounds)&&(e.marktype==="group"||e.interactive!==!1&&(!n||n(e)))}function A7(e,t,n,r){n&&n(e.mark)&&C7(e,t,ui.group.isect)&&r.push(e);const i=e.items,o=i&&i.length;if(o){const s=e.x||0,a=e.y||0;t.translate(-s,-a);for(let u=0;u<o;++u)_7(i[u],t,n,r);t.translate(s,a)}return r}function C7(e,t,n){const r=e.bounds;return t.encloses(r)||t.intersects(r)&&n(e,t)}const ME=new Jt;function k7(e){const t=e.clip;if(He(t))t(gg(ME.clear()));else if(t)ME.set(0,0,e.group.width,e.group.height);else return;e.bounds.intersect(ME)}const Hte=1e-9;function Ok(e,t,n){return e===t?!0:n==="path"?$7(e,t):e instanceof Date&&t instanceof Date?+e==+t:at(e)&&at(t)?Math.abs(e-t)<=Hte:!e||!t||!ye(e)&&!ye(t)?e==t:Gte(e,t)}function $7(e,t){return Ok(kf(e),kf(t))}function Gte(e,t){var n=Object.keys(e),r=Object.keys(t),i,o;if(n.length!==r.length)return!1;for(n.sort(),r.sort(),o=n.length-1;o>=0;o--)if(n[o]!=r[o])return!1;for(o=n.length-1;o>=0;o--)if(i=n[o],!Ok(e[i],t[i],i))return!1;return typeof e==typeof t}function Vte(){TL(),yZ()}const Df="top",Ji="left",Zi="right",su="bottom",Yte="top-left",Xte="top-right",Qte="bottom-left",Kte="bottom-right",Pk="start",RS="middle",ur="end",Jte="x",Zte="y",Wv="group",Lk="axis",zk="title",ene="frame",tne="scope",Ik="legend",F7="row-header",D7="row-footer",M7="row-title",T7="column-header",N7="column-footer",R7="column-title",nne="padding",rne="symbol",O7="fit",P7="fit-x",L7="fit-y",ine="pad",Bk="none",pm="all",OS="each",Uk="flush",Ua="column",ja="row";function z7(e){J.call(this,null,e)}pe(z7,J,{transform(e,t){const n=t.dataflow,r=e.mark,i=r.marktype,o=ui[i],s=o.bound;let a=r.bounds,u;if(o.nested)r.items.length&&n.dirty(r.items[0]),a=gm(r,s),r.items.forEach(c=>{c.bounds.clear().union(a)});else if(i===Wv||e.modified())switch(t.visit(t.MOD,c=>n.dirty(c)),a.clear(),r.items.forEach(c=>a.union(gm(c,s))),r.role){case Lk:case Ik:case zk:t.reflow()}else u=t.changed(t.REM),t.visit(t.ADD,c=>{a.union(gm(c,s))}),t.visit(t.MOD,c=>{u=u||a.alignsWith(c.bounds),n.dirty(c),a.union(gm(c,s))}),u&&(a.clear(),r.items.forEach(c=>a.union(c.bounds)));return k7(r),t.modifies("bounds")}});function gm(e,t,n){return t(e.bounds.clear(),e,n)}const bN=":vega_identifier:";function jk(e){J.call(this,0,e)}jk.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]};pe(jk,J,{transform(e,t){const n=one(t.dataflow),r=e.as;let i=n.value;return t.visit(t.ADD,o=>o[r]=o[r]||++i),n.set(this.value=i),t}});function one(e){return e._signals[bN]||(e._signals[bN]=e.add(0))}function I7(e){J.call(this,null,e)}pe(I7,J,{transform(e,t){let n=this.value;n||(n=t.dataflow.scenegraph().mark(e.markdef,sne(e),e.index),n.group.context=e.context,e.context.group||(e.context.group=n.group),n.source=this.source,n.clip=e.clip,n.interactive=e.interactive,this.value=n);const r=n.marktype===Wv?Rv:Nv;return t.visit(t.ADD,i=>r.call(i,n)),(e.modified("clip")||e.modified("interactive"))&&(n.clip=e.clip,n.interactive=!!e.interactive,n.zdirty=!0,t.reflow()),n.items=t.source,t}});function sne(e){const t=e.groups,n=e.parent;return t&&t.size===1?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}function B7(e){J.call(this,null,e)}const SN={parity:e=>e.filter((t,n)=>n%2?t.opacity=0:1),greedy:(e,t)=>{let n;return e.filter((r,i)=>!i||!U7(n.bounds,r.bounds,t)?(n=r,1):r.opacity=0)}},U7=(e,t,n)=>n>Math.max(t.x1-e.x2,e.x1-t.x2,t.y1-e.y2,e.y1-t.y2),_N=(e,t)=>{for(var n=1,r=e.length,i=e[0].bounds,o;n<r;i=o,++n)if(U7(i,o=e[n].bounds,t))return!0},ane=e=>{const t=e.bounds;return t.width()>1&&t.height()>1},une=(e,t,n)=>{var r=e.range(),i=new Jt;return t===Df||t===su?i.set(r[0],-1/0,r[1],1/0):i.set(-1/0,r[0],1/0,r[1]),i.expand(n||1),o=>i.encloses(o.bounds)},AN=e=>(e.forEach(t=>t.opacity=1),e),CN=(e,t)=>e.reflow(t.modified()).modifies("opacity");pe(B7,J,{transform(e,t){const n=SN[e.method]||SN.parity,r=e.separation||0;let i=t.materialize(t.SOURCE).source,o,s;if(!i||!i.length)return;if(!e.method)return e.modified("method")&&(AN(i),t=CN(t,e)),t;if(i=i.filter(ane),!i.length)return;if(e.sort&&(i=i.slice().sort(e.sort)),o=AN(i),t=CN(t,e),o.length>=3&&_N(o,r)){do o=n(o,r);while(o.length>=3&&_N(o,r));o.length<3&&!Ze(i).opacity&&(o.length>1&&(Ze(o).opacity=0),Ze(i).opacity=1)}e.boundScale&&e.boundTolerance>=0&&(s=une(e.boundScale,e.boundOrient,+e.boundTolerance),i.forEach(u=>{s(u)||(u.opacity=0)}));const a=o[0].mark.bounds.clear();return i.forEach(u=>{u.opacity&&a.union(u.bounds)}),t}});function j7(e){J.call(this,null,e)}pe(j7,J,{transform(e,t){const n=t.dataflow;if(t.visit(t.ALL,r=>n.dirty(r)),t.fields&&t.fields.zindex){const r=t.source&&t.source[0];r&&(r.mark.zdirty=!0)}}});const qn=new Jt;function ef(e,t,n){return e[t]===n?0:(e[t]=n,1)}function lne(e){var t=e.items[0].orient;return t===Ji||t===Zi}function cne(e){let t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}function fne(e,t,n,r){var i=t.items[0],o=i.datum,s=i.translate!=null?i.translate:.5,a=i.orient,u=cne(o),c=i.range,f=i.offset,h=i.position,p=i.minExtent,m=i.maxExtent,y=o.title&&i.items[u[2]].items[0],v=i.titlePadding,w=i.bounds,E=y&&_k(y),S=0,A=0,C,k;switch(qn.clear().union(w),w.clear(),(C=u[0])>-1&&w.union(i.items[C].bounds),(C=u[1])>-1&&w.union(i.items[C].bounds),a){case Df:S=h||0,A=-f,k=Math.max(p,Math.min(m,-w.y1)),w.add(0,-k).add(c,0),y&&mm(e,y,k,v,E,0,-1,w);break;case Ji:S=-f,A=h||0,k=Math.max(p,Math.min(m,-w.x1)),w.add(-k,0).add(0,c),y&&mm(e,y,k,v,E,1,-1,w);break;case Zi:S=n+f,A=h||0,k=Math.max(p,Math.min(m,w.x2)),w.add(0,0).add(k,c),y&&mm(e,y,k,v,E,1,1,w);break;case su:S=h||0,A=r+f,k=Math.max(p,Math.min(m,w.y2)),w.add(0,0).add(c,k),y&&mm(e,y,k,v,0,0,1,w);break;default:S=i.x,A=i.y}return Zs(w.translate(S,A),i),ef(i,"x",S+s)|ef(i,"y",A+s)&&(i.bounds=qn,e.dirty(i),i.bounds=w,e.dirty(i)),i.mark.bounds.clear().union(w)}function mm(e,t,n,r,i,o,s,a){const u=t.bounds;if(t.auto){const c=s*(n+i+r);let f=0,h=0;e.dirty(t),o?f=(t.x||0)-(t.x=c):h=(t.y||0)-(t.y=c),t.mark.bounds.clear().union(u.translate(-f,-h)),e.dirty(t)}a.union(u)}const kN=(e,t)=>Math.floor(Math.min(e,t)),$N=(e,t)=>Math.ceil(Math.max(e,t));function dne(e){var t=e.items,n=t.length,r=0,i,o;const s={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;r<n;++r)if(i=t[r],o=i.items,i.marktype===Wv)switch(i.role){case Lk:case Ik:case zk:break;case F7:s.rowheaders.push(...o);break;case D7:s.rowfooters.push(...o);break;case T7:s.colheaders.push(...o);break;case N7:s.colfooters.push(...o);break;case M7:s.rowtitle=o[0];break;case R7:s.coltitle=o[0];break;default:s.marks.push(...o)}return s}function hne(e){return new Jt().set(0,0,e.width||0,e.height||0)}function pne(e){const t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function Dt(e,t,n){const r=ye(e)?e[t]:e;return r??(n!==void 0?n:0)}function FN(e){return e<0?Math.ceil(-e):0}function W7(e,t,n){var r=!n.nodirty,i=n.bounds===Uk?hne:pne,o=qn.set(0,0,0,0),s=Dt(n.align,Ua),a=Dt(n.align,ja),u=Dt(n.padding,Ua),c=Dt(n.padding,ja),f=n.columns||t.length,h=f<=0?1:Math.ceil(t.length/f),p=t.length,m=Array(p),y=Array(f),v=0,w=Array(p),E=Array(h),S=0,A=Array(p),C=Array(p),k=Array(p),D,$,M,T,L,O,X,W,I,N,U;for($=0;$<f;++$)y[$]=0;for($=0;$<h;++$)E[$]=0;for($=0;$<p;++$)O=t[$],L=k[$]=i(O),O.x=O.x||0,A[$]=0,O.y=O.y||0,C[$]=0,M=$%f,T=~~($/f),v=Math.max(v,X=Math.ceil(L.x2)),S=Math.max(S,W=Math.ceil(L.y2)),y[M]=Math.max(y[M],X),E[T]=Math.max(E[T],W),m[$]=u+FN(L.x1),w[$]=c+FN(L.y1),r&&e.dirty(t[$]);for($=0;$<p;++$)$%f===0&&(m[$]=0),$<f&&(w[$]=0);if(s===OS)for(M=1;M<f;++M){for(U=0,$=M;$<p;$+=f)U<m[$]&&(U=m[$]);for($=M;$<p;$+=f)m[$]=U+y[M-1]}else if(s===pm){for(U=0,$=0;$<p;++$)$%f&&U<m[$]&&(U=m[$]);for($=0;$<p;++$)$%f&&(m[$]=U+v)}else for(s=!1,M=1;M<f;++M)for($=M;$<p;$+=f)m[$]+=y[M-1];if(a===OS)for(T=1;T<h;++T){for(U=0,$=T*f,D=$+f;$<D;++$)U<w[$]&&(U=w[$]);for($=T*f;$<D;++$)w[$]=U+E[T-1]}else if(a===pm){for(U=0,$=f;$<p;++$)U<w[$]&&(U=w[$]);for($=f;$<p;++$)w[$]=U+S}else for(a=!1,T=1;T<h;++T)for($=T*f,D=$+f;$<D;++$)w[$]+=E[T-1];for(I=0,$=0;$<p;++$)I=m[$]+($%f?I:0),A[$]+=I-t[$].x;for(M=0;M<f;++M)for(N=0,$=M;$<p;$+=f)N+=w[$],C[$]+=N-t[$].y;if(s&&Dt(n.center,Ua)&&h>1)for($=0;$<p;++$)L=s===pm?v:y[$%f],I=L-k[$].x2-t[$].x-A[$],I>0&&(A[$]+=I/2);if(a&&Dt(n.center,ja)&&f!==1)for($=0;$<p;++$)L=a===pm?S:E[~~($/f)],N=L-k[$].y2-t[$].y-C[$],N>0&&(C[$]+=N/2);for($=0;$<p;++$)o.union(k[$].translate(A[$],C[$]));switch(I=Dt(n.anchor,Jte),N=Dt(n.anchor,Zte),Dt(n.anchor,Ua)){case ur:I-=o.width();break;case RS:I-=o.width()/2}switch(Dt(n.anchor,ja)){case ur:N-=o.height();break;case RS:N-=o.height()/2}for(I=Math.round(I),N=Math.round(N),o.clear(),$=0;$<p;++$)t[$].mark.bounds.clear();for($=0;$<p;++$)O=t[$],O.x+=A[$]+=I,O.y+=C[$]+=N,o.union(O.mark.bounds.union(O.bounds.translate(A[$],C[$]))),r&&e.dirty(O);return o}function gne(e,t,n){var r=dne(t),i=r.marks,o=n.bounds===Uk?mne:yne,s=n.offset,a=n.columns||i.length,u=a<=0?1:Math.ceil(i.length/a),c=u*a,f,h,p,m,y,v,w;const E=W7(e,i,n);E.empty()&&E.set(0,0,0,0),r.rowheaders&&(v=Dt(n.headerBand,ja,null),f=ym(e,r.rowheaders,i,a,u,-Dt(s,"rowHeader"),kN,0,o,"x1",0,a,1,v)),r.colheaders&&(v=Dt(n.headerBand,Ua,null),h=ym(e,r.colheaders,i,a,a,-Dt(s,"columnHeader"),kN,1,o,"y1",0,1,a,v)),r.rowfooters&&(v=Dt(n.footerBand,ja,null),p=ym(e,r.rowfooters,i,a,u,Dt(s,"rowFooter"),$N,0,o,"x2",a-1,a,1,v)),r.colfooters&&(v=Dt(n.footerBand,Ua,null),m=ym(e,r.colfooters,i,a,a,Dt(s,"columnFooter"),$N,1,o,"y2",c-a,1,a,v)),r.rowtitle&&(y=Dt(n.titleAnchor,ja),w=Dt(s,"rowTitle"),w=y===ur?p+w:f-w,v=Dt(n.titleBand,ja,.5),DN(e,r.rowtitle,w,0,E,v)),r.coltitle&&(y=Dt(n.titleAnchor,Ua),w=Dt(s,"columnTitle"),w=y===ur?m+w:h-w,v=Dt(n.titleBand,Ua,.5),DN(e,r.coltitle,w,1,E,v))}function mne(e,t){return t==="x1"?e.x||0:t==="y1"?e.y||0:t==="x2"?(e.x||0)+(e.width||0):t==="y2"?(e.y||0)+(e.height||0):void 0}function yne(e,t){return e.bounds[t]}function ym(e,t,n,r,i,o,s,a,u,c,f,h,p,m){var y=n.length,v=0,w=0,E,S,A,C,k,D,$,M,T;if(!y)return v;for(E=f;E<y;E+=h)n[E]&&(v=s(v,u(n[E],c)));if(!t.length)return v;for(t.length>i&&(e.warn("Grid headers exceed limit: "+i),t=t.slice(0,i)),v+=o,S=0,C=t.length;S<C;++S)e.dirty(t[S]),t[S].mark.bounds.clear();for(E=f,S=0,C=t.length;S<C;++S,E+=h){for(D=t[S],k=D.mark.bounds,A=E;A>=0&&($=n[A])==null;A-=p);a?(M=m==null?$.x:Math.round($.bounds.x1+m*$.bounds.width()),T=v):(M=v,T=m==null?$.y:Math.round($.bounds.y1+m*$.bounds.height())),k.union(D.bounds.translate(M-(D.x||0),T-(D.y||0))),D.x=M,D.y=T,e.dirty(D),w=s(w,k[c])}return w}function DN(e,t,n,r,i,o){if(t){e.dirty(t);var s=n,a=n;r?s=Math.round(i.x1+o*i.width()):a=Math.round(i.y1+o*i.height()),t.bounds.translate(s-(t.x||0),a-(t.y||0)),t.mark.bounds.clear().union(t.bounds),t.x=s,t.y=a,e.dirty(t)}}function vne(e,t){const n=e[t]||{};return(r,i)=>n[r]!=null?n[r]:e[r]!=null?e[r]:i}function xne(e,t){let n=-1/0;return e.forEach(r=>{r.offset!=null&&(n=Math.max(n,r.offset))}),n>-1/0?n:t}function wne(e,t,n,r,i,o,s){const a=vne(n,t),u=xne(e,a("offset",0)),c=a("anchor",Pk),f=c===ur?1:c===RS?.5:0,h={align:OS,bounds:a("bounds",Uk),columns:a("direction")==="vertical"?1:e.length,padding:a("margin",8),center:a("center"),nodirty:!0};switch(t){case Ji:h.anchor={x:Math.floor(r.x1)-u,column:ur,y:f*(s||r.height()+2*r.y1),row:c};break;case Zi:h.anchor={x:Math.ceil(r.x2)+u,y:f*(s||r.height()+2*r.y1),row:c};break;case Df:h.anchor={y:Math.floor(i.y1)-u,row:ur,x:f*(o||i.width()+2*i.x1),column:c};break;case su:h.anchor={y:Math.ceil(i.y2)+u,x:f*(o||i.width()+2*i.x1),column:c};break;case Yte:h.anchor={x:u,y:u};break;case Xte:h.anchor={x:o-u,y:u,column:ur};break;case Qte:h.anchor={x:u,y:s-u,row:ur};break;case Kte:h.anchor={x:o-u,y:s-u,column:ur,row:ur};break}return h}function Ene(e,t){var n=t.items[0],r=n.datum,i=n.orient,o=n.bounds,s=n.x,a=n.y,u,c;return n._bounds?n._bounds.clear().union(o):n._bounds=o.clone(),o.clear(),Sne(e,n,n.items[0].items[0]),o=bne(n,o),u=2*n.padding,c=2*n.padding,o.empty()||(u=Math.ceil(o.width()+u),c=Math.ceil(o.height()+c)),r.type===rne&&_ne(n.items[0].items[0].items[0].items),i!==Bk&&(n.x=s=0,n.y=a=0),n.width=u,n.height=c,Zs(o.set(s,a,s+u,a+c),n),n.mark.bounds.clear().union(o),n}function bne(e,t){return e.items.forEach(n=>t.union(n.bounds)),t.x1=e.padding,t.y1=e.padding,t}function Sne(e,t,n){var r=t.padding,i=r-n.x,o=r-n.y;if(!t.datum.title)(i||o)&&Eh(e,n,i,o);else{var s=t.items[1].items[0],a=s.anchor,u=t.titlePadding||0,c=r-s.x,f=r-s.y;switch(s.orient){case Ji:i+=Math.ceil(s.bounds.width())+u;break;case Zi:case su:break;default:o+=s.bounds.height()+u}switch((i||o)&&Eh(e,n,i,o),s.orient){case Ji:f+=Ic(t,n,s,a,1,1);break;case Zi:c+=Ic(t,n,s,ur,0,0)+u,f+=Ic(t,n,s,a,1,1);break;case su:c+=Ic(t,n,s,a,0,0),f+=Ic(t,n,s,ur,-1,0,1)+u;break;default:c+=Ic(t,n,s,a,0,0)}(c||f)&&Eh(e,s,c,f),(c=Math.round(s.bounds.x1-r))<0&&(Eh(e,n,-c,0),Eh(e,s,-c,0))}}function Ic(e,t,n,r,i,o,s){const a=e.datum.type!=="symbol",u=n.datum.vgrad,c=a&&(o||!u)&&!s?t.items[0]:t,f=c.bounds[i?"y2":"x2"]-e.padding,h=u&&o?f:0,p=u&&o?0:f,m=i<=0?0:_k(n);return Math.round(r===Pk?h:r===ur?p-m:.5*(f-m))}function Eh(e,t,n,r){t.x+=n,t.y+=r,t.bounds.translate(n,r),t.mark.bounds.translate(n,r),e.dirty(t)}function _ne(e){const t=e.reduce((n,r)=>(n[r.column]=Math.max(r.bounds.x2-r.x,n[r.column]||0),n),{});e.forEach(n=>{n.width=t[n.column],n.height=n.bounds.y2-n.y})}function Ane(e,t,n,r,i){var o=t.items[0],s=o.frame,a=o.orient,u=o.anchor,c=o.offset,f=o.padding,h=o.items[0].items[0],p=o.items[1]&&o.items[1].items[0],m=a===Ji||a===Zi?r:n,y=0,v=0,w=0,E=0,S=0,A;if(s!==Wv?a===Ji?(y=i.y2,m=i.y1):a===Zi?(y=i.y1,m=i.y2):(y=i.x1,m=i.x2):a===Ji&&(y=r,m=0),A=u===Pk?y:u===ur?m:(y+m)/2,p&&p.text){switch(a){case Df:case su:S=h.bounds.height()+f;break;case Ji:E=h.bounds.width()+f;break;case Zi:E=-h.bounds.width()-f;break}qn.clear().union(p.bounds),qn.translate(E-(p.x||0),S-(p.y||0)),ef(p,"x",E)|ef(p,"y",S)&&(e.dirty(p),p.bounds.clear().union(qn),p.mark.bounds.clear().union(qn),e.dirty(p)),qn.clear().union(p.bounds)}else qn.clear();switch(qn.union(h.bounds),a){case Df:v=A,w=i.y1-qn.height()-c;break;case Ji:v=i.x1-qn.width()-c,w=A;break;case Zi:v=i.x2+qn.width()+c,w=A;break;case su:v=A,w=i.y2+c;break;default:v=o.x,w=o.y}return ef(o,"x",v)|ef(o,"y",w)&&(qn.translate(v,w),e.dirty(o),o.bounds.clear().union(qn),t.bounds.clear().union(qn),e.dirty(o)),o.bounds}function q7(e){J.call(this,null,e)}pe(q7,J,{transform(e,t){const n=t.dataflow;return e.mark.items.forEach(r=>{e.layout&&gne(n,r,e.layout),kne(n,r,e)}),Cne(e.mark.group)?t.reflow():t}});function Cne(e){return e&&e.mark.role!=="legend-entry"}function kne(e,t,n){var r=t.items,i=Math.max(0,t.width||0),o=Math.max(0,t.height||0),s=new Jt().set(0,0,i,o),a=s.clone(),u=s.clone(),c=[],f,h,p,m,y,v;for(y=0,v=r.length;y<v;++y)switch(h=r[y],h.role){case Lk:m=lne(h)?a:u,m.union(fne(e,h,i,o));break;case zk:f=h;break;case Ik:c.push(Ene(e,h));break;case ene:case tne:case F7:case D7:case M7:case T7:case N7:case R7:a.union(h.bounds),u.union(h.bounds);break;default:s.union(h.bounds)}if(c.length){const w={};c.forEach(E=>{p=E.orient||Zi,p!==Bk&&(w[p]||(w[p]=[])).push(E)});for(const E in w){const S=w[E];W7(e,S,wne(S,E,n.legends,a,u,i,o))}c.forEach(E=>{const S=E.bounds;if(S.equals(E._bounds)||(E.bounds=E._bounds,e.dirty(E),E.bounds=S,e.dirty(E)),n.autosize&&(n.autosize.type===O7||n.autosize.type===P7||n.autosize.type===L7))switch(E.orient){case Ji:case Zi:s.add(S.x1,0).add(S.x2,0);break;case Df:case su:s.add(0,S.y1).add(0,S.y2)}else s.union(S)})}s.union(a).union(u),f&&s.union(Ane(e,f,i,o,s)),t.clip&&s.set(0,0,t.width||0,t.height||0),$ne(e,t,s,n)}function $ne(e,t,n,r){const i=r.autosize||{},o=i.type;if(e._autosize<1||!o)return;let s=e._width,a=e._height,u=Math.max(0,t.width||0),c=Math.max(0,Math.ceil(-n.x1)),f=Math.max(0,t.height||0),h=Math.max(0,Math.ceil(-n.y1));const p=Math.max(0,Math.ceil(n.x2-u)),m=Math.max(0,Math.ceil(n.y2-f));if(i.contains===nne){const y=e.padding();s-=y.left+y.right,a-=y.top+y.bottom}o===Bk?(c=0,h=0,u=s,f=a):o===O7?(u=Math.max(0,s-c-p),f=Math.max(0,a-h-m)):o===P7?(u=Math.max(0,s-c-p),a=f+h+m):o===L7?(s=u+c+p,f=Math.max(0,a-h-m)):o===ine&&(s=u+c+p,a=f+h+m),e._resizeView(s,a,u,f,[c,h],i.resize)}const Fne=Object.freeze(Object.defineProperty({__proto__:null,bound:z7,identifier:jk,mark:I7,overlap:B7,render:j7,viewlayout:q7},Symbol.toStringTag,{value:"Module"}));function H7(e){J.call(this,null,e)}pe(H7,J,{transform(e,t){if(this.value&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=this.value,o=e.scale,s=e.count==null?e.values?e.values.length:10:e.count,a=sk(o,s,e.minstep),u=e.format||vL(n,o,a,e.formatSpecifier,e.formatType,!!e.values),c=e.values?yL(o,e.values,a):ak(o,a);return i&&(r.rem=i),i=c.map((f,h)=>ct({index:h/(c.length-1||1),value:f,label:u(f)})),e.extra&&i.length&&i.push(ct({index:-1,extra:{value:i[0].value},label:""})),r.source=i,r.add=i,this.value=i,r}});function G7(e){J.call(this,null,e)}function Dne(){return ct({})}function Mne(e){const t=td().test(n=>n.exit);return t.lookup=n=>t.get(e(n)),t}pe(G7,J,{transform(e,t){var n=t.dataflow,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.item||Dne,o=e.key||Te,s=this.value;return ne(r.encode)&&(r.encode=null),s&&(e.modified("key")||t.modified(o))&&te("DataJoin does not support modified key function or fields."),s||(t=t.addAll(),this.value=s=Mne(o)),t.visit(t.ADD,a=>{const u=o(a);let c=s.get(u);c?c.exit?(s.empty--,r.add.push(c)):r.mod.push(c):(c=i(a),s.set(u,c),r.add.push(c)),c.datum=a,c.exit=!1}),t.visit(t.MOD,a=>{const u=o(a),c=s.get(u);c&&(c.datum=a,r.mod.push(c))}),t.visit(t.REM,a=>{const u=o(a),c=s.get(u);a===c.datum&&!c.exit&&(r.rem.push(c),c.exit=!0,++s.empty)}),t.changed(t.ADD_MOD)&&r.modifies("datum"),(t.clean()||e.clean&&s.empty>n.cleanThreshold)&&n.runAfter(s.clean),r}});function V7(e){J.call(this,null,e)}pe(V7,J,{transform(e,t){var n=t.fork(t.ADD_REM),r=e.mod||!1,i=e.encoders,o=t.encode;if(ne(o))if(n.changed()||o.every(h=>i[h]))o=o[0],n.encode=null;else return t.StopPropagation;var s=o==="enter",a=i.update||$a,u=i.enter||$a,c=i.exit||$a,f=(o&&!s?i[o]:a)||$a;if(t.changed(t.ADD)&&(t.visit(t.ADD,h=>{u(h,e),a(h,e)}),n.modifies(u.output),n.modifies(a.output),f!==$a&&f!==a&&(t.visit(t.ADD,h=>{f(h,e)}),n.modifies(f.output))),t.changed(t.REM)&&c!==$a&&(t.visit(t.REM,h=>{c(h,e)}),n.modifies(c.output)),s||f!==$a){const h=t.MOD|(e.modified()?t.REFLOW:0);s?(t.visit(h,p=>{const m=u(p,e)||r;(f(p,e)||m)&&n.mod.push(p)}),n.mod.length&&n.modifies(u.output)):t.visit(h,p=>{(f(p,e)||r)&&n.mod.push(p)}),n.mod.length&&n.modifies(f.output)}return n.changed()?n:t.StopPropagation}});function Y7(e){J.call(this,[],e)}pe(Y7,J,{transform(e,t){if(this.value!=null&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=this.value,o=e.type||Ym,s=e.scale,a=+e.limit,u=sk(s,e.count==null?5:e.count,e.minstep),c=!!e.values||o===Ym,f=e.format||bL(n,s,u,o,e.formatSpecifier,e.formatType,c),h=e.values||EL(s,u),p,m,y,v,w;return i&&(r.rem=i),o===Ym?(a&&h.length>a?(t.dataflow.warn("Symbol legend count exceeds limit, filtering items."),i=h.slice(0,a-1),w=!0):i=h,He(y=e.size)?(!e.values&&s(i[0])===0&&(i=i.slice(1)),v=i.reduce((E,S)=>Math.max(E,y(S,e)),0)):y=nr(v=y||8),i=i.map((E,S)=>ct({index:S,label:f(E,S,i),value:E,offset:v,size:y(E,e)})),w&&(w=h[i.length],i.push(ct({index:i.length,label:`…${h.length-i.length} entries`,value:w,offset:v,size:y(w,e)})))):o===iZ?(p=s.domain(),m=pL(s,p[0],Ze(p)),h.length<3&&!e.values&&p[0]!==Ze(p)&&(h=[p[0],Ze(p)]),i=h.map((E,S)=>ct({index:S,label:f(E,S,h),value:E,perc:m(E)}))):(y=h.length-1,m=gZ(s),i=h.map((E,S)=>ct({index:S,label:f(E,S,h),value:E,perc:S?m(E):0,perc2:S===y?1:m(h[S+1])}))),r.source=i,r.add=i,this.value=i,r}});const Tne=e=>e.source.x,Nne=e=>e.source.y,Rne=e=>e.target.x,One=e=>e.target.y;function Wk(e){J.call(this,{},e)}Wk.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]};pe(Wk,J,{transform(e,t){var n=e.sourceX||Tne,r=e.sourceY||Nne,i=e.targetX||Rne,o=e.targetY||One,s=e.as||"path",a=e.orient||"vertical",u=e.shape||"line",c=MN.get(u+"-"+a)||MN.get(u);return c||te("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:"")),t.visit(t.SOURCE,f=>{f[s]=c(n(f),r(f),i(f),o(f))}),t.reflow(e.modified()).modifies(s)}});const X7=(e,t,n,r)=>"M"+e+","+t+"L"+n+","+r,Pne=(e,t,n,r)=>X7(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),Q7=(e,t,n,r)=>{var i=n-e,o=r-t,s=Math.hypot(i,o)/2,a=180*Math.atan2(o,i)/Math.PI;return"M"+e+","+t+"A"+s+","+s+" "+a+" 0 1 "+n+","+r},Lne=(e,t,n,r)=>Q7(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),K7=(e,t,n,r)=>{const i=n-e,o=r-t,s=.2*(i+o),a=.2*(o-i);return"M"+e+","+t+"C"+(e+s)+","+(t+a)+" "+(n+a)+","+(r-s)+" "+n+","+r},zne=(e,t,n,r)=>K7(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),Ine=(e,t,n,r)=>"M"+e+","+t+"V"+r+"H"+n,Bne=(e,t,n,r)=>"M"+e+","+t+"H"+n+"V"+r,Une=(e,t,n,r)=>{const i=Math.cos(e),o=Math.sin(e),s=Math.cos(n),a=Math.sin(n),u=Math.abs(n-e)>Math.PI?n<=e:n>e;return"M"+t*i+","+t*o+"A"+t+","+t+" 0 0,"+(u?1:0)+" "+t*s+","+t*a+"L"+r*s+","+r*a},jne=(e,t,n,r)=>{const i=(e+n)/2;return"M"+e+","+t+"C"+i+","+t+" "+i+","+r+" "+n+","+r},Wne=(e,t,n,r)=>{const i=(t+r)/2;return"M"+e+","+t+"C"+e+","+i+" "+n+","+i+" "+n+","+r},qne=(e,t,n,r)=>{const i=Math.cos(e),o=Math.sin(e),s=Math.cos(n),a=Math.sin(n),u=(t+r)/2;return"M"+t*i+","+t*o+"C"+u*i+","+u*o+" "+u*s+","+u*a+" "+r*s+","+r*a},MN=td({line:X7,"line-radial":Pne,arc:Q7,"arc-radial":Lne,curve:K7,"curve-radial":zne,"orthogonal-horizontal":Ine,"orthogonal-vertical":Bne,"orthogonal-radial":Une,"diagonal-horizontal":jne,"diagonal-vertical":Wne,"diagonal-radial":qne});function qk(e){J.call(this,null,e)}qk.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]};pe(qk,J,{transform(e,t){var n=e.as||["startAngle","endAngle"],r=n[0],i=n[1],o=e.field||Kf,s=e.startAngle||0,a=e.endAngle!=null?e.endAngle:2*Math.PI,u=t.source,c=u.map(o),f=c.length,h=s,p=(a-s)/f8(c),m=ei(f),y,v,w;for(e.sort&&m.sort((E,S)=>c[E]-c[S]),y=0;y<f;++y)w=c[m[y]],v=u[m[y]],v[r]=h,v[i]=h+=w*p;return this.value=c,t.reflow(e.modified()).modifies(n)}});const Hne=5;function Gne(e){const t=e.type;return!e.bins&&(t===_f||t===ug||t===lg)}function J7(e){return rk(e)&&e!==Uo}const Vne=oo(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function Z7(e){J.call(this,null,e),this.modified(!0)}pe(Z7,J,{transform(e,t){var n=t.dataflow,r=this.value,i=Yne(e);(!r||i!==r.type)&&(this.value=r=lt(i)());for(i in e)if(!Vne[i]){if(i==="padding"&&J7(r.type))continue;He(r[i])?r[i](e[i]):n.warn("Unsupported scale property: "+i)}return ere(r,e,Zne(r,e,Qne(r,e,n))),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function Yne(e){var t=e.type,n="",r;return t===Uo?Uo+"-"+_f:(Xne(e)&&(r=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(e.domainMid!=null):0,n=r===2?Uo+"-":r===3?ld+"-":""),(n+t||_f).toLowerCase())}function Xne(e){const t=e.type;return rk(t)&&t!==_l&&t!==Al&&(e.scheme||e.range&&e.range.length&&e.range.every(ve))}function Qne(e,t,n){const r=Kne(e,t.domainRaw,n);if(r>-1)return r;var i=t.domain,o=e.type,s=t.zero||t.zero===void 0&&Gne(e),a,u;if(!i)return 0;if((s||t.domainMin!=null||t.domainMax!=null||t.domainMid!=null)&&(a=(i=i.slice()).length-1||1,s&&(i[0]>0&&(i[0]=0),i[a]<0&&(i[a]=0)),t.domainMin!=null&&(i[0]=t.domainMin),t.domainMax!=null&&(i[a]=t.domainMax),t.domainMid!=null)){u=t.domainMid;const c=u>i[a]?a+1:u<i[0]?0:a;c!==a&&n.warn("Scale domainMid exceeds domain min or max.",u),i.splice(c,0,u)}return J7(o)&&t.padding&&i[0]!==Ze(i)&&(i=Jne(o,i,t.range,t.padding,t.exponent,t.constant)),e.domain(ez(o,i,n)),o===ZC&&e.unknown(t.domainImplicit?pS:void 0),t.nice&&e.nice&&e.nice(t.nice!==!0&&sk(e,t.nice)||null),i.length}function Kne(e,t,n){return t?(e.domain(ez(e.type,t,n)),t.length):-1}function Jne(e,t,n,r,i,o){var s=Math.abs(Ze(n)-n[0]),a=s/(s-2*r),u=e===Ys?wA(t,null,a):e===lg?x1(t,null,a,.5):e===ug?x1(t,null,a,i||1):e===$v?EA(t,null,a,o||1):xA(t,null,a);return t=t.slice(),t[0]=u[0],t[t.length-1]=u[1],t}function ez(e,t,n){if(lL(e)){var r=Math.abs(t.reduce((i,o)=>i+(o<0?-1:o>0?1:0),0));r!==t.length&&n.warn("Log scale domain includes zero: "+de(t))}return t}function Zne(e,t,n){let r=t.bins;if(r&&!ne(r)){const i=e.domain(),o=i[0],s=Ze(i),a=r.step;let u=r.start==null?o:r.start,c=r.stop==null?s:r.stop;a||te("Scale bins parameter missing step property."),u<o&&(u=a*Math.ceil(o/a)),c>s&&(c=a*Math.floor(s/a)),r=ei(u,c+a/2,a)}return r?e.bins=r:e.bins&&delete e.bins,e.type===ek&&(r?!t.domain&&!t.domainRaw&&(e.domain(r),n=r.length):e.bins=e.domain()),n}function ere(e,t,n){var r=e.type,i=t.round||!1,o=t.range;if(t.rangeStep!=null)o=tre(r,t,n);else if(t.scheme&&(o=nre(r,t,n),He(o))){if(e.interpolator)return e.interpolator(o);te(`Scale type ${r} does not support interpolating color schemes.`)}if(o&&cL(r))return e.interpolator(Mv(PS(o,t.reverse),t.interpolate,t.interpolateGamma));o&&t.interpolate&&e.interpolate?e.interpolate(ik(t.interpolate,t.interpolateGamma)):He(e.round)?e.round(i):He(e.rangeRound)&&e.interpolate(i?sg:mu),o&&e.range(PS(o,t.reverse))}function tre(e,t,n){e!==rL&&e!==ES&&te("Only band and point scales support rangeStep.");var r=(t.paddingOuter!=null?t.paddingOuter:t.padding)||0,i=e===ES?1:(t.paddingInner!=null?t.paddingInner:t.padding)||0;return[0,t.rangeStep*JC(n,i,r)]}function nre(e,t,n){var r=t.schemeExtent,i,o;return ne(t.scheme)?o=Mv(t.scheme,t.interpolate,t.interpolateGamma):(i=t.scheme.toLowerCase(),o=ok(i),o||te(`Unrecognized scheme name: ${t.scheme}`)),n=e===Dv?n+1:e===ek?n-1:e===Af||e===Fv?+t.schemeCount||Hne:n,cL(e)?TN(o,r,t.reverse):He(o)?hL(TN(o,r),n):e===ZC?o:o.slice(0,n)}function TN(e,t,n){return He(e)&&(t||n)?dL(e,PS(t||[0,1],n)):e}function PS(e,t){return t?e.slice().reverse():e}function tz(e){J.call(this,null,e)}pe(tz,J,{transform(e,t){const n=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");return n&&t.source.sort(Yl(e.sort)),this.modified(n),t}});const NN="zero",nz="center",rz="normalize",iz=["y0","y1"];function Hk(e){J.call(this,null,e)}Hk.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:NN,values:[NN,nz,rz]},{name:"as",type:"string",array:!0,length:2,default:iz}]};pe(Hk,J,{transform(e,t){var n=e.as||iz,r=n[0],i=n[1],o=Yl(e.sort),s=e.field||Kf,a=e.offset===nz?rre:e.offset===rz?ire:ore,u,c,f,h;for(u=sre(t.source,e.groupby,o,s),c=0,f=u.length,h=u.max;c<f;++c)a(u[c],h,s,r,i);return t.reflow(e.modified()).modifies(n)}});function rre(e,t,n,r,i){for(var o=(t-e.sum)/2,s=e.length,a=0,u;a<s;++a)u=e[a],u[r]=o,u[i]=o+=Math.abs(n(u))}function ire(e,t,n,r,i){for(var o=1/e.sum,s=0,a=e.length,u=0,c=0,f;u<a;++u)f=e[u],f[r]=s,f[i]=s=o*(c+=Math.abs(n(f)))}function ore(e,t,n,r,i){for(var o=0,s=0,a=e.length,u=0,c,f;u<a;++u)f=e[u],c=+n(f),c<0?(f[r]=s,f[i]=s+=c):(f[r]=o,f[i]=o+=c)}function sre(e,t,n,r){var i=[],o=v=>v(f),s,a,u,c,f,h,p,m,y;if(t==null)i.push(e.slice());else for(s={},a=0,u=e.length;a<u;++a)f=e[a],h=t.map(o),p=s[h],p||(s[h]=p=[],i.push(p)),p.push(f);for(h=0,y=0,c=i.length;h<c;++h){for(p=i[h],a=0,m=0,u=p.length;a<u;++a)m+=Math.abs(r(p[a]));p.sum=m,m>y&&(y=m),n&&p.sort(n)}return i.max=y,i}const are=Object.freeze(Object.defineProperty({__proto__:null,axisticks:H7,datajoin:G7,encode:V7,legendentries:Y7,linkpath:Wk,pie:qk,scale:Z7,sortitems:tz,stack:Hk},Symbol.toStringTag,{value:"Module"}));var Oe=1e-6,Q1=1e-12,Xe=Math.PI,jt=Xe/2,K1=Xe/4,yr=Xe*2,Vt=180/Xe,Ge=Xe/180,Je=Math.abs,fd=Math.atan,Mi=Math.atan2,Pe=Math.cos,vm=Math.ceil,oz=Math.exp,LS=Math.hypot,J1=Math.log,TE=Math.pow,Ne=Math.sin,bi=Math.sign||function(e){return e>0?1:e<0?-1:0},vr=Math.sqrt,Gk=Math.tan;function sz(e){return e>1?0:e<-1?Xe:Math.acos(e)}function Br(e){return e>1?jt:e<-1?-jt:Math.asin(e)}function Dn(){}function Z1(e,t){e&&ON.hasOwnProperty(e.type)&&ON[e.type](e,t)}var RN={Feature:function(e,t){Z1(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)Z1(n[r].geometry,t)}},ON={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){zS(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)zS(n[r],t,0)},Polygon:function(e,t){PN(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)PN(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)Z1(n[r],t)}};function zS(e,t,n){var r=-1,i=e.length-n,o;for(t.lineStart();++r<i;)o=e[r],t.point(o[0],o[1],o[2]);t.lineEnd()}function PN(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)zS(e[n],t,1);t.polygonEnd()}function Ms(e,t){e&&RN.hasOwnProperty(e.type)?RN[e.type](e,t):Z1(e,t)}var ey=new gr,ty=new gr,az,uz,IS,BS,US,Xo={point:Dn,lineStart:Dn,lineEnd:Dn,polygonStart:function(){ey=new gr,Xo.lineStart=ure,Xo.lineEnd=lre},polygonEnd:function(){var e=+ey;ty.add(e<0?yr+e:e),this.lineStart=this.lineEnd=this.point=Dn},sphere:function(){ty.add(yr)}};function ure(){Xo.point=cre}function lre(){lz(az,uz)}function cre(e,t){Xo.point=lz,az=e,uz=t,e*=Ge,t*=Ge,IS=e,BS=Pe(t=t/2+K1),US=Ne(t)}function lz(e,t){e*=Ge,t*=Ge,t=t/2+K1;var n=e-IS,r=n>=0?1:-1,i=r*n,o=Pe(t),s=Ne(t),a=US*s,u=BS*o+a*Pe(i),c=a*r*Ne(i);ey.add(Mi(c,u)),IS=e,BS=o,US=s}function fre(e){return ty=new gr,Ms(e,Xo),ty*2}function ny(e){return[Mi(e[1],e[0]),Br(e[2])]}function kl(e){var t=e[0],n=e[1],r=Pe(n);return[r*Pe(t),r*Ne(t),Ne(n)]}function xm(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Mf(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function NE(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function wm(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function ry(e){var t=vr(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var Ot,Tr,Bt,Jr,tl,cz,fz,lf,lp,Na,Xs,$s={point:jS,lineStart:LN,lineEnd:zN,polygonStart:function(){$s.point=hz,$s.lineStart=dre,$s.lineEnd=hre,lp=new gr,Xo.polygonStart()},polygonEnd:function(){Xo.polygonEnd(),$s.point=jS,$s.lineStart=LN,$s.lineEnd=zN,ey<0?(Ot=-(Bt=180),Tr=-(Jr=90)):lp>Oe?Jr=90:lp<-Oe&&(Tr=-90),Xs[0]=Ot,Xs[1]=Bt},sphere:function(){Ot=-(Bt=180),Tr=-(Jr=90)}};function jS(e,t){Na.push(Xs=[Ot=e,Bt=e]),t<Tr&&(Tr=t),t>Jr&&(Jr=t)}function dz(e,t){var n=kl([e*Ge,t*Ge]);if(lf){var r=Mf(lf,n),i=[r[1],-r[0],0],o=Mf(i,r);ry(o),o=ny(o);var s=e-tl,a=s>0?1:-1,u=o[0]*Vt*a,c,f=Je(s)>180;f^(a*tl<u&&u<a*e)?(c=o[1]*Vt,c>Jr&&(Jr=c)):(u=(u+360)%360-180,f^(a*tl<u&&u<a*e)?(c=-o[1]*Vt,c<Tr&&(Tr=c)):(t<Tr&&(Tr=t),t>Jr&&(Jr=t))),f?e<tl?Kr(Ot,e)>Kr(Ot,Bt)&&(Bt=e):Kr(e,Bt)>Kr(Ot,Bt)&&(Ot=e):Bt>=Ot?(e<Ot&&(Ot=e),e>Bt&&(Bt=e)):e>tl?Kr(Ot,e)>Kr(Ot,Bt)&&(Bt=e):Kr(e,Bt)>Kr(Ot,Bt)&&(Ot=e)}else Na.push(Xs=[Ot=e,Bt=e]);t<Tr&&(Tr=t),t>Jr&&(Jr=t),lf=n,tl=e}function LN(){$s.point=dz}function zN(){Xs[0]=Ot,Xs[1]=Bt,$s.point=jS,lf=null}function hz(e,t){if(lf){var n=e-tl;lp.add(Je(n)>180?n+(n>0?360:-360):n)}else cz=e,fz=t;Xo.point(e,t),dz(e,t)}function dre(){Xo.lineStart()}function hre(){hz(cz,fz),Xo.lineEnd(),Je(lp)>Oe&&(Ot=-(Bt=180)),Xs[0]=Ot,Xs[1]=Bt,lf=null}function Kr(e,t){return(t-=e)<0?t+360:t}function pre(e,t){return e[0]-t[0]}function IN(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}function gre(e){var t,n,r,i,o,s,a;if(Jr=Bt=-(Ot=Tr=1/0),Na=[],Ms(e,$s),n=Na.length){for(Na.sort(pre),t=1,r=Na[0],o=[r];t<n;++t)i=Na[t],IN(r,i[0])||IN(r,i[1])?(Kr(r[0],i[1])>Kr(r[0],r[1])&&(r[1]=i[1]),Kr(i[0],r[1])>Kr(r[0],r[1])&&(r[0]=i[0])):o.push(r=i);for(s=-1/0,n=o.length-1,t=0,r=o[n];t<=n;r=i,++t)i=o[t],(a=Kr(r[1],i[0]))>s&&(s=a,Ot=i[0],Bt=r[1])}return Na=Xs=null,Ot===1/0||Tr===1/0?[[NaN,NaN],[NaN,NaN]]:[[Ot,Tr],[Bt,Jr]]}var qh,iy,oy,sy,ay,uy,ly,cy,WS,qS,HS,pz,gz,lr,cr,fr,eo={sphere:Dn,point:Vk,lineStart:BN,lineEnd:UN,polygonStart:function(){eo.lineStart=vre,eo.lineEnd=xre},polygonEnd:function(){eo.lineStart=BN,eo.lineEnd=UN}};function Vk(e,t){e*=Ge,t*=Ge;var n=Pe(t);Eg(n*Pe(e),n*Ne(e),Ne(t))}function Eg(e,t,n){++qh,oy+=(e-oy)/qh,sy+=(t-sy)/qh,ay+=(n-ay)/qh}function BN(){eo.point=mre}function mre(e,t){e*=Ge,t*=Ge;var n=Pe(t);lr=n*Pe(e),cr=n*Ne(e),fr=Ne(t),eo.point=yre,Eg(lr,cr,fr)}function yre(e,t){e*=Ge,t*=Ge;var n=Pe(t),r=n*Pe(e),i=n*Ne(e),o=Ne(t),s=Mi(vr((s=cr*o-fr*i)*s+(s=fr*r-lr*o)*s+(s=lr*i-cr*r)*s),lr*r+cr*i+fr*o);iy+=s,uy+=s*(lr+(lr=r)),ly+=s*(cr+(cr=i)),cy+=s*(fr+(fr=o)),Eg(lr,cr,fr)}function UN(){eo.point=Vk}function vre(){eo.point=wre}function xre(){mz(pz,gz),eo.point=Vk}function wre(e,t){pz=e,gz=t,e*=Ge,t*=Ge,eo.point=mz;var n=Pe(t);lr=n*Pe(e),cr=n*Ne(e),fr=Ne(t),Eg(lr,cr,fr)}function mz(e,t){e*=Ge,t*=Ge;var n=Pe(t),r=n*Pe(e),i=n*Ne(e),o=Ne(t),s=cr*o-fr*i,a=fr*r-lr*o,u=lr*i-cr*r,c=LS(s,a,u),f=Br(c),h=c&&-f/c;WS.add(h*s),qS.add(h*a),HS.add(h*u),iy+=f,uy+=f*(lr+(lr=r)),ly+=f*(cr+(cr=i)),cy+=f*(fr+(fr=o)),Eg(lr,cr,fr)}function Ere(e){qh=iy=oy=sy=ay=uy=ly=cy=0,WS=new gr,qS=new gr,HS=new gr,Ms(e,eo);var t=+WS,n=+qS,r=+HS,i=LS(t,n,r);return i<Q1&&(t=uy,n=ly,r=cy,iy<Oe&&(t=oy,n=sy,r=ay),i=LS(t,n,r),i<Q1)?[NaN,NaN]:[Mi(n,t)*Vt,Br(r/i)*Vt]}function GS(e,t){function n(r,i){return r=e(r,i),t(r[0],r[1])}return e.invert&&t.invert&&(n.invert=function(r,i){return r=t.invert(r,i),r&&e.invert(r[0],r[1])}),n}function VS(e,t){return Je(e)>Xe&&(e-=Math.round(e/yr)*yr),[e,t]}VS.invert=VS;function yz(e,t,n){return(e%=yr)?t||n?GS(WN(e),qN(t,n)):WN(e):t||n?qN(t,n):VS}function jN(e){return function(t,n){return t+=e,Je(t)>Xe&&(t-=Math.round(t/yr)*yr),[t,n]}}function WN(e){var t=jN(e);return t.invert=jN(-e),t}function qN(e,t){var n=Pe(e),r=Ne(e),i=Pe(t),o=Ne(t);function s(a,u){var c=Pe(u),f=Pe(a)*c,h=Ne(a)*c,p=Ne(u),m=p*n+f*r;return[Mi(h*i-m*o,f*n-p*r),Br(m*i+h*o)]}return s.invert=function(a,u){var c=Pe(u),f=Pe(a)*c,h=Ne(a)*c,p=Ne(u),m=p*i-h*o;return[Mi(h*i+p*o,f*n+m*r),Br(m*n-f*r)]},s}function bre(e){e=yz(e[0]*Ge,e[1]*Ge,e.length>2?e[2]*Ge:0);function t(n){return n=e(n[0]*Ge,n[1]*Ge),n[0]*=Vt,n[1]*=Vt,n}return t.invert=function(n){return n=e.invert(n[0]*Ge,n[1]*Ge),n[0]*=Vt,n[1]*=Vt,n},t}function Sre(e,t,n,r,i,o){if(n){var s=Pe(t),a=Ne(t),u=r*n;i==null?(i=t+r*yr,o=t-u/2):(i=HN(s,i),o=HN(s,o),(r>0?i<o:i>o)&&(i+=r*yr));for(var c,f=i;r>0?f>o:f<o;f-=u)c=ny([s,-a*Pe(f),-a*Ne(f)]),e.point(c[0],c[1])}}function HN(e,t){t=kl(t),t[0]-=e,ry(t);var n=sz(-t[1]);return((-t[2]<0?-n:n)+yr-Oe)%yr}function vz(){var e=[],t;return{point:function(n,r,i){t.push([n,r,i])},lineStart:function(){e.push(t=[])},lineEnd:Dn,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function r1(e,t){return Je(e[0]-t[0])<Oe&&Je(e[1]-t[1])<Oe}function Em(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function xz(e,t,n,r,i){var o=[],s=[],a,u;if(e.forEach(function(y){if(!((v=y.length-1)<=0)){var v,w=y[0],E=y[v],S;if(r1(w,E)){if(!w[2]&&!E[2]){for(i.lineStart(),a=0;a<v;++a)i.point((w=y[a])[0],w[1]);i.lineEnd();return}E[0]+=2*Oe}o.push(S=new Em(w,y,null,!0)),s.push(S.o=new Em(w,null,S,!1)),o.push(S=new Em(E,y,null,!1)),s.push(S.o=new Em(E,null,S,!0))}}),!!o.length){for(s.sort(t),GN(o),GN(s),a=0,u=s.length;a<u;++a)s[a].e=n=!n;for(var c=o[0],f,h;;){for(var p=c,m=!0;p.v;)if((p=p.n)===c)return;f=p.z,i.lineStart();do{if(p.v=p.o.v=!0,p.e){if(m)for(a=0,u=f.length;a<u;++a)i.point((h=f[a])[0],h[1]);else r(p.x,p.n.x,1,i);p=p.n}else{if(m)for(f=p.p.z,a=f.length-1;a>=0;--a)i.point((h=f[a])[0],h[1]);else r(p.x,p.p.x,-1,i);p=p.p}p=p.o,f=p.z,m=!m}while(!p.v);i.lineEnd()}}}function GN(e){if(t=e.length){for(var t,n=0,r=e[0],i;++n<t;)r.n=i=e[n],i.p=r,r=i;r.n=i=e[0],i.p=r}}function RE(e){return Je(e[0])<=Xe?e[0]:bi(e[0])*((Je(e[0])+Xe)%yr-Xe)}function _re(e,t){var n=RE(t),r=t[1],i=Ne(r),o=[Ne(n),-Pe(n),0],s=0,a=0,u=new gr;i===1?r=jt+Oe:i===-1&&(r=-jt-Oe);for(var c=0,f=e.length;c<f;++c)if(p=(h=e[c]).length)for(var h,p,m=h[p-1],y=RE(m),v=m[1]/2+K1,w=Ne(v),E=Pe(v),S=0;S<p;++S,y=C,w=D,E=$,m=A){var A=h[S],C=RE(A),k=A[1]/2+K1,D=Ne(k),$=Pe(k),M=C-y,T=M>=0?1:-1,L=T*M,O=L>Xe,X=w*D;if(u.add(Mi(X*T*Ne(L),E*$+X*Pe(L))),s+=O?M+T*yr:M,O^y>=n^C>=n){var W=Mf(kl(m),kl(A));ry(W);var I=Mf(o,W);ry(I);var N=(O^M>=0?-1:1)*Br(I[2]);(r>N||r===N&&(W[0]||W[1]))&&(a+=O^M>=0?1:-1)}}return(s<-Oe||s<Oe&&u<-Q1)^a&1}function wz(e,t,n,r){return function(i){var o=t(i),s=vz(),a=t(s),u=!1,c,f,h,p={point:m,lineStart:v,lineEnd:w,polygonStart:function(){p.point=E,p.lineStart=S,p.lineEnd=A,f=[],c=[]},polygonEnd:function(){p.point=m,p.lineStart=v,p.lineEnd=w,f=c8(f);var C=_re(c,r);f.length?(u||(i.polygonStart(),u=!0),xz(f,Cre,C,n,i)):C&&(u||(i.polygonStart(),u=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),u&&(i.polygonEnd(),u=!1),f=c=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function m(C,k){e(C,k)&&i.point(C,k)}function y(C,k){o.point(C,k)}function v(){p.point=y,o.lineStart()}function w(){p.point=m,o.lineEnd()}function E(C,k){h.push([C,k]),a.point(C,k)}function S(){a.lineStart(),h=[]}function A(){E(h[0][0],h[0][1]),a.lineEnd();var C=a.clean(),k=s.result(),D,$=k.length,M,T,L;if(h.pop(),c.push(h),h=null,!!$){if(C&1){if(T=k[0],(M=T.length-1)>0){for(u||(i.polygonStart(),u=!0),i.lineStart(),D=0;D<M;++D)i.point((L=T[D])[0],L[1]);i.lineEnd()}return}$>1&&C&2&&k.push(k.pop().concat(k.shift())),f.push(k.filter(Are))}}return p}}function Are(e){return e.length>1}function Cre(e,t){return((e=e.x)[0]<0?e[1]-jt-Oe:jt-e[1])-((t=t.x)[0]<0?t[1]-jt-Oe:jt-t[1])}const VN=wz(function(){return!0},kre,Fre,[-Xe,-jt]);function kre(e){var t=NaN,n=NaN,r=NaN,i;return{lineStart:function(){e.lineStart(),i=1},point:function(o,s){var a=o>0?Xe:-Xe,u=Je(o-t);Je(u-Xe)<Oe?(e.point(t,n=(n+s)/2>0?jt:-jt),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(a,n),e.point(o,n),i=0):r!==a&&u>=Xe&&(Je(t-r)<Oe&&(t-=r*Oe),Je(o-a)<Oe&&(o-=a*Oe),n=$re(t,n,o,s),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(a,n),i=0),e.point(t=o,n=s),r=a},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-i}}}function $re(e,t,n,r){var i,o,s=Ne(e-n);return Je(s)>Oe?fd((Ne(t)*(o=Pe(r))*Ne(n)-Ne(r)*(i=Pe(t))*Ne(e))/(i*o*s)):(t+r)/2}function Fre(e,t,n,r){var i;if(e==null)i=n*jt,r.point(-Xe,i),r.point(0,i),r.point(Xe,i),r.point(Xe,0),r.point(Xe,-i),r.point(0,-i),r.point(-Xe,-i),r.point(-Xe,0),r.point(-Xe,i);else if(Je(e[0]-t[0])>Oe){var o=e[0]<t[0]?Xe:-Xe;i=n*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(t[0],t[1])}function Dre(e){var t=Pe(e),n=2*Ge,r=t>0,i=Je(t)>Oe;function o(f,h,p,m){Sre(m,e,n,p,f,h)}function s(f,h){return Pe(f)*Pe(h)>t}function a(f){var h,p,m,y,v;return{lineStart:function(){y=m=!1,v=1},point:function(w,E){var S=[w,E],A,C=s(w,E),k=r?C?0:c(w,E):C?c(w+(w<0?Xe:-Xe),E):0;if(!h&&(y=m=C)&&f.lineStart(),C!==m&&(A=u(h,S),(!A||r1(h,A)||r1(S,A))&&(S[2]=1)),C!==m)v=0,C?(f.lineStart(),A=u(S,h),f.point(A[0],A[1])):(A=u(h,S),f.point(A[0],A[1],2),f.lineEnd()),h=A;else if(i&&h&&r^C){var D;!(k&p)&&(D=u(S,h,!0))&&(v=0,r?(f.lineStart(),f.point(D[0][0],D[0][1]),f.point(D[1][0],D[1][1]),f.lineEnd()):(f.point(D[1][0],D[1][1]),f.lineEnd(),f.lineStart(),f.point(D[0][0],D[0][1],3)))}C&&(!h||!r1(h,S))&&f.point(S[0],S[1]),h=S,m=C,p=k},lineEnd:function(){m&&f.lineEnd(),h=null},clean:function(){return v|(y&&m)<<1}}}function u(f,h,p){var m=kl(f),y=kl(h),v=[1,0,0],w=Mf(m,y),E=xm(w,w),S=w[0],A=E-S*S;if(!A)return!p&&f;var C=t*E/A,k=-t*S/A,D=Mf(v,w),$=wm(v,C),M=wm(w,k);NE($,M);var T=D,L=xm($,T),O=xm(T,T),X=L*L-O*(xm($,$)-1);if(!(X<0)){var W=vr(X),I=wm(T,(-L-W)/O);if(NE(I,$),I=ny(I),!p)return I;var N=f[0],U=h[0],Y=f[1],j=h[1],q;U<N&&(q=N,N=U,U=q);var K=U-N,P=Je(K-Xe)<Oe,G=P||K<Oe;if(!P&&j<Y&&(q=Y,Y=j,j=q),G?P?Y+j>0^I[1]<(Je(I[0]-N)<Oe?Y:j):Y<=I[1]&&I[1]<=j:K>Xe^(N<=I[0]&&I[0]<=U)){var me=wm(T,(-L+W)/O);return NE(me,$),[I,ny(me)]}}}function c(f,h){var p=r?e:Xe-e,m=0;return f<-p?m|=1:f>p&&(m|=2),h<-p?m|=4:h>p&&(m|=8),m}return wz(s,a,o,r?[0,-e]:[-Xe,e-Xe])}function Mre(e,t,n,r,i,o){var s=e[0],a=e[1],u=t[0],c=t[1],f=0,h=1,p=u-s,m=c-a,y;if(y=n-s,!(!p&&y>0)){if(y/=p,p<0){if(y<f)return;y<h&&(h=y)}else if(p>0){if(y>h)return;y>f&&(f=y)}if(y=i-s,!(!p&&y<0)){if(y/=p,p<0){if(y>h)return;y>f&&(f=y)}else if(p>0){if(y<f)return;y<h&&(h=y)}if(y=r-a,!(!m&&y>0)){if(y/=m,m<0){if(y<f)return;y<h&&(h=y)}else if(m>0){if(y>h)return;y>f&&(f=y)}if(y=o-a,!(!m&&y<0)){if(y/=m,m<0){if(y>h)return;y>f&&(f=y)}else if(m>0){if(y<f)return;y<h&&(h=y)}return f>0&&(e[0]=s+f*p,e[1]=a+f*m),h<1&&(t[0]=s+h*p,t[1]=a+h*m),!0}}}}}var Hh=1e9,bm=-Hh;function Ez(e,t,n,r){function i(c,f){return e<=c&&c<=n&&t<=f&&f<=r}function o(c,f,h,p){var m=0,y=0;if(c==null||(m=s(c,h))!==(y=s(f,h))||u(c,f)<0^h>0)do p.point(m===0||m===3?e:n,m>1?r:t);while((m=(m+h+4)%4)!==y);else p.point(f[0],f[1])}function s(c,f){return Je(c[0]-e)<Oe?f>0?0:3:Je(c[0]-n)<Oe?f>0?2:1:Je(c[1]-t)<Oe?f>0?1:0:f>0?3:2}function a(c,f){return u(c.x,f.x)}function u(c,f){var h=s(c,1),p=s(f,1);return h!==p?h-p:h===0?f[1]-c[1]:h===1?c[0]-f[0]:h===2?c[1]-f[1]:f[0]-c[0]}return function(c){var f=c,h=vz(),p,m,y,v,w,E,S,A,C,k,D,$={point:M,lineStart:X,lineEnd:W,polygonStart:L,polygonEnd:O};function M(N,U){i(N,U)&&f.point(N,U)}function T(){for(var N=0,U=0,Y=m.length;U<Y;++U)for(var j=m[U],q=1,K=j.length,P=j[0],G,me,_e=P[0],we=P[1];q<K;++q)G=_e,me=we,P=j[q],_e=P[0],we=P[1],me<=r?we>r&&(_e-G)*(r-me)>(we-me)*(e-G)&&++N:we<=r&&(_e-G)*(r-me)<(we-me)*(e-G)&&--N;return N}function L(){f=h,p=[],m=[],D=!0}function O(){var N=T(),U=D&&N,Y=(p=c8(p)).length;(U||Y)&&(c.polygonStart(),U&&(c.lineStart(),o(null,null,1,c),c.lineEnd()),Y&&xz(p,a,N,o,c),c.polygonEnd()),f=c,p=m=y=null}function X(){$.point=I,m&&m.push(y=[]),k=!0,C=!1,S=A=NaN}function W(){p&&(I(v,w),E&&C&&h.rejoin(),p.push(h.result())),$.point=M,C&&f.lineEnd()}function I(N,U){var Y=i(N,U);if(m&&y.push([N,U]),k)v=N,w=U,E=Y,k=!1,Y&&(f.lineStart(),f.point(N,U));else if(Y&&C)f.point(N,U);else{var j=[S=Math.max(bm,Math.min(Hh,S)),A=Math.max(bm,Math.min(Hh,A))],q=[N=Math.max(bm,Math.min(Hh,N)),U=Math.max(bm,Math.min(Hh,U))];Mre(j,q,e,t,n,r)?(C||(f.lineStart(),f.point(j[0],j[1])),f.point(q[0],q[1]),Y||f.lineEnd(),D=!1):Y&&(f.lineStart(),f.point(N,U),D=!1)}S=N,A=U,C=Y}return $}}function YN(e,t,n){var r=ei(e,t-Oe,n).concat(t);return function(i){return r.map(function(o){return[i,o]})}}function XN(e,t,n){var r=ei(e,t-Oe,n).concat(t);return function(i){return r.map(function(o){return[o,i]})}}function Tre(){var e,t,n,r,i,o,s,a,u=10,c=u,f=90,h=360,p,m,y,v,w=2.5;function E(){return{type:"MultiLineString",coordinates:S()}}function S(){return ei(vm(r/f)*f,n,f).map(y).concat(ei(vm(a/h)*h,s,h).map(v)).concat(ei(vm(t/u)*u,e,u).filter(function(A){return Je(A%f)>Oe}).map(p)).concat(ei(vm(o/c)*c,i,c).filter(function(A){return Je(A%h)>Oe}).map(m))}return E.lines=function(){return S().map(function(A){return{type:"LineString",coordinates:A}})},E.outline=function(){return{type:"Polygon",coordinates:[y(r).concat(v(s).slice(1),y(n).reverse().slice(1),v(a).reverse().slice(1))]}},E.extent=function(A){return arguments.length?E.extentMajor(A).extentMinor(A):E.extentMinor()},E.extentMajor=function(A){return arguments.length?(r=+A[0][0],n=+A[1][0],a=+A[0][1],s=+A[1][1],r>n&&(A=r,r=n,n=A),a>s&&(A=a,a=s,s=A),E.precision(w)):[[r,a],[n,s]]},E.extentMinor=function(A){return arguments.length?(t=+A[0][0],e=+A[1][0],o=+A[0][1],i=+A[1][1],t>e&&(A=t,t=e,e=A),o>i&&(A=o,o=i,i=A),E.precision(w)):[[t,o],[e,i]]},E.step=function(A){return arguments.length?E.stepMajor(A).stepMinor(A):E.stepMinor()},E.stepMajor=function(A){return arguments.length?(f=+A[0],h=+A[1],E):[f,h]},E.stepMinor=function(A){return arguments.length?(u=+A[0],c=+A[1],E):[u,c]},E.precision=function(A){return arguments.length?(w=+A,p=YN(o,i,90),m=XN(t,e,w),y=YN(a,s,90),v=XN(r,n,w),E):w},E.extentMajor([[-180,-90+Oe],[180,90-Oe]]).extentMinor([[-180,-80-Oe],[180,80+Oe]])}const Tp=e=>e;var OE=new gr,YS=new gr,bz,Sz,XS,QS,Ts={point:Dn,lineStart:Dn,lineEnd:Dn,polygonStart:function(){Ts.lineStart=Nre,Ts.lineEnd=Ore},polygonEnd:function(){Ts.lineStart=Ts.lineEnd=Ts.point=Dn,OE.add(Je(YS)),YS=new gr},result:function(){var e=OE/2;return OE=new gr,e}};function Nre(){Ts.point=Rre}function Rre(e,t){Ts.point=_z,bz=XS=e,Sz=QS=t}function _z(e,t){YS.add(QS*e-XS*t),XS=e,QS=t}function Ore(){_z(bz,Sz)}var Tf=1/0,fy=Tf,Np=-Tf,dy=Np,hy={point:Pre,lineStart:Dn,lineEnd:Dn,polygonStart:Dn,polygonEnd:Dn,result:function(){var e=[[Tf,fy],[Np,dy]];return Np=dy=-(fy=Tf=1/0),e}};function Pre(e,t){e<Tf&&(Tf=e),e>Np&&(Np=e),t<fy&&(fy=t),t>dy&&(dy=t)}var KS=0,JS=0,Gh=0,py=0,gy=0,tf=0,ZS=0,e_=0,Vh=0,Az,Cz,Oo,Po,wi={point:$l,lineStart:QN,lineEnd:KN,polygonStart:function(){wi.lineStart=Ire,wi.lineEnd=Bre},polygonEnd:function(){wi.point=$l,wi.lineStart=QN,wi.lineEnd=KN},result:function(){var e=Vh?[ZS/Vh,e_/Vh]:tf?[py/tf,gy/tf]:Gh?[KS/Gh,JS/Gh]:[NaN,NaN];return KS=JS=Gh=py=gy=tf=ZS=e_=Vh=0,e}};function $l(e,t){KS+=e,JS+=t,++Gh}function QN(){wi.point=Lre}function Lre(e,t){wi.point=zre,$l(Oo=e,Po=t)}function zre(e,t){var n=e-Oo,r=t-Po,i=vr(n*n+r*r);py+=i*(Oo+e)/2,gy+=i*(Po+t)/2,tf+=i,$l(Oo=e,Po=t)}function KN(){wi.point=$l}function Ire(){wi.point=Ure}function Bre(){kz(Az,Cz)}function Ure(e,t){wi.point=kz,$l(Az=Oo=e,Cz=Po=t)}function kz(e,t){var n=e-Oo,r=t-Po,i=vr(n*n+r*r);py+=i*(Oo+e)/2,gy+=i*(Po+t)/2,tf+=i,i=Po*e-Oo*t,ZS+=i*(Oo+e),e_+=i*(Po+t),Vh+=i*3,$l(Oo=e,Po=t)}function $z(e){this._context=e}$z.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,yr);break}}},result:Dn};var t_=new gr,PE,Fz,Dz,Yh,Xh,Rp={point:Dn,lineStart:function(){Rp.point=jre},lineEnd:function(){PE&&Mz(Fz,Dz),Rp.point=Dn},polygonStart:function(){PE=!0},polygonEnd:function(){PE=null},result:function(){var e=+t_;return t_=new gr,e}};function jre(e,t){Rp.point=Mz,Fz=Yh=e,Dz=Xh=t}function Mz(e,t){Yh-=e,Xh-=t,t_.add(vr(Yh*Yh+Xh*Xh)),Yh=e,Xh=t}let JN,my,ZN,eR;class tR{constructor(t){this._append=t==null?Tz:Wre(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,n){switch(this._point){case 0:{this._append`M${t},${n}`,this._point=1;break}case 1:{this._append`L${t},${n}`;break}default:{if(this._append`M${t},${n}`,this._radius!==ZN||this._append!==my){const r=this._radius,i=this._;this._="",this._append`m0,${r}a${r},${r} 0 1,1 0,${-2*r}a${r},${r} 0 1,1 0,${2*r}z`,ZN=r,my=this._append,eR=this._,this._=i}this._+=eR;break}}}result(){const t=this._;return this._="",t.length?t:null}}function Tz(e){let t=1;this._+=e[0];for(const n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function Wre(e){const t=Math.floor(e);if(!(t>=0))throw new RangeError(`invalid digits: ${e}`);if(t>15)return Tz;if(t!==JN){const n=10**t;JN=t,my=function(i){let o=1;this._+=i[0];for(const s=i.length;o<s;++o)this._+=Math.round(arguments[o]*n)/n+i[o]}}return my}function Nz(e,t){let n=3,r=4.5,i,o;function s(a){return a&&(typeof r=="function"&&o.pointRadius(+r.apply(this,arguments)),Ms(a,i(o))),o.result()}return s.area=function(a){return Ms(a,i(Ts)),Ts.result()},s.measure=function(a){return Ms(a,i(Rp)),Rp.result()},s.bounds=function(a){return Ms(a,i(hy)),hy.result()},s.centroid=function(a){return Ms(a,i(wi)),wi.result()},s.projection=function(a){return arguments.length?(i=a==null?(e=null,Tp):(e=a).stream,s):e},s.context=function(a){return arguments.length?(o=a==null?(t=null,new tR(n)):new $z(t=a),typeof r!="function"&&o.pointRadius(r),s):t},s.pointRadius=function(a){return arguments.length?(r=typeof a=="function"?a:(o.pointRadius(+a),+a),s):r},s.digits=function(a){if(!arguments.length)return n;if(a==null)n=null;else{const u=Math.floor(a);if(!(u>=0))throw new RangeError(`invalid digits: ${a}`);n=u}return t===null&&(o=new tR(n)),s},s.projection(e).digits(n).context(t)}function qv(e){return function(t){var n=new n_;for(var r in e)n[r]=e[r];return n.stream=t,n}}function n_(){}n_.prototype={constructor:n_,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function Yk(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),r!=null&&e.clipExtent(null),Ms(n,e.stream(hy)),t(hy.result()),r!=null&&e.clipExtent(r),e}function Hv(e,t,n){return Yk(e,function(r){var i=t[1][0]-t[0][0],o=t[1][1]-t[0][1],s=Math.min(i/(r[1][0]-r[0][0]),o/(r[1][1]-r[0][1])),a=+t[0][0]+(i-s*(r[1][0]+r[0][0]))/2,u=+t[0][1]+(o-s*(r[1][1]+r[0][1]))/2;e.scale(150*s).translate([a,u])},n)}function Xk(e,t,n){return Hv(e,[[0,0],t],n)}function Qk(e,t,n){return Yk(e,function(r){var i=+t,o=i/(r[1][0]-r[0][0]),s=(i-o*(r[1][0]+r[0][0]))/2,a=-o*r[0][1];e.scale(150*o).translate([s,a])},n)}function Kk(e,t,n){return Yk(e,function(r){var i=+t,o=i/(r[1][1]-r[0][1]),s=-o*r[0][0],a=(i-o*(r[1][1]+r[0][1]))/2;e.scale(150*o).translate([s,a])},n)}var nR=16,qre=Pe(30*Ge);function rR(e,t){return+t?Gre(e,t):Hre(e)}function Hre(e){return qv({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function Gre(e,t){function n(r,i,o,s,a,u,c,f,h,p,m,y,v,w){var E=c-r,S=f-i,A=E*E+S*S;if(A>4*t&&v--){var C=s+p,k=a+m,D=u+y,$=vr(C*C+k*k+D*D),M=Br(D/=$),T=Je(Je(D)-1)<Oe||Je(o-h)<Oe?(o+h)/2:Mi(k,C),L=e(T,M),O=L[0],X=L[1],W=O-r,I=X-i,N=S*W-E*I;(N*N/A>t||Je((E*W+S*I)/A-.5)>.3||s*p+a*m+u*y<qre)&&(n(r,i,o,s,a,u,O,X,T,C/=$,k/=$,D,v,w),w.point(O,X),n(O,X,T,C,k,D,c,f,h,p,m,y,v,w))}}return function(r){var i,o,s,a,u,c,f,h,p,m,y,v,w={point:E,lineStart:S,lineEnd:C,polygonStart:function(){r.polygonStart(),w.lineStart=k},polygonEnd:function(){r.polygonEnd(),w.lineStart=S}};function E(M,T){M=e(M,T),r.point(M[0],M[1])}function S(){h=NaN,w.point=A,r.lineStart()}function A(M,T){var L=kl([M,T]),O=e(M,T);n(h,p,f,m,y,v,h=O[0],p=O[1],f=M,m=L[0],y=L[1],v=L[2],nR,r),r.point(h,p)}function C(){w.point=E,r.lineEnd()}function k(){S(),w.point=D,w.lineEnd=$}function D(M,T){A(i=M,T),o=h,s=p,a=m,u=y,c=v,w.point=A}function $(){n(h,p,f,m,y,v,o,s,i,a,u,c,nR,r),w.lineEnd=C,C()}return w}}var Vre=qv({point:function(e,t){this.stream.point(e*Ge,t*Ge)}});function Yre(e){return qv({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}function Xre(e,t,n,r,i){function o(s,a){return s*=r,a*=i,[t+e*s,n-e*a]}return o.invert=function(s,a){return[(s-t)/e*r,(n-a)/e*i]},o}function iR(e,t,n,r,i,o){if(!o)return Xre(e,t,n,r,i);var s=Pe(o),a=Ne(o),u=s*e,c=a*e,f=s/e,h=a/e,p=(a*n-s*t)/e,m=(a*t+s*n)/e;function y(v,w){return v*=r,w*=i,[u*v-c*w+t,n-c*v-u*w]}return y.invert=function(v,w){return[r*(f*v-h*w+p),i*(m-h*v-f*w)]},y}function is(e){return Rz(function(){return e})()}function Rz(e){var t,n=150,r=480,i=250,o=0,s=0,a=0,u=0,c=0,f,h=0,p=1,m=1,y=null,v=VN,w=null,E,S,A,C=Tp,k=.5,D,$,M,T,L;function O(N){return M(N[0]*Ge,N[1]*Ge)}function X(N){return N=M.invert(N[0],N[1]),N&&[N[0]*Vt,N[1]*Vt]}O.stream=function(N){return T&&L===N?T:T=Vre(Yre(f)(v(D(C(L=N)))))},O.preclip=function(N){return arguments.length?(v=N,y=void 0,I()):v},O.postclip=function(N){return arguments.length?(C=N,w=E=S=A=null,I()):C},O.clipAngle=function(N){return arguments.length?(v=+N?Dre(y=N*Ge):(y=null,VN),I()):y*Vt},O.clipExtent=function(N){return arguments.length?(C=N==null?(w=E=S=A=null,Tp):Ez(w=+N[0][0],E=+N[0][1],S=+N[1][0],A=+N[1][1]),I()):w==null?null:[[w,E],[S,A]]},O.scale=function(N){return arguments.length?(n=+N,W()):n},O.translate=function(N){return arguments.length?(r=+N[0],i=+N[1],W()):[r,i]},O.center=function(N){return arguments.length?(o=N[0]%360*Ge,s=N[1]%360*Ge,W()):[o*Vt,s*Vt]},O.rotate=function(N){return arguments.length?(a=N[0]%360*Ge,u=N[1]%360*Ge,c=N.length>2?N[2]%360*Ge:0,W()):[a*Vt,u*Vt,c*Vt]},O.angle=function(N){return arguments.length?(h=N%360*Ge,W()):h*Vt},O.reflectX=function(N){return arguments.length?(p=N?-1:1,W()):p<0},O.reflectY=function(N){return arguments.length?(m=N?-1:1,W()):m<0},O.precision=function(N){return arguments.length?(D=rR($,k=N*N),I()):vr(k)},O.fitExtent=function(N,U){return Hv(O,N,U)},O.fitSize=function(N,U){return Xk(O,N,U)},O.fitWidth=function(N,U){return Qk(O,N,U)},O.fitHeight=function(N,U){return Kk(O,N,U)};function W(){var N=iR(n,0,0,p,m,h).apply(null,t(o,s)),U=iR(n,r-N[0],i-N[1],p,m,h);return f=yz(a,u,c),$=GS(t,U),M=GS(f,$),D=rR($,k),I()}function I(){return T=L=null,O}return function(){return t=e.apply(this,arguments),O.invert=t.invert&&X,W()}}function Jk(e){var t=0,n=Xe/3,r=Rz(e),i=r(t,n);return i.parallels=function(o){return arguments.length?r(t=o[0]*Ge,n=o[1]*Ge):[t*Vt,n*Vt]},i}function Qre(e){var t=Pe(e);function n(r,i){return[r*t,Ne(i)/t]}return n.invert=function(r,i){return[r/t,Br(i*t)]},n}function Kre(e,t){var n=Ne(e),r=(n+Ne(t))/2;if(Je(r)<Oe)return Qre(e);var i=1+n*(2*r-n),o=vr(i)/r;function s(a,u){var c=vr(i-2*r*Ne(u))/r;return[c*Ne(a*=r),o-c*Pe(a)]}return s.invert=function(a,u){var c=o-u,f=Mi(a,Je(c))*bi(c);return c*r<0&&(f-=Xe*bi(a)*bi(c)),[f/r,Br((i-(a*a+c*c)*r*r)/(2*r))]},s}function yy(){return Jk(Kre).scale(155.424).center([0,33.6442])}function Oz(){return yy().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function Jre(e){var t=e.length;return{point:function(n,r){for(var i=-1;++i<t;)e[i].point(n,r)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}function Zre(){var e,t,n=Oz(),r,i=yy().rotate([154,0]).center([-2,58.5]).parallels([55,65]),o,s=yy().rotate([157,0]).center([-3,19.9]).parallels([8,18]),a,u,c={point:function(p,m){u=[p,m]}};function f(p){var m=p[0],y=p[1];return u=null,r.point(m,y),u||(o.point(m,y),u)||(a.point(m,y),u)}f.invert=function(p){var m=n.scale(),y=n.translate(),v=(p[0]-y[0])/m,w=(p[1]-y[1])/m;return(w>=.12&&w<.234&&v>=-.425&&v<-.214?i:w>=.166&&w<.234&&v>=-.214&&v<-.115?s:n).invert(p)},f.stream=function(p){return e&&t===p?e:e=Jre([n.stream(t=p),i.stream(p),s.stream(p)])},f.precision=function(p){return arguments.length?(n.precision(p),i.precision(p),s.precision(p),h()):n.precision()},f.scale=function(p){return arguments.length?(n.scale(p),i.scale(p*.35),s.scale(p),f.translate(n.translate())):n.scale()},f.translate=function(p){if(!arguments.length)return n.translate();var m=n.scale(),y=+p[0],v=+p[1];return r=n.translate(p).clipExtent([[y-.455*m,v-.238*m],[y+.455*m,v+.238*m]]).stream(c),o=i.translate([y-.307*m,v+.201*m]).clipExtent([[y-.425*m+Oe,v+.12*m+Oe],[y-.214*m-Oe,v+.234*m-Oe]]).stream(c),a=s.translate([y-.205*m,v+.212*m]).clipExtent([[y-.214*m+Oe,v+.166*m+Oe],[y-.115*m-Oe,v+.234*m-Oe]]).stream(c),h()},f.fitExtent=function(p,m){return Hv(f,p,m)},f.fitSize=function(p,m){return Xk(f,p,m)},f.fitWidth=function(p,m){return Qk(f,p,m)},f.fitHeight=function(p,m){return Kk(f,p,m)};function h(){return e=t=null,f}return f.scale(1070)}function Pz(e){return function(t,n){var r=Pe(t),i=Pe(n),o=e(r*i);return o===1/0?[2,0]:[o*i*Ne(t),o*Ne(n)]}}function bg(e){return function(t,n){var r=vr(t*t+n*n),i=e(r),o=Ne(i),s=Pe(i);return[Mi(t*o,r*s),Br(r&&n*o/r)]}}var Lz=Pz(function(e){return vr(2/(1+e))});Lz.invert=bg(function(e){return 2*Br(e/2)});function eie(){return is(Lz).scale(124.75).clipAngle(180-.001)}var zz=Pz(function(e){return(e=sz(e))&&e/Ne(e)});zz.invert=bg(function(e){return e});function tie(){return is(zz).scale(79.4188).clipAngle(180-.001)}function Gv(e,t){return[e,J1(Gk((jt+t)/2))]}Gv.invert=function(e,t){return[e,2*fd(oz(t))-jt]};function nie(){return Iz(Gv).scale(961/yr)}function Iz(e){var t=is(e),n=t.center,r=t.scale,i=t.translate,o=t.clipExtent,s=null,a,u,c;t.scale=function(h){return arguments.length?(r(h),f()):r()},t.translate=function(h){return arguments.length?(i(h),f()):i()},t.center=function(h){return arguments.length?(n(h),f()):n()},t.clipExtent=function(h){return arguments.length?(h==null?s=a=u=c=null:(s=+h[0][0],a=+h[0][1],u=+h[1][0],c=+h[1][1]),f()):s==null?null:[[s,a],[u,c]]};function f(){var h=Xe*r(),p=t(bre(t.rotate()).invert([0,0]));return o(s==null?[[p[0]-h,p[1]-h],[p[0]+h,p[1]+h]]:e===Gv?[[Math.max(p[0]-h,s),a],[Math.min(p[0]+h,u),c]]:[[s,Math.max(p[1]-h,a)],[u,Math.min(p[1]+h,c)]])}return f()}function Sm(e){return Gk((jt+e)/2)}function rie(e,t){var n=Pe(e),r=e===t?Ne(e):J1(n/Pe(t))/J1(Sm(t)/Sm(e)),i=n*TE(Sm(e),r)/r;if(!r)return Gv;function o(s,a){i>0?a<-jt+Oe&&(a=-jt+Oe):a>jt-Oe&&(a=jt-Oe);var u=i/TE(Sm(a),r);return[u*Ne(r*s),i-u*Pe(r*s)]}return o.invert=function(s,a){var u=i-a,c=bi(r)*vr(s*s+u*u),f=Mi(s,Je(u))*bi(u);return u*r<0&&(f-=Xe*bi(s)*bi(u)),[f/r,2*fd(TE(i/c,1/r))-jt]},o}function iie(){return Jk(rie).scale(109.5).parallels([30,30])}function vy(e,t){return[e,t]}vy.invert=vy;function oie(){return is(vy).scale(152.63)}function sie(e,t){var n=Pe(e),r=e===t?Ne(e):(n-Pe(t))/(t-e),i=n/r+e;if(Je(r)<Oe)return vy;function o(s,a){var u=i-a,c=r*s;return[u*Ne(c),i-u*Pe(c)]}return o.invert=function(s,a){var u=i-a,c=Mi(s,Je(u))*bi(u);return u*r<0&&(c-=Xe*bi(s)*bi(u)),[c/r,i-bi(r)*vr(s*s+u*u)]},o}function aie(){return Jk(sie).scale(131.154).center([0,13.9389])}var cp=1.340264,fp=-.081106,dp=893e-6,hp=.003796,xy=vr(3)/2,uie=12;function Bz(e,t){var n=Br(xy*Ne(t)),r=n*n,i=r*r*r;return[e*Pe(n)/(xy*(cp+3*fp*r+i*(7*dp+9*hp*r))),n*(cp+fp*r+i*(dp+hp*r))]}Bz.invert=function(e,t){for(var n=t,r=n*n,i=r*r*r,o=0,s,a,u;o<uie&&(a=n*(cp+fp*r+i*(dp+hp*r))-t,u=cp+3*fp*r+i*(7*dp+9*hp*r),n-=s=a/u,r=n*n,i=r*r*r,!(Je(s)<Q1));++o);return[xy*e*(cp+3*fp*r+i*(7*dp+9*hp*r))/Pe(n),Br(Ne(n)/xy)]};function lie(){return is(Bz).scale(177.158)}function Uz(e,t){var n=Pe(t),r=Pe(e)*n;return[n*Ne(e)/r,Ne(t)/r]}Uz.invert=bg(fd);function cie(){return is(Uz).scale(144.049).clipAngle(60)}function fie(){var e=1,t=0,n=0,r=1,i=1,o=0,s,a,u=null,c,f,h,p=1,m=1,y=qv({point:function(C,k){var D=A([C,k]);this.stream.point(D[0],D[1])}}),v=Tp,w,E;function S(){return p=e*r,m=e*i,w=E=null,A}function A(C){var k=C[0]*p,D=C[1]*m;if(o){var $=D*s-k*a;k=k*s+D*a,D=$}return[k+t,D+n]}return A.invert=function(C){var k=C[0]-t,D=C[1]-n;if(o){var $=D*s+k*a;k=k*s-D*a,D=$}return[k/p,D/m]},A.stream=function(C){return w&&E===C?w:w=y(v(E=C))},A.postclip=function(C){return arguments.length?(v=C,u=c=f=h=null,S()):v},A.clipExtent=function(C){return arguments.length?(v=C==null?(u=c=f=h=null,Tp):Ez(u=+C[0][0],c=+C[0][1],f=+C[1][0],h=+C[1][1]),S()):u==null?null:[[u,c],[f,h]]},A.scale=function(C){return arguments.length?(e=+C,S()):e},A.translate=function(C){return arguments.length?(t=+C[0],n=+C[1],S()):[t,n]},A.angle=function(C){return arguments.length?(o=C%360*Ge,a=Ne(o),s=Pe(o),S()):o*Vt},A.reflectX=function(C){return arguments.length?(r=C?-1:1,S()):r<0},A.reflectY=function(C){return arguments.length?(i=C?-1:1,S()):i<0},A.fitExtent=function(C,k){return Hv(A,C,k)},A.fitSize=function(C,k){return Xk(A,C,k)},A.fitWidth=function(C,k){return Qk(A,C,k)},A.fitHeight=function(C,k){return Kk(A,C,k)},A}function jz(e,t){var n=t*t,r=n*n;return[e*(.8707-.131979*n+r*(-.013791+r*(.003971*n-.001529*r))),t*(1.007226+n*(.015085+r*(-.044475+.028874*n-.005916*r)))]}jz.invert=function(e,t){var n=t,r=25,i;do{var o=n*n,s=o*o;n-=i=(n*(1.007226+o*(.015085+s*(-.044475+.028874*o-.005916*s)))-t)/(1.007226+o*(.015085*3+s*(-.044475*7+.028874*9*o-.005916*11*s)))}while(Je(i)>Oe&&--r>0);return[e/(.8707+(o=n*n)*(-.131979+o*(-.013791+o*o*o*(.003971-.001529*o)))),n]};function die(){return is(jz).scale(175.295)}function Wz(e,t){return[Pe(t)*Ne(e),Ne(t)]}Wz.invert=bg(Br);function hie(){return is(Wz).scale(249.5).clipAngle(90+Oe)}function qz(e,t){var n=Pe(t),r=1+Pe(e)*n;return[n*Ne(e)/r,Ne(t)/r]}qz.invert=bg(function(e){return 2*fd(e)});function pie(){return is(qz).scale(250).clipAngle(142)}function Hz(e,t){return[J1(Gk((jt+t)/2)),-e]}Hz.invert=function(e,t){return[-t,2*fd(oz(e))-jt]};function gie(){var e=Iz(Hz),t=e.center,n=e.rotate;return e.center=function(r){return arguments.length?t([-r[1],r[0]]):(r=t(),[r[1],-r[0]])},e.rotate=function(r){return arguments.length?n([r[0],r[1],r.length>2?r[2]+90:90]):(r=n(),[r[0],r[1],r[2]-90])},n([0,0,90]).scale(159.155)}var mie=Math.abs,r_=Math.cos,wy=Math.sin,yie=1e-6,Gz=Math.PI,i_=Gz/2,oR=vie(2);function sR(e){return e>1?i_:e<-1?-i_:Math.asin(e)}function vie(e){return e>0?Math.sqrt(e):0}function xie(e,t){var n=e*wy(t),r=30,i;do t-=i=(t+wy(t)-n)/(1+r_(t));while(mie(i)>yie&&--r>0);return t/2}function wie(e,t,n){function r(i,o){return[e*i*r_(o=xie(n,o)),t*wy(o)]}return r.invert=function(i,o){return o=sR(o/t),[i/(e*r_(o)),sR((2*o+wy(2*o))/n)]},r}var Eie=wie(oR/i_,oR,Gz);function bie(){return is(Eie).scale(169.529)}const Sie=Nz(),o_=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function _ie(e,t){return function n(){const r=t();return r.type=e,r.path=Nz().projection(r),r.copy=r.copy||function(){const i=n();return o_.forEach(o=>{r[o]&&i[o](r[o]())}),i.path.pointRadius(r.path.pointRadius()),i},aL(r)}}function Zk(e,t){if(!e||typeof e!="string")throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(Ey[e]=_ie(e,t),this):Ey[e]||null}function Vz(e){return e&&e.path||Sie}const Ey={albers:Oz,albersusa:Zre,azimuthalequalarea:eie,azimuthalequidistant:tie,conicconformal:iie,conicequalarea:yy,conicequidistant:aie,equalEarth:lie,equirectangular:oie,gnomonic:cie,identity:fie,mercator:nie,mollweide:bie,naturalEarth1:die,orthographic:hie,stereographic:pie,transversemercator:gie};for(const e in Ey)Zk(e,Ey[e]);function Aie(){}const Ss=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function Yz(){var e=1,t=1,n=a;function r(u,c){return c.map(f=>i(u,f))}function i(u,c){var f=[],h=[];return o(u,c,p=>{n(p,u,c),Cie(p)>0?f.push([p]):h.push(p)}),h.forEach(p=>{for(var m=0,y=f.length,v;m<y;++m)if(kie((v=f[m])[0],p)!==-1){v.push(p);return}}),{type:"MultiPolygon",value:c,coordinates:f}}function o(u,c,f){var h=[],p=[],m,y,v,w,E,S;for(m=y=-1,w=u[0]>=c,Ss[w<<1].forEach(A);++m<e-1;)v=w,w=u[m+1]>=c,Ss[v|w<<1].forEach(A);for(Ss[w<<0].forEach(A);++y<t-1;){for(m=-1,w=u[y*e+e]>=c,E=u[y*e]>=c,Ss[w<<1|E<<2].forEach(A);++m<e-1;)v=w,w=u[y*e+e+m+1]>=c,S=E,E=u[y*e+m+1]>=c,Ss[v|w<<1|E<<2|S<<3].forEach(A);Ss[w|E<<3].forEach(A)}for(m=-1,E=u[y*e]>=c,Ss[E<<2].forEach(A);++m<e-1;)S=E,E=u[y*e+m+1]>=c,Ss[E<<2|S<<3].forEach(A);Ss[E<<3].forEach(A);function A(C){var k=[C[0][0]+m,C[0][1]+y],D=[C[1][0]+m,C[1][1]+y],$=s(k),M=s(D),T,L;(T=p[$])?(L=h[M])?(delete p[T.end],delete h[L.start],T===L?(T.ring.push(D),f(T.ring)):h[T.start]=p[L.end]={start:T.start,end:L.end,ring:T.ring.concat(L.ring)}):(delete p[T.end],T.ring.push(D),p[T.end=M]=T):(T=h[M])?(L=p[$])?(delete h[T.start],delete p[L.end],T===L?(T.ring.push(D),f(T.ring)):h[L.start]=p[T.end]={start:L.start,end:T.end,ring:L.ring.concat(T.ring)}):(delete h[T.start],T.ring.unshift(k),h[T.start=$]=T):h[$]=p[M]={start:$,end:M,ring:[k,D]}}}function s(u){return u[0]*2+u[1]*(e+1)*4}function a(u,c,f){u.forEach(h=>{var p=h[0],m=h[1],y=p|0,v=m|0,w,E=c[v*e+y];p>0&&p<e&&y===p&&(w=c[v*e+y-1],h[0]=p+(f-w)/(E-w)-.5),m>0&&m<t&&v===m&&(w=c[(v-1)*e+y],h[1]=m+(f-w)/(E-w)-.5)})}return r.contour=i,r.size=function(u){if(!arguments.length)return[e,t];var c=Math.floor(u[0]),f=Math.floor(u[1]);return c>=0&&f>=0||te("invalid size"),e=c,t=f,r},r.smooth=function(u){return arguments.length?(n=u?a:Aie,r):n===a},r}function Cie(e){for(var t=0,n=e.length,r=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];++t<n;)r+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return r}function kie(e,t){for(var n=-1,r=t.length,i;++n<r;)if(i=$ie(e,t[n]))return i;return 0}function $ie(e,t){for(var n=t[0],r=t[1],i=-1,o=0,s=e.length,a=s-1;o<s;a=o++){var u=e[o],c=u[0],f=u[1],h=e[a],p=h[0],m=h[1];if(Fie(u,h,t))return 0;f>r!=m>r&&n<(p-c)*(r-f)/(m-f)+c&&(i=-i)}return i}function Fie(e,t,n){var r;return Die(e,t,n)&&Mie(e[r=+(e[0]===t[0])],n[r],t[r])}function Die(e,t,n){return(t[0]-e[0])*(n[1]-e[1])===(n[0]-e[0])*(t[1]-e[1])}function Mie(e,t,n){return e<=t&&t<=n||n<=t&&t<=e}function Xz(e,t,n){return function(r){var i=Ho(r),o=n?Math.min(i[0],0):i[0],s=i[1],a=s-o,u=t?Za(o,s,e):a/(e+1);return ei(o+u,s,u)}}function e$(e){J.call(this,null,e)}e$.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]};pe(e$,J,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=t.materialize(t.SOURCE).source,i=e.field||tr,o=Yz().smooth(e.smooth!==!1),s=e.thresholds||Tie(r,i,e),a=e.as===null?null:e.as||"contour",u=[];return r.forEach(c=>{const f=i(c),h=o.size([f.width,f.height])(f.values,ne(s)?s:s(f.values));Nie(h,f,c,e),h.forEach(p=>{u.push(lv(c,ct(a!=null?{[a]:p}:p)))})}),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}});function Tie(e,t,n){const r=Xz(n.levels||10,n.nice,n.zero!==!1);return n.resolve!=="shared"?r:r(e.map(i=>dl(t(i).values)))}function Nie(e,t,n,r){let i=r.scale||t.scale,o=r.translate||t.translate;if(He(i)&&(i=i(n,r)),He(o)&&(o=o(n,r)),(i===1||i==null)&&!o)return;const s=(at(i)?i:i[0])||1,a=(at(i)?i:i[1])||1,u=o&&o[0]||0,c=o&&o[1]||0;e.forEach(Qz(t,s,a,u,c))}function Qz(e,t,n,r,i){const o=e.x1||0,s=e.y1||0,a=t*n<0;function u(h){h.forEach(c)}function c(h){a&&h.reverse(),h.forEach(f)}function f(h){h[0]=(h[0]-o)*t+r,h[1]=(h[1]-s)*n+i}return function(h){return h.coordinates.forEach(u),h}}function aR(e,t,n){const r=e>=0?e:GA(t,n);return Math.round((Math.sqrt(4*r*r+1)-1)/2)}function LE(e){return He(e)?e:nr(+e)}function Kz(){var e=u=>u[0],t=u=>u[1],n=Kf,r=[-1,-1],i=960,o=500,s=2;function a(u,c){const f=aR(r[0],u,e)>>s,h=aR(r[1],u,t)>>s,p=f?f+2:0,m=h?h+2:0,y=2*p+(i>>s),v=2*m+(o>>s),w=new Float32Array(y*v),E=new Float32Array(y*v);let S=w;u.forEach(C=>{const k=p+(+e(C)>>s),D=m+(+t(C)>>s);k>=0&&k<y&&D>=0&&D<v&&(w[k+D*y]+=+n(C))}),f>0&&h>0?(Bc(y,v,w,E,f),Uc(y,v,E,w,h),Bc(y,v,w,E,f),Uc(y,v,E,w,h),Bc(y,v,w,E,f),Uc(y,v,E,w,h)):f>0?(Bc(y,v,w,E,f),Bc(y,v,E,w,f),Bc(y,v,w,E,f),S=E):h>0&&(Uc(y,v,w,E,h),Uc(y,v,E,w,h),Uc(y,v,w,E,h),S=E);const A=c?Math.pow(2,-2*s):1/f8(S);for(let C=0,k=y*v;C<k;++C)S[C]*=A;return{values:S,scale:1<<s,width:y,height:v,x1:p,y1:m,x2:p+(i>>s),y2:m+(o>>s)}}return a.x=function(u){return arguments.length?(e=LE(u),a):e},a.y=function(u){return arguments.length?(t=LE(u),a):t},a.weight=function(u){return arguments.length?(n=LE(u),a):n},a.size=function(u){if(!arguments.length)return[i,o];var c=+u[0],f=+u[1];return c>=0&&f>=0||te("invalid size"),i=c,o=f,a},a.cellSize=function(u){return arguments.length?((u=+u)>=1||te("invalid cell size"),s=Math.floor(Math.log(u)/Math.LN2),a):1<<s},a.bandwidth=function(u){return arguments.length?(u=xe(u),u.length===1&&(u=[+u[0],+u[0]]),u.length!==2&&te("invalid bandwidth"),r=u,a):r},a}function Bc(e,t,n,r,i){const o=(i<<1)+1;for(let s=0;s<t;++s)for(let a=0,u=0;a<e+i;++a)a<e&&(u+=n[a+s*e]),a>=i&&(a>=o&&(u-=n[a-o+s*e]),r[a-i+s*e]=u/Math.min(a+1,e-1+o-a,o))}function Uc(e,t,n,r,i){const o=(i<<1)+1;for(let s=0;s<e;++s)for(let a=0,u=0;a<t+i;++a)a<t&&(u+=n[s+a*e]),a>=i&&(a>=o&&(u-=n[s+(a-o)*e]),r[s+(a-i)*e]=u/Math.min(a+1,t-1+o-a,o))}function t$(e){J.call(this,null,e)}t$.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const Rie=["x","y","weight","size","cellSize","bandwidth"];function Jz(e,t){return Rie.forEach(n=>t[n]!=null?e[n](t[n]):0),e}pe(t$,J,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=t.materialize(t.SOURCE).source,i=Oie(r,e.groupby),o=(e.groupby||[]).map(Wt),s=Jz(Kz(),e),a=e.as||"grid",u=[];function c(f,h){for(let p=0;p<o.length;++p)f[o[p]]=h[p];return f}return u=i.map(f=>ct(c({[a]:s(f,e.counts)},f.dims))),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}});function Oie(e,t){var n=[],r=f=>f(a),i,o,s,a,u,c;if(t==null)n.push(e);else for(i={},o=0,s=e.length;o<s;++o)a=e[o],u=t.map(r),c=i[u],c||(i[u]=c=[],c.dims=u,n.push(c)),c.push(a);return n}function n$(e){J.call(this,null,e)}n$.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]};pe(n$,J,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=Yz().smooth(e.smooth!==!1),i=e.values,o=e.thresholds||Xz(e.count||10,e.nice,!!i),s=e.size,a,u;return i||(i=t.materialize(t.SOURCE).source,a=Jz(Kz(),e)(i,!0),u=Qz(a,a.scale||1,a.scale||1,0,0),s=[a.width,a.height],i=a.values),o=ne(o)?o:o(i),i=r.size(s)(i,o),u&&i.forEach(u),this.value&&(n.rem=this.value),this.value=n.source=n.add=(i||[]).map(ct),n}});const s_="Feature",r$="FeatureCollection",Pie="MultiPoint";function i$(e){J.call(this,null,e)}i$.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]};pe(i$,J,{transform(e,t){var n=this._features,r=this._points,i=e.fields,o=i&&i[0],s=i&&i[1],a=e.geojson||!i&&tr,u=t.ADD,c;c=e.modified()||t.changed(t.REM)||t.modified(Xn(a))||o&&t.modified(Xn(o))||s&&t.modified(Xn(s)),(!this.value||c)&&(u=t.SOURCE,this._features=n=[],this._points=r=[]),a&&t.visit(u,f=>n.push(a(f))),o&&s&&(t.visit(u,f=>{var h=o(f),p=s(f);h!=null&&p!=null&&(h=+h)===h&&(p=+p)===p&&r.push([h,p])}),n=n.concat({type:s_,geometry:{type:Pie,coordinates:r}})),this.value={type:r$,features:n}}});function o$(e){J.call(this,null,e)}o$.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]};pe(o$,J,{transform(e,t){var n=t.fork(t.ALL),r=this.value,i=e.field||tr,o=e.as||"path",s=n.SOURCE;!r||e.modified()?(this.value=r=Vz(e.projection),n.materialize().reflow()):s=i===tr||t.modified(i.fields)?n.ADD_MOD:n.ADD;const a=Lie(r,e.pointRadius);return n.visit(s,u=>u[o]=r(i(u))),r.pointRadius(a),n.modifies(o)}});function Lie(e,t){const n=e.pointRadius();return e.context(null),t!=null&&e.pointRadius(t),n}function s$(e){J.call(this,null,e)}s$.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]};pe(s$,J,{transform(e,t){var n=e.projection,r=e.fields[0],i=e.fields[1],o=e.as||["x","y"],s=o[0],a=o[1],u;function c(f){const h=n([r(f),i(f)]);h?(f[s]=h[0],f[a]=h[1]):(f[s]=void 0,f[a]=void 0)}return e.modified()?t=t.materialize().reflow(!0).visit(t.SOURCE,c):(u=t.modified(r.fields)||t.modified(i.fields),t.visit(u?t.ADD_MOD:t.ADD,c)),t.modifies(o)}});function a$(e){J.call(this,null,e)}a$.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]};pe(a$,J,{transform(e,t){var n=t.fork(t.ALL),r=this.value,i=e.as||"shape",o=n.ADD;return(!r||e.modified())&&(this.value=r=zie(Vz(e.projection),e.field||ki("datum"),e.pointRadius),n.materialize().reflow(),o=n.SOURCE),n.visit(o,s=>s[i]=r),n.modifies(i)}});function zie(e,t,n){const r=n==null?i=>e(t(i)):i=>{var o=e.pointRadius(),s=e.pointRadius(n)(t(i));return e.pointRadius(o),s};return r.context=i=>(e.context(i),r),r}function u$(e){J.call(this,[],e),this.generator=Tre()}u$.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]};pe(u$,J,{transform(e,t){var n=this.value,r=this.generator,i;if(!n.length||e.modified())for(const o in e)He(r[o])&&r[o](e[o]);return i=r(),n.length?t.mod.push(sP(n[0],i)):t.add.push(ct(i)),n[0]=i,t}});function l$(e){J.call(this,null,e)}l$.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]};pe(l$,J,{transform(e,t){if(!t.changed()&&!e.modified())return t.StopPropagation;var n=t.materialize(t.SOURCE).source,r=e.resolve==="shared",i=e.field||tr,o=Bie(e.opacity,e),s=Iie(e.color,e),a=e.as||"image",u={$x:0,$y:0,$value:0,$max:r?dl(n.map(c=>dl(i(c).values))):0};return n.forEach(c=>{const f=i(c),h=qe({},c,u);r||(h.$max=dl(f.values||[])),c[a]=Uie(f,h,s.dep?s:nr(s(h)),o.dep?o:nr(o(h)))}),t.reflow(!0).modifies(a)}});function Iie(e,t){let n;return He(e)?(n=r=>nu(e(r,t)),n.dep=Zz(e)):n=nr(nu(e||"#888")),n}function Bie(e,t){let n;return He(e)?(n=r=>e(r,t),n.dep=Zz(e)):e?n=nr(e):(n=r=>r.$value/r.$max||0,n.dep=!0),n}function Zz(e){if(!He(e))return!1;const t=oo(Xn(e));return t.$x||t.$y||t.$value||t.$max}function Uie(e,t,n,r){const i=e.width,o=e.height,s=e.x1||0,a=e.y1||0,u=e.x2||i,c=e.y2||o,f=e.values,h=f?w=>f[w]:Pa,p=Xa(u-s,c-a),m=p.getContext("2d"),y=m.getImageData(0,0,u-s,c-a),v=y.data;for(let w=a,E=0;w<c;++w){t.$y=w-a;for(let S=s,A=w*i;S<u;++S,E+=4){t.$x=S-s,t.$value=h(S+A);const C=n(t);v[E+0]=C.r,v[E+1]=C.g,v[E+2]=C.b,v[E+3]=~~(255*r(t))}}return m.putImageData(y,0,0),p}function eI(e){J.call(this,null,e),this.modified(!0)}pe(eI,J,{transform(e,t){let n=this.value;return!n||e.modified("type")?(this.value=n=Wie(e.type),o_.forEach(r=>{e[r]!=null&&uR(n,r,e[r])})):o_.forEach(r=>{e.modified(r)&&uR(n,r,e[r])}),e.pointRadius!=null&&n.path.pointRadius(e.pointRadius),e.fit&&jie(n,e),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function jie(e,t){const n=qie(t.fit);t.extent?e.fitExtent(t.extent,n):t.size&&e.fitSize(t.size,n)}function Wie(e){const t=Zk((e||"mercator").toLowerCase());return t||te("Unrecognized projection type: "+e),t()}function uR(e,t,n){He(e[t])&&e[t](n)}function qie(e){return e=xe(e),e.length===1?e[0]:{type:r$,features:e.reduce((t,n)=>t.concat(Hie(n)),[])}}function Hie(e){return e.type===r$?e.features:xe(e).filter(t=>t!=null).map(t=>t.type===s_?t:{type:s_,geometry:t})}const Gie=Object.freeze(Object.defineProperty({__proto__:null,contour:n$,geojson:i$,geopath:o$,geopoint:s$,geoshape:a$,graticule:u$,heatmap:l$,isocontour:e$,kde2d:t$,projection:eI},Symbol.toStringTag,{value:"Module"}));function Vie(e,t){var n,r=1;e==null&&(e=0),t==null&&(t=0);function i(){var o,s=n.length,a,u=0,c=0;for(o=0;o<s;++o)a=n[o],u+=a.x,c+=a.y;for(u=(u/s-e)*r,c=(c/s-t)*r,o=0;o<s;++o)a=n[o],a.x-=u,a.y-=c}return i.initialize=function(o){n=o},i.x=function(o){return arguments.length?(e=+o,i):e},i.y=function(o){return arguments.length?(t=+o,i):t},i.strength=function(o){return arguments.length?(r=+o,i):r},i}function Yie(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return tI(this.cover(t,n),t,n,e)}function tI(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var i,o=e._root,s={data:r},a=e._x0,u=e._y0,c=e._x1,f=e._y1,h,p,m,y,v,w,E,S;if(!o)return e._root=s,e;for(;o.length;)if((v=t>=(h=(a+c)/2))?a=h:c=h,(w=n>=(p=(u+f)/2))?u=p:f=p,i=o,!(o=o[E=w<<1|v]))return i[E]=s,e;if(m=+e._x.call(null,o.data),y=+e._y.call(null,o.data),t===m&&n===y)return s.next=o,i?i[E]=s:e._root=s,e;do i=i?i[E]=new Array(4):e._root=new Array(4),(v=t>=(h=(a+c)/2))?a=h:c=h,(w=n>=(p=(u+f)/2))?u=p:f=p;while((E=w<<1|v)===(S=(y>=p)<<1|m>=h));return i[S]=o,i[E]=s,e}function Xie(e){var t,n,r=e.length,i,o,s=new Array(r),a=new Array(r),u=1/0,c=1/0,f=-1/0,h=-1/0;for(n=0;n<r;++n)isNaN(i=+this._x.call(null,t=e[n]))||isNaN(o=+this._y.call(null,t))||(s[n]=i,a[n]=o,i<u&&(u=i),i>f&&(f=i),o<c&&(c=o),o>h&&(h=o));if(u>f||c>h)return this;for(this.cover(u,c).cover(f,h),n=0;n<r;++n)tI(this,s[n],a[n],e[n]);return this}function Qie(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(n))i=(n=Math.floor(e))+1,o=(r=Math.floor(t))+1;else{for(var s=i-n||1,a=this._root,u,c;n>e||e>=i||r>t||t>=o;)switch(c=(t<r)<<1|e<n,u=new Array(4),u[c]=a,a=u,s*=2,c){case 0:i=n+s,o=r+s;break;case 1:n=i-s,o=r+s;break;case 2:i=n+s,r=o-s;break;case 3:n=i-s,r=o-s;break}this._root&&this._root.length&&(this._root=a)}return this._x0=n,this._y0=r,this._x1=i,this._y1=o,this}function Kie(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function Jie(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function dr(e,t,n,r,i){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=i}function Zie(e,t,n){var r,i=this._x0,o=this._y0,s,a,u,c,f=this._x1,h=this._y1,p=[],m=this._root,y,v;for(m&&p.push(new dr(m,i,o,f,h)),n==null?n=1/0:(i=e-n,o=t-n,f=e+n,h=t+n,n*=n);y=p.pop();)if(!(!(m=y.node)||(s=y.x0)>f||(a=y.y0)>h||(u=y.x1)<i||(c=y.y1)<o))if(m.length){var w=(s+u)/2,E=(a+c)/2;p.push(new dr(m[3],w,E,u,c),new dr(m[2],s,E,w,c),new dr(m[1],w,a,u,E),new dr(m[0],s,a,w,E)),(v=(t>=E)<<1|e>=w)&&(y=p[p.length-1],p[p.length-1]=p[p.length-1-v],p[p.length-1-v]=y)}else{var S=e-+this._x.call(null,m.data),A=t-+this._y.call(null,m.data),C=S*S+A*A;if(C<n){var k=Math.sqrt(n=C);i=e-k,o=t-k,f=e+k,h=t+k,r=m.data}}return r}function eoe(e){if(isNaN(f=+this._x.call(null,e))||isNaN(h=+this._y.call(null,e)))return this;var t,n=this._root,r,i,o,s=this._x0,a=this._y0,u=this._x1,c=this._y1,f,h,p,m,y,v,w,E;if(!n)return this;if(n.length)for(;;){if((y=f>=(p=(s+u)/2))?s=p:u=p,(v=h>=(m=(a+c)/2))?a=m:c=m,t=n,!(n=n[w=v<<1|y]))return this;if(!n.length)break;(t[w+1&3]||t[w+2&3]||t[w+3&3])&&(r=t,E=w)}for(;n.data!==e;)if(i=n,!(n=n.next))return this;return(o=n.next)&&delete n.next,i?(o?i.next=o:delete i.next,this):t?(o?t[w]=o:delete t[w],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(r?r[E]=n:this._root=n),this):(this._root=o,this)}function toe(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function noe(){return this._root}function roe(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function ioe(e){var t=[],n,r=this._root,i,o,s,a,u;for(r&&t.push(new dr(r,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(r=n.node,o=n.x0,s=n.y0,a=n.x1,u=n.y1)&&r.length){var c=(o+a)/2,f=(s+u)/2;(i=r[3])&&t.push(new dr(i,c,f,a,u)),(i=r[2])&&t.push(new dr(i,o,f,c,u)),(i=r[1])&&t.push(new dr(i,c,s,a,f)),(i=r[0])&&t.push(new dr(i,o,s,c,f))}return this}function ooe(e){var t=[],n=[],r;for(this._root&&t.push(new dr(this._root,this._x0,this._y0,this._x1,this._y1));r=t.pop();){var i=r.node;if(i.length){var o,s=r.x0,a=r.y0,u=r.x1,c=r.y1,f=(s+u)/2,h=(a+c)/2;(o=i[0])&&t.push(new dr(o,s,a,f,h)),(o=i[1])&&t.push(new dr(o,f,a,u,h)),(o=i[2])&&t.push(new dr(o,s,h,f,c)),(o=i[3])&&t.push(new dr(o,f,h,u,c))}n.push(r)}for(;r=n.pop();)e(r.node,r.x0,r.y0,r.x1,r.y1);return this}function soe(e){return e[0]}function aoe(e){return arguments.length?(this._x=e,this):this._x}function uoe(e){return e[1]}function loe(e){return arguments.length?(this._y=e,this):this._y}function c$(e,t,n){var r=new f$(t??soe,n??uoe,NaN,NaN,NaN,NaN);return e==null?r:r.addAll(e)}function f$(e,t,n,r,i,o){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function lR(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var wr=c$.prototype=f$.prototype;wr.copy=function(){var e=new f$(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,r;if(!t)return e;if(!t.length)return e._root=lR(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var i=0;i<4;++i)(r=t.source[i])&&(r.length?n.push({source:r,target:t.target[i]=new Array(4)}):t.target[i]=lR(r));return e};wr.add=Yie;wr.addAll=Xie;wr.cover=Qie;wr.data=Kie;wr.extent=Jie;wr.find=Zie;wr.remove=eoe;wr.removeAll=toe;wr.root=noe;wr.size=roe;wr.visit=ioe;wr.visitAfter=ooe;wr.x=aoe;wr.y=loe;function hr(e){return function(){return e}}function Wa(e){return(e()-.5)*1e-6}function coe(e){return e.x+e.vx}function foe(e){return e.y+e.vy}function doe(e){var t,n,r,i=1,o=1;typeof e!="function"&&(e=hr(e==null?1:+e));function s(){for(var c,f=t.length,h,p,m,y,v,w,E=0;E<o;++E)for(h=c$(t,coe,foe).visitAfter(a),c=0;c<f;++c)p=t[c],v=n[p.index],w=v*v,m=p.x+p.vx,y=p.y+p.vy,h.visit(S);function S(A,C,k,D,$){var M=A.data,T=A.r,L=v+T;if(M){if(M.index>p.index){var O=m-M.x-M.vx,X=y-M.y-M.vy,W=O*O+X*X;W<L*L&&(O===0&&(O=Wa(r),W+=O*O),X===0&&(X=Wa(r),W+=X*X),W=(L-(W=Math.sqrt(W)))/W*i,p.vx+=(O*=W)*(L=(T*=T)/(w+T)),p.vy+=(X*=W)*L,M.vx-=O*(L=1-L),M.vy-=X*L)}return}return C>m+L||D<m-L||k>y+L||$<y-L}}function a(c){if(c.data)return c.r=n[c.data.index];for(var f=c.r=0;f<4;++f)c[f]&&c[f].r>c.r&&(c.r=c[f].r)}function u(){if(t){var c,f=t.length,h;for(n=new Array(f),c=0;c<f;++c)h=t[c],n[h.index]=+e(h,c,t)}}return s.initialize=function(c,f){t=c,r=f,u()},s.iterations=function(c){return arguments.length?(o=+c,s):o},s.strength=function(c){return arguments.length?(i=+c,s):i},s.radius=function(c){return arguments.length?(e=typeof c=="function"?c:hr(+c),u(),s):e},s}function hoe(e){return e.index}function cR(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function poe(e){var t=hoe,n=h,r,i=hr(30),o,s,a,u,c,f=1;e==null&&(e=[]);function h(w){return 1/Math.min(a[w.source.index],a[w.target.index])}function p(w){for(var E=0,S=e.length;E<f;++E)for(var A=0,C,k,D,$,M,T,L;A<S;++A)C=e[A],k=C.source,D=C.target,$=D.x+D.vx-k.x-k.vx||Wa(c),M=D.y+D.vy-k.y-k.vy||Wa(c),T=Math.sqrt($*$+M*M),T=(T-o[A])/T*w*r[A],$*=T,M*=T,D.vx-=$*(L=u[A]),D.vy-=M*L,k.vx+=$*(L=1-L),k.vy+=M*L}function m(){if(s){var w,E=s.length,S=e.length,A=new Map(s.map((k,D)=>[t(k,D,s),k])),C;for(w=0,a=new Array(E);w<S;++w)C=e[w],C.index=w,typeof C.source!="object"&&(C.source=cR(A,C.source)),typeof C.target!="object"&&(C.target=cR(A,C.target)),a[C.source.index]=(a[C.source.index]||0)+1,a[C.target.index]=(a[C.target.index]||0)+1;for(w=0,u=new Array(S);w<S;++w)C=e[w],u[w]=a[C.source.index]/(a[C.source.index]+a[C.target.index]);r=new Array(S),y(),o=new Array(S),v()}}function y(){if(s)for(var w=0,E=e.length;w<E;++w)r[w]=+n(e[w],w,e)}function v(){if(s)for(var w=0,E=e.length;w<E;++w)o[w]=+i(e[w],w,e)}return p.initialize=function(w,E){s=w,c=E,m()},p.links=function(w){return arguments.length?(e=w,m(),p):e},p.id=function(w){return arguments.length?(t=w,p):t},p.iterations=function(w){return arguments.length?(f=+w,p):f},p.strength=function(w){return arguments.length?(n=typeof w=="function"?w:hr(+w),y(),p):n},p.distance=function(w){return arguments.length?(i=typeof w=="function"?w:hr(+w),v(),p):i},p}var goe={value:()=>{}};function nI(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new i1(n)}function i1(e){this._=e}function moe(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}i1.prototype=nI.prototype={constructor:i1,on:function(e,t){var n=this._,r=moe(e+"",n),i,o=-1,s=r.length;if(arguments.length<2){for(;++o<s;)if((i=(e=r[o]).type)&&(i=yoe(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++o<s;)if(i=(e=r[o]).type)n[i]=fR(n[i],e.name,t);else if(t==null)for(i in n)n[i]=fR(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new i1(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,o;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=this._[e],r=0,i=o.length;r<i;++r)o[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,o=r.length;i<o;++i)r[i].value.apply(t,n)}};function yoe(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function fR(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=goe,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var Nf=0,Qh=0,bh=0,rI=1e3,by,Kh,Sy=0,Fl=0,Vv=0,Op=typeof performance=="object"&&performance.now?performance:Date,iI=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function d$(){return Fl||(iI(voe),Fl=Op.now()+Vv)}function voe(){Fl=0}function _y(){this._call=this._time=this._next=null}_y.prototype=oI.prototype={constructor:_y,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?d$():+n)+(t==null?0:+t),!this._next&&Kh!==this&&(Kh?Kh._next=this:by=this,Kh=this),this._call=e,this._time=n,a_()},stop:function(){this._call&&(this._call=null,this._time=1/0,a_())}};function oI(e,t,n){var r=new _y;return r.restart(e,t,n),r}function xoe(){d$(),++Nf;for(var e=by,t;e;)(t=Fl-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Nf}function dR(){Fl=(Sy=Op.now())+Vv,Nf=Qh=0;try{xoe()}finally{Nf=0,Eoe(),Fl=0}}function woe(){var e=Op.now(),t=e-Sy;t>rI&&(Vv-=t,Sy=e)}function Eoe(){for(var e,t=by,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:by=n);Kh=e,a_(r)}function a_(e){if(!Nf){Qh&&(Qh=clearTimeout(Qh));var t=e-Fl;t>24?(e<1/0&&(Qh=setTimeout(dR,e-Op.now()-Vv)),bh&&(bh=clearInterval(bh))):(bh||(Sy=Op.now(),bh=setInterval(woe,rI)),Nf=1,iI(dR))}}function boe(e,t,n){var r=new _y,i=t;return t==null?(r.restart(e,t,n),r):(r._restart=r.restart,r.restart=function(o,s,a){s=+s,a=a==null?d$():+a,r._restart(function u(c){c+=i,r._restart(u,i+=s,a),o(c)},s,a)},r.restart(e,t,n),r)}const Soe=1664525,_oe=1013904223,hR=4294967296;function Aoe(){let e=1;return()=>(e=(Soe*e+_oe)%hR)/hR}function Coe(e){return e.x}function koe(e){return e.y}var $oe=10,Foe=Math.PI*(3-Math.sqrt(5));function Doe(e){var t,n=1,r=.001,i=1-Math.pow(r,1/300),o=0,s=.6,a=new Map,u=oI(h),c=nI("tick","end"),f=Aoe();e==null&&(e=[]);function h(){p(),c.call("tick",t),n<r&&(u.stop(),c.call("end",t))}function p(v){var w,E=e.length,S;v===void 0&&(v=1);for(var A=0;A<v;++A)for(n+=(o-n)*i,a.forEach(function(C){C(n)}),w=0;w<E;++w)S=e[w],S.fx==null?S.x+=S.vx*=s:(S.x=S.fx,S.vx=0),S.fy==null?S.y+=S.vy*=s:(S.y=S.fy,S.vy=0);return t}function m(){for(var v=0,w=e.length,E;v<w;++v){if(E=e[v],E.index=v,E.fx!=null&&(E.x=E.fx),E.fy!=null&&(E.y=E.fy),isNaN(E.x)||isNaN(E.y)){var S=$oe*Math.sqrt(.5+v),A=v*Foe;E.x=S*Math.cos(A),E.y=S*Math.sin(A)}(isNaN(E.vx)||isNaN(E.vy))&&(E.vx=E.vy=0)}}function y(v){return v.initialize&&v.initialize(e,f),v}return m(),t={tick:p,restart:function(){return u.restart(h),t},stop:function(){return u.stop(),t},nodes:function(v){return arguments.length?(e=v,m(),a.forEach(y),t):e},alpha:function(v){return arguments.length?(n=+v,t):n},alphaMin:function(v){return arguments.length?(r=+v,t):r},alphaDecay:function(v){return arguments.length?(i=+v,t):+i},alphaTarget:function(v){return arguments.length?(o=+v,t):o},velocityDecay:function(v){return arguments.length?(s=1-v,t):1-s},randomSource:function(v){return arguments.length?(f=v,a.forEach(y),t):f},force:function(v,w){return arguments.length>1?(w==null?a.delete(v):a.set(v,y(w)),t):a.get(v)},find:function(v,w,E){var S=0,A=e.length,C,k,D,$,M;for(E==null?E=1/0:E*=E,S=0;S<A;++S)$=e[S],C=v-$.x,k=w-$.y,D=C*C+k*k,D<E&&(M=$,E=D);return M},on:function(v,w){return arguments.length>1?(c.on(v,w),t):c.on(v)}}}function Moe(){var e,t,n,r,i=hr(-30),o,s=1,a=1/0,u=.81;function c(m){var y,v=e.length,w=c$(e,Coe,koe).visitAfter(h);for(r=m,y=0;y<v;++y)t=e[y],w.visit(p)}function f(){if(e){var m,y=e.length,v;for(o=new Array(y),m=0;m<y;++m)v=e[m],o[v.index]=+i(v,m,e)}}function h(m){var y=0,v,w,E=0,S,A,C;if(m.length){for(S=A=C=0;C<4;++C)(v=m[C])&&(w=Math.abs(v.value))&&(y+=v.value,E+=w,S+=w*v.x,A+=w*v.y);m.x=S/E,m.y=A/E}else{v=m,v.x=v.data.x,v.y=v.data.y;do y+=o[v.data.index];while(v=v.next)}m.value=y}function p(m,y,v,w){if(!m.value)return!0;var E=m.x-t.x,S=m.y-t.y,A=w-y,C=E*E+S*S;if(A*A/u<C)return C<a&&(E===0&&(E=Wa(n),C+=E*E),S===0&&(S=Wa(n),C+=S*S),C<s&&(C=Math.sqrt(s*C)),t.vx+=E*m.value*r/C,t.vy+=S*m.value*r/C),!0;if(m.length||C>=a)return;(m.data!==t||m.next)&&(E===0&&(E=Wa(n),C+=E*E),S===0&&(S=Wa(n),C+=S*S),C<s&&(C=Math.sqrt(s*C)));do m.data!==t&&(A=o[m.data.index]*r/C,t.vx+=E*A,t.vy+=S*A);while(m=m.next)}return c.initialize=function(m,y){e=m,n=y,f()},c.strength=function(m){return arguments.length?(i=typeof m=="function"?m:hr(+m),f(),c):i},c.distanceMin=function(m){return arguments.length?(s=m*m,c):Math.sqrt(s)},c.distanceMax=function(m){return arguments.length?(a=m*m,c):Math.sqrt(a)},c.theta=function(m){return arguments.length?(u=m*m,c):Math.sqrt(u)},c}function Toe(e){var t=hr(.1),n,r,i;typeof e!="function"&&(e=hr(e==null?0:+e));function o(a){for(var u=0,c=n.length,f;u<c;++u)f=n[u],f.vx+=(i[u]-f.x)*r[u]*a}function s(){if(n){var a,u=n.length;for(r=new Array(u),i=new Array(u),a=0;a<u;++a)r[a]=isNaN(i[a]=+e(n[a],a,n))?0:+t(n[a],a,n)}}return o.initialize=function(a){n=a,s()},o.strength=function(a){return arguments.length?(t=typeof a=="function"?a:hr(+a),s(),o):t},o.x=function(a){return arguments.length?(e=typeof a=="function"?a:hr(+a),s(),o):e},o}function Noe(e){var t=hr(.1),n,r,i;typeof e!="function"&&(e=hr(e==null?0:+e));function o(a){for(var u=0,c=n.length,f;u<c;++u)f=n[u],f.vy+=(i[u]-f.y)*r[u]*a}function s(){if(n){var a,u=n.length;for(r=new Array(u),i=new Array(u),a=0;a<u;++a)r[a]=isNaN(i[a]=+e(n[a],a,n))?0:+t(n[a],a,n)}}return o.initialize=function(a){n=a,s()},o.strength=function(a){return arguments.length?(t=typeof a=="function"?a:hr(+a),s(),o):t},o.y=function(a){return arguments.length?(e=typeof a=="function"?a:hr(+a),s(),o):e},o}const pR={center:Vie,collide:doe,nbody:Moe,link:poe,x:Toe,y:Noe},Jh="forces",u_=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],Roe=["static","iterations"],sI=["x","y","vx","vy"];function h$(e){J.call(this,null,e)}h$.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30,expr:!0},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:sI}]};pe(h$,J,{transform(e,t){var n=this.value,r=t.changed(t.ADD_REM),i=e.modified(u_),o=e.iterations||300;if(n?(r&&(t.modifies("index"),n.nodes(t.source)),(i||t.changed(t.MOD))&&aI(n,e,0,t)):(this.value=n=Poe(t.source,e),n.on("tick",Ooe(t.dataflow,this)),e.static||(r=!0,n.tick()),t.modifies("index")),i||r||e.modified(Roe)||t.changed()&&e.restart){if(n.alpha(Math.max(n.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(n.alphaMin(),1/o)),e.static)for(n.stop();--o>=0;)n.tick();else if(n.stopped()&&n.restart(),!r)return t.StopPropagation}return this.finish(e,t)},finish(e,t){const n=t.dataflow;for(let a=this._argops,u=0,c=a.length,f;u<c;++u)if(f=a[u],!(f.name!==Jh||f.op._argval.force!=="link")){for(var r=f.op._argops,i=0,o=r.length,s;i<o;++i)if(r[i].name==="links"&&(s=r[i].op.source)){n.pulse(s,n.changeset().reflow());break}}return t.reflow(e.modified()).modifies(sI)}});function Ooe(e,t){return()=>e.touch(t).run()}function Poe(e,t){const n=Doe(e),r=n.stop,i=n.restart;let o=!1;return n.stopped=()=>o,n.restart=()=>(o=!1,i()),n.stop=()=>(o=!0,r()),aI(n,t,!0).on("end",()=>o=!0)}function aI(e,t,n,r){var i=xe(t.forces),o,s,a,u;for(o=0,s=u_.length;o<s;++o)a=u_[o],a!==Jh&&t.modified(a)&&e[a](t[a]);for(o=0,s=i.length;o<s;++o)u=Jh+o,a=n||t.modified(Jh,o)?zoe(i[o]):r&&Loe(i[o],r)?e.force(u):null,a&&e.force(u,a);for(s=e.numForces||0;o<s;++o)e.force(Jh+o,null);return e.numForces=i.length,e}function Loe(e,t){var n,r;for(n in e)if(He(r=e[n])&&t.modified(Xn(r)))return 1;return 0}function zoe(e){var t,n;Ee(pR,e.force)||te("Unrecognized force: "+e.force),t=pR[e.force]();for(n in e)He(t[n])&&Ioe(t[n],e[n],e);return t}function Ioe(e,t,n){e(He(t)?r=>t(r,n):t)}const Boe=Object.freeze(Object.defineProperty({__proto__:null,force:h$},Symbol.toStringTag,{value:"Module"}));function Uoe(e,t){return e.parent===t.parent?1:2}function joe(e){return e.reduce(Woe,0)/e.length}function Woe(e,t){return e+t.x}function qoe(e){return 1+e.reduce(Hoe,0)}function Hoe(e,t){return Math.max(e,t.y)}function Goe(e){for(var t;t=e.children;)e=t[0];return e}function Voe(e){for(var t;t=e.children;)e=t[t.length-1];return e}function Yoe(){var e=Uoe,t=1,n=1,r=!1;function i(o){var s,a=0;o.eachAfter(function(p){var m=p.children;m?(p.x=joe(m),p.y=qoe(m)):(p.x=s?a+=e(p,s):0,p.y=0,s=p)});var u=Goe(o),c=Voe(o),f=u.x-e(u,c)/2,h=c.x+e(c,u)/2;return o.eachAfter(r?function(p){p.x=(p.x-o.x)*t,p.y=(o.y-p.y)*n}:function(p){p.x=(p.x-f)/(h-f)*t,p.y=(1-(o.y?p.y/o.y:1))*n})}return i.separation=function(o){return arguments.length?(e=o,i):e},i.size=function(o){return arguments.length?(r=!1,t=+o[0],n=+o[1],i):r?null:[t,n]},i.nodeSize=function(o){return arguments.length?(r=!0,t=+o[0],n=+o[1],i):r?[t,n]:null},i}function Xoe(e){var t=0,n=e.children,r=n&&n.length;if(!r)t=1;else for(;--r>=0;)t+=n[r].value;e.value=t}function Qoe(){return this.eachAfter(Xoe)}function Koe(e,t){let n=-1;for(const r of this)e.call(t,r,++n,this);return this}function Joe(e,t){for(var n=this,r=[n],i,o,s=-1;n=r.pop();)if(e.call(t,n,++s,this),i=n.children)for(o=i.length-1;o>=0;--o)r.push(i[o]);return this}function Zoe(e,t){for(var n=this,r=[n],i=[],o,s,a,u=-1;n=r.pop();)if(i.push(n),o=n.children)for(s=0,a=o.length;s<a;++s)r.push(o[s]);for(;n=i.pop();)e.call(t,n,++u,this);return this}function ese(e,t){let n=-1;for(const r of this)if(e.call(t,r,++n,this))return r}function tse(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,r=t.children,i=r&&r.length;--i>=0;)n+=r[i].value;t.value=n})}function nse(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function rse(e){for(var t=this,n=ise(t,e),r=[t];t!==n;)t=t.parent,r.push(t);for(var i=r.length;e!==n;)r.splice(i,0,e),e=e.parent;return r}function ise(e,t){if(e===t)return e;var n=e.ancestors(),r=t.ancestors(),i=null;for(e=n.pop(),t=r.pop();e===t;)i=e,e=n.pop(),t=r.pop();return i}function ose(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function sse(){return Array.from(this)}function ase(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function use(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t}function*lse(){var e=this,t,n=[e],r,i,o;do for(t=n.reverse(),n=[];e=t.pop();)if(yield e,r=e.children)for(i=0,o=r.length;i<o;++i)n.push(r[i]);while(n.length)}function p$(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=dse)):t===void 0&&(t=fse);for(var n=new Rf(e),r,i=[n],o,s,a,u;r=i.pop();)if((s=t(r.data))&&(u=(s=Array.from(s)).length))for(r.children=s,a=u-1;a>=0;--a)i.push(o=s[a]=new Rf(s[a])),o.parent=r,o.depth=r.depth+1;return n.eachBefore(uI)}function cse(){return p$(this).eachBefore(hse)}function fse(e){return e.children}function dse(e){return Array.isArray(e)?e[1]:null}function hse(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function uI(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function Rf(e){this.data=e,this.depth=this.height=0,this.parent=null}Rf.prototype=p$.prototype={constructor:Rf,count:Qoe,each:Koe,eachAfter:Zoe,eachBefore:Joe,find:ese,sum:tse,sort:nse,path:rse,ancestors:ose,descendants:sse,leaves:ase,links:use,copy:cse,[Symbol.iterator]:lse};function o1(e){return e==null?null:lI(e)}function lI(e){if(typeof e!="function")throw new Error;return e}function al(){return 0}function Xc(e){return function(){return e}}const pse=1664525,gse=1013904223,gR=4294967296;function mse(){let e=1;return()=>(e=(pse*e+gse)%gR)/gR}function yse(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function vse(e,t){let n=e.length,r,i;for(;n;)i=t()*n--|0,r=e[n],e[n]=e[i],e[i]=r;return e}function xse(e,t){for(var n=0,r=(e=vse(Array.from(e),t)).length,i=[],o,s;n<r;)o=e[n],s&&cI(s,o)?++n:(s=Ese(i=wse(i,o)),n=0);return s}function wse(e,t){var n,r;if(zE(t,e))return[t];for(n=0;n<e.length;++n)if(_m(t,e[n])&&zE(Zh(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(r=n+1;r<e.length;++r)if(_m(Zh(e[n],e[r]),t)&&_m(Zh(e[n],t),e[r])&&_m(Zh(e[r],t),e[n])&&zE(fI(e[n],e[r],t),e))return[e[n],e[r],t];throw new Error}function _m(e,t){var n=e.r-t.r,r=t.x-e.x,i=t.y-e.y;return n<0||n*n<r*r+i*i}function cI(e,t){var n=e.r-t.r+Math.max(e.r,t.r,1)*1e-9,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function zE(e,t){for(var n=0;n<t.length;++n)if(!cI(e,t[n]))return!1;return!0}function Ese(e){switch(e.length){case 1:return bse(e[0]);case 2:return Zh(e[0],e[1]);case 3:return fI(e[0],e[1],e[2])}}function bse(e){return{x:e.x,y:e.y,r:e.r}}function Zh(e,t){var n=e.x,r=e.y,i=e.r,o=t.x,s=t.y,a=t.r,u=o-n,c=s-r,f=a-i,h=Math.sqrt(u*u+c*c);return{x:(n+o+u/h*f)/2,y:(r+s+c/h*f)/2,r:(h+i+a)/2}}function fI(e,t,n){var r=e.x,i=e.y,o=e.r,s=t.x,a=t.y,u=t.r,c=n.x,f=n.y,h=n.r,p=r-s,m=r-c,y=i-a,v=i-f,w=u-o,E=h-o,S=r*r+i*i-o*o,A=S-s*s-a*a+u*u,C=S-c*c-f*f+h*h,k=m*y-p*v,D=(y*C-v*A)/(k*2)-r,$=(v*w-y*E)/k,M=(m*A-p*C)/(k*2)-i,T=(p*E-m*w)/k,L=$*$+T*T-1,O=2*(o+D*$+M*T),X=D*D+M*M-o*o,W=-(Math.abs(L)>1e-6?(O+Math.sqrt(O*O-4*L*X))/(2*L):X/O);return{x:r+D+$*W,y:i+M+T*W,r:W}}function mR(e,t,n){var r=e.x-t.x,i,o,s=e.y-t.y,a,u,c=r*r+s*s;c?(o=t.r+n.r,o*=o,u=e.r+n.r,u*=u,o>u?(i=(c+u-o)/(2*c),a=Math.sqrt(Math.max(0,u/c-i*i)),n.x=e.x-i*r-a*s,n.y=e.y-i*s+a*r):(i=(c+o-u)/(2*c),a=Math.sqrt(Math.max(0,o/c-i*i)),n.x=t.x+i*r-a*s,n.y=t.y+i*s+a*r)):(n.x=t.x+n.r,n.y=t.y)}function yR(e,t){var n=e.r+t.r-1e-6,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function vR(e){var t=e._,n=e.next._,r=t.r+n.r,i=(t.x*n.r+n.x*t.r)/r,o=(t.y*n.r+n.y*t.r)/r;return i*i+o*o}function Am(e){this._=e,this.next=null,this.previous=null}function Sse(e,t){if(!(o=(e=yse(e)).length))return 0;var n,r,i,o,s,a,u,c,f,h,p;if(n=e[0],n.x=0,n.y=0,!(o>1))return n.r;if(r=e[1],n.x=-r.r,r.x=n.r,r.y=0,!(o>2))return n.r+r.r;mR(r,n,i=e[2]),n=new Am(n),r=new Am(r),i=new Am(i),n.next=i.previous=r,r.next=n.previous=i,i.next=r.previous=n;e:for(u=3;u<o;++u){mR(n._,r._,i=e[u]),i=new Am(i),c=r.next,f=n.previous,h=r._.r,p=n._.r;do if(h<=p){if(yR(c._,i._)){r=c,n.next=r,r.previous=n,--u;continue e}h+=c._.r,c=c.next}else{if(yR(f._,i._)){n=f,n.next=r,r.previous=n,--u;continue e}p+=f._.r,f=f.previous}while(c!==f.next);for(i.previous=n,i.next=r,n.next=r.previous=r=i,s=vR(n);(i=i.next)!==r;)(a=vR(i))<s&&(n=i,s=a);r=n.next}for(n=[r._],i=r;(i=i.next)!==r;)n.push(i._);for(i=xse(n,t),u=0;u<o;++u)n=e[u],n.x-=i.x,n.y-=i.y;return i.r}function _se(e){return Math.sqrt(e.value)}function Ase(){var e=null,t=1,n=1,r=al;function i(o){const s=mse();return o.x=t/2,o.y=n/2,e?o.eachBefore(xR(e)).eachAfter(IE(r,.5,s)).eachBefore(wR(1)):o.eachBefore(xR(_se)).eachAfter(IE(al,1,s)).eachAfter(IE(r,o.r/Math.min(t,n),s)).eachBefore(wR(Math.min(t,n)/(2*o.r))),o}return i.radius=function(o){return arguments.length?(e=o1(o),i):e},i.size=function(o){return arguments.length?(t=+o[0],n=+o[1],i):[t,n]},i.padding=function(o){return arguments.length?(r=typeof o=="function"?o:Xc(+o),i):r},i}function xR(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function IE(e,t,n){return function(r){if(i=r.children){var i,o,s=i.length,a=e(r)*t||0,u;if(a)for(o=0;o<s;++o)i[o].r+=a;if(u=Sse(i,n),a)for(o=0;o<s;++o)i[o].r-=a;r.r=u+a}}}function wR(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}function dI(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function Sg(e,t,n,r,i){for(var o=e.children,s,a=-1,u=o.length,c=e.value&&(r-t)/e.value;++a<u;)s=o[a],s.y0=n,s.y1=i,s.x0=t,s.x1=t+=s.value*c}function Cse(){var e=1,t=1,n=0,r=!1;function i(s){var a=s.height+1;return s.x0=s.y0=n,s.x1=e,s.y1=t/a,s.eachBefore(o(t,a)),r&&s.eachBefore(dI),s}function o(s,a){return function(u){u.children&&Sg(u,u.x0,s*(u.depth+1)/a,u.x1,s*(u.depth+2)/a);var c=u.x0,f=u.y0,h=u.x1-n,p=u.y1-n;h<c&&(c=h=(c+h)/2),p<f&&(f=p=(f+p)/2),u.x0=c,u.y0=f,u.x1=h,u.y1=p}}return i.round=function(s){return arguments.length?(r=!!s,i):r},i.size=function(s){return arguments.length?(e=+s[0],t=+s[1],i):[e,t]},i.padding=function(s){return arguments.length?(n=+s,i):n},i}var kse={depth:-1},ER={},BE={};function $se(e){return e.id}function Fse(e){return e.parentId}function bR(){var e=$se,t=Fse,n;function r(i){var o=Array.from(i),s=e,a=t,u,c,f,h,p,m,y,v,w=new Map;if(n!=null){const E=o.map((C,k)=>Dse(n(C,k,i))),S=E.map(SR),A=new Set(E).add("");for(const C of S)A.has(C)||(A.add(C),E.push(C),S.push(SR(C)),o.push(BE));s=(C,k)=>E[k],a=(C,k)=>S[k]}for(f=0,u=o.length;f<u;++f)c=o[f],m=o[f]=new Rf(c),(y=s(c,f,i))!=null&&(y+="")&&(v=m.id=y,w.set(v,w.has(v)?ER:m)),(y=a(c,f,i))!=null&&(y+="")&&(m.parent=y);for(f=0;f<u;++f)if(m=o[f],y=m.parent){if(p=w.get(y),!p)throw new Error("missing: "+y);if(p===ER)throw new Error("ambiguous: "+y);p.children?p.children.push(m):p.children=[m],m.parent=p}else{if(h)throw new Error("multiple roots");h=m}if(!h)throw new Error("no root");if(n!=null){for(;h.data===BE&&h.children.length===1;)h=h.children[0],--u;for(let E=o.length-1;E>=0&&(m=o[E],m.data===BE);--E)m.data=null}if(h.parent=kse,h.eachBefore(function(E){E.depth=E.parent.depth+1,--u}).eachBefore(uI),h.parent=null,u>0)throw new Error("cycle");return h}return r.id=function(i){return arguments.length?(e=o1(i),r):e},r.parentId=function(i){return arguments.length?(t=o1(i),r):t},r.path=function(i){return arguments.length?(n=o1(i),r):n},r}function Dse(e){e=`${e}`;let t=e.length;return l_(e,t-1)&&!l_(e,t-2)&&(e=e.slice(0,-1)),e[0]==="/"?e:`/${e}`}function SR(e){let t=e.length;if(t<2)return"";for(;--t>1&&!l_(e,t););return e.slice(0,t)}function l_(e,t){if(e[t]==="/"){let n=0;for(;t>0&&e[--t]==="\\";)++n;if((n&1)===0)return!0}return!1}function Mse(e,t){return e.parent===t.parent?1:2}function UE(e){var t=e.children;return t?t[0]:e.t}function jE(e){var t=e.children;return t?t[t.length-1]:e.t}function Tse(e,t,n){var r=n/(t.i-e.i);t.c-=r,t.s+=n,e.c+=r,t.z+=n,t.m+=n}function Nse(e){for(var t=0,n=0,r=e.children,i=r.length,o;--i>=0;)o=r[i],o.z+=t,o.m+=t,t+=o.s+(n+=o.c)}function Rse(e,t,n){return e.a.parent===t.parent?e.a:n}function s1(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}s1.prototype=Object.create(Rf.prototype);function Ose(e){for(var t=new s1(e,0),n,r=[t],i,o,s,a;n=r.pop();)if(o=n._.children)for(n.children=new Array(a=o.length),s=a-1;s>=0;--s)r.push(i=n.children[s]=new s1(o[s],s)),i.parent=n;return(t.parent=new s1(null,0)).children=[t],t}function Pse(){var e=Mse,t=1,n=1,r=null;function i(c){var f=Ose(c);if(f.eachAfter(o),f.parent.m=-f.z,f.eachBefore(s),r)c.eachBefore(u);else{var h=c,p=c,m=c;c.eachBefore(function(S){S.x<h.x&&(h=S),S.x>p.x&&(p=S),S.depth>m.depth&&(m=S)});var y=h===p?1:e(h,p)/2,v=y-h.x,w=t/(p.x+y+v),E=n/(m.depth||1);c.eachBefore(function(S){S.x=(S.x+v)*w,S.y=S.depth*E})}return c}function o(c){var f=c.children,h=c.parent.children,p=c.i?h[c.i-1]:null;if(f){Nse(c);var m=(f[0].z+f[f.length-1].z)/2;p?(c.z=p.z+e(c._,p._),c.m=c.z-m):c.z=m}else p&&(c.z=p.z+e(c._,p._));c.parent.A=a(c,p,c.parent.A||h[0])}function s(c){c._.x=c.z+c.parent.m,c.m+=c.parent.m}function a(c,f,h){if(f){for(var p=c,m=c,y=f,v=p.parent.children[0],w=p.m,E=m.m,S=y.m,A=v.m,C;y=jE(y),p=UE(p),y&&p;)v=UE(v),m=jE(m),m.a=c,C=y.z+S-p.z-w+e(y._,p._),C>0&&(Tse(Rse(y,c,h),c,C),w+=C,E+=C),S+=y.m,w+=p.m,A+=v.m,E+=m.m;y&&!jE(m)&&(m.t=y,m.m+=S-E),p&&!UE(v)&&(v.t=p,v.m+=w-A,h=c)}return h}function u(c){c.x*=t,c.y=c.depth*n}return i.separation=function(c){return arguments.length?(e=c,i):e},i.size=function(c){return arguments.length?(r=!1,t=+c[0],n=+c[1],i):r?null:[t,n]},i.nodeSize=function(c){return arguments.length?(r=!0,t=+c[0],n=+c[1],i):r?[t,n]:null},i}function Yv(e,t,n,r,i){for(var o=e.children,s,a=-1,u=o.length,c=e.value&&(i-n)/e.value;++a<u;)s=o[a],s.x0=t,s.x1=r,s.y0=n,s.y1=n+=s.value*c}var hI=(1+Math.sqrt(5))/2;function pI(e,t,n,r,i,o){for(var s=[],a=t.children,u,c,f=0,h=0,p=a.length,m,y,v=t.value,w,E,S,A,C,k,D;f<p;){m=i-n,y=o-r;do w=a[h++].value;while(!w&&h<p);for(E=S=w,k=Math.max(y/m,m/y)/(v*e),D=w*w*k,C=Math.max(S/D,D/E);h<p;++h){if(w+=c=a[h].value,c<E&&(E=c),c>S&&(S=c),D=w*w*k,A=Math.max(S/D,D/E),A>C){w-=c;break}C=A}s.push(u={value:w,dice:m<y,children:a.slice(f,h)}),u.dice?Sg(u,n,r,i,v?r+=y*w/v:o):Yv(u,n,r,v?n+=m*w/v:i,o),v-=w,f=h}return s}const gI=(function e(t){function n(r,i,o,s,a){pI(t,r,i,o,s,a)}return n.ratio=function(r){return e((r=+r)>1?r:1)},n})(hI);function Lse(){var e=gI,t=!1,n=1,r=1,i=[0],o=al,s=al,a=al,u=al,c=al;function f(p){return p.x0=p.y0=0,p.x1=n,p.y1=r,p.eachBefore(h),i=[0],t&&p.eachBefore(dI),p}function h(p){var m=i[p.depth],y=p.x0+m,v=p.y0+m,w=p.x1-m,E=p.y1-m;w<y&&(y=w=(y+w)/2),E<v&&(v=E=(v+E)/2),p.x0=y,p.y0=v,p.x1=w,p.y1=E,p.children&&(m=i[p.depth+1]=o(p)/2,y+=c(p)-m,v+=s(p)-m,w-=a(p)-m,E-=u(p)-m,w<y&&(y=w=(y+w)/2),E<v&&(v=E=(v+E)/2),e(p,y,v,w,E))}return f.round=function(p){return arguments.length?(t=!!p,f):t},f.size=function(p){return arguments.length?(n=+p[0],r=+p[1],f):[n,r]},f.tile=function(p){return arguments.length?(e=lI(p),f):e},f.padding=function(p){return arguments.length?f.paddingInner(p).paddingOuter(p):f.paddingInner()},f.paddingInner=function(p){return arguments.length?(o=typeof p=="function"?p:Xc(+p),f):o},f.paddingOuter=function(p){return arguments.length?f.paddingTop(p).paddingRight(p).paddingBottom(p).paddingLeft(p):f.paddingTop()},f.paddingTop=function(p){return arguments.length?(s=typeof p=="function"?p:Xc(+p),f):s},f.paddingRight=function(p){return arguments.length?(a=typeof p=="function"?p:Xc(+p),f):a},f.paddingBottom=function(p){return arguments.length?(u=typeof p=="function"?p:Xc(+p),f):u},f.paddingLeft=function(p){return arguments.length?(c=typeof p=="function"?p:Xc(+p),f):c},f}function zse(e,t,n,r,i){var o=e.children,s,a=o.length,u,c=new Array(a+1);for(c[0]=u=s=0;s<a;++s)c[s+1]=u+=o[s].value;f(0,a,e.value,t,n,r,i);function f(h,p,m,y,v,w,E){if(h>=p-1){var S=o[h];S.x0=y,S.y0=v,S.x1=w,S.y1=E;return}for(var A=c[h],C=m/2+A,k=h+1,D=p-1;k<D;){var $=k+D>>>1;c[$]<C?k=$+1:D=$}C-c[k-1]<c[k]-C&&h+1<k&&--k;var M=c[k]-A,T=m-M;if(w-y>E-v){var L=m?(y*T+w*M)/m:w;f(h,k,M,y,v,L,E),f(k,p,T,L,v,w,E)}else{var O=m?(v*T+E*M)/m:E;f(h,k,M,y,v,w,O),f(k,p,T,y,O,w,E)}}}function Ise(e,t,n,r,i){(e.depth&1?Yv:Sg)(e,t,n,r,i)}const Bse=(function e(t){function n(r,i,o,s,a){if((u=r._squarify)&&u.ratio===t)for(var u,c,f,h,p=-1,m,y=u.length,v=r.value;++p<y;){for(c=u[p],f=c.children,h=c.value=0,m=f.length;h<m;++h)c.value+=f[h].value;c.dice?Sg(c,i,o,s,v?o+=(a-o)*c.value/v:a):Yv(c,i,o,v?i+=(s-i)*c.value/v:s,a),v-=c.value}else r._squarify=u=pI(t,r,i,o,s,a),u.ratio=t}return n.ratio=function(r){return e((r=+r)>1?r:1)},n})(hI);function c_(e,t,n){const r={};return e.each(i=>{const o=i.data;n(o)&&(r[t(o)]=i)}),e.lookup=r,e}function g$(e){J.call(this,null,e)}g$.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const Use=e=>e.values;pe(g$,J,{transform(e,t){t.source||te("Nest transform requires an upstream data source.");var n=e.generate,r=e.modified(),i=t.clone(),o=this.value;return(!o||r||t.changed())&&(o&&o.each(s=>{s.children&&uv(s.data)&&i.rem.push(s.data)}),this.value=o=p$({values:xe(e.keys).reduce((s,a)=>(s.key(a),s),jse()).entries(i.source)},Use),n&&o.each(s=>{s.children&&(s=ct(s.data),i.add.push(s),i.source.push(s))}),c_(o,Te,Te)),i.source.root=o,i}});function jse(){const e=[],t={entries:i=>r(n(i,0),0),key:i=>(e.push(i),t)};function n(i,o){if(o>=e.length)return i;const s=i.length,a=e[o++],u={},c={};let f=-1,h,p,m;for(;++f<s;)h=a(p=i[f])+"",(m=u[h])?m.push(p):u[h]=[p];for(h in u)c[h]=n(u[h],o);return c}function r(i,o){if(++o>e.length)return i;const s=[];for(const a in i)s.push({key:a,values:r(i[a],o)});return s}return t}function ea(e){J.call(this,null,e)}const Wse=(e,t)=>e.parent===t.parent?1:2;pe(ea,J,{transform(e,t){(!t.source||!t.source.root)&&te(this.constructor.name+" transform requires a backing tree data source.");const n=this.layout(e.method),r=this.fields,i=t.source.root,o=e.as||r;e.field?i.sum(e.field):i.count(),e.sort&&i.sort(Yl(e.sort,s=>s.data)),qse(n,this.params,e),n.separation&&n.separation(e.separation!==!1?Wse:Kf);try{this.value=n(i)}catch(s){te(s)}return i.each(s=>Hse(s,r,o)),t.reflow(e.modified()).modifies(o).modifies("leaf")}});function qse(e,t,n){for(let r,i=0,o=t.length;i<o;++i)r=t[i],r in n&&e[r](n[r])}function Hse(e,t,n){const r=e.data,i=t.length-1;for(let o=0;o<i;++o)r[n[o]]=e[t[o]];r[n[i]]=e.children?e.children.length:0}const f_=["x","y","r","depth","children"];function m$(e){ea.call(this,e)}m$.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:f_.length,default:f_}]};pe(m$,ea,{layout:Ase,params:["radius","size","padding"],fields:f_});const d_=["x0","y0","x1","y1","depth","children"];function y$(e){ea.call(this,e)}y$.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:d_.length,default:d_}]};pe(y$,ea,{layout:Cse,params:["size","round","padding"],fields:d_});function v$(e){J.call(this,null,e)}v$.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]};pe(v$,J,{transform(e,t){t.source||te("Stratify transform requires an upstream data source.");let n=this.value;const r=e.modified(),i=t.fork(t.ALL).materialize(t.SOURCE),o=!n||r||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);return i.source=i.source.slice(),o&&(n=i.source.length?c_(bR().id(e.key).parentId(e.parentKey)(i.source),e.key,$i):c_(bR()([{}]),e.key,e.key)),i.source.root=this.value=n,i}});const _R={tidy:Pse,cluster:Yoe},h_=["x","y","depth","children"];function x$(e){ea.call(this,e)}x$.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:h_.length,default:h_}]};pe(x$,ea,{layout(e){const t=e||"tidy";if(Ee(_R,t))return _R[t]();te("Unrecognized Tree layout method: "+t)},params:["size","nodeSize"],fields:h_});function w$(e){J.call(this,[],e)}w$.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]};pe(w$,J,{transform(e,t){const n=this.value,r=t.source&&t.source.root,i=t.fork(t.NO_SOURCE),o={};return r||te("TreeLinks transform requires a tree data source."),t.changed(t.ADD_REM)?(i.rem=n,t.visit(t.SOURCE,s=>o[Te(s)]=1),r.each(s=>{const a=s.data,u=s.parent&&s.parent.data;u&&o[Te(a)]&&o[Te(u)]&&i.add.push(ct({source:u,target:a}))}),this.value=i.add):t.changed(t.MOD)&&(t.visit(t.MOD,s=>o[Te(s)]=1),n.forEach(s=>{(o[Te(s.source)]||o[Te(s.target)])&&i.mod.push(s)})),i}});const AR={binary:zse,dice:Sg,slice:Yv,slicedice:Ise,squarify:gI,resquarify:Bse},p_=["x0","y0","x1","y1","depth","children"];function E$(e){ea.call(this,e)}E$.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:p_.length,default:p_}]};pe(E$,ea,{layout(){const e=Lse();return e.ratio=t=>{const n=e.tile();n.ratio&&e.tile(n.ratio(t))},e.method=t=>{Ee(AR,t)?e.tile(AR[t]):te("Unrecognized Treemap layout method: "+t)},e},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:p_});const Gse=Object.freeze(Object.defineProperty({__proto__:null,nest:g$,pack:m$,partition:y$,stratify:v$,tree:x$,treelinks:w$,treemap:E$},Symbol.toStringTag,{value:"Module"})),WE=4278190080;function Vse(e,t){const n=e.bitmap();return(t||[]).forEach(r=>n.set(e(r.boundary[0]),e(r.boundary[3]))),[n,void 0]}function Yse(e,t,n,r,i){const o=e.width,s=e.height,a=r||i,u=Xa(o,s).getContext("2d"),c=Xa(o,s).getContext("2d"),f=a&&Xa(o,s).getContext("2d");n.forEach(M=>a1(u,M,!1)),a1(c,t,!1),a&&a1(f,t,!0);const h=qE(u,o,s),p=qE(c,o,s),m=a&&qE(f,o,s),y=e.bitmap(),v=a&&e.bitmap();let w,E,S,A,C,k,D,$;for(E=0;E<s;++E)for(w=0;w<o;++w)C=E*o+w,k=h[C]&WE,$=p[C]&WE,D=a&&m[C]&WE,(k||D||$)&&(S=e(w),A=e(E),!i&&(k||$)&&y.set(S,A),a&&(k||D)&&v.set(S,A));return[y,v]}function qE(e,t,n){return new Uint32Array(e.getImageData(0,0,t,n).data.buffer)}function a1(e,t,n){if(!t.length)return;const r=t[0].mark.marktype;r==="group"?t.forEach(i=>{i.items.forEach(o=>a1(e,o.items,n))}):ui[r].draw(e,{items:n?t.map(Xse):t})}function Xse(e){const t=lv(e,{});return t.stroke&&t.strokeOpacity!==0||t.fill&&t.fillOpacity!==0?{...t,strokeOpacity:1,stroke:"#000",fillOpacity:0}:t}const _s=5,or=31,Pp=32,Ra=new Uint32Array(Pp+1),Qi=new Uint32Array(Pp+1);Qi[0]=0;Ra[0]=~Qi[0];for(let e=1;e<=Pp;++e)Qi[e]=Qi[e-1]<<1|1,Ra[e]=~Qi[e];function Qse(e,t){const n=new Uint32Array(~~((e*t+Pp)/Pp));function r(o,s){n[o]|=s}function i(o,s){n[o]&=s}return{array:n,get:(o,s)=>{const a=s*e+o;return n[a>>>_s]&1<<(a&or)},set:(o,s)=>{const a=s*e+o;r(a>>>_s,1<<(a&or))},clear:(o,s)=>{const a=s*e+o;i(a>>>_s,~(1<<(a&or)))},getRange:(o,s,a,u)=>{let c=u,f,h,p,m;for(;c>=s;--c)if(f=c*e+o,h=c*e+a,p=f>>>_s,m=h>>>_s,p===m){if(n[p]&Ra[f&or]&Qi[(h&or)+1])return!0}else{if(n[p]&Ra[f&or]||n[m]&Qi[(h&or)+1])return!0;for(let y=p+1;y<m;++y)if(n[y])return!0}return!1},setRange:(o,s,a,u)=>{let c,f,h,p,m;for(;s<=u;++s)if(c=s*e+o,f=s*e+a,h=c>>>_s,p=f>>>_s,h===p)r(h,Ra[c&or]&Qi[(f&or)+1]);else for(r(h,Ra[c&or]),r(p,Qi[(f&or)+1]),m=h+1;m<p;++m)r(m,4294967295)},clearRange:(o,s,a,u)=>{let c,f,h,p,m;for(;s<=u;++s)if(c=s*e+o,f=s*e+a,h=c>>>_s,p=f>>>_s,h===p)i(h,Qi[c&or]|Ra[(f&or)+1]);else for(i(h,Qi[c&or]),i(p,Ra[(f&or)+1]),m=h+1;m<p;++m)i(m,0)},outOfBounds:(o,s,a,u)=>o<0||s<0||u>=t||a>=e}}function Kse(e,t,n){const r=Math.max(1,Math.sqrt(e*t/1e6)),i=~~((e+2*n+r)/r),o=~~((t+2*n+r)/r),s=a=>~~((a+n)/r);return s.invert=a=>a*r-n,s.bitmap=()=>Qse(i,o),s.ratio=r,s.padding=n,s.width=e,s.height=t,s}function Jse(e,t,n,r){const i=e.width,o=e.height;return function(s){const a=s.datum.datum.items[r].items,u=a.length,c=s.datum.fontSize,f=ri.width(s.datum,s.datum.text);let h=0,p,m,y,v,w,E,S;for(let A=0;A<u;++A)p=a[A].x,y=a[A].y,m=a[A].x2===void 0?p:a[A].x2,v=a[A].y2===void 0?y:a[A].y2,w=(p+m)/2,E=(y+v)/2,S=Math.abs(m-p+v-y),S>=h&&(h=S,s.x=w,s.y=E);return w=f/2,E=c/2,p=s.x-w,m=s.x+w,y=s.y-E,v=s.y+E,s.align="center",p<0&&m<=i?s.align="left":0<=p&&i<m&&(s.align="right"),s.baseline="middle",y<0&&v<=o?s.baseline="top":0<=y&&o<v&&(s.baseline="bottom"),!0}}function Ay(e,t,n,r,i,o){let s=n/2;return e-s<0||e+s>i||t-(s=r/2)<0||t+s>o}function qa(e,t,n,r,i,o,s,a){const u=i*o/(r*2),c=e(t-u),f=e(t+u),h=e(n-(o=o/2)),p=e(n+o);return s.outOfBounds(c,h,f,p)||s.getRange(c,h,f,p)||a&&a.getRange(c,h,f,p)}function Zse(e,t,n,r){const i=e.width,o=e.height,s=t[0],a=t[1];function u(c,f,h,p,m){const y=e.invert(c),v=e.invert(f);let w=h,E=o,S;if(!Ay(y,v,p,m,i,o)&&!qa(e,y,v,m,p,w,s,a)&&!qa(e,y,v,m,p,m,s,null)){for(;E-w>=1;)S=(w+E)/2,qa(e,y,v,m,p,S,s,a)?E=S:w=S;if(w>h)return[y,v,w,!0]}}return function(c){const f=c.datum.datum.items[r].items,h=f.length,p=c.datum.fontSize,m=ri.width(c.datum,c.datum.text);let y=n?p:0,v=!1,w=!1,E=0,S,A,C,k,D,$,M,T,L,O,X,W,I,N,U,Y,j;for(let q=0;q<h;++q){for(S=f[q].x,C=f[q].y,A=f[q].x2===void 0?S:f[q].x2,k=f[q].y2===void 0?C:f[q].y2,S>A&&(j=S,S=A,A=j),C>k&&(j=C,C=k,k=j),L=e(S),X=e(A),O=~~((L+X)/2),W=e(C),N=e(k),I=~~((W+N)/2),M=O;M>=L;--M)for(T=I;T>=W;--T)Y=u(M,T,y,m,p),Y&&([c.x,c.y,y,v]=Y);for(M=O;M<=X;++M)for(T=I;T<=N;++T)Y=u(M,T,y,m,p),Y&&([c.x,c.y,y,v]=Y);!v&&!n&&(U=Math.abs(A-S+k-C),D=(S+A)/2,$=(C+k)/2,U>=E&&!Ay(D,$,m,p,i,o)&&!qa(e,D,$,p,m,p,s,null)&&(E=U,c.x=D,c.y=$,w=!0))}return v||w?(D=m/2,$=p/2,s.setRange(e(c.x-D),e(c.y-$),e(c.x+D),e(c.y+$)),c.align="center",c.baseline="middle",!0):!1}}const eae=[-1,-1,1,1],tae=[-1,1,-1,1];function nae(e,t,n,r){const i=e.width,o=e.height,s=t[0],a=t[1],u=e.bitmap();return function(c){const f=c.datum.datum.items[r].items,h=f.length,p=c.datum.fontSize,m=ri.width(c.datum,c.datum.text),y=[];let v=n?p:0,w=!1,E=!1,S=0,A,C,k,D,$,M,T,L,O,X,W,I;for(let N=0;N<h;++N){for(A=f[N].x,k=f[N].y,C=f[N].x2===void 0?A:f[N].x2,D=f[N].y2===void 0?k:f[N].y2,y.push([e((A+C)/2),e((k+D)/2)]);y.length;)if([T,L]=y.pop(),!(s.get(T,L)||a.get(T,L)||u.get(T,L))){u.set(T,L);for(let U=0;U<4;++U)$=T+eae[U],M=L+tae[U],u.outOfBounds($,M,$,M)||y.push([$,M]);if($=e.invert(T),M=e.invert(L),O=v,X=o,!Ay($,M,m,p,i,o)&&!qa(e,$,M,p,m,O,s,a)&&!qa(e,$,M,p,m,p,s,null)){for(;X-O>=1;)W=(O+X)/2,qa(e,$,M,p,m,W,s,a)?X=W:O=W;O>v&&(c.x=$,c.y=M,v=O,w=!0)}}!w&&!n&&(I=Math.abs(C-A+D-k),$=(A+C)/2,M=(k+D)/2,I>=S&&!Ay($,M,m,p,i,o)&&!qa(e,$,M,p,m,p,s,null)&&(S=I,c.x=$,c.y=M,E=!0))}return w||E?($=m/2,M=p/2,s.setRange(e(c.x-$),e(c.y-M),e(c.x+$),e(c.y+M)),c.align="center",c.baseline="middle",!0):!1}}const rae=["right","center","left"],iae=["bottom","middle","top"];function oae(e,t,n,r){const i=e.width,o=e.height,s=t[0],a=t[1],u=r.length;return function(c){const f=c.boundary,h=c.datum.fontSize;if(f[2]<0||f[5]<0||f[0]>i||f[3]>o)return!1;let p=c.textWidth??0,m,y,v,w,E,S,A,C,k,D,$,M,T,L,O;for(let X=0;X<u;++X){if(m=(n[X]&3)-1,y=(n[X]>>>2&3)-1,v=m===0&&y===0||r[X]<0,w=m&&y?Math.SQRT1_2:1,E=r[X]<0?-1:1,S=f[1+m]+r[X]*m*w,$=f[4+y]+E*h*y/2+r[X]*y*w,C=$-h/2,k=$+h/2,M=e(S),L=e(C),O=e(k),!p)if(CR(M,M,L,O,s,a,S,S,C,k,f,v))p=ri.width(c.datum,c.datum.text);else continue;if(D=S+E*p*m/2,S=D-p/2,A=D+p/2,M=e(S),T=e(A),CR(M,T,L,O,s,a,S,A,C,k,f,v))return c.x=m?m*E<0?A:S:D,c.y=y?y*E<0?k:C:$,c.align=rae[m*E+1],c.baseline=iae[y*E+1],s.setRange(M,L,T,O),!0}return!1}}function CR(e,t,n,r,i,o,s,a,u,c,f,h){return!(i.outOfBounds(e,n,t,r)||(h&&o||i).getRange(e,n,t,r))}const HE=0,GE=4,VE=8,YE=0,XE=1,QE=2,sae={"top-left":HE+YE,top:HE+XE,"top-right":HE+QE,left:GE+YE,middle:GE+XE,right:GE+QE,"bottom-left":VE+YE,bottom:VE+XE,"bottom-right":VE+QE},aae={naive:Jse,"reduced-search":Zse,floodfill:nae};function uae(e,t,n,r,i,o,s,a,u,c,f){if(!e.length)return e;const h=Math.max(r.length,i.length),p=lae(r,h),m=cae(i,h),y=fae(e[0].datum),v=y==="group"&&e[0].datum.items[u].marktype,w=v==="area",E=dae(y,v,a,u),S=c===null||c===1/0,A=w&&f==="naive";let C=-1,k=-1;const D=e.map(L=>{const O=S?ri.width(L,L.text):void 0;return C=Math.max(C,O),k=Math.max(k,L.fontSize),{datum:L,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:E(L),textWidth:O}});c=c===null||c===1/0?Math.max(C,k)+Math.max(...r):c;const $=Kse(t[0],t[1],c);let M;if(!A){n&&D.sort((X,W)=>n(X.datum,W.datum));let L=!1;for(let X=0;X<m.length&&!L;++X)L=m[X]===5||p[X]<0;const O=(y&&s||w)&&e.map(X=>X.datum);M=o.length||O?Yse($,O||[],o,L,w):Vse($,s&&D)}const T=w?aae[f]($,M,s,u):oae($,M,m,p);return D.forEach(L=>L.opacity=+T(L)),D}function lae(e,t){const n=new Float64Array(t),r=e.length;for(let i=0;i<r;++i)n[i]=e[i]||0;for(let i=r;i<t;++i)n[i]=n[r-1];return n}function cae(e,t){const n=new Int8Array(t),r=e.length;for(let i=0;i<r;++i)n[i]|=sae[e[i]];for(let i=r;i<t;++i)n[i]=n[r-1];return n}function fae(e){return e&&e.mark&&e.mark.marktype}function dae(e,t,n,r){const i=o=>[o.x,o.x,o.x,o.y,o.y,o.y];return e?e==="line"||e==="area"?o=>i(o.datum):t==="line"?o=>{const s=o.datum.items[r].items;return i(s.length?s[n==="start"?0:s.length-1]:{x:NaN,y:NaN})}:o=>{const s=o.datum.bounds;return[s.x1,(s.x1+s.x2)/2,s.x2,s.y1,(s.y1+s.y2)/2,s.y2]}:i}const g_=["x","y","opacity","align","baseline"],mI=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function b$(e){J.call(this,null,e)}b$.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:mI},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0,null:!0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:g_.length,default:g_}]};pe(b$,J,{transform(e,t){function n(o){const s=e[o];return He(s)&&t.modified(s.fields)}const r=e.modified();if(!(r||t.changed(t.ADD_REM)||n("sort")))return;(!e.size||e.size.length!==2)&&te("Size parameter should be specified as a [width, height] array.");const i=e.as||g_;return uae(t.materialize(t.SOURCE).source||[],e.size,e.sort,xe(e.offset==null?1:e.offset),xe(e.anchor||mI),e.avoidMarks||[],e.avoidBaseMark!==!1,e.lineAnchor||"end",e.markIndex||0,e.padding===void 0?0:e.padding,e.method||"naive").forEach(o=>{const s=o.datum;s[i[0]]=o.x,s[i[1]]=o.y,s[i[2]]=o.opacity,s[i[3]]=o.align,s[i[4]]=o.baseline}),t.reflow(r).modifies(i)}});const hae=Object.freeze(Object.defineProperty({__proto__:null,label:b$},Symbol.toStringTag,{value:"Module"}));function yI(e,t){var n=[],r=function(f){return f(a)},i,o,s,a,u,c;if(t==null)n.push(e);else for(i={},o=0,s=e.length;o<s;++o)a=e[o],u=t.map(r),c=i[u],c||(i[u]=c=[],c.dims=u,n.push(c)),c.push(a);return n}function S$(e){J.call(this,null,e)}S$.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]};pe(S$,J,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=t.materialize(t.SOURCE).source,i=yI(r,e.groupby),o=(e.groupby||[]).map(Wt),s=o.length,a=e.as||[Wt(e.x),Wt(e.y)],u=[];i.forEach(c=>{_P(c,e.x,e.y,e.bandwidth||.3).forEach(f=>{const h={};for(let p=0;p<s;++p)h[o[p]]=c.dims[p];h[a[0]]=f[0],h[a[1]]=f[1],u.push(ct(h))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}});const m_={constant:iC,linear:oC,log:wP,exp:EP,pow:bP,quad:sC,poly:SP},pae=(e,t)=>e==="poly"?t:e==="quad"?2:1;function _$(e){J.call(this,null,e)}_$.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(m_)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]};pe(_$,J,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=t.materialize(t.SOURCE).source,i=yI(r,e.groupby),o=(e.groupby||[]).map(Wt),s=e.method||"linear",a=e.order==null?3:e.order,u=pae(s,a),c=e.as||[Wt(e.x),Wt(e.y)],f=m_[s],h=[];let p=e.extent;Ee(m_,s)||te("Invalid regression method: "+s),p!=null&&s==="log"&&p[0]<=0&&(t.dataflow.warn("Ignoring extent with values <= 0 for log regression."),p=null),i.forEach(m=>{if(m.length<=u){t.dataflow.warn("Skipping regression with more parameters than data points.");return}const v=f(m,e.x,e.y,a);if(e.params){h.push(ct({keys:m.dims,coef:v.coef,rSquared:v.rSquared}));return}const w=p||Ho(m,e.x),E=S=>{const A={};for(let C=0;C<o.length;++C)A[o[C]]=m.dims[C];A[c[0]]=S[0],A[c[1]]=S[1],h.push(ct(A))};s==="linear"||s==="constant"?w.forEach(S=>E([S,v.predict(S)])):mv(v.predict,w,25,200).forEach(E)}),this.value&&(n.rem=this.value),this.value=n.add=n.source=h}return n}});const gae=Object.freeze(Object.defineProperty({__proto__:null,loess:S$,regression:_$},Symbol.toStringTag,{value:"Module"})),Us=11102230246251565e-32,jn=134217729,mae=(3+8*Us)*Us;function KE(e,t,n,r,i){let o,s,a,u,c=t[0],f=r[0],h=0,p=0;f>c==f>-c?(o=c,c=t[++h]):(o=f,f=r[++p]);let m=0;if(h<e&&p<n)for(f>c==f>-c?(s=c+o,a=o-(s-c),c=t[++h]):(s=f+o,a=o-(s-f),f=r[++p]),o=s,a!==0&&(i[m++]=a);h<e&&p<n;)f>c==f>-c?(s=o+c,u=s-o,a=o-(s-u)+(c-u),c=t[++h]):(s=o+f,u=s-o,a=o-(s-u)+(f-u),f=r[++p]),o=s,a!==0&&(i[m++]=a);for(;h<e;)s=o+c,u=s-o,a=o-(s-u)+(c-u),c=t[++h],o=s,a!==0&&(i[m++]=a);for(;p<n;)s=o+f,u=s-o,a=o-(s-u)+(f-u),f=r[++p],o=s,a!==0&&(i[m++]=a);return(o!==0||m===0)&&(i[m++]=o),m}function yae(e,t){let n=t[0];for(let r=1;r<e;r++)n+=t[r];return n}function _g(e){return new Float64Array(e)}const vae=(3+16*Us)*Us,xae=(2+12*Us)*Us,wae=(9+64*Us)*Us*Us,jc=_g(4),kR=_g(8),$R=_g(12),FR=_g(16),sr=_g(4);function Eae(e,t,n,r,i,o,s){let a,u,c,f,h,p,m,y,v,w,E,S,A,C,k,D,$,M;const T=e-i,L=n-i,O=t-o,X=r-o;C=T*X,p=jn*T,m=p-(p-T),y=T-m,p=jn*X,v=p-(p-X),w=X-v,k=y*w-(C-m*v-y*v-m*w),D=O*L,p=jn*O,m=p-(p-O),y=O-m,p=jn*L,v=p-(p-L),w=L-v,$=y*w-(D-m*v-y*v-m*w),E=k-$,h=k-E,jc[0]=k-(E+h)+(h-$),S=C+E,h=S-C,A=C-(S-h)+(E-h),E=A-D,h=A-E,jc[1]=A-(E+h)+(h-D),M=S+E,h=M-S,jc[2]=S-(M-h)+(E-h),jc[3]=M;let W=yae(4,jc),I=xae*s;if(W>=I||-W>=I||(h=e-T,a=e-(T+h)+(h-i),h=n-L,c=n-(L+h)+(h-i),h=t-O,u=t-(O+h)+(h-o),h=r-X,f=r-(X+h)+(h-o),a===0&&u===0&&c===0&&f===0)||(I=wae*s+mae*Math.abs(W),W+=T*f+X*a-(O*c+L*u),W>=I||-W>=I))return W;C=a*X,p=jn*a,m=p-(p-a),y=a-m,p=jn*X,v=p-(p-X),w=X-v,k=y*w-(C-m*v-y*v-m*w),D=u*L,p=jn*u,m=p-(p-u),y=u-m,p=jn*L,v=p-(p-L),w=L-v,$=y*w-(D-m*v-y*v-m*w),E=k-$,h=k-E,sr[0]=k-(E+h)+(h-$),S=C+E,h=S-C,A=C-(S-h)+(E-h),E=A-D,h=A-E,sr[1]=A-(E+h)+(h-D),M=S+E,h=M-S,sr[2]=S-(M-h)+(E-h),sr[3]=M;const N=KE(4,jc,4,sr,kR);C=T*f,p=jn*T,m=p-(p-T),y=T-m,p=jn*f,v=p-(p-f),w=f-v,k=y*w-(C-m*v-y*v-m*w),D=O*c,p=jn*O,m=p-(p-O),y=O-m,p=jn*c,v=p-(p-c),w=c-v,$=y*w-(D-m*v-y*v-m*w),E=k-$,h=k-E,sr[0]=k-(E+h)+(h-$),S=C+E,h=S-C,A=C-(S-h)+(E-h),E=A-D,h=A-E,sr[1]=A-(E+h)+(h-D),M=S+E,h=M-S,sr[2]=S-(M-h)+(E-h),sr[3]=M;const U=KE(N,kR,4,sr,$R);C=a*f,p=jn*a,m=p-(p-a),y=a-m,p=jn*f,v=p-(p-f),w=f-v,k=y*w-(C-m*v-y*v-m*w),D=u*c,p=jn*u,m=p-(p-u),y=u-m,p=jn*c,v=p-(p-c),w=c-v,$=y*w-(D-m*v-y*v-m*w),E=k-$,h=k-E,sr[0]=k-(E+h)+(h-$),S=C+E,h=S-C,A=C-(S-h)+(E-h),E=A-D,h=A-E,sr[1]=A-(E+h)+(h-D),M=S+E,h=M-S,sr[2]=S-(M-h)+(E-h),sr[3]=M;const Y=KE(U,$R,4,sr,FR);return FR[Y-1]}function Cm(e,t,n,r,i,o){const s=(t-o)*(n-i),a=(e-i)*(r-o),u=s-a,c=Math.abs(s+a);return Math.abs(u)>=vae*c?u:-Eae(e,t,n,r,i,o,c)}const DR=Math.pow(2,-52),km=new Uint32Array(512);class Cy{static from(t,n=Cae,r=kae){const i=t.length,o=new Float64Array(i*2);for(let s=0;s<i;s++){const a=t[s];o[2*s]=n(a),o[2*s+1]=r(a)}return new Cy(o)}constructor(t){const n=t.length>>1;if(n>0&&typeof t[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=t;const r=Math.max(2*n-5,0);this._triangles=new Uint32Array(r*3),this._halfedges=new Int32Array(r*3),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}update(){const{coords:t,_hullPrev:n,_hullNext:r,_hullTri:i,_hullHash:o}=this,s=t.length>>1;let a=1/0,u=1/0,c=-1/0,f=-1/0;for(let T=0;T<s;T++){const L=t[2*T],O=t[2*T+1];L<a&&(a=L),O<u&&(u=O),L>c&&(c=L),O>f&&(f=O),this._ids[T]=T}const h=(a+c)/2,p=(u+f)/2;let m,y,v;for(let T=0,L=1/0;T<s;T++){const O=JE(h,p,t[2*T],t[2*T+1]);O<L&&(m=T,L=O)}const w=t[2*m],E=t[2*m+1];for(let T=0,L=1/0;T<s;T++){if(T===m)continue;const O=JE(w,E,t[2*T],t[2*T+1]);O<L&&O>0&&(y=T,L=O)}let S=t[2*y],A=t[2*y+1],C=1/0;for(let T=0;T<s;T++){if(T===m||T===y)continue;const L=_ae(w,E,S,A,t[2*T],t[2*T+1]);L<C&&(v=T,C=L)}let k=t[2*v],D=t[2*v+1];if(C===1/0){for(let O=0;O<s;O++)this._dists[O]=t[2*O]-t[0]||t[2*O+1]-t[1];nf(this._ids,this._dists,0,s-1);const T=new Uint32Array(s);let L=0;for(let O=0,X=-1/0;O<s;O++){const W=this._ids[O],I=this._dists[W];I>X&&(T[L++]=W,X=I)}this.hull=T.subarray(0,L),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(Cm(w,E,S,A,k,D)<0){const T=y,L=S,O=A;y=v,S=k,A=D,v=T,k=L,D=O}const $=Aae(w,E,S,A,k,D);this._cx=$.x,this._cy=$.y;for(let T=0;T<s;T++)this._dists[T]=JE(t[2*T],t[2*T+1],$.x,$.y);nf(this._ids,this._dists,0,s-1),this._hullStart=m;let M=3;r[m]=n[v]=y,r[y]=n[m]=v,r[v]=n[y]=m,i[m]=0,i[y]=1,i[v]=2,o.fill(-1),o[this._hashKey(w,E)]=m,o[this._hashKey(S,A)]=y,o[this._hashKey(k,D)]=v,this.trianglesLen=0,this._addTriangle(m,y,v,-1,-1,-1);for(let T=0,L,O;T<this._ids.length;T++){const X=this._ids[T],W=t[2*X],I=t[2*X+1];if(T>0&&Math.abs(W-L)<=DR&&Math.abs(I-O)<=DR||(L=W,O=I,X===m||X===y||X===v))continue;let N=0;for(let K=0,P=this._hashKey(W,I);K<this._hashSize&&(N=o[(P+K)%this._hashSize],!(N!==-1&&N!==r[N]));K++);N=n[N];let U=N,Y;for(;Y=r[U],Cm(W,I,t[2*U],t[2*U+1],t[2*Y],t[2*Y+1])>=0;)if(U=Y,U===N){U=-1;break}if(U===-1)continue;let j=this._addTriangle(U,X,r[U],-1,-1,i[U]);i[X]=this._legalize(j+2),i[U]=j,M++;let q=r[U];for(;Y=r[q],Cm(W,I,t[2*q],t[2*q+1],t[2*Y],t[2*Y+1])<0;)j=this._addTriangle(q,X,Y,i[X],-1,i[q]),i[X]=this._legalize(j+2),r[q]=q,M--,q=Y;if(U===N)for(;Y=n[U],Cm(W,I,t[2*Y],t[2*Y+1],t[2*U],t[2*U+1])<0;)j=this._addTriangle(Y,X,U,-1,i[U],i[Y]),this._legalize(j+2),i[Y]=j,r[U]=U,M--,U=Y;this._hullStart=n[X]=U,r[U]=n[q]=X,r[X]=q,o[this._hashKey(W,I)]=X,o[this._hashKey(t[2*U],t[2*U+1])]=U}this.hull=new Uint32Array(M);for(let T=0,L=this._hullStart;T<M;T++)this.hull[T]=L,L=r[L];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,n){return Math.floor(bae(t-this._cx,n-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:n,_halfedges:r,coords:i}=this;let o=0,s=0;for(;;){const a=r[t],u=t-t%3;if(s=u+(t+2)%3,a===-1){if(o===0)break;t=km[--o];continue}const c=a-a%3,f=u+(t+1)%3,h=c+(a+2)%3,p=n[s],m=n[t],y=n[f],v=n[h];if(Sae(i[2*p],i[2*p+1],i[2*m],i[2*m+1],i[2*y],i[2*y+1],i[2*v],i[2*v+1])){n[t]=v,n[a]=p;const E=r[h];if(E===-1){let A=this._hullStart;do{if(this._hullTri[A]===h){this._hullTri[A]=t;break}A=this._hullPrev[A]}while(A!==this._hullStart)}this._link(t,E),this._link(a,r[s]),this._link(s,h);const S=c+(a+1)%3;o<km.length&&(km[o++]=S)}else{if(o===0)break;t=km[--o]}}return s}_link(t,n){this._halfedges[t]=n,n!==-1&&(this._halfedges[n]=t)}_addTriangle(t,n,r,i,o,s){const a=this.trianglesLen;return this._triangles[a]=t,this._triangles[a+1]=n,this._triangles[a+2]=r,this._link(a,i),this._link(a+1,o),this._link(a+2,s),this.trianglesLen+=3,a}}function bae(e,t){const n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}function JE(e,t,n,r){const i=e-n,o=t-r;return i*i+o*o}function Sae(e,t,n,r,i,o,s,a){const u=e-s,c=t-a,f=n-s,h=r-a,p=i-s,m=o-a,y=u*u+c*c,v=f*f+h*h,w=p*p+m*m;return u*(h*w-v*m)-c*(f*w-v*p)+y*(f*m-h*p)<0}function _ae(e,t,n,r,i,o){const s=n-e,a=r-t,u=i-e,c=o-t,f=s*s+a*a,h=u*u+c*c,p=.5/(s*c-a*u),m=(c*f-a*h)*p,y=(s*h-u*f)*p;return m*m+y*y}function Aae(e,t,n,r,i,o){const s=n-e,a=r-t,u=i-e,c=o-t,f=s*s+a*a,h=u*u+c*c,p=.5/(s*c-a*u),m=e+(c*f-a*h)*p,y=t+(s*h-u*f)*p;return{x:m,y}}function nf(e,t,n,r){if(r-n<=20)for(let i=n+1;i<=r;i++){const o=e[i],s=t[o];let a=i-1;for(;a>=n&&t[e[a]]>s;)e[a+1]=e[a--];e[a+1]=o}else{const i=n+r>>1;let o=n+1,s=r;Sh(e,i,o),t[e[n]]>t[e[r]]&&Sh(e,n,r),t[e[o]]>t[e[r]]&&Sh(e,o,r),t[e[n]]>t[e[o]]&&Sh(e,n,o);const a=e[o],u=t[a];for(;;){do o++;while(t[e[o]]<u);do s--;while(t[e[s]]>u);if(s<o)break;Sh(e,o,s)}e[n+1]=e[s],e[s]=a,r-o+1>=s-n?(nf(e,t,o,r),nf(e,t,n,s-1)):(nf(e,t,n,s-1),nf(e,t,o,r))}}function Sh(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function Cae(e){return e[0]}function kae(e){return e[1]}const MR=1e-6;class fl{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,n){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,n){this._+=`L${this._x1=+t},${this._y1=+n}`}arc(t,n,r){t=+t,n=+n,r=+r;const i=t+r,o=n;if(r<0)throw new Error("negative radius");this._x1===null?this._+=`M${i},${o}`:(Math.abs(this._x1-i)>MR||Math.abs(this._y1-o)>MR)&&(this._+="L"+i+","+o),r&&(this._+=`A${r},${r},0,1,1,${t-r},${n}A${r},${r},0,1,1,${this._x1=i},${this._y1=o}`)}rect(t,n,r,i){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${+r}v${+i}h${-r}Z`}value(){return this._||null}}class y_{constructor(){this._=[]}moveTo(t,n){this._.push([t,n])}closePath(){this._.push(this._[0].slice())}lineTo(t,n){this._.push([t,n])}value(){return this._.length?this._:null}}let $ae=class{constructor(t,[n,r,i,o]=[0,0,960,500]){if(!((i=+i)>=(n=+n))||!((o=+o)>=(r=+r)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(t.points.length*2),this.vectors=new Float64Array(t.points.length*2),this.xmax=i,this.xmin=n,this.ymax=o,this.ymin=r,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:n,triangles:r},vectors:i}=this;let o,s;const a=this.circumcenters=this._circumcenters.subarray(0,r.length/3*2);for(let v=0,w=0,E=r.length,S,A;v<E;v+=3,w+=2){const C=r[v]*2,k=r[v+1]*2,D=r[v+2]*2,$=t[C],M=t[C+1],T=t[k],L=t[k+1],O=t[D],X=t[D+1],W=T-$,I=L-M,N=O-$,U=X-M,Y=(W*U-I*N)*2;if(Math.abs(Y)<1e-9){if(o===void 0){o=s=0;for(const q of n)o+=t[q*2],s+=t[q*2+1];o/=n.length,s/=n.length}const j=1e9*Math.sign((o-$)*U-(s-M)*N);S=($+O)/2-j*U,A=(M+X)/2+j*N}else{const j=1/Y,q=W*W+I*I,K=N*N+U*U;S=$+(U*q-I*K)*j,A=M+(W*K-N*q)*j}a[w]=S,a[w+1]=A}let u=n[n.length-1],c,f=u*4,h,p=t[2*u],m,y=t[2*u+1];i.fill(0);for(let v=0;v<n.length;++v)u=n[v],c=f,h=p,m=y,f=u*4,p=t[2*u],y=t[2*u+1],i[c+2]=i[f]=m-y,i[c+3]=i[f+1]=p-h}render(t){const n=t==null?t=new fl:void 0,{delaunay:{halfedges:r,inedges:i,hull:o},circumcenters:s,vectors:a}=this;if(o.length<=1)return null;for(let f=0,h=r.length;f<h;++f){const p=r[f];if(p<f)continue;const m=Math.floor(f/3)*2,y=Math.floor(p/3)*2,v=s[m],w=s[m+1],E=s[y],S=s[y+1];this._renderSegment(v,w,E,S,t)}let u,c=o[o.length-1];for(let f=0;f<o.length;++f){u=c,c=o[f];const h=Math.floor(i[c]/3)*2,p=s[h],m=s[h+1],y=u*4,v=this._project(p,m,a[y+2],a[y+3]);v&&this._renderSegment(p,m,v[0],v[1],t)}return n&&n.value()}renderBounds(t){const n=t==null?t=new fl:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),n&&n.value()}renderCell(t,n){const r=n==null?n=new fl:void 0,i=this._clip(t);if(i===null||!i.length)return;n.moveTo(i[0],i[1]);let o=i.length;for(;i[0]===i[o-2]&&i[1]===i[o-1]&&o>1;)o-=2;for(let s=2;s<o;s+=2)(i[s]!==i[s-2]||i[s+1]!==i[s-1])&&n.lineTo(i[s],i[s+1]);return n.closePath(),r&&r.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let n=0,r=t.length/2;n<r;++n){const i=this.cellPolygon(n);i&&(i.index=n,yield i)}}cellPolygon(t){const n=new y_;return this.renderCell(t,n),n.value()}_renderSegment(t,n,r,i,o){let s;const a=this._regioncode(t,n),u=this._regioncode(r,i);a===0&&u===0?(o.moveTo(t,n),o.lineTo(r,i)):(s=this._clipSegment(t,n,r,i,a,u))&&(o.moveTo(s[0],s[1]),o.lineTo(s[2],s[3]))}contains(t,n,r){return n=+n,n!==n||(r=+r,r!==r)?!1:this.delaunay._step(t,n,r)===t}*neighbors(t){const n=this._clip(t);if(n)for(const r of this.delaunay.neighbors(t)){const i=this._clip(r);if(i){e:for(let o=0,s=n.length;o<s;o+=2)for(let a=0,u=i.length;a<u;a+=2)if(n[o]===i[a]&&n[o+1]===i[a+1]&&n[(o+2)%s]===i[(a+u-2)%u]&&n[(o+3)%s]===i[(a+u-1)%u]){yield r;break e}}}}_cell(t){const{circumcenters:n,delaunay:{inedges:r,halfedges:i,triangles:o}}=this,s=r[t];if(s===-1)return null;const a=[];let u=s;do{const c=Math.floor(u/3);if(a.push(n[c*2],n[c*2+1]),u=u%3===2?u-2:u+1,o[u]!==t)break;u=i[u]}while(u!==s&&u!==-1);return a}_clip(t){if(t===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const n=this._cell(t);if(n===null)return null;const{vectors:r}=this,i=t*4;return this._simplify(r[i]||r[i+1]?this._clipInfinite(t,n,r[i],r[i+1],r[i+2],r[i+3]):this._clipFinite(t,n))}_clipFinite(t,n){const r=n.length;let i=null,o,s,a=n[r-2],u=n[r-1],c,f=this._regioncode(a,u),h,p=0;for(let m=0;m<r;m+=2)if(o=a,s=u,a=n[m],u=n[m+1],c=f,f=this._regioncode(a,u),c===0&&f===0)h=p,p=0,i?i.push(a,u):i=[a,u];else{let y,v,w,E,S;if(c===0){if((y=this._clipSegment(o,s,a,u,c,f))===null)continue;[v,w,E,S]=y}else{if((y=this._clipSegment(a,u,o,s,f,c))===null)continue;[E,S,v,w]=y,h=p,p=this._edgecode(v,w),h&&p&&this._edge(t,h,p,i,i.length),i?i.push(v,w):i=[v,w]}h=p,p=this._edgecode(E,S),h&&p&&this._edge(t,h,p,i,i.length),i?i.push(E,S):i=[E,S]}if(i)h=p,p=this._edgecode(i[0],i[1]),h&&p&&this._edge(t,h,p,i,i.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return i}_clipSegment(t,n,r,i,o,s){const a=o<s;for(a&&([t,n,r,i,o,s]=[r,i,t,n,s,o]);;){if(o===0&&s===0)return a?[r,i,t,n]:[t,n,r,i];if(o&s)return null;let u,c,f=o||s;f&8?(u=t+(r-t)*(this.ymax-n)/(i-n),c=this.ymax):f&4?(u=t+(r-t)*(this.ymin-n)/(i-n),c=this.ymin):f&2?(c=n+(i-n)*(this.xmax-t)/(r-t),u=this.xmax):(c=n+(i-n)*(this.xmin-t)/(r-t),u=this.xmin),o?(t=u,n=c,o=this._regioncode(t,n)):(r=u,i=c,s=this._regioncode(r,i))}}_clipInfinite(t,n,r,i,o,s){let a=Array.from(n),u;if((u=this._project(a[0],a[1],r,i))&&a.unshift(u[0],u[1]),(u=this._project(a[a.length-2],a[a.length-1],o,s))&&a.push(u[0],u[1]),a=this._clipFinite(t,a))for(let c=0,f=a.length,h,p=this._edgecode(a[f-2],a[f-1]);c<f;c+=2)h=p,p=this._edgecode(a[c],a[c+1]),h&&p&&(c=this._edge(t,h,p,a,c),f=a.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(a=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return a}_edge(t,n,r,i,o){for(;n!==r;){let s,a;switch(n){case 5:n=4;continue;case 4:n=6,s=this.xmax,a=this.ymin;break;case 6:n=2;continue;case 2:n=10,s=this.xmax,a=this.ymax;break;case 10:n=8;continue;case 8:n=9,s=this.xmin,a=this.ymax;break;case 9:n=1;continue;case 1:n=5,s=this.xmin,a=this.ymin;break}(i[o]!==s||i[o+1]!==a)&&this.contains(t,s,a)&&(i.splice(o,0,s,a),o+=2)}return o}_project(t,n,r,i){let o=1/0,s,a,u;if(i<0){if(n<=this.ymin)return null;(s=(this.ymin-n)/i)<o&&(u=this.ymin,a=t+(o=s)*r)}else if(i>0){if(n>=this.ymax)return null;(s=(this.ymax-n)/i)<o&&(u=this.ymax,a=t+(o=s)*r)}if(r>0){if(t>=this.xmax)return null;(s=(this.xmax-t)/r)<o&&(a=this.xmax,u=n+(o=s)*i)}else if(r<0){if(t<=this.xmin)return null;(s=(this.xmin-t)/r)<o&&(a=this.xmin,u=n+(o=s)*i)}return[a,u]}_edgecode(t,n){return(t===this.xmin?1:t===this.xmax?2:0)|(n===this.ymin?4:n===this.ymax?8:0)}_regioncode(t,n){return(t<this.xmin?1:t>this.xmax?2:0)|(n<this.ymin?4:n>this.ymax?8:0)}_simplify(t){if(t&&t.length>4){for(let n=0;n<t.length;n+=2){const r=(n+2)%t.length,i=(n+4)%t.length;(t[n]===t[r]&&t[r]===t[i]||t[n+1]===t[r+1]&&t[r+1]===t[i+1])&&(t.splice(r,2),n-=2)}t.length||(t=null)}return t}};const Fae=2*Math.PI,Wc=Math.pow;function Dae(e){return e[0]}function Mae(e){return e[1]}function Tae(e){const{triangles:t,coords:n}=e;for(let r=0;r<t.length;r+=3){const i=2*t[r],o=2*t[r+1],s=2*t[r+2];if((n[s]-n[i])*(n[o+1]-n[i+1])-(n[o]-n[i])*(n[s+1]-n[i+1])>1e-10)return!1}return!0}function Nae(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}class A${static from(t,n=Dae,r=Mae,i){return new A$("length"in t?Rae(t,n,r,i):Float64Array.from(Oae(t,n,r,i)))}constructor(t){this._delaunator=new Cy(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,n=this.points;if(t.hull&&t.hull.length>2&&Tae(t)){this.collinear=Int32Array.from({length:n.length/2},(p,m)=>m).sort((p,m)=>n[2*p]-n[2*m]||n[2*p+1]-n[2*m+1]);const u=this.collinear[0],c=this.collinear[this.collinear.length-1],f=[n[2*u],n[2*u+1],n[2*c],n[2*c+1]],h=1e-8*Math.hypot(f[3]-f[1],f[2]-f[0]);for(let p=0,m=n.length/2;p<m;++p){const y=Nae(n[2*p],n[2*p+1],h);n[2*p]=y[0],n[2*p+1]=y[1]}this._delaunator=new Cy(n)}else delete this.collinear;const r=this.halfedges=this._delaunator.halfedges,i=this.hull=this._delaunator.hull,o=this.triangles=this._delaunator.triangles,s=this.inedges.fill(-1),a=this._hullIndex.fill(-1);for(let u=0,c=r.length;u<c;++u){const f=o[u%3===2?u-2:u+1];(r[u]===-1||s[f]===-1)&&(s[f]=u)}for(let u=0,c=i.length;u<c;++u)a[i[u]]=u;i.length<=2&&i.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=i[0],s[i[0]]=1,i.length===2&&(s[i[1]]=0,this.triangles[1]=i[1],this.triangles[2]=i[1]))}voronoi(t){return new $ae(this,t)}*neighbors(t){const{inedges:n,hull:r,_hullIndex:i,halfedges:o,triangles:s,collinear:a}=this;if(a){const h=a.indexOf(t);h>0&&(yield a[h-1]),h<a.length-1&&(yield a[h+1]);return}const u=n[t];if(u===-1)return;let c=u,f=-1;do{if(yield f=s[c],c=c%3===2?c-2:c+1,s[c]!==t)return;if(c=o[c],c===-1){const h=r[(i[t]+1)%r.length];h!==f&&(yield h);return}}while(c!==u)}find(t,n,r=0){if(t=+t,t!==t||(n=+n,n!==n))return-1;const i=r;let o;for(;(o=this._step(r,t,n))>=0&&o!==r&&o!==i;)r=o;return o}_step(t,n,r){const{inedges:i,hull:o,_hullIndex:s,halfedges:a,triangles:u,points:c}=this;if(i[t]===-1||!c.length)return(t+1)%(c.length>>1);let f=t,h=Wc(n-c[t*2],2)+Wc(r-c[t*2+1],2);const p=i[t];let m=p;do{let y=u[m];const v=Wc(n-c[y*2],2)+Wc(r-c[y*2+1],2);if(v<h&&(h=v,f=y),m=m%3===2?m-2:m+1,u[m]!==t)break;if(m=a[m],m===-1){if(m=o[(s[t]+1)%o.length],m!==y&&Wc(n-c[m*2],2)+Wc(r-c[m*2+1],2)<h)return m;break}}while(m!==p);return f}render(t){const n=t==null?t=new fl:void 0,{points:r,halfedges:i,triangles:o}=this;for(let s=0,a=i.length;s<a;++s){const u=i[s];if(u<s)continue;const c=o[s]*2,f=o[u]*2;t.moveTo(r[c],r[c+1]),t.lineTo(r[f],r[f+1])}return this.renderHull(t),n&&n.value()}renderPoints(t,n){n===void 0&&(!t||typeof t.moveTo!="function")&&(n=t,t=null),n=n==null?2:+n;const r=t==null?t=new fl:void 0,{points:i}=this;for(let o=0,s=i.length;o<s;o+=2){const a=i[o],u=i[o+1];t.moveTo(a+n,u),t.arc(a,u,n,0,Fae)}return r&&r.value()}renderHull(t){const n=t==null?t=new fl:void 0,{hull:r,points:i}=this,o=r[0]*2,s=r.length;t.moveTo(i[o],i[o+1]);for(let a=1;a<s;++a){const u=2*r[a];t.lineTo(i[u],i[u+1])}return t.closePath(),n&&n.value()}hullPolygon(){const t=new y_;return this.renderHull(t),t.value()}renderTriangle(t,n){const r=n==null?n=new fl:void 0,{points:i,triangles:o}=this,s=o[t*=3]*2,a=o[t+1]*2,u=o[t+2]*2;return n.moveTo(i[s],i[s+1]),n.lineTo(i[a],i[a+1]),n.lineTo(i[u],i[u+1]),n.closePath(),r&&r.value()}*trianglePolygons(){const{triangles:t}=this;for(let n=0,r=t.length/3;n<r;++n)yield this.trianglePolygon(n)}trianglePolygon(t){const n=new y_;return this.renderTriangle(t,n),n.value()}}function Rae(e,t,n,r){const i=e.length,o=new Float64Array(i*2);for(let s=0;s<i;++s){const a=e[s];o[s*2]=t.call(r,a,s,e),o[s*2+1]=n.call(r,a,s,e)}return o}function*Oae(e,t,n,r){let i=0;for(const o of e)yield t.call(r,o,i,e),yield n.call(r,o,i,e),++i}function C$(e){J.call(this,null,e)}C$.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const Pae=[-1e5,-1e5,1e5,1e5];pe(C$,J,{transform(e,t){const n=e.as||"path",r=t.source;if(!r||!r.length)return t;let i=e.size;i=i?[0,0,i[0],i[1]]:(i=e.extent)?[i[0][0],i[0][1],i[1][0],i[1][1]]:Pae;const o=this.value=A$.from(r,e.x,e.y).voronoi(i);for(let s=0,a=r.length;s<a;++s){const u=o.cellPolygon(s);r[s][n]=u&&!zae(u)?Lae(u):null}return t.reflow(e.modified()).modifies(n)}});function Lae(e){const t=e[0][0],n=e[0][1];let r=e.length-1;for(;e[r][0]===t&&e[r][1]===n;--r);return"M"+e.slice(0,r+1).join("L")+"Z"}function zae(e){return e.length===2&&e[0][0]===e[1][0]&&e[0][1]===e[1][1]}const Iae=Object.freeze(Object.defineProperty({__proto__:null,voronoi:C$},Symbol.toStringTag,{value:"Module"}));var ZE=Math.PI/180,ep=64,u1=2048;function Bae(){var e=[256,256],t,n,r,i,o,s,a,u=vI,c=[],f=Math.random,h={};h.layout=function(){for(var y=p(Xa()),v=Gae((e[0]>>5)*e[1]),w=null,E=c.length,S=-1,A=[],C=c.map(D=>({text:t(D),font:n(D),style:i(D),weight:o(D),rotate:s(D),size:~~(r(D)+1e-14),padding:a(D),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:D})).sort((D,$)=>$.size-D.size);++S<E;){var k=C[S];k.x=e[0]*(f()+.5)>>1,k.y=e[1]*(f()+.5)>>1,Uae(y,k,C,S),k.hasText&&m(v,k,w)&&(A.push(k),w?Wae(w,k):w=[{x:k.x+k.x0,y:k.y+k.y0},{x:k.x+k.x1,y:k.y+k.y1}],k.x-=e[0]>>1,k.y-=e[1]>>1)}return A};function p(y){y.width=y.height=1;var v=Math.sqrt(y.getContext("2d").getImageData(0,0,1,1).data.length>>2);y.width=(ep<<5)/v,y.height=u1/v;var w=y.getContext("2d");return w.fillStyle=w.strokeStyle="red",w.textAlign="center",{context:w,ratio:v}}function m(y,v,w){for(var E=v.x,S=v.y,A=Math.hypot(e[0],e[1]),C=u(e),k=f()<.5?1:-1,D=-k,$,M,T;($=C(D+=k))&&(M=~~$[0],T=~~$[1],!(Math.min(Math.abs(M),Math.abs(T))>=A));)if(v.x=E+M,v.y=S+T,!(v.x+v.x0<0||v.y+v.y0<0||v.x+v.x1>e[0]||v.y+v.y1>e[1])&&(!w||!jae(v,y,e[0]))&&(!w||qae(v,w))){for(var L=v.sprite,O=v.width>>5,X=e[0]>>5,W=v.x-(O<<4),I=W&127,N=32-I,U=v.y1-v.y0,Y=(v.y+v.y0)*X+(W>>5),j,q=0;q<U;q++){j=0;for(var K=0;K<=O;K++)y[Y+K]|=j<<N|(K<O?(j=L[q*O+K])>>>I:0);Y+=X}return v.sprite=null,!0}return!1}return h.words=function(y){return arguments.length?(c=y,h):c},h.size=function(y){return arguments.length?(e=[+y[0],+y[1]],h):e},h.font=function(y){return arguments.length?(n=qu(y),h):n},h.fontStyle=function(y){return arguments.length?(i=qu(y),h):i},h.fontWeight=function(y){return arguments.length?(o=qu(y),h):o},h.rotate=function(y){return arguments.length?(s=qu(y),h):s},h.text=function(y){return arguments.length?(t=qu(y),h):t},h.spiral=function(y){return arguments.length?(u=Vae[y]||y,h):u},h.fontSize=function(y){return arguments.length?(r=qu(y),h):r},h.padding=function(y){return arguments.length?(a=qu(y),h):a},h.random=function(y){return arguments.length?(f=y,h):f},h}function Uae(e,t,n,r){if(!t.sprite){var i=e.context,o=e.ratio;i.clearRect(0,0,(ep<<5)/o,u1/o);var s=0,a=0,u=0,c=n.length,f,h,p,m,y;for(--r;++r<c;){if(t=n[r],i.save(),i.font=t.style+" "+t.weight+" "+~~((t.size+1)/o)+"px "+t.font,f=i.measureText(t.text+"m").width*o,p=t.size<<1,t.rotate){var v=Math.sin(t.rotate*ZE),w=Math.cos(t.rotate*ZE),E=f*w,S=f*v,A=p*w,C=p*v;f=Math.max(Math.abs(E+C),Math.abs(E-C))+31>>5<<5,p=~~Math.max(Math.abs(S+A),Math.abs(S-A))}else f=f+31>>5<<5;if(p>u&&(u=p),s+f>=ep<<5&&(s=0,a+=u,u=0),a+p>=u1)break;i.translate((s+(f>>1))/o,(a+(p>>1))/o),t.rotate&&i.rotate(t.rotate*ZE),i.fillText(t.text,0,0),t.padding&&(i.lineWidth=2*t.padding,i.strokeText(t.text,0,0)),i.restore(),t.width=f,t.height=p,t.xoff=s,t.yoff=a,t.x1=f>>1,t.y1=p>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,s+=f}for(var k=i.getImageData(0,0,(ep<<5)/o,u1/o).data,D=[];--r>=0;)if(t=n[r],!!t.hasText){for(f=t.width,h=f>>5,p=t.y1-t.y0,m=0;m<p*h;m++)D[m]=0;if(s=t.xoff,s==null)return;a=t.yoff;var $=0,M=-1;for(y=0;y<p;y++){for(m=0;m<f;m++){var T=h*y+(m>>5),L=k[(a+y)*(ep<<5)+(s+m)<<2]?1<<31-m%32:0;D[T]|=L,$|=L}$?M=y:(t.y0++,p--,y--,a++)}t.y1=t.y0+M,t.sprite=D.slice(0,(t.y1-t.y0)*h)}}}function jae(e,t,n){n>>=5;for(var r=e.sprite,i=e.width>>5,o=e.x-(i<<4),s=o&127,a=32-s,u=e.y1-e.y0,c=(e.y+e.y0)*n+(o>>5),f,h=0;h<u;h++){f=0;for(var p=0;p<=i;p++)if((f<<a|(p<i?(f=r[h*i+p])>>>s:0))&t[c+p])return!0;c+=n}return!1}function Wae(e,t){var n=e[0],r=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>r.x&&(r.x=t.x+t.x1),t.y+t.y1>r.y&&(r.y=t.y+t.y1)}function qae(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function vI(e){var t=e[0]/e[1];return function(n){return[t*(n*=.1)*Math.cos(n),n*Math.sin(n)]}}function Hae(e){var t=4,n=t*e[0]/e[1],r=0,i=0;return function(o){var s=o<0?-1:1;switch(Math.sqrt(1+4*s*o)-s&3){case 0:r+=n;break;case 1:i+=t;break;case 2:r-=n;break;default:i-=t;break}return[r,i]}}function Gae(e){for(var t=[],n=-1;++n<e;)t[n]=0;return t}function qu(e){return typeof e=="function"?e:function(){return e}}var Vae={archimedean:vI,rectangular:Hae};const xI=["x","y","font","fontSize","fontStyle","fontWeight","angle"],Yae=["text","font","rotate","fontSize","fontStyle","fontWeight"];function k$(e){J.call(this,Bae(),e)}k$.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:xI}]};pe(k$,J,{transform(e,t){e.size&&!(e.size[0]&&e.size[1])&&te("Wordcloud size dimensions must be non-zero.");function n(y){const v=e[y];return He(v)&&t.modified(v.fields)}const r=e.modified();if(!(r||t.changed(t.ADD_REM)||Yae.some(n)))return;const i=t.materialize(t.SOURCE).source,o=this.value,s=e.as||xI;let a=e.fontSize||14,u;if(He(a)?u=e.fontSizeRange:a=nr(a),u){const y=a,v=lt("sqrt")().domain(Ho(i,y)).range(u);a=w=>v(y(w))}i.forEach(y=>{y[s[0]]=NaN,y[s[1]]=NaN,y[s[3]]=0});const c=o.words(i).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(a).random(Di).layout(),f=o.size(),h=f[0]>>1,p=f[1]>>1,m=c.length;for(let y=0,v,w;y<m;++y)v=c[y],w=v.datum,w[s[0]]=v.x+h,w[s[1]]=v.y+p,w[s[2]]=v.font,w[s[3]]=v.size,w[s[4]]=v.style,w[s[5]]=v.weight,w[s[6]]=v.rotate;return t.reflow(r).modifies(s)}});const Xae=Object.freeze(Object.defineProperty({__proto__:null,wordcloud:k$},Symbol.toStringTag,{value:"Module"})),Qae=e=>new Uint8Array(e),Kae=e=>new Uint16Array(e),pp=e=>new Uint32Array(e);function Jae(){let e=8,t=[],n=pp(0),r=$m(0,e),i=$m(0,e);return{data:()=>t,seen:()=>n=Zae(n,t.length),add(o){for(let s=0,a=t.length,u=o.length,c;s<u;++s)c=o[s],c._index=a++,t.push(c)},remove(o,s){const a=t.length,u=Array(a-o),c=t;let f,h,p;for(h=0;!s[h]&&h<a;++h)u[h]=t[h],c[h]=h;for(p=h;h<a;++h)f=t[h],s[h]?c[h]=-1:(c[h]=p,r[p]=r[h],i[p]=i[h],u[p]=f,f._index=p++),r[h]=0;return t=u,c},size:()=>t.length,curr:()=>r,prev:()=>i,reset:o=>i[o]=r[o],all:()=>e<257?255:e<65537?65535:4294967295,set(o,s){r[o]|=s},clear(o,s){r[o]&=~s},resize(o,s){const a=r.length;(o>a||s>e)&&(e=Math.max(s,e),r=$m(o,e,r),i=$m(o,e))}}}function Zae(e,t,n){return e.length>=t?e:(n=n||new e.constructor(t),n.set(e),n)}function $m(e,t,n){const r=(t<257?Qae:t<65537?Kae:pp)(e);return n&&r.set(n),r}function TR(e,t,n){const r=1<<t;return{one:r,zero:~r,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd(i,o){const s=this,a=s.bisect(s.range,i.value),u=i.index,c=a[0],f=a[1],h=u.length;let p;for(p=0;p<c;++p)o[u[p]]|=r;for(p=f;p<h;++p)o[u[p]]|=r;return s}}}function NR(){let e=pp(0),t=[],n=0;function r(a,u,c){if(!u.length)return[];const f=n,h=u.length,p=pp(h);let m=Array(h),y,v,w;for(w=0;w<h;++w)m[w]=a(u[w]),p[w]=w;if(m=eue(m,p),f)y=t,v=e,t=Array(f+h),e=pp(f+h),tue(c,y,v,f,m,p,h,t,e);else{if(c>0)for(w=0;w<h;++w)p[w]+=c;t=m,e=p}return n=f+h,{index:p,value:m}}function i(a,u){const c=n;let f,h,p;for(h=0;!u[e[h]]&&h<c;++h);for(p=h;h<c;++h)u[f=e[h]]||(e[p]=f,t[p]=t[h],++p);n=c-a}function o(a){for(let u=0,c=n;u<c;++u)e[u]=a[e[u]]}function s(a,u){let c;return u?c=u.length:(u=t,c=n),[sV(u,a[0],0,c),Ja(u,a[1],0,c)]}return{insert:r,remove:i,bisect:s,reindex:o,index:()=>e,size:()=>n}}function eue(e,t){return e.sort.call(t,(n,r)=>{const i=e[n],o=e[r];return i<o?-1:i>o?1:0}),lV(e,t)}function tue(e,t,n,r,i,o,s,a,u){let c=0,f=0,h;for(h=0;c<r&&f<s;++h)t[c]<i[f]?(a[h]=t[c],u[h]=n[c++]):(a[h]=i[f],u[h]=o[f++]+e);for(;c<r;++c,++h)a[h]=t[c],u[h]=n[c];for(;f<s;++f,++h)a[h]=i[f],u[h]=o[f]+e}function $$(e){J.call(this,Jae(),e),this._indices=null,this._dims=null}$$.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]};pe($$,J,{transform(e,t){if(this._dims){var n=e.modified("fields")||e.fields.some(r=>t.modified(r.fields));return n?this.reinit(e,t):this.eval(e,t)}else return this.init(e,t)},init(e,t){const n=e.fields,r=e.query,i=this._indices={},o=this._dims=[],s=r.length;let a=0,u,c;for(;a<s;++a)u=n[a].fname,c=i[u]||(i[u]=NR()),o.push(TR(c,a,r[a]));return this.eval(e,t)},reinit(e,t){const n=t.materialize().fork(),r=e.fields,i=e.query,o=this._indices,s=this._dims,a=this.value,u=a.curr(),c=a.prev(),f=a.all(),h=n.rem=n.add,p=n.mod,m=i.length,y={};let v,w,E,S,A,C,k,D,$;if(c.set(u),t.rem.length&&(A=this.remove(e,t,n)),t.add.length&&a.add(t.add),t.mod.length)for(C={},S=t.mod,k=0,D=S.length;k<D;++k)C[S[k]._index]=1;for(k=0;k<m;++k)$=r[k],(!s[k]||e.modified("fields",k)||t.modified($.fields))&&(E=$.fname,(v=y[E])||(o[E]=w=NR(),y[E]=v=w.insert($,t.source,0)),s[k]=TR(w,k,i[k]).onAdd(v,u));for(k=0,D=a.data().length;k<D;++k)A[k]||(c[k]!==u[k]?h.push(k):C[k]&&u[k]!==f&&p.push(k));return a.mask=(1<<m)-1,n},eval(e,t){const n=t.materialize().fork(),r=this._dims.length;let i=0;return t.rem.length&&(this.remove(e,t,n),i|=(1<<r)-1),e.modified("query")&&!e.modified("fields")&&(i|=this.update(e,t,n)),t.add.length&&(this.insert(e,t,n),i|=(1<<r)-1),t.mod.length&&(this.modify(t,n),i|=(1<<r)-1),this.value.mask=i,n},insert(e,t,n){const r=t.add,i=this.value,o=this._dims,s=this._indices,a=e.fields,u={},c=n.add,f=i.size()+r.length,h=o.length;let p=i.size(),m,y,v;i.resize(f,h),i.add(r);const w=i.curr(),E=i.prev(),S=i.all();for(m=0;m<h;++m)y=a[m].fname,v=u[y]||(u[y]=s[y].insert(a[m],r,p)),o[m].onAdd(v,w);for(;p<f;++p)E[p]=S,w[p]!==S&&c.push(p)},modify(e,t){const n=t.mod,r=this.value,i=r.curr(),o=r.all(),s=e.mod;let a,u,c;for(a=0,u=s.length;a<u;++a)c=s[a]._index,i[c]!==o&&n.push(c)},remove(e,t,n){const r=this._indices,i=this.value,o=i.curr(),s=i.prev(),a=i.all(),u={},c=n.rem,f=t.rem;let h,p,m,y;for(h=0,p=f.length;h<p;++h)m=f[h]._index,u[m]=1,s[m]=y=o[m],o[m]=a,y!==a&&c.push(m);for(m in r)r[m].remove(p,u);return this.reindex(t,p,u),u},reindex(e,t,n){const r=this._indices,i=this.value;e.runAfter(()=>{const o=i.remove(t,n);for(const s in r)r[s].reindex(o)})},update(e,t,n){const r=this._dims,i=e.query,o=t.stamp,s=r.length;let a=0,u,c;for(n.filters=0,c=0;c<s;++c)e.modified("query",c)&&(u=c,++a);if(a===1)a=r[u].one,this.incrementOne(r[u],i[u],n.add,n.rem);else for(c=0,a=0;c<s;++c)e.modified("query",c)&&(a|=r[c].one,this.incrementAll(r[c],i[c],o,n.add),n.rem=n.add);return a},incrementAll(e,t,n,r){const i=this.value,o=i.seen(),s=i.curr(),a=i.prev(),u=e.index(),c=e.bisect(e.range),f=e.bisect(t),h=f[0],p=f[1],m=c[0],y=c[1],v=e.one;let w,E,S;if(h<m)for(w=h,E=Math.min(m,p);w<E;++w)S=u[w],o[S]!==n&&(a[S]=s[S],o[S]=n,r.push(S)),s[S]^=v;else if(h>m)for(w=m,E=Math.min(h,y);w<E;++w)S=u[w],o[S]!==n&&(a[S]=s[S],o[S]=n,r.push(S)),s[S]^=v;if(p>y)for(w=Math.max(h,y),E=p;w<E;++w)S=u[w],o[S]!==n&&(a[S]=s[S],o[S]=n,r.push(S)),s[S]^=v;else if(p<y)for(w=Math.max(m,p),E=y;w<E;++w)S=u[w],o[S]!==n&&(a[S]=s[S],o[S]=n,r.push(S)),s[S]^=v;e.range=t.slice()},incrementOne(e,t,n,r){const i=this.value,o=i.curr(),s=e.index(),a=e.bisect(e.range),u=e.bisect(t),c=u[0],f=u[1],h=a[0],p=a[1],m=e.one;let y,v,w;if(c<h)for(y=c,v=Math.min(h,f);y<v;++y)w=s[y],o[w]^=m,n.push(w);else if(c>h)for(y=h,v=Math.min(c,p);y<v;++y)w=s[y],o[w]^=m,r.push(w);if(f>p)for(y=Math.max(c,p),v=f;y<v;++y)w=s[y],o[w]^=m,n.push(w);else if(f<p)for(y=Math.max(h,f),v=p;y<v;++y)w=s[y],o[w]^=m,r.push(w);e.range=t.slice()}});function F$(e){J.call(this,null,e)}F$.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]};pe(F$,J,{transform(e,t){const n=~(e.ignore||0),r=e.filter,i=r.mask;if((i&n)===0)return t.StopPropagation;const o=t.fork(t.ALL),s=r.data(),a=r.curr(),u=r.prev(),c=f=>a[f]&n?null:s[f];return o.filter(o.MOD,c),i&i-1?(o.filter(o.ADD,f=>{const h=a[f]&n;return!h&&h^u[f]&n?s[f]:null}),o.filter(o.REM,f=>{const h=a[f]&n;return h&&!(h^(h^u[f]&n))?s[f]:null})):(o.filter(o.ADD,c),o.filter(o.REM,f=>(a[f]&n)===i?s[f]:null)),o.filter(o.SOURCE,f=>c(f._index))}});const nue=Object.freeze(Object.defineProperty({__proto__:null,crossfilter:$$,resolvefilter:F$},Symbol.toStringTag,{value:"Module"})),rue="RawCode",Dl="Literal",iue="Property",oue="Identifier",sue="ArrayExpression",aue="BinaryExpression",wI="CallExpression",uue="ConditionalExpression",lue="LogicalExpression",cue="MemberExpression",fue="ObjectExpression",due="UnaryExpression";function ho(e){this.type=e}ho.prototype.visit=function(e){let t,n,r;if(e(this))return 1;for(t=hue(this),n=0,r=t.length;n<r;++n)if(t[n].visit(e))return 1};function hue(e){switch(e.type){case sue:return e.elements;case aue:case lue:return[e.left,e.right];case wI:return[e.callee].concat(e.arguments);case uue:return[e.test,e.consequent,e.alternate];case cue:return[e.object,e.property];case fue:return e.properties;case iue:return[e.key,e.value];case due:return[e.argument];case oue:case Dl:case rue:default:return[]}}var os,ke,Z,Kn,pt,Xv=1,Ag=2,Ml=3,vu=4,Qv=5,Jl=6,Dr=7,Cg=8,pue=9;os={};os[Xv]="Boolean";os[Ag]="<end>";os[Ml]="Identifier";os[vu]="Keyword";os[Qv]="Null";os[Jl]="Numeric";os[Dr]="Punctuator";os[Cg]="String";os[pue]="RegularExpression";var gue="ArrayExpression",mue="BinaryExpression",yue="CallExpression",vue="ConditionalExpression",EI="Identifier",xue="Literal",wue="LogicalExpression",Eue="MemberExpression",bue="ObjectExpression",Sue="Property",_ue="UnaryExpression",mn="Unexpected token %0",Aue="Unexpected number",Cue="Unexpected string",kue="Unexpected identifier",$ue="Unexpected reserved word",Fue="Unexpected end of input",v_="Invalid regular expression",eb="Invalid regular expression: missing /",bI="Octal literals are not allowed in strict mode.",Due="Duplicate data property in object literal not allowed in strict mode",Mn="ILLEGAL",Lp="Disabled.",Mue=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),Tue=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function Kv(e,t){if(!e)throw new Error("ASSERT: "+t)}function Fs(e){return e>=48&&e<=57}function D$(e){return"0123456789abcdefABCDEF".includes(e)}function gp(e){return"01234567".includes(e)}function Nue(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].includes(e)}function zp(e){return e===10||e===13||e===8232||e===8233}function kg(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&Mue.test(String.fromCharCode(e))}function ky(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&Tue.test(String.fromCharCode(e))}const Rue={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function SI(){for(;Z<Kn;){const e=ke.charCodeAt(Z);if(Nue(e)||zp(e))++Z;else break}}function x_(e){var t,n,r,i=0;for(n=e==="u"?4:2,t=0;t<n;++t)Z<Kn&&D$(ke[Z])?(r=ke[Z++],i=i*16+"0123456789abcdef".indexOf(r.toLowerCase())):ot({},mn,Mn);return String.fromCharCode(i)}function Oue(){var e,t,n,r;for(e=ke[Z],t=0,e==="}"&&ot({},mn,Mn);Z<Kn&&(e=ke[Z++],!!D$(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&ot({},mn,Mn),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,r=(t-65536&1023)+56320,String.fromCharCode(n,r))}function _I(){var e,t;for(e=ke.charCodeAt(Z++),t=String.fromCharCode(e),e===92&&(ke.charCodeAt(Z)!==117&&ot({},mn,Mn),++Z,e=x_("u"),(!e||e==="\\"||!kg(e.charCodeAt(0)))&&ot({},mn,Mn),t=e);Z<Kn&&(e=ke.charCodeAt(Z),!!ky(e));)++Z,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),ke.charCodeAt(Z)!==117&&ot({},mn,Mn),++Z,e=x_("u"),(!e||e==="\\"||!ky(e.charCodeAt(0)))&&ot({},mn,Mn),t+=e);return t}function Pue(){var e,t;for(e=Z++;Z<Kn;){if(t=ke.charCodeAt(Z),t===92)return Z=e,_I();if(ky(t))++Z;else break}return ke.slice(e,Z)}function Lue(){var e,t,n;return e=Z,t=ke.charCodeAt(Z)===92?_I():Pue(),t.length===1?n=Ml:Rue.hasOwnProperty(t)?n=vu:t==="null"?n=Qv:t==="true"||t==="false"?n=Xv:n=Ml,{type:n,value:t,start:e,end:Z}}function tb(){var e=Z,t=ke.charCodeAt(Z),n,r=ke[Z],i,o,s;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++Z,{type:Dr,value:String.fromCharCode(t),start:e,end:Z};default:if(n=ke.charCodeAt(Z+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return Z+=2,{type:Dr,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:Z};case 33:case 61:return Z+=2,ke.charCodeAt(Z)===61&&++Z,{type:Dr,value:ke.slice(e,Z),start:e,end:Z}}}if(s=ke.substr(Z,4),s===">>>=")return Z+=4,{type:Dr,value:s,start:e,end:Z};if(o=s.substr(0,3),o===">>>"||o==="<<="||o===">>=")return Z+=3,{type:Dr,value:o,start:e,end:Z};if(i=o.substr(0,2),r===i[1]&&"+-<>&|".includes(r)||i==="=>")return Z+=2,{type:Dr,value:i,start:e,end:Z};if(i==="//"&&ot({},mn,Mn),"<>=!+-*%&|^/".includes(r))return++Z,{type:Dr,value:r,start:e,end:Z};ot({},mn,Mn)}function zue(e){let t="";for(;Z<Kn&&D$(ke[Z]);)t+=ke[Z++];return t.length===0&&ot({},mn,Mn),kg(ke.charCodeAt(Z))&&ot({},mn,Mn),{type:Jl,value:parseInt("0x"+t,16),start:e,end:Z}}function Iue(e){let t="0"+ke[Z++];for(;Z<Kn&&gp(ke[Z]);)t+=ke[Z++];return(kg(ke.charCodeAt(Z))||Fs(ke.charCodeAt(Z)))&&ot({},mn,Mn),{type:Jl,value:parseInt(t,8),octal:!0,start:e,end:Z}}function RR(){var e,t,n;if(n=ke[Z],Kv(Fs(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=Z,e="",n!=="."){if(e=ke[Z++],n=ke[Z],e==="0"){if(n==="x"||n==="X")return++Z,zue(t);if(gp(n))return Iue(t);n&&Fs(n.charCodeAt(0))&&ot({},mn,Mn)}for(;Fs(ke.charCodeAt(Z));)e+=ke[Z++];n=ke[Z]}if(n==="."){for(e+=ke[Z++];Fs(ke.charCodeAt(Z));)e+=ke[Z++];n=ke[Z]}if(n==="e"||n==="E")if(e+=ke[Z++],n=ke[Z],(n==="+"||n==="-")&&(e+=ke[Z++]),Fs(ke.charCodeAt(Z)))for(;Fs(ke.charCodeAt(Z));)e+=ke[Z++];else ot({},mn,Mn);return kg(ke.charCodeAt(Z))&&ot({},mn,Mn),{type:Jl,value:parseFloat(e),start:t,end:Z}}function Bue(){var e="",t,n,r,i,o=!1;for(t=ke[Z],Kv(t==="'"||t==='"',"String literal must starts with a quote"),n=Z,++Z;Z<Kn;)if(r=ke[Z++],r===t){t="";break}else if(r==="\\")if(r=ke[Z++],!r||!zp(r.charCodeAt(0)))switch(r){case"u":case"x":ke[Z]==="{"?(++Z,e+=Oue()):e+=x_(r);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:gp(r)?(i="01234567".indexOf(r),i!==0&&(o=!0),Z<Kn&&gp(ke[Z])&&(o=!0,i=i*8+"01234567".indexOf(ke[Z++]),"0123".includes(r)&&Z<Kn&&gp(ke[Z])&&(i=i*8+"01234567".indexOf(ke[Z++]))),e+=String.fromCharCode(i)):e+=r;break}else r==="\r"&&ke[Z]===`
`&&++Z;else{if(zp(r.charCodeAt(0)))break;e+=r}return t!==""&&ot({},mn,Mn),{type:Cg,value:e,octal:o,start:n,end:Z}}function Uue(e,t){let n=e;t.includes("u")&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(r,i)=>{if(parseInt(i,16)<=1114111)return"x";ot({},v_)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch{ot({},v_)}try{return new RegExp(e,t)}catch{return null}}function jue(){var e,t,n,r,i;for(e=ke[Z],Kv(e==="/","Regular expression literal must start with a slash"),t=ke[Z++],n=!1,r=!1;Z<Kn;)if(e=ke[Z++],t+=e,e==="\\")e=ke[Z++],zp(e.charCodeAt(0))&&ot({},eb),t+=e;else if(zp(e.charCodeAt(0)))ot({},eb);else if(n)e==="]"&&(n=!1);else if(e==="/"){r=!0;break}else e==="["&&(n=!0);return r||ot({},eb),i=t.substr(1,t.length-2),{value:i,literal:t}}function Wue(){var e,t,n;for(t="",n="";Z<Kn&&(e=ke[Z],!!ky(e.charCodeAt(0)));)++Z,e==="\\"&&Z<Kn?ot({},mn,Mn):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&ot({},v_,n),{value:n,literal:t}}function que(){var e,t,n,r;return pt=null,SI(),e=Z,t=jue(),n=Wue(),r=Uue(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:Z}}function Hue(e){return e.type===Ml||e.type===vu||e.type===Xv||e.type===Qv}function AI(){if(SI(),Z>=Kn)return{type:Ag,start:Z,end:Z};const e=ke.charCodeAt(Z);return kg(e)?Lue():e===40||e===41||e===59?tb():e===39||e===34?Bue():e===46?Fs(ke.charCodeAt(Z+1))?RR():tb():Fs(e)?RR():tb()}function Nr(){const e=pt;return Z=e.end,pt=AI(),Z=e.end,e}function CI(){const e=Z;pt=AI(),Z=e}function Gue(e){const t=new ho(gue);return t.elements=e,t}function OR(e,t,n){const r=new ho(e==="||"||e==="&&"?wue:mue);return r.operator=e,r.left=t,r.right=n,r}function Vue(e,t){const n=new ho(yue);return n.callee=e,n.arguments=t,n}function Yue(e,t,n){const r=new ho(vue);return r.test=e,r.consequent=t,r.alternate=n,r}function M$(e){const t=new ho(EI);return t.name=e,t}function tp(e){const t=new ho(xue);return t.value=e.value,t.raw=ke.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function PR(e,t,n){const r=new ho(Eue);return r.computed=e==="[",r.object=t,r.property=n,r.computed||(n.member=!0),r}function Xue(e){const t=new ho(bue);return t.properties=e,t}function LR(e,t,n){const r=new ho(Sue);return r.key=t,r.value=n,r.kind=e,r}function Que(e,t){const n=new ho(_ue);return n.operator=e,n.argument=t,n.prefix=!0,n}function ot(e,t){var n,r=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,(o,s)=>(Kv(s<r.length,"Message reference must be in range"),r[s]));throw n=new Error(i),n.index=Z,n.description=i,n}function Jv(e){e.type===Ag&&ot(e,Fue),e.type===Jl&&ot(e,Aue),e.type===Cg&&ot(e,Cue),e.type===Ml&&ot(e,kue),e.type===vu&&ot(e,$ue),ot(e,mn,e.value)}function Jn(e){const t=Nr();(t.type!==Dr||t.value!==e)&&Jv(t)}function Ct(e){return pt.type===Dr&&pt.value===e}function nb(e){return pt.type===vu&&pt.value===e}function Kue(){const e=[];for(Z=pt.start,Jn("[");!Ct("]");)Ct(",")?(Nr(),e.push(null)):(e.push(Tl()),Ct("]")||Jn(","));return Nr(),Gue(e)}function zR(){Z=pt.start;const e=Nr();return e.type===Cg||e.type===Jl?(e.octal&&ot(e,bI),tp(e)):M$(e.value)}function Jue(){var e,t,n,r;if(Z=pt.start,e=pt,e.type===Ml)return n=zR(),Jn(":"),r=Tl(),LR("init",n,r);if(e.type===Ag||e.type===Dr)Jv(e);else return t=zR(),Jn(":"),r=Tl(),LR("init",t,r)}function Zue(){var e=[],t,n,r,i={},o=String;for(Z=pt.start,Jn("{");!Ct("}");)t=Jue(),t.key.type===EI?n=t.key.name:n=o(t.key.value),r="$"+n,Object.prototype.hasOwnProperty.call(i,r)?ot({},Due):i[r]=!0,e.push(t),Ct("}")||Jn(",");return Jn("}"),Xue(e)}function ele(){Jn("(");const e=T$();return Jn(")"),e}const tle={if:1};function nle(){var e,t,n;if(Ct("("))return ele();if(Ct("["))return Kue();if(Ct("{"))return Zue();if(e=pt.type,Z=pt.start,e===Ml||tle[pt.value])n=M$(Nr().value);else if(e===Cg||e===Jl)pt.octal&&ot(pt,bI),n=tp(Nr());else{if(e===vu)throw new Error(Lp);e===Xv?(t=Nr(),t.value=t.value==="true",n=tp(t)):e===Qv?(t=Nr(),t.value=null,n=tp(t)):Ct("/")||Ct("/=")?(n=tp(que()),CI()):Jv(Nr())}return n}function rle(){const e=[];if(Jn("("),!Ct(")"))for(;Z<Kn&&(e.push(Tl()),!Ct(")"));)Jn(",");return Jn(")"),e}function ile(){Z=pt.start;const e=Nr();return Hue(e)||Jv(e),M$(e.value)}function ole(){return Jn("."),ile()}function sle(){Jn("[");const e=T$();return Jn("]"),e}function ale(){var e,t,n;for(e=nle();;)if(Ct("."))n=ole(),e=PR(".",e,n);else if(Ct("("))t=rle(),e=Vue(e,t);else if(Ct("["))n=sle(),e=PR("[",e,n);else break;return e}function IR(){const e=ale();if(pt.type===Dr&&(Ct("++")||Ct("--")))throw new Error(Lp);return e}function l1(){var e,t;if(pt.type!==Dr&&pt.type!==vu)t=IR();else{if(Ct("++")||Ct("--"))throw new Error(Lp);if(Ct("+")||Ct("-")||Ct("~")||Ct("!"))e=Nr(),t=l1(),t=Que(e.value,t);else{if(nb("delete")||nb("void")||nb("typeof"))throw new Error(Lp);t=IR()}}return t}function BR(e){let t=0;if(e.type!==Dr&&e.type!==vu)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function ule(){var e,t,n,r,i,o,s,a,u,c;if(e=pt,u=l1(),r=pt,i=BR(r),i===0)return u;for(r.prec=i,Nr(),t=[e,pt],s=l1(),o=[u,r,s];(i=BR(pt))>0;){for(;o.length>2&&i<=o[o.length-2].prec;)s=o.pop(),a=o.pop().value,u=o.pop(),t.pop(),n=OR(a,u,s),o.push(n);r=Nr(),r.prec=i,o.push(r),t.push(pt),n=l1(),o.push(n)}for(c=o.length-1,n=o[c],t.pop();c>1;)t.pop(),n=OR(o[c-1].value,o[c-2],n),c-=2;return n}function Tl(){var e,t,n;return e=ule(),Ct("?")&&(Nr(),t=Tl(),Jn(":"),n=Tl(),e=Yue(e,t,n)),e}function T$(){const e=Tl();if(Ct(","))throw new Error(Lp);return e}function kI(e){ke=e,Z=0,Kn=ke.length,pt=null,CI();const t=T$();if(pt.type!==Ag)throw new Error("Unexpect token after expression.");return t}var $I={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function FI(e){function t(s,a,u,c){let f=e(a[0]);return u&&(f=u+"("+f+")",u.lastIndexOf("new ",0)===0&&(f="("+f+")")),f+"."+s+(c<0?"":c===0?"()":"("+a.slice(1).map(e).join(",")+")")}function n(s,a,u){return c=>t(s,c,a,u)}const r="new Date",i="String",o="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",hypot:"Math.hypot",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(s){s.length<3&&te("Missing arguments to clamp function."),s.length>3&&te("Too many arguments to clamp function.");const a=s.map(e);return"Math.max("+a[1]+", Math.min("+a[2]+","+a[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:r,date:n("getDate",r,0),day:n("getDay",r,0),year:n("getFullYear",r,0),month:n("getMonth",r,0),hours:n("getHours",r,0),minutes:n("getMinutes",r,0),seconds:n("getSeconds",r,0),milliseconds:n("getMilliseconds",r,0),time:n("getTime",r,0),timezoneoffset:n("getTimezoneOffset",r,0),utcdate:n("getUTCDate",r,0),utcday:n("getUTCDay",r,0),utcyear:n("getUTCFullYear",r,0),utcmonth:n("getUTCMonth",r,0),utchours:n("getUTCHours",r,0),utcminutes:n("getUTCMinutes",r,0),utcseconds:n("getUTCSeconds",r,0),utcmilliseconds:n("getUTCMilliseconds",r,0),length:n("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",i,0),lower:n("toLowerCase",i,0),substring:n("substring",i),split:n("split",i),trim:n("trim",i,0),btoa:"btoa",atob:"atob",regexp:o,test:n("test",o),if:function(s){s.length<3&&te("Missing arguments to if function."),s.length>3&&te("Too many arguments to if function.");const a=s.map(e);return"("+a[0]+"?"+a[1]+":"+a[2]+")"}}}function lle(e){const t=e&&e.length-1;return t&&(e[0]==='"'&&e[t]==='"'||e[0]==="'"&&e[t]==="'")?e.slice(1,-1):e}function DI(e){e=e||{};const t=e.allowed?oo(e.allowed):{},n=e.forbidden?oo(e.forbidden):{},r=e.constants||$I,i=(e.functions||FI)(h),o=e.globalvar,s=e.fieldvar,a=He(o)?o:y=>`${o}["${y}"]`;let u={},c={},f=0;function h(y){if(ve(y))return y;const v=p[y.type];return v==null&&te("Unsupported type: "+y.type),v(y)}const p={Literal:y=>y.raw,Identifier:y=>{const v=y.name;return f>0?v:Ee(n,v)?te("Illegal identifier: "+v):Ee(r,v)?r[v]:Ee(t,v)?v:(u[v]=1,a(v))},MemberExpression:y=>{const v=!y.computed,w=h(y.object);v&&(f+=1);const E=h(y.property);return w===s&&(c[lle(E)]=1),v&&(f-=1),w+(v?"."+E:"["+E+"]")},CallExpression:y=>{y.callee.type!=="Identifier"&&te("Illegal callee type: "+y.callee.type);const v=y.callee.name,w=y.arguments,E=Ee(i,v)&&i[v];return E||te("Unrecognized function: "+v),He(E)?E(w):E+"("+w.map(h).join(",")+")"},ArrayExpression:y=>"["+y.elements.map(h).join(",")+"]",BinaryExpression:y=>"("+h(y.left)+" "+y.operator+" "+h(y.right)+")",UnaryExpression:y=>"("+y.operator+h(y.argument)+")",ConditionalExpression:y=>"("+h(y.test)+"?"+h(y.consequent)+":"+h(y.alternate)+")",LogicalExpression:y=>"("+h(y.left)+y.operator+h(y.right)+")",ObjectExpression:y=>{for(const v of y.properties){const w=v.key.name;gA.has(w)&&te("Illegal property: "+w)}return"{"+y.properties.map(h).join(",")+"}"},Property:y=>{f+=1;const v=h(y.key);return f-=1,v+":"+h(y.value)}};function m(y){const v={code:h(y),globals:Object.keys(u),fields:Object.keys(c)};return u={},c={},v}return m.functions=i,m.constants=r,m}const UR=Symbol("vega_selection_getter");function MI(e){return(!e.getter||!e.getter[UR])&&(e.getter=ki(e.field),e.getter[UR]=!0),e.getter}const N$="intersect",jR="union",cle="vlMulti",fle="vlPoint",WR="or",dle="and",No="_vgsid_",Ip=ki(No),hle="E",ple="R",gle="R-E",mle="R-LE",yle="R-RE",vle="E-LT",xle="E-LTE",wle="E-GT",Ele="E-GTE",ble="E-VALID",Sle="E-ONE",$y="index:unit";function qR(e,t){for(var n=t.fields,r=t.values,i=n.length,o=0,s,a;o<i;++o)if(a=n[o],s=MI(a)(e),Ga(s)&&(s=Vn(s)),Ga(r[o])&&(r[o]=Vn(r[o])),ne(r[o])&&Ga(r[o][0])&&(r[o]=r[o].map(Vn)),a.type===hle){if(ne(r[o])?!r[o].includes(s):s!==r[o])return!1}else if(a.type===ple){if(!Jc(s,r[o]))return!1}else if(a.type===yle){if(!Jc(s,r[o],!0,!1))return!1}else if(a.type===gle){if(!Jc(s,r[o],!1,!1))return!1}else if(a.type===mle){if(!Jc(s,r[o],!1,!0))return!1}else if(a.type===vle){if(s>=r[o])return!1}else if(a.type===xle){if(s>r[o])return!1}else if(a.type===wle){if(s<=r[o])return!1}else if(a.type===Ele){if(s<r[o])return!1}else if(a.type===ble){if(s===null||isNaN(s))return!1}else if(a.type===Sle&&r[o].indexOf(s)===-1)return!1;return!0}function _le(e,t,n){for(var r=this.context.data[e],i=r?r.values.value:[],o=r?r[$y]&&r[$y].value:void 0,s=n===N$,a=i.length,u=0,c,f,h,p,m;u<a;++u)if(c=i[u],o&&s){if(f=f||{},h=f[p=c.unit]||0,h===-1)continue;if(m=qR(t,c),f[p]=m?-1:++h,m&&o.size===1)return!0;if(!m&&h===o.get(p).count)return!1}else if(m=qR(t,c),s^m)return m;return a&&s}const TI=nd(Ip),Ale=TI.left,Cle=TI.right;function kle(e,t,n){const r=this.context.data[e],i=r?r.values.value:[],o=r?r[$y]&&r[$y].value:void 0,s=n===N$,a=Ip(t),u=Ale(i,a);if(u===i.length||Ip(i[u])!==a)return!1;if(o&&s){if(o.size===1)return!0;if(Cle(i,a)-u<o.size)return!1}return!0}function $le(e,t){return e.map(n=>qe(t.fields?{values:t.fields.map(r=>MI(r)(n.datum))}:{[No]:Ip(n.datum)},t))}function Fle(e,t,n,r){for(var i=this.context.data[e],o=i?i.values.value:[],s={},a={},u={},c,f,h,p,m,y,v,w,E,S,A=o.length,C=0,k,D;C<A;++C)if(c=o[C],p=c.unit,f=c.fields,h=c.values,f&&h){for(k=0,D=f.length;k<D;++k)m=f[k],v=s[m.field]||(s[m.field]={}),w=v[p]||(v[p]=[]),u[m.field]=E=m.type.charAt(0),S=rb[`${E}_union`],v[p]=S(w,xe(h[k]));n&&(w=a[p]||(a[p]=[]),w.push(xe(h).reduce(($,M,T)=>($[f[T].field]=M,$),{})))}else m=No,y=Ip(c),v=s[m]||(s[m]={}),w=v[p]||(v[p]=[]),w.push(y),n&&(w=a[p]||(a[p]=[]),w.push({[No]:y}));if(t=t||jR,s[No]?s[No]=rb[`${No}_${t}`](...Object.values(s[No])):Object.keys(s).forEach($=>{s[$]=Object.keys(s[$]).map(M=>s[$][M]).reduce((M,T)=>M===void 0?T:rb[`${u[$]}_${t}`](M,T))}),o=Object.keys(a),n&&o.length){const $=r?fle:cle;s[$]=t===jR?{[WR]:o.reduce((M,T)=>(M.push(...a[T]),M),[])}:{[dle]:o.map(M=>({[WR]:a[M]}))}}return s}var rb={[`${No}_union`]:vV,[`${No}_intersect`]:mV,E_union:function(e,t){if(!e.length)return t;for(var n=0,r=t.length;n<r;++n)e.includes(t[n])||e.push(t[n]);return e},E_intersect:function(e,t){return e.length?e.filter(n=>t.includes(n)):t},R_union:function(e,t){var n=Vn(t[0]),r=Vn(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?(e[0]>n&&(e[0]=n),e[1]<r&&(e[1]=r),e):[n,r]},R_intersect:function(e,t){var n=Vn(t[0]),r=Vn(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?r<e[0]||e[1]<n?[]:(e[0]<n&&(e[0]=n),e[1]>r&&(e[1]=r),e):[n,r]}};const Dle=":",Mle="@";function R$(e,t,n,r){t[0].type!==Dl&&te("First argument to selection functions must be a string literal.");const i=t[0].value,o=t.length>=2&&Ze(t).value,s="unit",a=Mle+s,u=Dle+i;o===N$&&!Ee(r,a)&&(r[a]=n.getData(i).indataRef(n,s)),Ee(r,u)||(r[u]=n.getData(i).tuplesRef())}function NI(e){const t=this.context.data[e];return t?t.values.value:[]}function Tle(e,t,n){const r=this.context.data[e]["index:"+t],i=r?r.value.get(n):void 0;return i&&i.count}function Nle(e,t){const n=this.context.dataflow,r=this.context.data[e],i=r.input;return n.pulse(i,n.changeset().remove($i).insert(t)),1}function Rle(e,t,n){if(e){const r=this.context.dataflow,i=e.mark.source;r.pulse(i,r.changeset().encode(e,t))}return n!==void 0?n:e}const $g=e=>function(t,n){const r=this.context.dataflow.locale();return t===null?"null":r[e](n)(t)},Ole=$g("format"),RI=$g("timeFormat"),Ple=$g("utcFormat"),Lle=$g("timeParse"),zle=$g("utcParse"),Fm=new Date(2e3,0,1);function Zv(e,t,n){return!Number.isInteger(e)||!Number.isInteger(t)?"":(Fm.setYear(2e3),Fm.setMonth(e),Fm.setDate(t),RI.call(this,Fm,n))}function Ile(e){return Zv.call(this,e,1,"%B")}function Ble(e){return Zv.call(this,e,1,"%b")}function Ule(e){return Zv.call(this,0,2+e,"%A")}function jle(e){return Zv.call(this,0,2+e,"%a")}const Wle=":",qle="@",w_="%",OI="$";function O$(e,t,n,r){t[0].type!==Dl&&te("First argument to data functions must be a string literal.");const i=t[0].value,o=Wle+i;if(!Ee(o,r))try{r[o]=n.getData(i).tuplesRef()}catch{}}function Hle(e,t,n,r){t[0].type!==Dl&&te("First argument to indata must be a string literal."),t[1].type!==Dl&&te("Second argument to indata must be a string literal.");const i=t[0].value,o=t[1].value,s=qle+o;Ee(s,r)||(r[s]=n.getData(i).indataRef(n,o))}function mr(e,t,n,r){if(t[0].type===Dl)HR(n,r,t[0].value);else for(e in n.scales)HR(n,r,e)}function HR(e,t,n){const r=w_+n;if(!Ee(t,r))try{t[r]=e.scaleRef(n)}catch{}}function ss(e,t){if(ve(e)){const n=t.scales[e];return n&&YT(n.value)?n.value:void 0}else if(He(e))return YT(e)?e:void 0}function Gle(e,t,n){t.__bandwidth=i=>i&&i.bandwidth?i.bandwidth():0,n._bandwidth=mr,n._range=mr,n._scale=mr;const r=i=>"_["+(i.type===Dl?de(w_+i.value):de(w_)+"+"+e(i))+"]";return{_bandwidth:i=>`this.__bandwidth(${r(i[0])})`,_range:i=>`${r(i[0])}.range()`,_scale:i=>`${r(i[0])}(${e(i[1])})`}}function P$(e,t){return function(n,r,i){if(n){const o=ss(n,(i||this).context);return o&&o.path[e](r)}else return t(r)}}const Vle=P$("area",fre),Yle=P$("bounds",gre),Xle=P$("centroid",Ere);function Qle(e,t){const n=ss(e,(t||this).context);return n&&n.scale()}function Kle(e){const t=this.context.group;let n=!1;if(t)for(;e;){if(e===t){n=!0;break}e=e.mark.group}return n}function L$(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(r){e.warn(r)}return n[n.length-1]}function Jle(){return L$(this.context.dataflow,"warn",arguments)}function Zle(){return L$(this.context.dataflow,"info",arguments)}function ece(){return L$(this.context.dataflow,"debug",arguments)}function ib(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}function E_(e){const t=nu(e),n=ib(t.r),r=ib(t.g),i=ib(t.b);return .2126*n+.7152*r+.0722*i}function tce(e,t){const n=E_(e),r=E_(t),i=Math.max(n,r),o=Math.min(n,r);return(i+.05)/(o+.05)}function nce(){const e=[].slice.call(arguments);return e.unshift({}),qe(...e)}function PI(e,t){return e===t||e!==e&&t!==t?!0:ne(e)?ne(t)&&e.length===t.length?rce(e,t):!1:ye(e)&&ye(t)?LI(e,t):!1}function rce(e,t){for(let n=0,r=e.length;n<r;++n)if(!PI(e[n],t[n]))return!1;return!0}function LI(e,t){for(const n in e)if(!PI(e[n],t[n]))return!1;return!0}function GR(e){return t=>LI(e,t)}function ice(e,t,n,r,i,o){const s=this.context.dataflow,a=this.context.data[e],u=a.input,c=s.stamp();let f=a.changes,h,p;if(s._trigger===!1||!(u.value.length||t||r))return 0;if((!f||f.stamp<c)&&(a.changes=f=s.changeset(),f.stamp=c,s.runAfter(()=>{a.modified=!0,s.pulse(u,f).run()},!0,1)),n&&(h=n===!0?$i:ne(n)||uv(n)?n:GR(n),f.remove(h)),t&&f.insert(t),r&&(h=GR(r),u.value.some(h)?f.remove(h):f.insert(r)),i)for(p in o)f.modify(i,p,o[p]);return 1}function oce(e){const t=e.touches,n=t[0].clientX-t[1].clientX,r=t[0].clientY-t[1].clientY;return Math.hypot(n,r)}function sce(e){const t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)}const VR={};function ace(e,t){const n=VR[t]||(VR[t]=ki(t));return ne(e)?e.map(n):n(e)}function ex(e){return ne(e)||ArrayBuffer.isView(e)?e:null}function z$(e){return ex(e)||(ve(e)?e:null)}function uce(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return ex(e).join(...n)}function lce(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return z$(e).indexOf(...n)}function cce(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return z$(e).lastIndexOf(...n)}function fce(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return z$(e).slice(...n)}function dce(e,t,n){return He(n)&&te("Function argument passed to replace."),!ve(t)&&!_A(t)&&te("Please pass a string or RegExp argument to replace."),String(e).replace(t,n)}function hce(e){return ex(e).slice().reverse()}function pce(e){return ex(e).slice().sort(ed)}function gce(e,t,n){return JC(e||0,t||0,n||0)}function mce(e,t){const n=ss(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0}function yce(e,t){const n=ss(e,(t||this).context);return n?n.copy():void 0}function vce(e,t){const n=ss(e,(t||this).context);return n?n.domain():[]}function xce(e,t,n){const r=ss(e,(n||this).context);return r?ne(t)?(r.invertRange||r.invert)(t):(r.invert||r.invertExtent)(t):void 0}function wce(e,t){const n=ss(e,(t||this).context);return n&&n.range?n.range():[]}function Ece(e,t,n){const r=ss(e,(n||this).context);return r?r(t):void 0}function bce(e,t,n,r,i){e=ss(e,(i||this).context);const o=CL(t,n);let s=e.domain(),a=s[0],u=Ze(s),c=tr;return u-a?c=pL(e,a,u):e=(e.interpolator?lt("sequential")().interpolator(e.interpolator()):lt("linear")().interpolate(e.interpolate()).range(e.range())).domain([a=0,u=1]),e.ticks&&(s=e.ticks(+r||15),a!==s[0]&&s.unshift(a),u!==Ze(s)&&s.push(u)),s.forEach(f=>o.stop(c(f),e(f))),o}function Sce(e,t,n){const r=ss(e,(n||this).context);return function(i){return r?r.path.context(i)(t):""}}function _ce(e){let t=null;return function(n){return n?Fp(n,t=t||kf(e)):e}}const zI=e=>e.data;function II(e,t){const n=NI.call(t,e);return n.root&&n.root.lookup||{}}function Ace(e,t,n){const r=II(e,this),i=r[t],o=r[n];return i&&o?i.path(o).map(zI):void 0}function Cce(e,t){const n=II(e,this)[t];return n?n.ancestors().map(zI):void 0}const BI=()=>typeof window<"u"&&window||null;function kce(){const e=BI();return e?e.screen:{}}function $ce(){const e=BI();return e?[e.innerWidth,e.innerHeight]:[void 0,void 0]}function Fce(){const e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[void 0,void 0]}function UI(e,t,n){if(!e)return[];const[r,i]=e,o=new Jt().set(r[0],r[1],i[0],i[1]),s=n||this.context.dataflow.scenegraph().root;return S7(s,o,Dce(t))}function Dce(e){let t=null;if(e){const n=xe(e.marktype),r=xe(e.markname);t=i=>(!n.length||n.some(o=>i.marktype===o))&&(!r.length||r.some(o=>i.name===o))}return t}function Mce(e,t,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:5;e=xe(e);const i=e[e.length-1];return i===void 0||Math.hypot(i[0]-t,i[1]-n)>r?[...e,[t,n]]:e}function Tce(e){return xe(e).reduce((t,n,r)=>{let[i,o]=n;return t+=r==0?`M ${i},${o} `:r===e.length-1?" Z":`L ${i},${o} `},"")}function Nce(e,t,n){const{x:r,y:i,mark:o}=n,s=new Jt().set(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER,Number.MIN_SAFE_INTEGER);for(const[u,c]of t)u<s.x1&&(s.x1=u),u>s.x2&&(s.x2=u),c<s.y1&&(s.y1=c),c>s.y2&&(s.y2=c);return s.translate(r,i),UI([[s.x1,s.y1],[s.x2,s.y2]],e,o).filter(u=>Rce(u.x,u.y,t))}function Rce(e,t,n){let r=0;for(let i=0,o=n.length-1;i<n.length;o=i++){const[s,a]=n[o],[u,c]=n[i];c>t!=a>t&&e<(s-u)*(t-c)/(a-c)+u&&r++}return r&1}const Bp={random(){return Di()},cumulativeNormal:hv,cumulativeLogNormal:JA,cumulativeUniform:nC,densityNormal:VA,densityLogNormal:KA,densityUniform:tC,quantileNormal:pv,quantileLogNormal:ZA,quantileUniform:rC,sampleNormal:dv,sampleLogNormal:QA,sampleUniform:eC,isArray:ne,isBoolean:hu,isDate:Ga,isDefined(e){return e!==void 0},isNumber:at,isObject:ye,isRegExp:_A,isString:ve,isTuple:uv,isValid(e){return e!=null&&e===e},toBoolean:CA,toDate(e){return kA(e)},toNumber:Vn,toString:$A,indexof:lce,join:uce,lastindexof:cce,replace:dce,reverse:hce,sort:pce,slice:fce,flush:G4,lerp:Y4,merge:nce,pad:K4,peek:Ze,pluck:ace,span:tg,inrange:Jc,truncate:J4,rgb:nu,lab:R1,hcl:O1,hsl:T1,luminance:E_,contrast:tce,sequence:ei,format:Ole,utcFormat:Ple,utcParse:zle,utcOffset:M8,utcSequence:R8,timeFormat:RI,timeParse:Lle,timeOffset:D8,timeSequence:N8,timeUnitSpecifier:x8,monthFormat:Ile,monthAbbrevFormat:Ble,dayFormat:Ule,dayAbbrevFormat:jle,quarter:j4,utcquarter:W4,week:E8,utcweek:_8,dayofyear:w8,utcdayofyear:S8,warn:Jle,info:Zle,debug:ece,extent(e){return Ho(e)},inScope:Kle,intersect:UI,clampRange:q4,pinchDistance:oce,pinchAngle:sce,screen:kce,containerSize:Fce,windowSize:$ce,bandspace:gce,setdata:Nle,pathShape:_ce,panLinear:z4,panLog:I4,panPow:B4,panSymlog:U4,zoomLinear:xA,zoomLog:wA,zoomPow:x1,zoomSymlog:EA,encode:Rle,modify:ice,lassoAppend:Mce,lassoPath:Tce,intersectLasso:Nce},Oce=["view","item","group","xy","x","y"],Pce="event.vega.",jI="this.",I$={},WI={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:e=>`_[${de(OI+e)}]`,functions:Lce,constants:$I,visitors:I$},b_=DI(WI);function Lce(e){const t=FI(e);Oce.forEach(n=>t[n]=Pce+n);for(const n in Bp)t[n]=jI+n;return qe(t,Gle(e,Bp,I$)),t}function Qt(e,t,n){return arguments.length===1?Bp[e]:(Bp[e]=t,n&&(I$[e]=n),b_&&(b_.functions[e]=jI+e),this)}Qt("bandwidth",mce,mr);Qt("copy",yce,mr);Qt("domain",vce,mr);Qt("range",wce,mr);Qt("invert",xce,mr);Qt("scale",Ece,mr);Qt("gradient",bce,mr);Qt("geoArea",Vle,mr);Qt("geoBounds",Yle,mr);Qt("geoCentroid",Xle,mr);Qt("geoShape",Sce,mr);Qt("geoScale",Qle,mr);Qt("indata",Tle,Hle);Qt("data",NI,O$);Qt("treePath",Ace,O$);Qt("treeAncestors",Cce,O$);Qt("vlSelectionTest",_le,R$);Qt("vlSelectionIdTest",kle,R$);Qt("vlSelectionResolve",Fle,R$);Qt("vlSelectionTuples",$le);function Qo(e,t){const n={};let r;try{e=ve(e)?e:de(e)+"",r=kI(e)}catch{te("Expression parse error: "+e)}r.visit(o=>{if(o.type!==wI)return;const s=o.callee.name,a=WI.visitors[s];a&&a(s,o.arguments,t,n)});const i=b_(r);return i.globals.forEach(o=>{const s=OI+o;!Ee(n,s)&&t.getSignal(o)&&(n[s]=t.signalRef(o))}),{$expr:qe({code:i.code},t.options.ast?{ast:r}:null),$fields:i.fields,$params:n}}function zce(e){const t=this,n=e.operators||[];return e.background&&(t.background=e.background),e.eventConfig&&(t.eventConfig=e.eventConfig),e.locale&&(t.locale=e.locale),n.forEach(r=>t.parseOperator(r)),n.forEach(r=>t.parseOperatorParameters(r)),(e.streams||[]).forEach(r=>t.parseStream(r)),(e.updates||[]).forEach(r=>t.parseUpdate(r)),t.resolve()}const Ice=oo(["rule"]),YR=oo(["group","image","rect"]);function Bce(e,t){let n="";return Ice[t]||(e.x2&&(e.x?(YR[t]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),e.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),e.y2&&(e.y?(YR[t]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),e.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}function B$(e){return(e+"").toLowerCase()}function Uce(e){return B$(e)==="operator"}function jce(e){return B$(e)==="collect"}function _h(e,t,n){n.endsWith(";")||(n="return("+n+");");const r=Function(...t.concat(n));return e&&e.functions?r.bind(e.functions):r}function Wce(e,t,n,r){return`((u = ${e}) < (v = ${t}) || u == null) && v != null ? ${n}
  : (u > v || v == null) && u != null ? ${r}
  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ${n}
  : v !== v && u === u ? ${r} : `}var qce={operator:(e,t)=>_h(e,["_"],t.code),parameter:(e,t)=>_h(e,["datum","_"],t.code),event:(e,t)=>_h(e,["event"],t.code),handler:(e,t)=>{const n=`var datum=event.item&&event.item.datum;return ${t.code};`;return _h(e,["_","event"],n)},encode:(e,t)=>{const{marktype:n,channels:r}=t;let i="var o=item,datum=o.datum,m=0,$;";for(const o in r){const s="o["+de(o)+"]";i+=`$=${r[o].code};if(${s}!==$)${s}=$,m=1;`}return i+=Bce(r,n),i+="return m;",_h(e,["item","_"],i)},codegen:{get(e){const t=`[${e.map(de).join("][")}]`,n=Function("_",`return _${t};`);return n.path=t,n},comparator(e,t){let n;const r=(o,s)=>{const a=t[s];let u,c;return o.path?(u=`a${o.path}`,c=`b${o.path}`):((n=n||{})["f"+s]=o,u=`this.f${s}(a)`,c=`this.f${s}(b)`),Wce(u,c,-a,a)},i=Function("a","b","var u, v; return "+e.map(r).join("")+"0;");return n?i.bind(n):i}}};function Hce(e){const t=this;Uce(e.type)||!e.type?t.operator(e,e.update?t.operatorExpression(e.update):null):t.transform(e,e.type)}function Gce(e){const t=this;if(e.params){const n=t.get(e.id);n||te("Invalid operator id: "+e.id),t.dataflow.connect(n,n.parameters(t.parseParameters(e.params),e.react,e.initonly))}}function Vce(e,t){t=t||{};const n=this;for(const r in e){const i=e[r];t[r]=ne(i)?i.map(o=>XR(o,n,t)):XR(i,n,t)}return t}function XR(e,t,n){if(!e||!ye(e))return e;for(let r=0,i=QR.length,o;r<i;++r)if(o=QR[r],Ee(e,o.key))return o.parse(e,t,n);return e}var QR=[{key:"$ref",parse:Yce},{key:"$key",parse:Qce},{key:"$expr",parse:Xce},{key:"$field",parse:Kce},{key:"$encode",parse:Zce},{key:"$compare",parse:Jce},{key:"$context",parse:efe},{key:"$subflow",parse:tfe},{key:"$tupleid",parse:nfe}];function Yce(e,t){return t.get(e.$ref)||te("Operator not defined: "+e.$ref)}function Xce(e,t,n){e.$params&&t.parseParameters(e.$params,n);const r="e:"+e.$expr.code;return t.fn[r]||(t.fn[r]=qr(t.parameterExpression(e.$expr),e.$fields))}function Qce(e,t){const n="k:"+e.$key+"_"+!!e.$flat;return t.fn[n]||(t.fn[n]=AA(e.$key,e.$flat,t.expr.codegen))}function Kce(e,t){if(!e.$field)return null;const n="f:"+e.$field+"_"+e.$name;return t.fn[n]||(t.fn[n]=ki(e.$field,e.$name,t.expr.codegen))}function Jce(e,t){const n="c:"+e.$compare+"_"+e.$order,r=xe(e.$compare).map(i=>i&&i.$tupleid?Te:i);return t.fn[n]||(t.fn[n]=bA(r,e.$order,t.expr.codegen))}function Zce(e,t){const n=e.$encode,r={};for(const i in n){const o=n[i];r[i]=qr(t.encodeExpression(o.$expr),o.$fields),r[i].output=o.$output}return r}function efe(e,t){return t}function tfe(e,t){const n=e.$subflow;return function(r,i,o){const s=t.fork().parse(n),a=s.get(n.operators[0].id),u=s.signals.parent;return u&&u.set(o),a.detachSubflow=()=>t.detach(s),a}}function nfe(){return Te}function rfe(e){var t=this,n=e.filter!=null?t.eventExpression(e.filter):void 0,r=e.stream!=null?t.get(e.stream):void 0,i;e.source?r=t.events(e.source,e.type,n):e.merge&&(i=e.merge.map(o=>t.get(o)),r=i[0].merge.apply(i[0],i.slice(1))),e.between&&(i=e.between.map(o=>t.get(o)),r=r.between(i[0],i[1])),e.filter&&(r=r.filter(n)),e.throttle!=null&&(r=r.throttle(+e.throttle)),e.debounce!=null&&(r=r.debounce(+e.debounce)),r==null&&te("Invalid stream definition: "+JSON.stringify(e)),e.consume&&r.consume(!0),t.stream(e,r)}function ife(e){var t=this,n=ye(n=e.source)?n.$ref:n,r=t.get(n),i=null,o=e.update,s=void 0;r||te("Source not defined: "+e.source),i=e.target&&e.target.$expr?t.eventExpression(e.target.$expr):t.get(e.target),o&&o.$expr&&(o.$params&&(s=t.parseParameters(o.$params)),o=t.handlerExpression(o.$expr)),t.update(e,r,i,o,s)}const ofe={skip:!0};function sfe(e){var t=this,n={};if(e.signals){var r=n.signals={};Object.keys(t.signals).forEach(o=>{const s=t.signals[o];e.signals(o,s)&&(r[o]=s.value)})}if(e.data){var i=n.data={};Object.keys(t.data).forEach(o=>{const s=t.data[o];e.data(o,s)&&(i[o]=s.input.value)})}return t.subcontext&&e.recurse!==!1&&(n.subcontext=t.subcontext.map(o=>o.getState(e))),n}function afe(e){var t=this,n=t.dataflow,r=e.data,i=e.signals;Object.keys(i||{}).forEach(o=>{n.update(t.signals[o],i[o],ofe)}),Object.keys(r||{}).forEach(o=>{n.pulse(t.data[o].input,n.changeset().remove($i).insert(r[o]))}),(e.subcontext||[]).forEach((o,s)=>{const a=t.subcontext[s];a&&a.setState(o)})}function qI(e,t,n,r){return new HI(e,t,n,r)}function HI(e,t,n,r){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.expr=r||qce,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function KR(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.events=e.events,this.expr=e.expr,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}HI.prototype=KR.prototype={fork(){const e=new KR(this);return(this.subcontext||(this.subcontext=[])).push(e),e},detach(e){this.subcontext=this.subcontext.filter(n=>n!==e);const t=Object.keys(e.nodes);for(const n of t)e.nodes[n]._targets=null;for(const n of t)e.nodes[n].detach();e.nodes=null},get(e){return this.nodes[e]},set(e,t){return this.nodes[e]=t},add(e,t){const n=this,r=n.dataflow,i=e.value;if(n.set(e.id,t),jce(e.type)&&i&&(i.$ingest?r.ingest(t,i.$ingest,i.$format):i.$request?r.preload(t,i.$request,i.$format):r.pulse(t,r.changeset().insert(i))),e.root&&(n.root=t),e.parent){let o=n.get(e.parent.$ref);o?(r.connect(o,[t]),t.targets().add(o)):(n.unresolved=n.unresolved||[]).push(()=>{o=n.get(e.parent.$ref),r.connect(o,[t]),t.targets().add(o)})}if(e.signal&&(n.signals[e.signal]=t),e.scale&&(n.scales[e.scale]=t),e.data)for(const o in e.data){const s=n.data[o]||(n.data[o]={});e.data[o].forEach(a=>s[a]=t)}},resolve(){return(this.unresolved||[]).forEach(e=>e()),delete this.unresolved,this},operator(e,t){this.add(e,this.dataflow.add(e.value,t))},transform(e,t){this.add(e,this.dataflow.add(this.transforms[B$(t)]))},stream(e,t){this.set(e.id,t)},update(e,t,n,r,i){this.dataflow.on(t,n,r,i,e.options)},operatorExpression(e){return this.expr.operator(this,e)},parameterExpression(e){return this.expr.parameter(this,e)},eventExpression(e){return this.expr.event(this,e)},handlerExpression(e){return this.expr.handler(this,e)},encodeExpression(e){return this.expr.encode(this,e)},parse:zce,parseOperator:Hce,parseOperatorParameters:Gce,parseParameters:Vce,parseStream:rfe,parseUpdate:ife,getState:sfe,setState:afe};function ufe(e){const t=e.container();t&&(t.setAttribute("role","graphics-document"),t.setAttribute("aria-roleDescription","visualization"),GI(t,e.description()))}function GI(e,t){e&&(t==null?e.removeAttribute("aria-label"):e.setAttribute("aria-label",t))}function lfe(e){e.add(null,t=>(e._background=t.bg,e._resize=1,t.bg),{bg:e._signals.background})}const ob="default";function cfe(e){const t=e._signals.cursor||(e._signals.cursor=e.add({user:ob,item:null}));e.on(e.events("view","pointermove"),t,(n,r)=>{const i=t.value,o=i?ve(i)?i:i.user:ob,s=r.item&&r.item.cursor||null;return i&&o===i.user&&s==i.item?i:{user:o,item:s}}),e.add(null,function(n){let r=n.cursor,i=this.value;return ve(r)||(i=r.item,r=r.user),S_(e,r&&r!==ob?r:i||r),i},{cursor:t})}function S_(e,t){const n=e.globalCursor()?typeof document<"u"&&document.body:e.container();if(n)return t==null?n.style.removeProperty("cursor"):n.style.cursor=t}function Fy(e,t){var n=e._runtime.data;return Ee(n,t)||te("Unrecognized data set: "+t),n[t]}function ffe(e,t){return arguments.length<2?Fy(this,e).values.value:tx.call(this,e,Xl().remove($i).insert(t))}function tx(e,t){aP(t)||te("Second argument to changes must be a changeset.");const n=Fy(this,e);return n.modified=!0,this.pulse(n.input,t)}function dfe(e,t){return tx.call(this,e,Xl().insert(t))}function hfe(e,t){return tx.call(this,e,Xl().remove(t))}function VI(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function YI(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function nx(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}function pfe(e){var t=nx(e),n=VI(e),r=YI(e);e._renderer.background(e.background()),e._renderer.resize(n,r,t),e._handler.origin(t),e._resizeListeners.forEach(i=>{try{i(n,r)}catch(o){e.error(o)}})}function gfe(e,t,n){var r=e._renderer,i=r&&r.canvas(),o,s,a;return i&&(a=nx(e),s=t.changedTouches?t.changedTouches[0]:t,o=Uv(s,i),o[0]-=a[0],o[1]-=a[1]),t.dataflow=e,t.item=n,t.vega=mfe(e,n,o),t}function mfe(e,t,n){const r=t?t.mark.marktype==="group"?t:t.mark.group:null;function i(s){var a=r,u;if(s){for(u=t;u;u=u.mark.group)if(u.mark.name===s){a=u;break}}return a&&a.mark&&a.mark.interactive?a:{}}function o(s){if(!s)return n;ve(s)&&(s=i(s));const a=n.slice();for(;s;)a[0]-=s.x||0,a[1]-=s.y||0,s=s.mark&&s.mark.group;return a}return{view:nr(e),item:nr(t||{}),group:i,xy:o,x:s=>o(s)[0],y:s=>o(s)[1]}}const JR="view",yfe="timer",vfe="window",xfe={trap:!1};function wfe(e){const t=qe({defaults:{}},e),n=(r,i)=>{i.forEach(o=>{ne(r[o])&&(r[o]=oo(r[o]))})};return n(t.defaults,["prevent","allow"]),n(t,["view","window","selector"]),t}function XI(e,t,n,r){e._eventListeners.push({type:n,sources:xe(t),handler:r})}function Efe(e,t){var n=e._eventConfig.defaults,r=n.prevent,i=n.allow;return r===!1||i===!0?!1:r===!0||i===!1?!0:r?r[t]:i?!i[t]:e.preventDefault()}function Dm(e,t,n){const r=e._eventConfig&&e._eventConfig[t];return r===!1||ye(r)&&!r[n]?(e.warn(`Blocked ${t} ${n} event listener.`),!1):!0}function bfe(e,t,n){var r=this,i=new fv(n),o=function(c,f){r.runAsync(null,()=>{e===JR&&Efe(r,t)&&c.preventDefault(),i.receive(gfe(r,c,f))})},s;if(e===yfe)Dm(r,"timer",t)&&r.timer(o,t);else if(e===JR)Dm(r,"view",t)&&r.addEventListener(t,o,xfe);else if(e===vfe?Dm(r,"window",t)&&typeof window<"u"&&(s=[window]):typeof document<"u"&&Dm(r,"selector",t)&&(s=Array.from(document.querySelectorAll(e))),!s)r.warn("Can not resolve event source: "+e);else{for(var a=0,u=s.length;a<u;++a)s[a].addEventListener(t,o);XI(r,s,t,o)}return i}function ZR(e){return e.item}function e6(e){return e.item.mark.source}function t6(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}function Sfe(e,t){return e=[e||"hover"],t=[t||"update",e[0]],this.on(this.events("view","pointerover",ZR),e6,t6(e)),this.on(this.events("view","pointerout",ZR),e6,t6(t)),this}function _fe(){var e=this._tooltip,t=this._timers,n=this._handler.handlers(),r=this._eventListeners,i,o,s,a,u;for(i=t.length;--i>=0;)t[i].stop();for(i=r.length;--i>=0;)for(s=r[i],o=s.sources.length;--o>=0;)s.sources[o].removeEventListener(s.type,s.handler);for(e&&e.call(this,this._handler,null,null,null),i=n.length;--i>=0;)u=n[i].type,a=n[i].handler,this._handler.off(u,a);return this}function ii(e,t,n){const r=document.createElement(e);for(const i in t)r.setAttribute(i,t[i]);return n!=null&&(r.textContent=n),r}const Afe="vega-bind",Cfe="vega-bind-name",kfe="vega-bind-radio";function $fe(e,t,n){if(!t)return;const r=n.param;let i=n.state;return i||(i=n.state={elements:null,active:!1,set:null,update:s=>{s!=e.signal(r.signal)&&e.runAsync(null,()=>{i.source=!0,e.signal(r.signal,s)})}},r.debounce&&(i.update=SA(r.debounce,i.update))),(r.input==null&&r.element?Ffe:Mfe)(i,t,r,e),i.active||(e.on(e._signals[r.signal],null,()=>{i.source?i.source=!1:i.set(e.signal(r.signal))}),i.active=!0),i}function Ffe(e,t,n,r){const i=n.event||"input",o=()=>e.update(t.value);r.signal(n.signal,t.value),t.addEventListener(i,o),XI(r,t,i,o),e.set=s=>{t.value=s,t.dispatchEvent(Dfe(i))}}function Dfe(e){return typeof Event<"u"?new Event(e):{type:e}}function Mfe(e,t,n,r){const i=r.signal(n.signal),o=ii("div",{class:Afe}),s=n.input==="radio"?o:o.appendChild(ii("label"));s.appendChild(ii("span",{class:Cfe},n.name||n.signal)),t.appendChild(o);let a=Tfe;switch(n.input){case"checkbox":a=Nfe;break;case"select":a=Rfe;break;case"radio":a=Ofe;break;case"range":a=Pfe;break}a(e,s,n,i)}function Tfe(e,t,n,r){const i=ii("input");for(const o in n)o!=="signal"&&o!=="element"&&i.setAttribute(o==="input"?"type":o,n[o]);i.setAttribute("name",n.signal),i.value=r,t.appendChild(i),i.addEventListener("input",()=>e.update(i.value)),e.elements=[i],e.set=o=>i.value=o}function Nfe(e,t,n,r){const i={type:"checkbox",name:n.signal};r&&(i.checked=!0);const o=ii("input",i);t.appendChild(o),o.addEventListener("change",()=>e.update(o.checked)),e.elements=[o],e.set=s=>o.checked=!!s||null}function Rfe(e,t,n,r){const i=ii("select",{name:n.signal}),o=n.labels||[];n.options.forEach((s,a)=>{const u={value:s};Dy(s,r)&&(u.selected=!0),i.appendChild(ii("option",u,(o[a]||s)+""))}),t.appendChild(i),i.addEventListener("change",()=>{e.update(n.options[i.selectedIndex])}),e.elements=[i],e.set=s=>{for(let a=0,u=n.options.length;a<u;++a)if(Dy(n.options[a],s)){i.selectedIndex=a;return}}}function Ofe(e,t,n,r){const i=ii("span",{class:kfe}),o=n.labels||[];t.appendChild(i),e.elements=n.options.map((s,a)=>{const u={type:"radio",name:n.signal,value:s};Dy(s,r)&&(u.checked=!0);const c=ii("input",u);c.addEventListener("change",()=>e.update(s));const f=ii("label",{},(o[a]||s)+"");return f.prepend(c),i.appendChild(f),c}),e.set=s=>{const a=e.elements,u=a.length;for(let c=0;c<u;++c)Dy(a[c].value,s)&&(a[c].checked=!0)}}function Pfe(e,t,n,r){r=r!==void 0?r:(+n.max+ +n.min)/2;const i=n.max!=null?n.max:Math.max(100,+r)||100,o=n.min||Math.min(0,i,+r)||0,s=n.step||Za(o,i,100),a=ii("input",{type:"range",name:n.signal,min:o,max:i,step:s});a.value=r;const u=ii("span",{},+r);t.appendChild(a),t.appendChild(u);const c=()=>{u.textContent=a.value,e.update(+a.value)};a.addEventListener("input",c),a.addEventListener("change",c),e.elements=[a],e.set=f=>{a.value=f,u.textContent=f}}function Dy(e,t){return e===t||e+""==t+""}function QI(e,t,n,r,i,o){return t=t||new r(e.loader()),t.initialize(n,VI(e),YI(e),nx(e),i,o).background(e.background())}function U$(e,t){return t?function(){try{t.apply(this,arguments)}catch(n){e.error(n)}}:null}function Lfe(e,t,n,r){const i=new r(e.loader(),U$(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,nx(e),e);return t&&t.handlers().forEach(o=>{i.on(o.type,o.handler)}),i}function zfe(e,t){const n=this,r=n._renderType,i=n._eventConfig.bind,o=jv(r);e=n._el=e?sb(n,e,!0):null,ufe(n),o||n.error("Unrecognized renderer type: "+r);const s=o.handler||wg,a=e?o.renderer:o.headless;return n._renderer=a?QI(n,n._renderer,e,a):null,n._handler=Lfe(n,n._handler,e,s),n._redraw=!0,e&&i!=="none"&&(t=t?n._elBind=sb(n,t,!0):e.appendChild(ii("form",{class:"vega-bindings"})),n._bind.forEach(u=>{u.param.element&&i!=="container"&&(u.element=sb(n,u.param.element,!!u.param.input))}),n._bind.forEach(u=>{$fe(n,u.element||t,u)})),n}function sb(e,t,n){if(typeof t=="string")if(typeof document<"u"){if(t=document.querySelector(t),!t)return e.error("Signal bind element not found: "+t),null}else return e.error("DOM document instance not found."),null;if(t&&n)try{t.textContent=""}catch(r){t=null,e.error(r)}return t}const Ah=e=>+e||0,Ife=e=>({top:e,bottom:e,left:e,right:e});function n6(e){return ye(e)?{top:Ah(e.top),bottom:Ah(e.bottom),left:Ah(e.left),right:Ah(e.right)}:Ife(Ah(e))}async function j$(e,t,n,r){const i=jv(t),o=i&&i.headless;return o||te("Unrecognized renderer type: "+t),await e.runAsync(),QI(e,null,null,o,n,r).renderAsync(e._scenegraph.root)}async function Bfe(e,t){e!==Ba.Canvas&&e!==Ba.SVG&&e!==Ba.PNG&&te("Unrecognized image type: "+e);const n=await j$(this,e,t);return e===Ba.SVG?Ufe(n.svg(),"image/svg+xml"):n.canvas().toDataURL("image/png")}function Ufe(e,t){const n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}async function jfe(e,t){return(await j$(this,Ba.Canvas,e,t)).canvas()}async function Wfe(e){return(await j$(this,Ba.SVG,e)).svg()}function qfe(e,t,n){return qI(e,Ef,Bp,n).parse(t)}function Hfe(e){var t=this._runtime.scales;return Ee(t,e)||te("Unrecognized scale or projection: "+e),t[e].value}var KI="width",JI="height",W$="padding",r6={skip:!0};function ZI(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===W$?r.left+r.right:0)}function eB(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===W$?r.top+r.bottom:0)}function Gfe(e){var t=e._signals,n=t[KI],r=t[JI],i=t[W$];function o(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,a=>{e._width=a.size,e._viewWidth=ZI(e,a.size),o()},{size:n}),e._resizeHeight=e.add(null,a=>{e._height=a.size,e._viewHeight=eB(e,a.size),o()},{size:r});const s=e.add(null,o,{pad:i});e._resizeWidth.rank=n.rank+1,e._resizeHeight.rank=r.rank+1,s.rank=i.rank+1}function Vfe(e,t,n,r,i,o){this.runAfter(s=>{let a=0;s._autosize=0,s.width()!==n&&(a=1,s.signal(KI,n,r6),s._resizeWidth.skip(!0)),s.height()!==r&&(a=1,s.signal(JI,r,r6),s._resizeHeight.skip(!0)),s._viewWidth!==e&&(s._resize=1,s._viewWidth=e),s._viewHeight!==t&&(s._resize=1,s._viewHeight=t),(s._origin[0]!==i[0]||s._origin[1]!==i[1])&&(s._resize=1,s._origin=i),a&&s.run("enter"),o&&s.runAfter(u=>u.resize())},!1,1)}function Yfe(e){return this._runtime.getState(e||{data:Xfe,signals:Qfe,recurse:!0})}function Xfe(e,t){return t.modified&&ne(t.input.value)&&!e.startsWith("_:vega:_")}function Qfe(e,t){return!(e==="parent"||t instanceof Ef.proxy)}function Kfe(e){return this.runAsync(null,t=>{t._trigger=!1,t._runtime.setState(e)},t=>{t._trigger=!0}),this}function Jfe(e,t){function n(r){e({timestamp:Date.now(),elapsed:r})}this._timers.push(boe(n,t))}function Zfe(e,t,n,r){const i=e.element();i&&i.setAttribute("title",ede(r))}function ede(e){return e==null?"":ne(e)?tB(e):ye(e)&&!Ga(e)?tde(e):e+""}function tde(e){return Object.keys(e).map(t=>{const n=e[t];return t+": "+(ne(n)?tB(n):nB(n))}).join(`
`)}function tB(e){return"["+e.map(nB).join(", ")+"]"}function nB(e){return ne(e)?"[…]":ye(e)&&!Ga(e)?"{…}":e}function nde(){if(this.renderer()==="canvas"&&this._renderer._canvas){let e=null;const t=()=>{e!=null&&e();const n=matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`);n.addEventListener("change",t),e=()=>{n.removeEventListener("change",t)},this._renderer._canvas.getContext("2d").pixelRatio=window.devicePixelRatio||1,this._redraw=!0,this._resize=1,this.resize().runAsync()};t()}}function rB(e,t){const n=this;if(t=t||{},sf.call(n),t.loader&&n.loader(t.loader),t.logger&&n.logger(t.logger),t.logLevel!=null&&n.logLevel(t.logLevel),t.locale||e.locale){const o=qe({},e.locale,t.locale);n.locale(K8(o.number,o.time))}n._el=null,n._elBind=null,n._renderType=t.renderer||Ba.Canvas,n._scenegraph=new QL;const r=n._scenegraph.root;n._renderer=null,n._tooltip=t.tooltip||Zfe,n._redraw=!0,n._handler=new wg().scene(r),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=wfe(e.eventConfig),n.globalCursor(n._eventConfig.globalCursor);const i=qfe(n,e,t.expr);n._runtime=i,n._signals=i.signals,n._bind=(e.bindings||[]).map(o=>({state:null,param:qe({},o)})),i.root&&i.root.set(r),r.source=i.data.root.input,n.pulse(i.data.root.input,n.changeset().insert(r.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=ZI(n,n._width),n._viewHeight=eB(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,Gfe(n),lfe(n),cfe(n),n.description(e.description),t.hover&&n.hover(),t.container&&n.initialize(t.container,t.bind),t.watchPixelRatio&&n._watchPixelRatio()}function Mm(e,t){return Ee(e._signals,t)?e._signals[t]:te("Unrecognized signal name: "+de(t))}function iB(e,t){const n=(e._targets||[]).filter(r=>r._update&&r._update.handler===t);return n.length?n[0]:null}function i6(e,t,n,r){let i=iB(n,r);return i||(i=U$(e,()=>r(t,n.value)),i.handler=r,e.on(n,null,i)),e}function o6(e,t,n){const r=iB(t,n);return r&&t._targets.remove(r),e}pe(rB,sf,{async evaluate(e,t,n){if(await sf.prototype.evaluate.call(this,e,t),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,pfe(this)),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(r){this.error(r)}return n&&Gm(this,n),this},dirty(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e)},description(e){if(arguments.length){const t=e!=null?e+"":null;return t!==this._desc&&GI(this._el,this._desc=t),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(e,t,n){const r=Mm(this,e);return arguments.length===1?r.value:this.update(r,t,n)},width(e){return arguments.length?this.signal("width",e):this.signal("width")},height(e){return arguments.length?this.signal("height",e):this.signal("height")},padding(e){return arguments.length?this.signal("padding",n6(e)):n6(this.signal("padding"))},autosize(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")},background(e){return arguments.length?this.signal("background",e):this.signal("background")},renderer(e){return arguments.length?(jv(e)||te("Unrecognized renderer type: "+e),e!==this._renderType&&(this._renderType=e,this._resetRenderer()),this):this._renderType},tooltip(e){return arguments.length?(e!==this._tooltip&&(this._tooltip=e,this._resetRenderer()),this):this._tooltip},loader(e){return arguments.length?(e!==this._loader&&(sf.prototype.loader.call(this,e),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(Mm(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:Vfe,addEventListener(e,t,n){let r=t;return n&&n.trap===!1||(r=U$(this,t),r.raw=t),this._handler.on(e,r),this},removeEventListener(e,t){for(var n=this._handler.handlers(e),r=n.length,i,o;--r>=0;)if(o=n[r].type,i=n[r].handler,e===o&&(t===i||t===i.raw)){this._handler.off(o,i);break}return this},addResizeListener(e){const t=this._resizeListeners;return t.includes(e)||t.push(e),this},removeResizeListener(e){var t=this._resizeListeners,n=t.indexOf(e);return n>=0&&t.splice(n,1),this},addSignalListener(e,t){return i6(this,e,Mm(this,e),t)},removeSignalListener(e,t){return o6(this,Mm(this,e),t)},addDataListener(e,t){return i6(this,e,Fy(this,e).values,t)},removeDataListener(e,t){return o6(this,Fy(this,e).values,t)},globalCursor(e){if(arguments.length){if(this._globalCursor!==!!e){const t=S_(this,null);this._globalCursor=!!e,t&&S_(this,t)}return this}else return this._globalCursor},preventDefault(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault},timer:Jfe,events:bfe,finalize:_fe,hover:Sfe,data:ffe,change:tx,insert:dfe,remove:hfe,scale:Hfe,initialize:zfe,toImageURL:Bfe,toCanvas:jfe,toSVG:Wfe,getState:Yfe,setState:Kfe,_watchPixelRatio:nde});const rde="view",My="[",Ty="]",oB="{",sB="}",ide=":",aB=",",ode="@",sde=">",ade=/[[\]{}]/,ude={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let uB,lB;function xu(e,t,n){return uB=t||rde,lB=n||ude,cB(e.trim()).map(__)}function lde(e){return lB[e]}function mp(e,t,n,r,i){const o=e.length;let s=0,a;for(;t<o;++t){if(a=e[t],!s&&a===n)return t;i&&i.indexOf(a)>=0?--s:r&&r.indexOf(a)>=0&&++s}return t}function cB(e){const t=[],n=e.length;let r=0,i=0;for(;i<n;)i=mp(e,i,aB,My+oB,Ty+sB),t.push(e.substring(r,i).trim()),r=++i;if(t.length===0)throw"Empty event selector: "+e;return t}function __(e){return e[0]==="["?cde(e):fde(e)}function cde(e){const t=e.length;let n=1,r;if(n=mp(e,n,Ty,My,Ty),n===t)throw"Empty between selector: "+e;if(r=cB(e.substring(1,n)),r.length!==2)throw"Between selector must have two elements: "+e;if(e=e.slice(n+1).trim(),e[0]!==sde)throw"Expected '>' after between selector: "+e;r=r.map(__);const i=__(e.slice(1).trim());return i.between?{between:r,stream:i}:(i.between=r,i)}function fde(e){const t={source:uB},n=[];let r=[0,0],i=0,o=0,s=e.length,a=0,u,c;if(e[s-1]===sB){if(a=e.lastIndexOf(oB),a>=0){try{r=dde(e.substring(a+1,s-1))}catch{throw"Invalid throttle specification: "+e}e=e.slice(0,a).trim(),s=e.length}else throw"Unmatched right brace: "+e;a=0}if(!s)throw e;if(e[0]===ode&&(i=++a),u=mp(e,a,ide),u<s&&(n.push(e.substring(o,u).trim()),o=a=++u),a=mp(e,a,My),a===s)n.push(e.substring(o,s).trim());else if(n.push(e.substring(o,a).trim()),c=[],o=++a,o===s)throw"Unmatched left bracket: "+e;for(;a<s;){if(a=mp(e,a,Ty),a===s)throw"Unmatched left bracket: "+e;if(c.push(e.substring(o,a).trim()),a<s-1&&e[++a]!==My)throw"Expected left bracket: "+e;o=++a}if(!(s=n.length)||ade.test(n[s-1]))throw"Invalid event selector: "+e;return s>1?(t.type=n[1],i?t.markname=n[0].slice(1):lde(n[0])?t.marktype=n[0]:t.source=n[0]):t.type=n[0],t.type.slice(-1)==="!"&&(t.consume=!0,t.type=t.type.slice(0,-1)),c!=null&&(t.filter=c),r[0]&&(t.throttle=r[0]),r[1]&&(t.debounce=r[1]),t}function dde(e){const t=e.split(aB);if(!e.length||t.length>2)throw e;return t.map(n=>{const r=+n;if(r!==r)throw e;return r})}function hde(e){return ye(e)?e:{type:e||"pad"}}const Ch=e=>+e||0,pde=e=>({top:e,bottom:e,left:e,right:e});function gde(e){return ye(e)?e.signal?e:{top:Ch(e.top),bottom:Ch(e.bottom),left:Ch(e.left),right:Ch(e.right)}:pde(Ch(e))}const yn=e=>ye(e)&&!ne(e)?qe({},e):{value:e};function s6(e,t,n,r){return n!=null?(ye(n)&&!ne(n)||ne(n)&&n.length&&ye(n[0])?e.update[t]=n:e[r||"enter"][t]={value:n},1):0}function On(e,t,n){for(const r in t)s6(e,r,t[r]);for(const r in n)s6(e,r,n[r],"update")}function dd(e,t,n){for(const r in t)n&&Ee(n,r)||(e[r]=qe(e[r]||{},t[r]));return e}function Qc(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}const q$="mark",H$="frame",G$="scope",mde="axis",yde="axis-domain",vde="axis-grid",xde="axis-label",wde="axis-tick",Ede="axis-title",bde="legend",Sde="legend-band",_de="legend-entry",Ade="legend-gradient",fB="legend-label",Cde="legend-symbol",kde="legend-title",$de="title",Fde="title-text",Dde="title-subtitle";function Mde(e,t,n,r,i){const o={},s={};let a,u,c,f;u="lineBreak",t==="text"&&i[u]!=null&&!Qc(u,e)&&ab(o,u,i[u]),(n=="legend"||String(n).startsWith("axis"))&&(n=null),f=n===H$?i.group:n===q$?qe({},i.mark,i[t]):null;for(u in f)c=Qc(u,e)||(u==="fill"||u==="stroke")&&(Qc("fill",e)||Qc("stroke",e)),c||ab(o,u,f[u]);xe(r).forEach(h=>{const p=i.style&&i.style[h];for(const m in p)Qc(m,e)||ab(o,m,p[m])}),e=qe({},e);for(u in o)f=o[u],f.signal?(a=a||{})[u]=f:s[u]=f;return e.enter=qe(s,e.enter),a&&(e.update=qe(a,e.update)),e}function ab(e,t,n){e[t]=n&&n.signal?{signal:n.signal}:{value:n}}const dB=e=>ve(e)?de(e):e.signal?`(${e.signal})`:hB(e);function rx(e){if(e.gradient!=null)return Nde(e);let t=e.signal?`(${e.signal})`:e.color?Tde(e.color):e.field!=null?hB(e.field):e.value!==void 0?de(e.value):void 0;return e.scale!=null&&(t=Rde(e,t)),t===void 0&&(t=null),e.exponent!=null&&(t=`pow(${t},${c1(e.exponent)})`),e.mult!=null&&(t+=`*${c1(e.mult)}`),e.offset!=null&&(t+=`+${c1(e.offset)}`),e.round&&(t=`round(${t})`),t}const Tm=(e,t,n,r)=>`(${e}(${[t,n,r].map(rx).join(",")})+'')`;function Tde(e){return e.c?Tm("hcl",e.h,e.c,e.l):e.h||e.s?Tm("hsl",e.h,e.s,e.l):e.l||e.a?Tm("lab",e.l,e.a,e.b):e.r||e.g||e.b?Tm("rgb",e.r,e.g,e.b):null}function Nde(e){const t=[e.start,e.stop,e.count].map(n=>n==null?null:de(n));for(;t.length&&Ze(t)==null;)t.pop();return t.unshift(dB(e.gradient)),`gradient(${t.join(",")})`}function c1(e){return ye(e)?"("+rx(e)+")":e}function hB(e){return pB(ye(e)?e:{datum:e})}function pB(e){let t,n,r;if(e.signal)t="datum",r=e.signal;else if(e.group||e.parent){for(n=Math.max(1,e.level||1),t="item";n-- >0;)t+=".mark.group";e.parent?(r=e.parent,t+=".datum"):r=e.group}else e.datum?(t="datum",r=e.datum):te("Invalid field reference: "+de(e));return e.signal||(r=ve(r)?es(r).map(de).join("]["):pB(r)),t+"["+r+"]"}function Rde(e,t){const n=dB(e.scale);return e.range!=null?t=`lerp(_range(${n}), ${+e.range})`:(t!==void 0&&(t=`_scale(${n}, ${t})`),e.band&&(t=(t?t+"+":"")+`_bandwidth(${n})`+(+e.band==1?"":"*"+c1(e.band)),e.extra&&(t=`(datum.extra ? _scale(${n}, datum.extra.value) : ${t})`)),t==null&&(t="0")),t}function Ode(e){let t="";return e.forEach(n=>{const r=rx(n);t+=n.test?`(${n.test})?${r}:`:r}),Ze(t)===":"&&(t+="null"),t}function gB(e,t,n,r,i,o){const s={};o=o||{},o.encoders={$encode:s},e=Mde(e,t,n,r,i.config);for(const a in e)s[a]=Pde(e[a],t,o,i);return o}function Pde(e,t,n,r){const i={},o={};for(const s in e)e[s]!=null&&(i[s]=zde(Lde(e[s]),r,n,o));return{$expr:{marktype:t,channels:i},$fields:Object.keys(o),$output:Object.keys(e)}}function Lde(e){return ne(e)?Ode(e):rx(e)}function zde(e,t,n,r){const i=Qo(e,t);return i.$fields.forEach(o=>r[o]=1),qe(n,i.$params),i.$expr}const Ide="outer",Bde=["value","update","init","react","bind"];function a6(e,t){te(e+' for "outer" push: '+de(t))}function mB(e,t){const n=e.name;if(e.push===Ide)t.signals[n]||a6("No prior signal definition",n),Bde.forEach(r=>{e[r]!==void 0&&a6("Invalid property ",r)});else{const r=t.addSignal(n,e.value);e.react===!1&&(r.react=!1),e.bind&&t.addBinding(n,e.bind)}}function A_(e,t,n,r){this.id=-1,this.type=e,this.value=t,this.params=n,r&&(this.parent=r)}function ix(e,t,n,r){return new A_(e,t,n,r)}function Ny(e,t){return ix("operator",e,t)}function Me(e){const t={$ref:e.id};return e.id<0&&(e.refs=e.refs||[]).push(t),t}function Up(e,t){return t?{$field:e,$name:t}:{$field:e}}const C_=Up("key");function u6(e,t){return{$compare:e,$order:t}}function Ude(e,t){const n={$key:e};return t&&(n.$flat=!0),n}const jde="ascending",Wde="descending";function qde(e){return ye(e)?(e.order===Wde?"-":"+")+ox(e.op,e.field):""}function ox(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"")}const V$="scope",k_="view";function an(e){return e&&e.signal}function Hde(e){return e&&e.expr}function f1(e){if(an(e))return!0;if(ye(e)){for(const t in e)if(f1(e[t]))return!0}return!1}function Yi(e,t){return e??t}function ml(e){return e&&e.signal||e}const l6="timer";function jp(e,t){return(e.merge?Vde:e.stream?Yde:e.type?Xde:te("Invalid stream specification: "+de(e)))(e,t)}function Gde(e){return e===V$?k_:e||k_}function Vde(e,t){const n=e.merge.map(i=>jp(i,t)),r=Y$({merge:n},e,t);return t.addStream(r).id}function Yde(e,t){const n=jp(e.stream,t),r=Y$({stream:n},e,t);return t.addStream(r).id}function Xde(e,t){let n;e.type===l6?(n=t.event(l6,e.throttle),e={between:e.between,filter:e.filter}):n=t.event(Gde(e.source),e.type);const r=Y$({stream:n},e,t);return Object.keys(r).length===1?n:t.addStream(r).id}function Y$(e,t,n){let r=t.between;return r&&(r.length!==2&&te('Stream "between" parameter must have 2 entries: '+de(t)),e.between=[jp(r[0],n),jp(r[1],n)]),r=t.filter?[].concat(t.filter):[],(t.marktype||t.markname||t.markrole)&&r.push(Qde(t.marktype,t.markname,t.markrole)),t.source===V$&&r.push("inScope(event.item)"),r.length&&(e.filter=Qo("("+r.join(")&&(")+")",n).$expr),(r=t.throttle)!=null&&(e.throttle=+r),(r=t.debounce)!=null&&(e.debounce=+r),t.consume&&(e.consume=!0),e}function Qde(e,t,n){const r="event.item";return r+(e&&e!=="*"?"&&"+r+".mark.marktype==='"+e+"'":"")+(n?"&&"+r+".mark.role==='"+n+"'":"")+(t?"&&"+r+".mark.name==='"+t+"'":"")}const Kde={code:"_.$value",ast:{type:"Identifier",value:"value"}};function Jde(e,t,n){const r=e.encode,i={target:n};let o=e.events,s=e.update,a=[];o||te("Signal update missing events specification."),ve(o)&&(o=xu(o,t.isSubscope()?V$:k_)),o=xe(o).filter(u=>u.signal||u.scale?(a.push(u),0):1),a.length>1&&(a=[ehe(a)]),o.length&&a.push(o.length>1?{merge:o}:o[0]),r!=null&&(s&&te("Signal encode and update are mutually exclusive."),s="encode(item(),"+de(r)+")"),i.update=ve(s)?Qo(s,t):s.expr!=null?Qo(s.expr,t):s.value!=null?s.value:s.signal!=null?{$expr:Kde,$params:{$value:t.signalRef(s.signal)}}:te("Invalid signal update specification."),e.force&&(i.options={force:!0}),a.forEach(u=>t.addUpdate(qe(Zde(u,t),i)))}function Zde(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):jp(e,t)}}function ehe(e){return{signal:"["+e.map(t=>t.scale?'scale("'+t.scale+'")':t.signal)+"]"}}function the(e,t){const n=t.getSignal(e.name);let r=e.update;e.init&&(r?te("Signals can not include both init and update expressions."):(r=e.init,n.initonly=!0)),r&&(r=Qo(r,t),n.update=r.$expr,n.params=r.$params),e.on&&e.on.forEach(i=>Jde(i,t,n.id))}const wt=e=>(t,n,r)=>ix(e,n,t||void 0,r),yB=wt("aggregate"),nhe=wt("axisticks"),vB=wt("bound"),po=wt("collect"),c6=wt("compare"),rhe=wt("datajoin"),xB=wt("encode"),ihe=wt("expression"),ohe=wt("facet"),she=wt("field"),ahe=wt("key"),uhe=wt("legendentries"),lhe=wt("load"),che=wt("mark"),fhe=wt("multiextent"),dhe=wt("multivalues"),hhe=wt("overlap"),phe=wt("params"),wB=wt("prefacet"),ghe=wt("projection"),mhe=wt("proxy"),yhe=wt("relay"),EB=wt("render"),vhe=wt("scale"),Zl=wt("sieve"),xhe=wt("sortitems"),bB=wt("viewlayout"),whe=wt("values");let Ehe=0;const SB={min:"min",max:"max",count:"sum"};function bhe(e,t){const n=e.type||"linear";uL(n)||te("Unrecognized scale type: "+de(n)),t.addScale(e.name,{type:n,domain:void 0})}function She(e,t){const n=t.getScale(e.name).params;let r;n.domain=_B(e.domain,e,t),e.range!=null&&(n.range=CB(e,t,n)),e.interpolate!=null&&Nhe(e.interpolate,n),e.nice!=null&&(n.nice=The(e.nice,t)),e.bins!=null&&(n.bins=Mhe(e.bins,t));for(r in e)Ee(n,r)||r==="name"||(n[r]=Si(e[r],t))}function Si(e,t){return ye(e)?e.signal?t.signalRef(e.signal):te("Unsupported object: "+de(e)):e}function d1(e,t){return e.signal?t.signalRef(e.signal):e.map(n=>Si(n,t))}function sx(e){te("Can not find data set: "+de(e))}function _B(e,t,n){if(!e){(t.domainMin!=null||t.domainMax!=null)&&te("No scale domain defined for domainMin/domainMax to override.");return}return e.signal?n.signalRef(e.signal):(ne(e)?_he:e.fields?Che:Ahe)(e,t,n)}function _he(e,t,n){return e.map(r=>Si(r,n))}function Ahe(e,t,n){const r=n.getData(e.data);return r||sx(e.data),Cf(t.type)?r.valuesRef(n,e.field,AB(e.sort,!1)):fL(t.type)?r.domainRef(n,e.field):r.extentRef(n,e.field)}function Che(e,t,n){const r=e.data,i=e.fields.reduce((o,s)=>(s=ve(s)?{data:r,field:s}:ne(s)||s.signal?khe(s,n):s,o.push(s),o),[]);return(Cf(t.type)?$he:fL(t.type)?Fhe:Dhe)(e,n,i)}function khe(e,t){const n="_:vega:_"+Ehe++,r=po({});if(ne(e))r.value={$ingest:e};else if(e.signal){const i="setdata("+de(n)+","+e.signal+")";r.params.input=t.signalRef(i)}return t.addDataPipeline(n,[r,Zl({})]),{data:n,field:"data"}}function $he(e,t,n){const r=AB(e.sort,!0);let i,o;const s=n.map(c=>{const f=t.getData(c.data);return f||sx(c.data),f.countsRef(t,c.field,r)}),a={groupby:C_,pulse:s};r&&(i=r.op||"count",o=r.field?ox(i,r.field):"count",a.ops=[SB[i]],a.fields=[t.fieldRef(o)],a.as=[o]),i=t.add(yB(a));const u=t.add(po({pulse:Me(i)}));return o=t.add(whe({field:C_,sort:t.sortRef(r),pulse:Me(u)})),Me(o)}function AB(e,t){return e&&(!e.field&&!e.op?ye(e)?e.field="key":e={field:"key"}:!e.field&&e.op!=="count"?te("No field provided for sort aggregate op: "+e.op):t&&e.field&&e.op&&!SB[e.op]&&te("Multiple domain scales can not be sorted using "+e.op)),e}function Fhe(e,t,n){const r=n.map(i=>{const o=t.getData(i.data);return o||sx(i.data),o.domainRef(t,i.field)});return Me(t.add(dhe({values:r})))}function Dhe(e,t,n){const r=n.map(i=>{const o=t.getData(i.data);return o||sx(i.data),o.extentRef(t,i.field)});return Me(t.add(fhe({extents:r})))}function Mhe(e,t){return e.signal||ne(e)?d1(e,t):t.objectProperty(e)}function The(e,t){return e.signal?t.signalRef(e.signal):ye(e)?{interval:Si(e.interval),step:Si(e.step)}:Si(e)}function Nhe(e,t){t.interpolate=Si(e.type||e),e.gamma!=null&&(t.interpolateGamma=Si(e.gamma))}function CB(e,t,n){const r=t.config.range;let i=e.range;if(i.signal)return t.signalRef(i.signal);if(ve(i)){if(r&&Ee(r,i))return e=qe({},e,{range:r[i]}),CB(e,t,n);i==="width"?i=[0,{signal:"width"}]:i==="height"?i=Cf(e.type)?[0,{signal:"height"}]:[{signal:"height"},0]:te("Unrecognized scale range value: "+de(i))}else if(i.scheme){n.scheme=ne(i.scheme)?d1(i.scheme,t):Si(i.scheme,t),i.extent&&(n.schemeExtent=d1(i.extent,t)),i.count&&(n.schemeCount=Si(i.count,t));return}else if(i.step){n.rangeStep=Si(i.step,t);return}else{if(Cf(e.type)&&!ne(i))return _B(i,e,t);ne(i)||te("Unsupported range type: "+de(i))}return i.map(o=>(ne(o)?d1:Si)(o,t))}function Rhe(e,t){const n=t.config.projection||{},r={};for(const i in e)i!=="name"&&(r[i]=$_(e[i],i,t));for(const i in n)r[i]==null&&(r[i]=$_(n[i],i,t));t.addProjection(e.name,r)}function $_(e,t,n){return ne(e)?e.map(r=>$_(r,t,n)):ye(e)?e.signal?n.signalRef(e.signal):t==="fit"?e:te("Unsupported parameter object: "+de(e)):e}const go="top",hd="left",pd="right",au="bottom",kB="center",Ohe="vertical",Phe="start",Lhe="middle",zhe="end",F_="index",X$="label",Ihe="offset",Of="perc",Bhe="perc2",Ai="value",Fg="guide-label",Q$="guide-title",Uhe="group-title",jhe="group-subtitle",f6="symbol",h1="gradient",D_="discrete",M_="size",Whe="shape",qhe="fill",Hhe="stroke",Ghe="strokeWidth",Vhe="strokeDash",Yhe="opacity",K$=[M_,Whe,qhe,Hhe,Ghe,Vhe,Yhe],Dg={name:1,style:1,interactive:1},tt={value:0},Ci={value:1},ax="group",$B="rect",J$="rule",Xhe="symbol",ec="text";function Wp(e){return e.type=ax,e.interactive=e.interactive||!1,e}function Hr(e,t){const n=(r,i)=>Yi(e[r],Yi(t[r],i));return n.isVertical=r=>Ohe===Yi(e.direction,t.direction||(r?t.symbolDirection:t.gradientDirection)),n.gradientLength=()=>Yi(e.gradientLength,t.gradientLength||t.gradientWidth),n.gradientThickness=()=>Yi(e.gradientThickness,t.gradientThickness||t.gradientHeight),n.entryColumns=()=>Yi(e.columns,Yi(t.columns,+n.isVertical(!0))),n}function FB(e,t){const n=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return n&&n.signal?n:n?n.value:null}function Qhe(e,t,n){const r=t.config.style[n];return r&&r[e]}function ux(e,t,n){return`item.anchor === '${Phe}' ? ${e} : item.anchor === '${zhe}' ? ${t} : ${n}`}const Z$=ux(de(hd),de(pd),de(kB));function Khe(e){const t=e("tickBand");let n=e("tickOffset"),r,i;return t?t.signal?(r={signal:`(${t.signal}) === 'extent' ? 1 : 0.5`},i={signal:`(${t.signal}) === 'extent'`},ye(n)||(n={signal:`(${t.signal}) === 'extent' ? 0 : ${n}`})):t==="extent"?(r=1,i=!0,n=0):(r=.5,i=!1):(r=e("bandPosition"),i=e("tickExtra")),{extra:i,band:r,offset:n}}function DB(e,t){return t?e?ye(e)?Object.assign({},e,{offset:DB(e.offset,t)}):{value:e,offset:t}:t:e}function li(e,t){return t?(e.name=t.name,e.style=t.style||e.style,e.interactive=!!t.interactive,e.encode=dd(e.encode,t,Dg)):e.interactive=!1,e}function Jhe(e,t,n,r){const i=Hr(e,n),o=i.isVertical(),s=i.gradientThickness(),a=i.gradientLength();let u,c,f,h,p;o?(c=[0,1],f=[0,0],h=s,p=a):(c=[0,0],f=[1,0],h=a,p=s);const m={enter:u={opacity:tt,x:tt,y:tt,width:yn(h),height:yn(p)},update:qe({},u,{opacity:Ci,fill:{gradient:t,start:c,stop:f}}),exit:{opacity:tt}};return On(m,{stroke:i("gradientStrokeColor"),strokeWidth:i("gradientStrokeWidth")},{opacity:i("gradientOpacity")}),li({type:$B,role:Ade,encode:m},r)}function Zhe(e,t,n,r,i){const o=Hr(e,n),s=o.isVertical(),a=o.gradientThickness(),u=o.gradientLength();let c,f,h,p,m="";s?(c="y",h="y2",f="x",p="width",m="1-"):(c="x",h="x2",f="y",p="height");const y={opacity:tt,fill:{scale:t,field:Ai}};y[c]={signal:m+"datum."+Of,mult:u},y[f]=tt,y[h]={signal:m+"datum."+Bhe,mult:u},y[p]=yn(a);const v={enter:y,update:qe({},y,{opacity:Ci}),exit:{opacity:tt}};return On(v,{stroke:o("gradientStrokeColor"),strokeWidth:o("gradientStrokeWidth")},{opacity:o("gradientOpacity")}),li({type:$B,role:Sde,key:Ai,from:i,encode:v},r)}const epe=`datum.${Of}<=0?"${hd}":datum.${Of}>=1?"${pd}":"${kB}"`,tpe=`datum.${Of}<=0?"${au}":datum.${Of}>=1?"${go}":"${Lhe}"`;function d6(e,t,n,r){const i=Hr(e,t),o=i.isVertical(),s=yn(i.gradientThickness()),a=i.gradientLength();let u=i("labelOverlap"),c,f,h,p,m="";const y={enter:c={opacity:tt},update:f={opacity:Ci,text:{field:X$}},exit:{opacity:tt}};return On(y,{fill:i("labelColor"),fillOpacity:i("labelOpacity"),font:i("labelFont"),fontSize:i("labelFontSize"),fontStyle:i("labelFontStyle"),fontWeight:i("labelFontWeight"),limit:Yi(e.labelLimit,t.gradientLabelLimit)}),o?(c.align={value:"left"},c.baseline=f.baseline={signal:tpe},h="y",p="x",m="1-"):(c.align=f.align={signal:epe},c.baseline={value:"top"},h="x",p="y"),c[h]=f[h]={signal:m+"datum."+Of,mult:a},c[p]=f[p]=s,s.offset=Yi(e.labelOffset,t.gradientLabelOffset)||0,u=u?{separation:i("labelSeparation"),method:u,order:"datum."+F_}:void 0,li({type:ec,role:fB,style:Fg,key:Ai,from:r,encode:y,overlap:u},n)}function npe(e,t,n,r,i){const o=Hr(e,t),s=n.entries,a=!!(s&&s.interactive),u=s?s.name:void 0,c=o("clipHeight"),f=o("symbolOffset"),h={data:"value"},p=`(${i}) ? datum.${Ihe} : datum.${M_}`,m=c?yn(c):{field:M_},y=`datum.${F_}`,v=`max(1, ${i})`;let w,E,S,A,C;m.mult=.5,w={enter:E={opacity:tt,x:{signal:p,mult:.5,offset:f},y:m},update:S={opacity:Ci,x:E.x,y:E.y},exit:{opacity:tt}};let k=null,D=null;e.fill||(k=t.symbolBaseFillColor,D=t.symbolBaseStrokeColor),On(w,{fill:o("symbolFillColor",k),shape:o("symbolType"),size:o("symbolSize"),stroke:o("symbolStrokeColor",D),strokeDash:o("symbolDash"),strokeDashOffset:o("symbolDashOffset"),strokeWidth:o("symbolStrokeWidth")},{opacity:o("symbolOpacity")}),K$.forEach(L=>{e[L]&&(S[L]=E[L]={scale:e[L],field:Ai})});const $=li({type:Xhe,role:Cde,key:Ai,from:h,clip:c?!0:void 0,encode:w},n.symbols),M=yn(f);M.offset=o("labelOffset"),w={enter:E={opacity:tt,x:{signal:p,offset:M},y:m},update:S={opacity:Ci,text:{field:X$},x:E.x,y:E.y},exit:{opacity:tt}},On(w,{align:o("labelAlign"),baseline:o("labelBaseline"),fill:o("labelColor"),fillOpacity:o("labelOpacity"),font:o("labelFont"),fontSize:o("labelFontSize"),fontStyle:o("labelFontStyle"),fontWeight:o("labelFontWeight"),limit:o("labelLimit")});const T=li({type:ec,role:fB,style:Fg,key:Ai,from:h,encode:w},n.labels);return w={enter:{noBound:{value:!c},width:tt,height:c?yn(c):tt,opacity:tt},exit:{opacity:tt},update:S={opacity:Ci,row:{signal:null},column:{signal:null}}},o.isVertical(!0)?(A=`ceil(item.mark.items.length / ${v})`,S.row.signal=`${y}%${A}`,S.column.signal=`floor(${y} / ${A})`,C={field:["row",y]}):(S.row.signal=`floor(${y} / ${v})`,S.column.signal=`${y} % ${v}`,C={field:y}),S.column.signal=`(${i})?${S.column.signal}:${y}`,r={facet:{data:r,name:"value",groupby:F_}},Wp({role:G$,from:r,encode:dd(w,s,Dg),marks:[$,T],name:u,interactive:a,sort:C})}function rpe(e,t){const n=Hr(e,t);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}const eF='item.orient === "left"',tF='item.orient === "right"',lx=`(${eF} || ${tF})`,ipe=`datum.vgrad && ${lx}`,ope=ux('"top"','"bottom"','"middle"'),spe=ux('"right"','"left"','"center"'),ape=`datum.vgrad && ${tF} ? (${spe}) : (${lx} && !(datum.vgrad && ${eF})) ? "left" : ${Z$}`,upe=`item._anchor || (${lx} ? "middle" : "start")`,lpe=`${ipe} ? (${eF} ? -90 : 90) : 0`,cpe=`${lx} ? (datum.vgrad ? (${tF} ? "bottom" : "top") : ${ope}) : "top"`;function fpe(e,t,n,r){const i=Hr(e,t),o={enter:{opacity:tt},update:{opacity:Ci,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:tt}};return On(o,{orient:i("titleOrient"),_anchor:i("titleAnchor"),anchor:{signal:upe},angle:{signal:lpe},align:{signal:ape},baseline:{signal:cpe},text:e.title,fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),baseline:i("titleBaseline")}),li({type:ec,role:kde,style:Q$,from:r,encode:o},n)}function dpe(e,t){let n;return ye(e)&&(e.signal?n=e.signal:e.path?n="pathShape("+h6(e.path)+")":e.sphere&&(n="geoShape("+h6(e.sphere)+', {type: "Sphere"})')),n?t.signalRef(n):!!e}function h6(e){return ye(e)&&e.signal?e.signal:de(e)}function MB(e){const t=e.role||"";return t.startsWith("axis")||t.startsWith("legend")||t.startsWith("title")?t:e.type===ax?G$:t||q$}function hpe(e){return{marktype:e.type,name:e.name||void 0,role:e.role||MB(e),zindex:+e.zindex||void 0,aria:e.aria,description:e.description}}function ppe(e,t){return e&&e.signal?t.signalRef(e.signal):e!==!1}function nF(e,t){const n=cP(e.type);n||te("Unrecognized transform type: "+de(e.type));const r=ix(n.type.toLowerCase(),null,TB(n,e,t));return e.signal&&t.addSignal(e.signal,t.proxy(r)),r.metadata=n.metadata||{},r}function TB(e,t,n){const r={},i=e.params.length;for(let o=0;o<i;++o){const s=e.params[o];r[s.name]=gpe(s,t,n)}return r}function gpe(e,t,n){const r=e.type,i=t[e.name];if(r==="index")return mpe(e,t,n);if(i===void 0){e.required&&te("Missing required "+de(t.type)+" parameter: "+de(e.name));return}else{if(r==="param")return ype(e,t,n);if(r==="projection")return n.projectionRef(t[e.name])}return e.array&&!an(i)?i.map(o=>p6(e,o,n)):p6(e,i,n)}function p6(e,t,n){const r=e.type;if(an(t))return m6(r)?te("Expression references can not be signals."):ub(r)?n.fieldRef(t):y6(r)?n.compareRef(t):n.signalRef(t.signal);{const i=e.expr||ub(r);return i&&vpe(t)?n.exprRef(t.expr,t.as):i&&xpe(t)?Up(t.field,t.as):m6(r)?Qo(t,n):wpe(r)?Me(n.getData(t).values):ub(r)?Up(t):y6(r)?n.compareRef(t):t}}function mpe(e,t,n){return ve(t.from)||te('Lookup "from" parameter must be a string literal.'),n.getData(t.from).lookupRef(n,t.key)}function ype(e,t,n){const r=t[e.name];return e.array?(ne(r)||te("Expected an array of sub-parameters. Instead: "+de(r)),r.map(i=>g6(e,i,n))):g6(e,r,n)}function g6(e,t,n){const r=e.params.length;let i;for(let s=0;s<r;++s){i=e.params[s];for(const a in i.key)if(i.key[a]!==t[a]){i=null;break}if(i)break}i||te("Unsupported parameter: "+de(t));const o=qe(TB(i,t,n),i.key);return Me(n.add(phe(o)))}const vpe=e=>e&&e.expr,xpe=e=>e&&e.field,wpe=e=>e==="data",m6=e=>e==="expr",ub=e=>e==="field",y6=e=>e==="compare";function Epe(e,t,n){let r,i,o,s,a;return e?(r=e.facet)&&(t||te("Only group marks can be faceted."),r.field!=null?s=a=p1(r,n):(e.data?a=Me(n.getData(e.data).aggregate):(o=nF(qe({type:"aggregate",groupby:xe(r.groupby)},r.aggregate),n),o.params.key=n.keyRef(r.groupby),o.params.pulse=p1(r,n),s=a=Me(n.add(o))),i=n.keyRef(r.groupby,!0))):s=Me(n.add(po(null,[{}]))),s||(s=p1(e,n)),{key:i,pulse:s,parent:a}}function p1(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:Me(t.getData(e.data).output)}function Nl(e,t,n,r,i){this.scope=e,this.input=t,this.output=n,this.values=r,this.aggregate=i,this.index={}}Nl.fromEntries=function(e,t){const n=t.length,r=t[n-1],i=t[n-2];let o=t[0],s=null,a=1;for(o&&o.type==="load"&&(o=t[1]),e.add(t[0]);a<n;++a)t[a].params.pulse=Me(t[a-1]),e.add(t[a]),t[a].type==="aggregate"&&(s=t[a]);return new Nl(e,o,i,r,s)};function NB(e){return ve(e)?e:null}function v6(e,t,n){const r=ox(n.op,n.field);let i;if(t.ops){for(let o=0,s=t.as.length;o<s;++o)if(t.as[o]===r)return}else t.ops=["count"],t.fields=[null],t.as=["count"];n.op&&(t.ops.push((i=n.op.signal)?e.signalRef(i):n.op),t.fields.push(e.fieldRef(n.field)),t.as.push(r))}function kh(e,t,n,r,i,o,s){const a=t[n]||(t[n]={}),u=qde(o);let c=NB(i),f,h;if(c!=null&&(e=t.scope,c=c+(u?"|"+u:""),f=a[c]),!f){const p=o?{field:C_,pulse:t.countsRef(e,i,o)}:{field:e.fieldRef(i),pulse:Me(t.output)};u&&(p.sort=e.sortRef(o)),h=e.add(ix(r,void 0,p)),s&&(t.index[i]=h),f=Me(h),c!=null&&(a[c]=f)}return f}Nl.prototype={countsRef(e,t,n){const r=this,i=r.counts||(r.counts={}),o=NB(t);let s,a,u;return o!=null&&(e=r.scope,s=i[o]),s?n&&n.field&&v6(e,s.agg.params,n):(u={groupby:e.fieldRef(t,"key"),pulse:Me(r.output)},n&&n.field&&v6(e,u,n),a=e.add(yB(u)),s=e.add(po({pulse:Me(a)})),s={agg:a,ref:Me(s)},o!=null&&(i[o]=s)),s.ref},tuplesRef(){return Me(this.values)},extentRef(e,t){return kh(e,this,"extent","extent",t,!1)},domainRef(e,t){return kh(e,this,"domain","values",t,!1)},valuesRef(e,t,n){return kh(e,this,"vals","values",t,n||!0)},lookupRef(e,t){return kh(e,this,"lookup","tupleindex",t,!1)},indataRef(e,t){return kh(e,this,"indata","tupleindex",t,!0,!0)}};function bpe(e,t,n){const r=e.from.facet,i=r.name,o=p1(r,t);let s;r.name||te("Facet must have a name: "+de(r)),r.data||te("Facet must reference a data set: "+de(r)),r.field?s=t.add(wB({field:t.fieldRef(r.field),pulse:o})):r.groupby?s=t.add(ohe({key:t.keyRef(r.groupby),group:Me(t.proxy(n.parent)),pulse:o})):te("Facet must specify groupby or field: "+de(r));const a=t.fork(),u=a.add(po()),c=a.add(Zl({pulse:Me(u)}));a.addData(i,new Nl(a,u,u,c)),a.addSignal("parent",null),s.params.subflow={$subflow:a.parse(e).toRuntime()}}function Spe(e,t,n){const r=t.add(wB({pulse:n.pulse})),i=t.fork();i.add(Zl()),i.addSignal("parent",null),r.params.subflow={$subflow:i.parse(e).toRuntime()}}function RB(e,t,n){const r=e.remove,i=e.insert,o=e.toggle,s=e.modify,a=e.values,u=t.add(Ny()),c="if("+e.trigger+',modify("'+n+'",'+[i,r,o,s,a].map(h=>h??"null").join(",")+"),0)",f=Qo(c,t);u.update=f.$expr,u.params=f.$params}function cx(e,t){const n=MB(e),r=e.type===ax,i=e.from&&e.from.facet,o=e.overlap;let s=e.layout||n===G$||n===H$,a,u,c,f,h,p,m;const y=n===q$||s||i,v=Epe(e.from,r,t);u=t.add(rhe({key:v.key||(e.key?Up(e.key):void 0),pulse:v.pulse,clean:!r}));const w=Me(u);u=c=t.add(po({pulse:w})),u=t.add(che({markdef:hpe(e),interactive:ppe(e.interactive,t),clip:dpe(e.clip,t),context:{$context:!0},groups:t.lookup(),parent:t.signals.parent?t.signalRef("parent"):null,index:t.markpath(),pulse:Me(u)}));const E=Me(u);u=f=t.add(xB(gB(e.encode,e.type,n,e.style,t,{mod:!1,pulse:E}))),u.params.parent=t.encode(),e.transform&&e.transform.forEach(D=>{const $=nF(D,t),M=$.metadata;(M.generates||M.changes)&&te("Mark transforms should not generate new data."),M.nomod||(f.params.mod=!0),$.params.pulse=Me(u),t.add(u=$)}),e.sort&&(u=t.add(xhe({sort:t.compareRef(e.sort),pulse:Me(u)})));const S=Me(u);(i||s)&&(s=t.add(bB({layout:t.objectProperty(e.layout),legends:t.legends,mark:E,pulse:S})),p=Me(s));const A=t.add(vB({mark:E,pulse:p||S}));m=Me(A),r&&(y&&(a=t.operators,a.pop(),s&&a.pop()),t.pushState(S,p||m,w),i?bpe(e,t,v):y?Spe(e,t,v):t.parse(e),t.popState(),y&&(s&&a.push(s),a.push(A))),o&&(m=_pe(o,m,t));const C=t.add(EB({pulse:m})),k=t.add(Zl({pulse:Me(C)},void 0,t.parent()));e.name!=null&&(h=e.name,t.addData(h,new Nl(t,c,C,k)),e.on&&e.on.forEach(D=>{(D.insert||D.remove||D.toggle)&&te("Marks only support modify triggers."),RB(D,t,h)}))}function _pe(e,t,n){const r=e.method,i=e.bound,o=e.separation,s={separation:an(o)?n.signalRef(o.signal):o,method:an(r)?n.signalRef(r.signal):r,pulse:t};if(e.order&&(s.sort=n.compareRef({field:e.order})),i){const a=i.tolerance;s.boundTolerance=an(a)?n.signalRef(a.signal):+a,s.boundScale=n.scaleRef(i.scale),s.boundOrient=i.orient}return Me(n.add(hhe(s)))}function Ape(e,t){const n=t.config.legend,r=e.encode||{},i=Hr(e,n),o=r.legend||{},s=o.name||void 0,a=o.interactive,u=o.style,c={};let f=0,h,p,m;K$.forEach(A=>e[A]?(c[A]=e[A],f=f||e[A]):0),f||te("Missing valid scale for legend.");const y=Cpe(e,t.scaleType(f)),v={title:e.title!=null,scales:c,type:y,vgrad:y!=="symbol"&&i.isVertical()},w=Me(t.add(po(null,[v]))),E={enter:{x:{value:0},y:{value:0}}},S=Me(t.add(uhe(p={type:y,scale:t.scaleRef(f),count:t.objectProperty(i("tickCount")),limit:t.property(i("symbolLimit")),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)})));return y===h1?(m=[Jhe(e,f,n,r.gradient),d6(e,n,r.labels,S)],p.count=p.count||t.signalRef(`max(2,2*floor((${ml(i.gradientLength())})/100))`)):y===D_?m=[Zhe(e,f,n,r.gradient,S),d6(e,n,r.labels,S)]:(h=rpe(e,n),m=[npe(e,n,r,S,ml(h.columns))],p.size=Fpe(e,t,m[0].marks)),m=[Wp({role:_de,from:w,encode:E,marks:m,layout:h,interactive:a})],v.title&&m.push(fpe(e,n,r.title,w)),cx(Wp({role:bde,from:w,encode:dd($pe(i,e,n),o,Dg),marks:m,aria:i("aria"),description:i("description"),zindex:i("zindex"),name:s,interactive:a,style:u}),t)}function Cpe(e,t){let n=e.type||f6;return!e.type&&kpe(e)===1&&(e.fill||e.stroke)&&(n=rk(t)?h1:bS(t)?D_:f6),n!==h1?n:bS(t)?D_:h1}function kpe(e){return K$.reduce((t,n)=>t+(e[n]?1:0),0)}function $pe(e,t,n){const r={enter:{},update:{}};return On(r,{orient:e("orient"),offset:e("offset"),padding:e("padding"),titlePadding:e("titlePadding"),cornerRadius:e("cornerRadius"),fill:e("fillColor"),stroke:e("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:e("legendX"),y:e("legendY"),format:t.format,formatType:t.formatType}),r}function Fpe(e,t,n){const r=ml(x6("size",e,n)),i=ml(x6("strokeWidth",e,n)),o=ml(Dpe(n[1].encode,t,Fg));return Qo(`max(ceil(sqrt(${r})+${i}),${o})`,t)}function x6(e,t,n){return t[e]?`scale("${t[e]}",datum)`:FB(e,n[0].encode)}function Dpe(e,t,n){return FB("fontSize",e)||Qhe("fontSize",t,n)}const Mpe=`item.orient==="${hd}"?-90:item.orient==="${pd}"?90:0`;function Tpe(e,t){e=ve(e)?{text:e}:e;const n=Hr(e,t.config.title),r=e.encode||{},i=r.group||{},o=i.name||void 0,s=i.interactive,a=i.style,u=[],c={},f=Me(t.add(po(null,[c])));return u.push(Ope(e,n,Npe(e),f)),e.subtitle&&u.push(Ppe(e,n,r.subtitle,f)),cx(Wp({role:$de,from:f,encode:Rpe(n,i),marks:u,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:o,interactive:s,style:a}),t)}function Npe(e){const t=e.encode;return t&&t.title||qe({name:e.name,interactive:e.interactive,style:e.style},t)}function Rpe(e,t){const n={enter:{},update:{}};return On(n,{orient:e("orient"),anchor:e("anchor"),align:{signal:Z$},angle:{signal:Mpe},limit:e("limit"),frame:e("frame"),offset:e("offset")||0,padding:e("subtitlePadding")}),dd(n,t,Dg)}function Ope(e,t,n,r){const i={value:0},o=e.text,s={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return On(s,{text:o,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("color"),font:t("font"),fontSize:t("fontSize"),fontStyle:t("fontStyle"),fontWeight:t("fontWeight"),lineHeight:t("lineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),li({type:ec,role:Fde,style:Uhe,from:r,encode:s},n)}function Ppe(e,t,n,r){const i={value:0},o=e.subtitle,s={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return On(s,{text:o,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("subtitleColor"),font:t("subtitleFont"),fontSize:t("subtitleFontSize"),fontStyle:t("subtitleFontStyle"),fontWeight:t("subtitleFontWeight"),lineHeight:t("subtitleLineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),li({type:ec,role:Dde,style:jhe,from:r,encode:s},n)}function Lpe(e,t){const n=[];e.transform&&e.transform.forEach(r=>{n.push(nF(r,t))}),e.on&&e.on.forEach(r=>{RB(r,t,e.name)}),t.addDataPipeline(e.name,zpe(e,t,n))}function zpe(e,t,n){const r=[];let i=null,o=!1,s=!1,a,u,c,f,h;for(e.values?an(e.values)||f1(e.format)?(r.push(w6(t,e)),r.push(i=Hu())):r.push(i=Hu({$ingest:e.values,$format:e.format})):e.url?f1(e.url)||f1(e.format)?(r.push(w6(t,e)),r.push(i=Hu())):r.push(i=Hu({$request:e.url,$format:e.format})):e.source&&(i=a=xe(e.source).map(p=>Me(t.getData(p).output)),r.push(null)),u=0,c=n.length;u<c;++u)f=n[u],h=f.metadata,!i&&!h.source&&r.push(i=Hu()),r.push(f),h.generates&&(s=!0),h.modifies&&!s&&(o=!0),h.source?i=f:h.changes&&(i=null);return a&&(c=a.length-1,r[0]=yhe({derive:o,pulse:c?a:a[0]}),(o||c)&&r.splice(1,0,Hu())),i||r.push(Hu()),r.push(Zl({})),r}function Hu(e){const t=po({},e);return t.metadata={source:!0},t}function w6(e,t){return lhe({url:t.url?e.property(t.url):void 0,async:t.async?e.property(t.async):void 0,values:t.values?e.property(t.values):void 0,format:e.objectProperty(t.format)})}const OB=e=>e===au||e===go,fx=(e,t,n)=>an(e)?jpe(e.signal,t,n):e===hd||e===go?t:n,vn=(e,t,n)=>an(e)?Bpe(e.signal,t,n):OB(e)?t:n,ro=(e,t,n)=>an(e)?Upe(e.signal,t,n):OB(e)?n:t,PB=(e,t,n)=>an(e)?Wpe(e.signal,t,n):e===go?{value:t}:{value:n},Ipe=(e,t,n)=>an(e)?qpe(e.signal,t,n):e===pd?{value:t}:{value:n},Bpe=(e,t,n)=>LB(`${e} === '${go}' || ${e} === '${au}'`,t,n),Upe=(e,t,n)=>LB(`${e} !== '${go}' && ${e} !== '${au}'`,t,n),jpe=(e,t,n)=>rF(`${e} === '${hd}' || ${e} === '${go}'`,t,n),Wpe=(e,t,n)=>rF(`${e} === '${go}'`,t,n),qpe=(e,t,n)=>rF(`${e} === '${pd}'`,t,n),LB=(e,t,n)=>(t=t!=null?yn(t):t,n=n!=null?yn(n):n,E6(t)&&E6(n)?(t=t?t.signal||de(t.value):null,n=n?n.signal||de(n.value):null,{signal:`${e} ? (${t}) : (${n})`}):[qe({test:e},t)].concat(n||[])),E6=e=>e==null||Object.keys(e).length===1,rF=(e,t,n)=>({signal:`${e} ? (${rf(t)}) : (${rf(n)})`}),Hpe=(e,t,n,r,i)=>({signal:(r!=null?`${e} === '${hd}' ? (${rf(r)}) : `:"")+(n!=null?`${e} === '${au}' ? (${rf(n)}) : `:"")+(i!=null?`${e} === '${pd}' ? (${rf(i)}) : `:"")+(t!=null?`${e} === '${go}' ? (${rf(t)}) : `:"")+"(null)"}),rf=e=>an(e)?e.signal:e==null?null:de(e),Gpe=(e,t)=>t===0?0:an(e)?{signal:`(${e.signal}) * ${t}`}:{value:e*t},cf=(e,t)=>{const n=e.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+t.signal}:e};function qc(e,t,n,r){let i;if(t&&Ee(t,e))return t[e];if(Ee(n,e))return n[e];if(e.startsWith("title")){switch(e){case"titleColor":i="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":i=e[5].toLowerCase()+e.slice(6)}return r[Q$][i]}else if(e.startsWith("label")){switch(e){case"labelColor":i="fill";break;case"labelFont":case"labelFontSize":i=e[5].toLowerCase()+e.slice(6)}return r[Fg][i]}return null}function b6(e){const t={};for(const n of e)if(n)for(const r in n)t[r]=1;return Object.keys(t)}function Vpe(e,t){var n=t.config,r=n.style,i=n.axis,o=t.scaleType(e.scale)==="band"&&n.axisBand,s=e.orient,a,u,c;if(an(s)){const h=b6([n.axisX,n.axisY]),p=b6([n.axisTop,n.axisBottom,n.axisLeft,n.axisRight]);a={};for(c of h)a[c]=vn(s,qc(c,n.axisX,i,r),qc(c,n.axisY,i,r));u={};for(c of p)u[c]=Hpe(s.signal,qc(c,n.axisTop,i,r),qc(c,n.axisBottom,i,r),qc(c,n.axisLeft,i,r),qc(c,n.axisRight,i,r))}else a=s===go||s===au?n.axisX:n.axisY,u=n["axis"+s[0].toUpperCase()+s.slice(1)];return a||u||o?qe({},i,a,u,o):i}function Ype(e,t,n,r){const i=Hr(e,t),o=e.orient;let s,a;const u={enter:s={opacity:tt},update:a={opacity:Ci},exit:{opacity:tt}};On(u,{stroke:i("domainColor"),strokeCap:i("domainCap"),strokeDash:i("domainDash"),strokeDashOffset:i("domainDashOffset"),strokeWidth:i("domainWidth"),strokeOpacity:i("domainOpacity")});const c=S6(e,0),f=S6(e,1);return s.x=a.x=vn(o,c,tt),s.x2=a.x2=vn(o,f),s.y=a.y=ro(o,c,tt),s.y2=a.y2=ro(o,f),li({type:J$,role:yde,from:r,encode:u},n)}function S6(e,t){return{scale:e.scale,range:t}}function Xpe(e,t,n,r,i){const o=Hr(e,t),s=e.orient,a=e.gridScale,u=fx(s,1,-1),c=Qpe(e.offset,u);let f,h,p;const m={enter:f={opacity:tt},update:p={opacity:Ci},exit:h={opacity:tt}};On(m,{stroke:o("gridColor"),strokeCap:o("gridCap"),strokeDash:o("gridDash"),strokeDashOffset:o("gridDashOffset"),strokeOpacity:o("gridOpacity"),strokeWidth:o("gridWidth")});const y={scale:e.scale,field:Ai,band:i.band,extra:i.extra,offset:i.offset,round:o("tickRound")},v=vn(s,{signal:"height"},{signal:"width"}),w=a?{scale:a,range:0,mult:u,offset:c}:{value:0,offset:c},E=a?{scale:a,range:1,mult:u,offset:c}:qe(v,{mult:u,offset:c});return f.x=p.x=vn(s,y,w),f.y=p.y=ro(s,y,w),f.x2=p.x2=ro(s,E),f.y2=p.y2=vn(s,E),h.x=vn(s,y),h.y=ro(s,y),li({type:J$,role:vde,key:Ai,from:r,encode:m},n)}function Qpe(e,t){if(t!==1)if(!ye(e))e=an(t)?{signal:`(${t.signal}) * (${e||0})`}:t*(e||0);else{let n=e=qe({},e);for(;n.mult!=null;)if(ye(n.mult))n=n.mult=qe({},n.mult);else return n.mult=an(t)?{signal:`(${n.mult}) * (${t.signal})`}:n.mult*t,e;n.mult=t}return e}function Kpe(e,t,n,r,i,o){const s=Hr(e,t),a=e.orient,u=fx(a,-1,1);let c,f,h;const p={enter:c={opacity:tt},update:h={opacity:Ci},exit:f={opacity:tt}};On(p,{stroke:s("tickColor"),strokeCap:s("tickCap"),strokeDash:s("tickDash"),strokeDashOffset:s("tickDashOffset"),strokeOpacity:s("tickOpacity"),strokeWidth:s("tickWidth")});const m=yn(i);m.mult=u;const y={scale:e.scale,field:Ai,band:o.band,extra:o.extra,offset:o.offset,round:s("tickRound")};return h.y=c.y=vn(a,tt,y),h.y2=c.y2=vn(a,m),f.x=vn(a,y),h.x=c.x=ro(a,tt,y),h.x2=c.x2=ro(a,m),f.y=ro(a,y),li({type:J$,role:wde,key:Ai,from:r,encode:p},n)}function lb(e,t,n,r,i){return{signal:'flush(range("'+e+'"), scale("'+e+'", datum.value), '+t+","+n+","+r+","+i+")"}}function Jpe(e,t,n,r,i,o){const s=Hr(e,t),a=e.orient,u=e.scale,c=fx(a,-1,1),f=ml(s("labelFlush")),h=ml(s("labelFlushOffset")),p=s("labelAlign"),m=s("labelBaseline");let y=f===0||!!f,v;const w=yn(i);w.mult=c,w.offset=yn(s("labelPadding")||0),w.offset.mult=c;const E={scale:u,field:Ai,band:.5,offset:DB(o.offset,s("labelOffset"))},S=vn(a,y?lb(u,f,'"left"','"right"','"center"'):{value:"center"},Ipe(a,"left","right")),A=vn(a,PB(a,"bottom","top"),y?lb(u,f,'"top"','"bottom"','"middle"'):{value:"middle"}),C=lb(u,f,`-(${h})`,h,0);y=y&&h;const k={opacity:tt,x:vn(a,E,w),y:ro(a,E,w)},D={enter:k,update:v={opacity:Ci,text:{field:X$},x:k.x,y:k.y,align:S,baseline:A},exit:{opacity:tt,x:k.x,y:k.y}};On(D,{dx:!p&&y?vn(a,C):null,dy:!m&&y?ro(a,C):null}),On(D,{angle:s("labelAngle"),fill:s("labelColor"),fillOpacity:s("labelOpacity"),font:s("labelFont"),fontSize:s("labelFontSize"),fontWeight:s("labelFontWeight"),fontStyle:s("labelFontStyle"),limit:s("labelLimit"),lineHeight:s("labelLineHeight")},{align:p,baseline:m});const $=s("labelBound");let M=s("labelOverlap");return M=M||$?{separation:s("labelSeparation"),method:M,order:"datum.index",bound:$?{scale:u,orient:a,tolerance:$}:null}:void 0,v.align!==S&&(v.align=cf(v.align,S)),v.baseline!==A&&(v.baseline=cf(v.baseline,A)),li({type:ec,role:xde,style:Fg,key:Ai,from:r,encode:D,overlap:M},n)}function Zpe(e,t,n,r){const i=Hr(e,t),o=e.orient,s=fx(o,-1,1);let a,u;const c={enter:a={opacity:tt,anchor:yn(i("titleAnchor",null)),align:{signal:Z$}},update:u=qe({},a,{opacity:Ci,text:yn(e.title)}),exit:{opacity:tt}},f={signal:`lerp(range("${e.scale}"), ${ux(0,1,.5)})`};return u.x=vn(o,f),u.y=ro(o,f),a.angle=vn(o,tt,Gpe(s,90)),a.baseline=vn(o,PB(o,au,go),{value:au}),u.angle=a.angle,u.baseline=a.baseline,On(c,{fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),angle:i("titleAngle"),baseline:i("titleBaseline")}),ege(i,o,c,n),c.update.align=cf(c.update.align,a.align),c.update.angle=cf(c.update.angle,a.angle),c.update.baseline=cf(c.update.baseline,a.baseline),li({type:ec,role:Ede,style:Q$,from:r,encode:c},n)}function ege(e,t,n,r){const i=(a,u)=>a!=null?(n.update[u]=cf(yn(a),n.update[u]),!1):!Qc(u,r),o=i(e("titleX"),"x"),s=i(e("titleY"),"y");n.enter.auto=s===o?yn(s):vn(t,yn(s),yn(o))}function tge(e,t){const n=Vpe(e,t),r=e.encode||{},i=r.axis||{},o=i.name||void 0,s=i.interactive,a=i.style,u=Hr(e,n),c=Khe(u),f={scale:e.scale,ticks:!!u("ticks"),labels:!!u("labels"),grid:!!u("grid"),domain:!!u("domain"),title:e.title!=null},h=Me(t.add(po({},[f]))),p=Me(t.add(nhe({scale:t.scaleRef(e.scale),extra:t.property(c.extra),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)}))),m=[];let y;return f.grid&&m.push(Xpe(e,n,r.grid,p,c)),f.ticks&&(y=u("tickSize"),m.push(Kpe(e,n,r.ticks,p,y,c))),f.labels&&(y=f.ticks?y:0,m.push(Jpe(e,n,r.labels,p,y,c))),f.domain&&m.push(Ype(e,n,r.domain,h)),f.title&&m.push(Zpe(e,n,r.title,h)),cx(Wp({role:mde,from:h,encode:dd(nge(u,e),i,Dg),marks:m,aria:u("aria"),description:u("description"),zindex:u("zindex"),name:o,interactive:s,style:a}),t)}function nge(e,t){const n={enter:{},update:{}};return On(n,{orient:e("orient"),offset:e("offset")||0,position:Yi(t.position,0),titlePadding:e("titlePadding"),minExtent:e("minExtent"),maxExtent:e("maxExtent"),range:{signal:`abs(span(range("${t.scale}")))`},translate:e("translate"),format:t.format,formatType:t.formatType}),n}function zB(e,t,n){const r=xe(e.signals),i=xe(e.scales);return n||r.forEach(o=>mB(o,t)),xe(e.projections).forEach(o=>Rhe(o,t)),i.forEach(o=>bhe(o,t)),xe(e.data).forEach(o=>Lpe(o,t)),i.forEach(o=>She(o,t)),(n||r).forEach(o=>the(o,t)),xe(e.axes).forEach(o=>tge(o,t)),xe(e.marks).forEach(o=>cx(o,t)),xe(e.legends).forEach(o=>Ape(o,t)),e.title&&Tpe(e.title,t),t.parseLambdas(),t}const rge=e=>dd({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e);function ige(e,t){const n=t.config,r=Me(t.root=t.add(Ny())),i=oge(e,n);i.forEach(c=>mB(c,t)),t.description=e.description||n.description,t.eventConfig=n.events,t.legends=t.objectProperty(n.legend&&n.legend.layout),t.locale=n.locale;const o=t.add(po()),s=t.add(xB(gB(rge(e.encode),ax,H$,e.style,t,{pulse:Me(o)}))),a=t.add(bB({layout:t.objectProperty(e.layout),legends:t.legends,autosize:t.signalRef("autosize"),mark:r,pulse:Me(s)}));t.operators.pop(),t.pushState(Me(s),Me(a),null),zB(e,t,i),t.operators.push(a);let u=t.add(vB({mark:r,pulse:Me(a)}));return u=t.add(EB({pulse:Me(u)})),u=t.add(Zl({pulse:Me(u)})),t.addData("root",new Nl(t,o,o,u)),t}function $h(e,t){return t&&t.signal?{name:e,update:t.signal}:{name:e,value:t}}function oge(e,t){const n=s=>Yi(e[s],t[s]),r=[$h("background",n("background")),$h("autosize",hde(n("autosize"))),$h("padding",gde(n("padding"))),$h("width",n("width")||0),$h("height",n("height")||0)],i=r.reduce((s,a)=>(s[a.name]=a,s),{}),o={};return xe(e.signals).forEach(s=>{Ee(i,s.name)?s=qe(i[s.name],s):r.push(s),o[s.name]=s}),xe(t.signals).forEach(s=>{!Ee(o,s.name)&&!Ee(i,s.name)&&r.push(s)}),r}function IB(e,t){this.config=e||{},this.options=t||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function _6(e){this.config=e.config,this.options=e.options,this.legends=e.legends,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath}IB.prototype=_6.prototype={parse(e){return zB(e,this)},fork(){return new _6(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(e){return this.operators.push(e),e.id=this.id(),e.refs&&(e.refs.forEach(t=>{t.$ref=e.id}),e.refs=null),e},proxy(e){const t=e instanceof A_?Me(e):e;return this.add(mhe({value:t}))},addStream(e){return this.streams.push(e),e.id=this.id(),e},addUpdate(e){return this.updates.push(e),e},finish(){let e,t;this.root&&(this.root.root=!0);for(e in this.signals)this.signals[e].signal=e;for(e in this.scales)this.scales[e].scale=e;function n(r,i,o){let s,a;r&&(s=r.data||(r.data={}),a=s[i]||(s[i]=[]),a.push(o))}for(e in this.data){t=this.data[e],n(t.input,e,"input"),n(t.output,e,"output"),n(t.values,e,"values");for(const r in t.index)n(t.index[r],e,"index:"+r)}return this},pushState(e,t,n){this._encode.push(Me(this.add(Zl({pulse:e})))),this._parent.push(t),this._lookup.push(n?Me(this.proxy(n)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return Ze(this._parent)},encode(){return Ze(this._encode)},lookup(){return Ze(this._lookup)},markpath(){const e=this._markpath;return++e[e.length-1]},fieldRef(e,t){if(ve(e))return Up(e,t);e.signal||te("Unsupported field reference: "+de(e));const n=e.signal;let r=this.field[n];if(!r){const i={name:this.signalRef(n)};t&&(i.as=t),this.field[n]=r=Me(this.add(she(i)))}return r},compareRef(e){let t=!1;const n=o=>an(o)?(t=!0,this.signalRef(o.signal)):Hde(o)?(t=!0,this.exprRef(o.expr)):o,r=xe(e.field).map(n),i=xe(e.order).map(n);return t?Me(this.add(c6({fields:r,orders:i}))):u6(r,i)},keyRef(e,t){let n=!1;const r=o=>an(o)?(n=!0,Me(i[o.signal])):o,i=this.signals;return e=xe(e).map(r),n?Me(this.add(ahe({fields:e,flat:t}))):Ude(e,t)},sortRef(e){if(!e)return e;const t=ox(e.op,e.field),n=e.order||jde;return n.signal?Me(this.add(c6({fields:t,orders:this.signalRef(n.signal)}))):u6(t,n)},event(e,t){const n=e+":"+t;if(!this.events[n]){const r=this.id();this.streams.push({id:r,source:e,type:t}),this.events[n]=r}return this.events[n]},hasOwnSignal(e){return Ee(this.signals,e)},addSignal(e,t){this.hasOwnSignal(e)&&te("Duplicate signal name: "+de(e));const n=t instanceof A_?t:this.add(Ny(t));return this.signals[e]=n},getSignal(e){return this.signals[e]||te("Unrecognized signal name: "+de(e)),this.signals[e]},signalRef(e){return this.signals[e]?Me(this.signals[e]):(Ee(this.lambdas,e)||(this.lambdas[e]=this.add(Ny(null))),Me(this.lambdas[e]))},parseLambdas(){const e=Object.keys(this.lambdas);for(let t=0,n=e.length;t<n;++t){const r=e[t],i=Qo(r,this),o=this.lambdas[r];o.params=i.$params,o.update=i.$expr}},property(e){return e&&e.signal?this.signalRef(e.signal):e},objectProperty(e){return!e||!ye(e)?e:this.signalRef(e.signal||iF(e))},exprRef(e,t){const n={expr:Qo(e,this)};return t&&(n.expr.$name=t),Me(this.add(ihe(n)))},addBinding(e,t){this.bindings||te("Nested signals do not support binding: "+de(e)),this.bindings.push(qe({signal:e},t))},addScaleProj(e,t){Ee(this.scales,e)&&te("Duplicate scale or projection name: "+de(e)),this.scales[e]=this.add(t)},addScale(e,t){this.addScaleProj(e,vhe(t))},addProjection(e,t){this.addScaleProj(e,ghe(t))},getScale(e){return this.scales[e]||te("Unrecognized scale name: "+de(e)),this.scales[e]},scaleRef(e){return Me(this.getScale(e))},scaleType(e){return this.getScale(e).params.type},projectionRef(e){return this.scaleRef(e)},projectionType(e){return this.scaleType(e)},addData(e,t){return Ee(this.data,e)&&te("Duplicate data set name: "+de(e)),this.data[e]=t},getData(e){return this.data[e]||te("Undefined data set name: "+de(e)),this.data[e]},addDataPipeline(e,t){return Ee(this.data,e)&&te("Duplicate data set name: "+de(e)),this.addData(e,Nl.fromEntries(this,t))}};function iF(e){return(ne(e)?sge:age)(e)}function sge(e){const t=e.length;let n="[";for(let r=0;r<t;++r){const i=e[r];n+=(r>0?",":"")+(ye(i)?i.signal||iF(i):de(i))}return n+"]"}function age(e){let t="{",n=0,r,i;for(r in e)i=e[r],t+=(++n>1?",":"")+de(r)+":"+(ye(i)?i.signal||iF(i):de(i));return t+"}"}function uge(){const e="sans-serif",r="#4c78a8",i="#000",o="#888",s="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:r},area:{fill:r},image:null,line:{stroke:r,strokeWidth:2},path:{stroke:r},rect:{fill:r},rule:{stroke:i},shape:{stroke:r},symbol:{fill:r,size:64},text:{fill:i,font:e,fontSize:11},trail:{fill:r,size:2},style:{"guide-label":{fill:i,font:e,fontSize:10},"guide-title":{fill:i,font:e,fontSize:11,fontWeight:"bold"},"group-title":{fill:i,font:e,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:i,font:e,fontSize:12},point:{size:30,strokeWidth:2,shape:"circle"},circle:{size:30,strokeWidth:2},square:{size:30,strokeWidth:2,shape:"square"},cell:{fill:"transparent",stroke:s},view:{fill:"transparent"}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:o,grid:!1,gridWidth:1,gridColor:s,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:o,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:s,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:o,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}function lge(e,t,n){return ye(e)||te("Input Vega specification must be an object."),t=Jf(uge(),t,e.config),ige(e,new IB(t,n)).toRuntime()}var cge="5.33.0";qe(Ef,ZQ,Fne,are,Gie,Boe,hae,Gse,gae,Iae,Xae,nue);const fge=Object.freeze(Object.defineProperty({__proto__:null,Bounds:Jt,CanvasHandler:wg,CanvasRenderer:V1,DATE:Ir,DAY:Gn,DAYOFYEAR:Yo,Dataflow:sf,Debug:N4,DisallowedObjectProperties:gA,Error:mA,EventStream:fv,Gradient:CL,GroupItem:Rv,HOURS:si,Handler:$k,HybridHandler:y7,HybridRenderer:NS,Info:T4,Item:Nv,MILLISECONDS:so,MINUTES:ai,MONTH:Qn,Marks:ui,MultiPulse:jA,None:M4,Operator:Et,Parameters:cv,Pulse:Ya,QUARTER:zr,RenderType:Ba,Renderer:xg,ResourceLoader:NL,SECONDS:Fi,SVGHandler:i7,SVGRenderer:Rk,SVGStringRenderer:m7,Scenegraph:QL,TIME_UNITS:TA,Transform:J,View:rB,WEEK:on,Warn:yA,YEAR:Nn,accessor:qr,accessorFields:Xn,accessorName:Wt,array:xe,ascending:ed,bandwidthNRD:GA,bin:hP,bootstrapCI:pP,boundClip:k7,boundContext:gg,boundItem:$S,boundMark:GL,boundStroke:Zs,changeset:Xl,clampRange:q4,codegenExpression:DI,compare:bA,constant:nr,cumulativeLogNormal:JA,cumulativeNormal:hv,cumulativeUniform:nC,dayofyear:w8,debounce:SA,defaultLocale:LA,definition:cP,densityLogNormal:KA,densityNormal:VA,densityUniform:tC,domChild:rn,domClear:xi,domCreate:za,domFind:kk,dotbin:gP,error:te,expressionFunction:Qt,extend:qe,extent:Ho,extentIndex:H4,falsy:$a,fastmap:td,field:ki,flush:G4,font:Iv,fontFamily:vg,fontSize:rs,format:Hm,formatLocale:A1,formats:BA,hasOwnProperty:Ee,id:eg,identity:tr,inferType:Z8,inferTypes:eP,ingest:ct,inherits:pe,inrange:Jc,interpolate:ik,interpolateColors:Mv,interpolateRange:dL,intersect:S7,intersectBoxLine:Zc,intersectPath:dk,intersectPoint:hk,intersectRule:OL,isArray:ne,isBoolean:hu,isDate:Ga,isFunction:He,isIterable:V4,isNumber:at,isObject:ye,isRegExp:_A,isString:ve,isTuple:uv,key:AA,lerp:Y4,lineHeight:iu,loader:sv,locale:K8,logger:vA,lruCache:X4,markup:Nk,merge:Q4,mergeConfig:Jf,multiLineOffset:_k,one:Kf,pad:K4,panLinear:z4,panLog:I4,panPow:B4,panSymlog:U4,parse:lge,parseExpression:kI,parseSelector:xu,path:vv,pathCurves:lk,pathEqual:$7,pathParse:kf,pathRectangle:FL,pathRender:Fp,pathSymbols:$L,pathTrail:DL,peek:Ze,point:Uv,projection:Zk,quantileLogNormal:ZA,quantileNormal:pv,quantileUniform:rC,quantiles:qA,quantizeInterpolator:hL,quarter:j4,quartiles:HA,get random(){return Di},randomInteger:rQ,randomKDE:XA,randomLCG:nQ,randomLogNormal:yP,randomMixture:vP,randomNormal:YA,randomUniform:xP,read:rP,regressionConstant:iC,regressionExp:EP,regressionLinear:oC,regressionLoess:_P,regressionLog:wP,regressionPoly:SP,regressionPow:bP,regressionQuad:sC,renderModule:jv,repeat:Oh,resetDefaultLocale:ZY,resetSVGClipId:TL,resetSVGDefIds:Vte,responseType:nP,runtimeContext:qI,sampleCurve:mv,sampleLogNormal:QA,sampleNormal:dv,sampleUniform:eC,scale:lt,sceneEqual:Ok,sceneFromJSON:YL,scenePickVisit:I1,sceneToJSON:VL,sceneVisit:ao,sceneZOrder:pk,scheme:ok,serializeXML:d7,setHybridRendererOptions:Wte,setRandom:eQ,span:tg,splitAccessPath:es,stringValue:de,textMetrics:ri,timeBin:L8,timeFloor:k8,timeFormatLocale:Sp,timeInterval:od,timeOffset:D8,timeSequence:N8,timeUnitSpecifier:x8,timeUnits:NA,toBoolean:CA,toDate:kA,toNumber:Vn,toSet:oo,toString:$A,transform:fP,transforms:Ef,truncate:J4,truthy:$i,tupleid:Te,typeParsers:cS,utcFloor:$8,utcInterval:sd,utcOffset:M8,utcSequence:R8,utcdayofyear:S8,utcquarter:W4,utcweek:_8,version:cge,visitArray:Ma,week:E8,writeConfig:Zf,zero:Pa,zoomLinear:xA,zoomLog:wA,zoomPow:x1,zoomSymlog:EA},Symbol.toStringTag,{value:"Module"}));function dge(e,t,n){let r;t.x2&&(t.x?(n&&e.x>e.x2&&(r=e.x,e.x=e.x2,e.x2=r),e.width=e.x2-e.x):e.x=e.x2-(e.width||0)),t.xc&&(e.x=e.xc-(e.width||0)/2),t.y2&&(t.y?(n&&e.y>e.y2&&(r=e.y,e.y=e.y2,e.y2=r),e.height=e.y2-e.y):e.y=e.y2-(e.height||0)),t.yc&&(e.y=e.yc-(e.height||0)/2)}var hge={NaN:NaN,E:Math.E,LN2:Math.LN2,LN10:Math.LN10,LOG2E:Math.LOG2E,LOG10E:Math.LOG10E,PI:Math.PI,SQRT1_2:Math.SQRT1_2,SQRT2:Math.SQRT2,MIN_VALUE:Number.MIN_VALUE,MAX_VALUE:Number.MAX_VALUE},pge={"*":(e,t)=>e*t,"+":(e,t)=>e+t,"-":(e,t)=>e-t,"/":(e,t)=>e/t,"%":(e,t)=>e%t,">":(e,t)=>e>t,"<":(e,t)=>e<t,"<=":(e,t)=>e<=t,">=":(e,t)=>e>=t,"==":(e,t)=>e==t,"!=":(e,t)=>e!=t,"===":(e,t)=>e===t,"!==":(e,t)=>e!==t,"&":(e,t)=>e&t,"|":(e,t)=>e|t,"^":(e,t)=>e^t,"<<":(e,t)=>e<<t,">>":(e,t)=>e>>t,">>>":(e,t)=>e>>>t},gge={"+":e=>+e,"-":e=>-e,"~":e=>~e,"!":e=>!e};const mge=Array.prototype.slice,Gu=(e,t,n)=>{const r=n?n(t[0]):t[0];return r[e].apply(r,mge.call(t,1))},yge=(e,t,n,r,i,o,s)=>new Date(e,t||0,n??1,r||0,i||0,o||0,s||0);var vge={isNaN:Number.isNaN,isFinite:Number.isFinite,abs:Math.abs,acos:Math.acos,asin:Math.asin,atan:Math.atan,atan2:Math.atan2,ceil:Math.ceil,cos:Math.cos,exp:Math.exp,floor:Math.floor,log:Math.log,max:Math.max,min:Math.min,pow:Math.pow,random:Math.random,round:Math.round,sin:Math.sin,sqrt:Math.sqrt,tan:Math.tan,clamp:(e,t,n)=>Math.max(t,Math.min(n,e)),now:Date.now,utc:Date.UTC,datetime:yge,date:e=>new Date(e).getDate(),day:e=>new Date(e).getDay(),year:e=>new Date(e).getFullYear(),month:e=>new Date(e).getMonth(),hours:e=>new Date(e).getHours(),minutes:e=>new Date(e).getMinutes(),seconds:e=>new Date(e).getSeconds(),milliseconds:e=>new Date(e).getMilliseconds(),time:e=>new Date(e).getTime(),timezoneoffset:e=>new Date(e).getTimezoneOffset(),utcdate:e=>new Date(e).getUTCDate(),utcday:e=>new Date(e).getUTCDay(),utcyear:e=>new Date(e).getUTCFullYear(),utcmonth:e=>new Date(e).getUTCMonth(),utchours:e=>new Date(e).getUTCHours(),utcminutes:e=>new Date(e).getUTCMinutes(),utcseconds:e=>new Date(e).getUTCSeconds(),utcmilliseconds:e=>new Date(e).getUTCMilliseconds(),length:e=>e.length,join:function(){return Gu("join",arguments)},indexof:function(){return Gu("indexOf",arguments)},lastindexof:function(){return Gu("lastIndexOf",arguments)},slice:function(){return Gu("slice",arguments)},reverse:e=>e.slice().reverse(),sort:e=>e.slice().sort(ed),parseFloat,parseInt,upper:e=>String(e).toUpperCase(),lower:e=>String(e).toLowerCase(),substring:function(){return Gu("substring",arguments,String)},split:function(){return Gu("split",arguments,String)},replace:function(){return Gu("replace",arguments,String)},trim:e=>String(e).trim(),btoa:e=>btoa(e),atob:e=>atob(e),regexp:RegExp,test:(e,t)=>RegExp(e).test(t)};const xge=["view","item","group","xy","x","y"],T_=new Set([Function,eval,setTimeout,setInterval]);typeof setImmediate=="function"&&T_.add(setImmediate);const wge={Literal:(e,t)=>t.value,Identifier:(e,t)=>{const n=t.name;return e.memberDepth>0?n:n==="datum"?e.datum:n==="event"?e.event:n==="item"?e.item:hge[n]||e.params["$"+n]},MemberExpression:(e,t)=>{const n=!t.computed,r=e(t.object);n&&(e.memberDepth+=1);const i=e(t.property);if(n&&(e.memberDepth-=1),T_.has(r[i])){console.error(`Prevented interpretation of member "${i}" which could lead to insecure code execution`);return}return r[i]},CallExpression:(e,t)=>{const n=t.arguments;let r=t.callee.name;return r.startsWith("_")&&(r=r.slice(1)),r==="if"?e(n[0])?e(n[1]):e(n[2]):(e.fn[r]||vge[r]).apply(e.fn,n.map(e))},ArrayExpression:(e,t)=>t.elements.map(e),BinaryExpression:(e,t)=>pge[t.operator](e(t.left),e(t.right)),UnaryExpression:(e,t)=>gge[t.operator](e(t.argument)),ConditionalExpression:(e,t)=>e(t.test)?e(t.consequent):e(t.alternate),LogicalExpression:(e,t)=>t.operator==="&&"?e(t.left)&&e(t.right):e(t.left)||e(t.right),ObjectExpression:(e,t)=>t.properties.reduce((n,r)=>{e.memberDepth+=1;const i=e(r.key);e.memberDepth-=1;const o=e(r.value);return gA.has(i)?console.error(`Prevented interpretation of property "${i}" which could lead to insecure code execution`):T_.has(o)?console.error(`Prevented interpretation of method "${o}" which could lead to insecure code execution`):n[i]=o,n},{})};function Fh(e,t,n,r,i,o){const s=a=>wge[a.type](s,a);return s.memberDepth=0,s.fn=Object.create(t),s.params=n,s.datum=r,s.event=i,s.item=o,xge.forEach(a=>s.fn[a]=function(){return i.vega[a](...arguments)}),s(e)}var Ege={operator(e,t){const n=t.ast,r=e.functions;return i=>Fh(n,r,i)},parameter(e,t){const n=t.ast,r=e.functions;return(i,o)=>Fh(n,r,o,i)},event(e,t){const n=t.ast,r=e.functions;return i=>Fh(n,r,void 0,void 0,i)},handler(e,t){const n=t.ast,r=e.functions;return(i,o)=>{const s=o.item&&o.item.datum;return Fh(n,r,i,s,o)}},encode(e,t){const{marktype:n,channels:r}=t,i=e.functions,o=n==="group"||n==="image"||n==="rect";return(s,a)=>{const u=s.datum;let c=0,f;for(const h in r)f=Fh(r[h].ast,i,a,u,void 0,s),s[h]!==f&&(s[h]=f,c=1);return n!=="rule"&&dge(s,r,o),c}}};const bge="5.23.0",Sge={version:bge};function oF(e){return se(e,"or")}function sF(e){return se(e,"and")}function aF(e){return se(e,"not")}function g1(e,t){if(aF(e))g1(e.not,t);else if(sF(e))for(const n of e.and)g1(n,t);else if(oF(e))for(const n of e.or)g1(n,t);else t(e)}function ff(e,t){return aF(e)?{not:ff(e.not,t)}:sF(e)?{and:e.and.map(n=>ff(n,t))}:oF(e)?{or:e.or.map(n=>ff(n,t))}:t(e)}const Ue=structuredClone;function BB(e){throw new Error(e)}function Pf(e,t){const n={};for(const r of t)Ee(e,r)&&(n[r]=e[r]);return n}function Pr(e,t){const n={...e};for(const r of t)delete n[r];return n}Set.prototype.toJSON=function(){return`Set(${[...this].map(e=>xt(e)).join(",")})`};function Ke(e){if(at(e))return e;const t=ve(e)?e:xt(e);if(t.length<250)return t;let n=0;for(let r=0;r<t.length;r++){const i=t.charCodeAt(r);n=(n<<5)-n+i,n=n&n}return n}function N_(e){return e===!1||e===null}function Qe(e,t){return e.includes(t)}function Lf(e,t){let n=0;for(const[r,i]of e.entries())if(t(i,r,n++))return!0;return!1}function uF(e,t){let n=0;for(const[r,i]of e.entries())if(!t(i,r,n++))return!1;return!0}function UB(e,...t){for(const n of t)_ge(e,n??{});return e}function _ge(e,t){for(const n of oe(t))Zf(e,n,t[n],!0)}function Lo(e,t){const n=[],r={};let i;for(const o of e)i=t(o),!(i in r)&&(r[i]=1,n.push(o));return n}function Age(e,t){const n=oe(e),r=oe(t);if(n.length!==r.length)return!1;for(const i of n)if(e[i]!==t[i])return!1;return!0}function jB(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function lF(e,t){for(const n of e)if(t.has(n))return!0;return!1}function R_(e){const t=new Set;for(const n of e){const i=es(n).map((s,a)=>a===0?s:`[${s}]`),o=i.map((s,a)=>i.slice(0,a+1).join(""));for(const s of o)t.add(s)}return t}function cF(e,t){return e===void 0||t===void 0?!0:lF(R_(e),R_(t))}function vt(e){return oe(e).length===0}const oe=Object.keys,Rn=Object.values,uu=Object.entries;function qp(e){return e===!0||e===!1}function Mt(e){const t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function yp(e,t){return aF(e)?`!(${yp(e.not,t)})`:sF(e)?`(${e.and.map(n=>yp(n,t)).join(") && (")})`:oF(e)?`(${e.or.map(n=>yp(n,t)).join(") || (")})`:t(e)}function Ry(e,t){if(t.length===0)return!0;const n=t.shift();return n in e&&Ry(e[n],t)&&delete e[n],vt(e)}function Mg(e){return e.charAt(0).toUpperCase()+e.substr(1)}function fF(e,t="datum"){const n=es(e),r=[];for(let i=1;i<=n.length;i++){const o=`[${n.slice(0,i).map(de).join("][")}]`;r.push(`${t}${o}`)}return r.join(" && ")}function WB(e,t="datum"){return`${t}[${de(es(e).join("."))}]`}function ht(e){return`datum['${e.replaceAll("'","\\'")}']`}function Cge(e){return e.replace(/(\[|\]|\.|'|")/g,"\\$1")}function Ti(e){return`${es(e).map(Cge).join("\\.")}`}function Rl(e,t,n){return e.replace(new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function gd(e){return`${es(e).join(".")}`}function zf(e){return e?es(e).length:0}function Yt(...e){return e.find(t=>t!==void 0)}let qB=42;function HB(e){const t=++qB;return e?String(e)+t:t}function kge(){qB=42}function GB(e){return VB(e)?e:`__${e}`}function VB(e){return e.startsWith("__")}function Hp(e){if(e!==void 0)return(e%360+360)%360}function dx(e){return at(e)?!0:!isNaN(e)&&!isNaN(parseFloat(e))}const A6=Object.getPrototypeOf(structuredClone({}));function ti(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor.name!==t.constructor.name)return!1;let n,r;if(Array.isArray(e)){if(n=e.length,n!=t.length)return!1;for(r=n;r--!==0;)if(!ti(e[r],t[r]))return!1;return!0}if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const o of e.entries())if(!t.has(o[0]))return!1;for(const o of e.entries())if(!ti(o[1],t.get(o[0])))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const o of e.entries())if(!t.has(o[0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(n=e.length,n!=t.length)return!1;for(r=n;r--!==0;)if(e[r]!==t[r])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf&&e.valueOf!==A6.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString&&e.toString!==A6.toString)return e.toString()===t.toString();const i=Object.keys(e);if(n=i.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!Object.prototype.hasOwnProperty.call(t,i[r]))return!1;for(r=n;r--!==0;){const o=i[r];if(!ti(e[o],t[o]))return!1}return!0}return e!==e&&t!==t}function xt(e){const t=[];return(function n(r){if(r&&r.toJSON&&typeof r.toJSON=="function"&&(r=r.toJSON()),r===void 0)return;if(typeof r=="number")return isFinite(r)?""+r:"null";if(typeof r!="object")return JSON.stringify(r);let i,o;if(Array.isArray(r)){for(o="[",i=0;i<r.length;i++)i&&(o+=","),o+=n(r[i])||"null";return o+"]"}if(r===null)return"null";if(t.includes(r))throw new TypeError("Converting circular structure to JSON");const s=t.push(r)-1,a=Object.keys(r).sort();for(o="",i=0;i<a.length;i++){const u=a[i],c=n(r[u]);c&&(o&&(o+=","),o+=JSON.stringify(u)+":"+c)}return t.splice(s,1),`{${o}}`})(e)}function se(e,t){return ye(e)&&Ee(e,t)&&e[t]!==void 0}const js="row",Ws="column",hx="facet",Tt="x",Sn="y",mo="x2",as="y2",wu="xOffset",md="yOffset",yo="radius",ta="radius2",Oi="theta",na="theta2",vo="latitude",xo="longitude",wo="latitude2",Ni="longitude2",Eu="time",Ur="color",us="fill",ls="stroke",jr="shape",ra="size",tc="angle",ia="opacity",bu="fillOpacity",Su="strokeOpacity",_u="strokeWidth",Au="strokeDash",Tg="text",If="order",Ng="detail",px="key",Ol="tooltip",gx="href",mx="url",yx="description",$ge={x:1,y:1,x2:1,y2:1},YB={theta:1,theta2:1,radius:1,radius2:1};function XB(e){return Ee(YB,e)}const dF={longitude:1,longitude2:1,latitude:1,latitude2:1};function QB(e){switch(e){case vo:return"y";case wo:return"y2";case xo:return"x";case Ni:return"x2"}}function KB(e){return Ee(dF,e)}const Fge=oe(dF),hF={...$ge,...YB,...dF,xOffset:1,yOffset:1,color:1,fill:1,stroke:1,time:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1};function df(e){return e===Ur||e===us||e===ls}const JB={row:1,column:1,facet:1},_i=oe(JB),pF={...hF,...JB},Dge=oe(pF),{order:ZSe,detail:e_e,tooltip:t_e,...Mge}=pF,{row:n_e,column:r_e,facet:i_e,...Tge}=Mge;function Nge(e){return Ee(Tge,e)}function ZB(e){return Ee(pF,e)}const Rge=[mo,as,wo,Ni,na,ta];function eU(e){return nc(e)!==e}function nc(e){switch(e){case mo:return Tt;case as:return Sn;case wo:return vo;case Ni:return xo;case na:return Oi;case ta:return yo}return e}function lu(e){if(XB(e))switch(e){case Oi:return"startAngle";case na:return"endAngle";case yo:return"outerRadius";case ta:return"innerRadius"}return e}function cs(e){switch(e){case Tt:return mo;case Sn:return as;case vo:return wo;case xo:return Ni;case Oi:return na;case yo:return ta}}function Wr(e){switch(e){case Tt:case mo:return"width";case Sn:case as:return"height"}}function tU(e){switch(e){case Tt:return"xOffset";case Sn:return"yOffset";case mo:return"x2Offset";case as:return"y2Offset";case Oi:return"thetaOffset";case yo:return"radiusOffset";case na:return"theta2Offset";case ta:return"radius2Offset"}}function gF(e){switch(e){case Tt:return"xOffset";case Sn:return"yOffset"}}function Oge(e){switch(e){case"xOffset":return"x";case"yOffset":return"y"}}const Pge=oe(hF),{x:o_e,y:s_e,x2:a_e,y2:u_e,xOffset:l_e,yOffset:c_e,latitude:f_e,longitude:d_e,latitude2:h_e,longitude2:p_e,theta:g_e,theta2:m_e,radius:y_e,radius2:v_e,...mF}=hF,Lge=oe(mF),yF={x:1,y:1},oa=oe(yF);function Xt(e){return Ee(yF,e)}const vF={theta:1,radius:1},zge=oe(vF);function vx(e){return e==="width"?Tt:Sn}const nU={xOffset:1,yOffset:1};function Rg(e){return Ee(nU,e)}const Ige={time:1};function cb(e){return e in Ige}const{text:x_e,tooltip:w_e,href:E_e,url:b_e,description:S_e,detail:__e,key:A_e,order:C_e,...rU}=mF,Bge=oe(rU);function Uge(e){return Ee(mF,e)}function jge(e){switch(e){case Ur:case us:case ls:case ra:case jr:case ia:case _u:case Au:return!0;case bu:case Su:case tc:case Eu:return!1}}const iU={...yF,...vF,...nU,...rU},xF=oe(iU);function fs(e){return Ee(iU,e)}function Wge(e,t){return Hge(e)[t]}const oU={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},{geoshape:k_e,...qge}=oU;function Hge(e){switch(e){case Ur:case us:case ls:case yx:case Ng:case px:case Ol:case gx:case If:case ia:case bu:case Su:case _u:case hx:case js:case Ws:return oU;case Tt:case Sn:case wu:case md:case vo:case xo:case Eu:return qge;case mo:case as:case wo:case Ni:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case ra:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case Au:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case jr:return{point:"always",geoshape:"always"};case Tg:return{text:"always"};case tc:return{point:"always",square:"always",text:"always"};case mx:return{image:"always"};case Oi:return{text:"always",arc:"always"};case yo:return{text:"always",arc:"always"};case na:case ta:return{arc:"always"}}}function fb(e){switch(e){case Tt:case Sn:case Oi:case yo:case wu:case md:case ra:case tc:case _u:case ia:case bu:case Su:case Eu:case mo:case as:case na:case ta:return;case hx:case js:case Ws:case jr:case Au:case Tg:case Ol:case gx:case mx:case yx:return"discrete";case Ur:case us:case ls:return"flexible";case vo:case xo:case wo:case Ni:case Ng:case px:case If:return}}const Gge={argmax:1,argmin:1,average:1,count:1,distinct:1,exponential:1,exponentialb:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},Vge={count:1,min:1,max:1};function Qs(e){return se(e,"argmin")}function Cu(e){return se(e,"argmax")}function wF(e){return ve(e)&&Ee(Gge,e)}const Yge=new Set(["count","valid","missing","distinct"]);function xx(e){return ve(e)&&Yge.has(e)}function Xge(e){return ve(e)&&Qe(["min","max"],e)}const Qge=new Set(["count","sum","distinct","valid","missing"]),Kge=new Set(["mean","average","median","q1","q3","min","max"]);function sU(e){return hu(e)&&(e=Mx(e,void 0)),"bin"+oe(e).map(t=>wx(e[t])?Mt(`_${t}_${uu(e[t])}`):Mt(`_${t}_${e[t]}`)).join("")}function St(e){return e===!0||rc(e)&&!e.binned}function Cn(e){return e==="binned"||rc(e)&&e.binned===!0}function rc(e){return ye(e)}function wx(e){return se(e,"param")}function C6(e){switch(e){case js:case Ws:case ra:case Ur:case us:case ls:case _u:case ia:case bu:case Su:case jr:return 6;case Au:return 4;default:return 10}}function Og(e){return se(e,"expr")}function kn(e,{level:t}={level:0}){const n=oe(e||{}),r={};for(const i of n)r[i]=t===0?Zr(e[i]):kn(e[i],{level:t-1});return r}function aU(e){const{anchor:t,frame:n,offset:r,orient:i,angle:o,limit:s,color:a,subtitleColor:u,subtitleFont:c,subtitleFontSize:f,subtitleFontStyle:h,subtitleFontWeight:p,subtitleLineHeight:m,subtitlePadding:y,...v}=e,w={...v,...a?{fill:a}:{}},E={...t?{anchor:t}:{},...n?{frame:n}:{},...r?{offset:r}:{},...i?{orient:i}:{},...o!==void 0?{angle:o}:{},...s!==void 0?{limit:s}:{}},S={...u?{subtitleColor:u}:{},...c?{subtitleFont:c}:{},...f?{subtitleFontSize:f}:{},...h?{subtitleFontStyle:h}:{},...p?{subtitleFontWeight:p}:{},...m?{subtitleLineHeight:m}:{},...y?{subtitlePadding:y}:{}},A=Pf(e,["align","baseline","dx","dy","limit"]);return{titleMarkConfig:w,subtitleMarkConfig:A,nonMarkTitleProperties:E,subtitle:S}}function Oa(e){return ve(e)||ne(e)&&ve(e[0])}function Fe(e){return se(e,"signal")}function ic(e){return se(e,"step")}function Jge(e){return ne(e)?!1:se(e,"fields")&&!se(e,"data")}function Zge(e){return ne(e)?!1:se(e,"fields")&&se(e,"data")}function zs(e){return ne(e)?!1:se(e,"field")&&se(e,"data")}const e0e={aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1,url:1,smooth:1},t0e=oe(e0e),n0e={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},O_=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];function uU(e){const t=ne(e.condition)?e.condition.map(k6):k6(e.condition);return{...Zr(e),condition:t}}function Zr(e){if(Og(e)){const{expr:t,...n}=e;return{signal:t,...n}}return e}function k6(e){if(Og(e)){const{expr:t,...n}=e;return{signal:t,...n}}return e}function kt(e){if(Og(e)){const{expr:t,...n}=e;return{signal:t,...n}}return Fe(e)?e:e!==void 0?{value:e}:void 0}function r0e(e){return Fe(e)?e.signal:de(e)}function $6(e){return Fe(e)?e.signal:de(e.value)}function to(e){return Fe(e)?e.signal:e==null?null:de(e)}function i0e(e,t,n){for(const r of n){const i=Ko(r,t.markDef,t.config);i!==void 0&&(e[r]=kt(i))}return e}function lU(e){return[].concat(e.type,e.style??[])}function yt(e,t,n,r={}){const{vgChannel:i,ignoreVgConfig:o}=r;return i&&se(t,i)?t[i]:t[e]!==void 0?t[e]:o&&(!i||i===e)?void 0:Ko(e,t,n,r)}function Ko(e,t,n,{vgChannel:r}={}){const i=P_(e,t,n.style);return Yt(r?i:void 0,i,r?n[t.type][r]:void 0,n[t.type][e],r?n.mark[r]:n.mark[e])}function P_(e,t,n){return cU(e,lU(t),n)}function cU(e,t,n){t=xe(t);let r;for(const i of t){const o=n[i];se(o,e)&&(r=o[e])}return r}function fU(e,t){return xe(e).reduce((n,r)=>(n.field.push(ge(r,t)),n.order.push(r.sort??"ascending"),n),{field:[],order:[]})}function dU(e,t){const n=[...e];return t.forEach(r=>{for(const i of n)if(ti(i,r))return;n.push(r)}),n}function hU(e,t){return ti(e,t)||!t?e:e?[...xe(e),...xe(t)].join(", "):t}function pU(e,t){const n=e.value,r=t.value;if(n==null||r===null)return{explicit:e.explicit,value:null};if((Oa(n)||Fe(n))&&(Oa(r)||Fe(r)))return{explicit:e.explicit,value:hU(n,r)};if(Oa(n)||Fe(n))return{explicit:e.explicit,value:n};if(Oa(r)||Fe(r))return{explicit:e.explicit,value:r};if(!Oa(n)&&!Fe(n)&&!Oa(r)&&!Fe(r))return{explicit:e.explicit,value:dU(n,r)};throw new Error("It should never reach here")}function EF(e){return`Invalid specification ${xt(e)}. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".`}const o0e='Autosize "fit" only works for single views and layered views.';function F6(e){return`${e=="width"?"Width":"Height"} "container" only works for single views and layered views.`}function D6(e){const t=e=="width"?"Width":"Height",n=e=="width"?"x":"y";return`${t} "container" only works well with autosize "fit" or "fit-${n}".`}function M6(e){return e?`Dropping "fit-${e}" because spec has discrete ${Wr(e)}.`:'Dropping "fit" because spec has discrete size.'}function bF(e){return`Unknown field for ${e}. Cannot calculate view size.`}function T6(e){return`Cannot project a selection on encoding channel "${e}", which has no field.`}function s0e(e,t){return`Cannot project a selection on encoding channel "${e}" as it uses an aggregate function ("${t}").`}function a0e(e){return`The "nearest" transform is not supported for ${e} marks.`}function gU(e){return`Selection not supported for ${e} yet.`}function u0e(e){return`Cannot find a selection named "${e}".`}const l0e="Scale bindings are currently only supported for scales with unbinned, continuous domains.",c0e="Sequntial scales are deprecated. The available quantitative scale type values are linear, log, pow, sqrt, symlog, time and utc",f0e="Legend bindings are only supported for selections over an individual field or encoding channel.";function d0e(e){return`Lookups can only be performed on selection parameters. "${e}" is a variable parameter.`}function h0e(e){return`Cannot define and lookup the "${e}" selection in the same view. Try moving the lookup into a second, layered view?`}const p0e="The same selection must be used to override scale domains in a layered view.",g0e='Interval selections should be initialized using "x", "y", "longitude", or "latitude" keys.';function m0e(e){return`Unknown repeated value "${e}".`}function N6(e){return`The "columns" property cannot be used when "${e}" has nested row/column.`}const y0e="Multiple timer selections in one unit spec are not supported. Ignoring all but the first.",SF="Animation involving facet, layer, or concat is currently unsupported.";function v0e(e){return`A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": ${de(e)}.`}function x0e(e,t,n,r){return(e.length?"Multiple ":"No ")+`matching ${de(t)} encoding found for selection ${de(n.param)}. Using "field": ${de(r)}.`}const w0e="Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415).";function E0e(e){return`Unrecognized parse "${e}".`}function R6(e,t,n){return`An ancestor parsed field "${e}" as ${n} but a child wants to parse the field as ${t}.`}const b0e="Attempt to add the same child twice.";function S0e(e){return`Ignoring an invalid transform: ${xt(e)}.`}const _0e='If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.';function O6(e){return`Config.customFormatTypes is not true, thus custom format type and format for channel ${e} are dropped.`}function A0e(e){const{parentProjection:t,projection:n}=e;return`Layer's shared projection ${xt(t)} is overridden by a child projection ${xt(n)}.`}const C0e="Arc marks uses theta channel rather than angle, replacing angle with theta.";function k0e(e){return`${e}Offset dropped because ${e} is continuous`}function $0e(e,t,n){return`Channel ${e} is a ${t}. Converted to {value: ${xt(n)}}.`}function mU(e){return`Invalid field type "${e}".`}function F0e(e,t){return`Invalid field type "${e}" for aggregate: "${t}", using "quantitative" instead.`}function D0e(e){return`Invalid aggregation operator "${e}".`}function yU(e,t){const{fill:n,stroke:r}=t;return`Dropping color ${e} as the plot also has ${n&&r?"fill and stroke":n?"fill":"stroke"}.`}function M0e(e){return`Position range does not support relative band size for ${e}.`}function L_(e,t){return`Dropping ${xt(e)} from channel "${t}" since it does not contain any data field, datum, value, or signal.`}const T0e="Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.";function Ex(e,t,n){return`${e} dropped as it is incompatible with "${t}".`}function N0e(e){return`${e}-encoding is dropped as ${e} is not a valid encoding channel.`}function R0e(e){return`${e} encoding should be discrete (ordinal / nominal / binned).`}function O0e(e){return`${e} encoding should be discrete (ordinal / nominal / binned) or use a discretizing scale (e.g. threshold).`}function P0e(e){return`Facet encoding dropped as ${e.join(" and ")} ${e.length>1?"are":"is"} also specified.`}function db(e,t){return`Using discrete channel "${e}" to encode "${t}" field can be misleading as it does not encode ${t==="ordinal"?"order":"magnitude"}.`}function L0e(e){return`The ${e} for range marks cannot be an expression`}function z0e(e,t){return`Line mark is for continuous lines and thus cannot be used with ${e&&t?"x2 and y2":e?"x2":"y2"}. We will use the rule mark (line segments) instead.`}function I0e(e,t){return`Specified orient "${e}" overridden with "${t}".`}function B0e(e){return`Cannot use the scale property "${e}" with non-color channel.`}function U0e(e){return`Cannot use the relative band size with ${e} scale.`}function j0e(e){return`Using unaggregated domain with raw field has no effect (${xt(e)}).`}function W0e(e){return`Unaggregated domain not applicable for "${e}" since it produces values outside the origin domain of the source data.`}function q0e(e){return`Unaggregated domain is currently unsupported for log scale (${xt(e)}).`}function H0e(e){return`Cannot apply size to non-oriented mark "${e}".`}function G0e(e,t,n){return`Channel "${e}" does not work with "${t}" scale. We are using "${n}" scale instead.`}function V0e(e,t){return`FieldDef does not work with "${e}" scale. We are using "${t}" scale instead.`}function vU(e,t,n){return`${n}-scale's "${t}" is dropped as it does not work with ${e} scale.`}function xU(e){return`The step for "${e}" is dropped because the ${e==="width"?"x":"y"} is continuous.`}function Y0e(e,t,n,r){return`Conflicting ${t.toString()} property "${e.toString()}" (${xt(n)} and ${xt(r)}). Using ${xt(n)}.`}function X0e(e,t,n,r){return`Conflicting ${t.toString()} property "${e.toString()}" (${xt(n)} and ${xt(r)}). Using the union of the two domains.`}function Q0e(e){return`Setting the scale to be independent for "${e}" means we also have to set the guide (axis or legend) to be independent.`}function K0e(e){return`Dropping sort property ${xt(e)} as unioned domains only support boolean or op "count", "min", and "max".`}const P6="Domains that should be unioned has conflicting sort properties. Sort will be set to true.",J0e="Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect.",Z0e="Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect.",eme="Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.";function tme(e){return`Cannot stack "${e}" if there is already "${e}2".`}function nme(e){return`Stack is applied to a non-linear scale (${e}).`}function rme(e){return`Stacking is applied even though the aggregate function is non-summative ("${e}").`}function Oy(e,t){return`Invalid ${e}: ${xt(t)}.`}function ime(e){return`Dropping day from datetime ${xt(e)} as day cannot be combined with other units.`}function ome(e,t){return`${t?"extent ":""}${t&&e?"and ":""}${e?"center ":""}${t&&e?"are ":"is "}not needed when data are aggregated.`}function sme(e,t,n){return`${e} is not usually used with ${t} for ${n}.`}function ame(e,t){return`Continuous axis should not have customized aggregation function ${e}; ${t} already agregates the axis.`}function L6(e){return`1D error band does not support ${e}.`}function wU(e){return`Channel ${e} is required for "binned" bin.`}function ume(e){return`Channel ${e} should not be used with "binned" bin.`}function lme(e){return`Domain for ${e} is required for threshold scale.`}const EU=vA(yA);let Pl=EU;function cme(e){return Pl=e,Pl}function fme(){return Pl=EU,Pl}function _F(...e){Pl.error(...e)}function ue(...e){Pl.warn(...e)}function dme(...e){Pl.debug(...e)}function oc(e){if(e&&ye(e)){for(const t of CF)if(se(e,t))return!0}return!1}const bU=["january","february","march","april","may","june","july","august","september","october","november","december"],hme=bU.map(e=>e.substr(0,3)),SU=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],pme=SU.map(e=>e.substr(0,3));function gme(e){if(dx(e)&&(e=+e),at(e))return e>4&&ue(Oy("quarter",e)),e-1;throw new Error(Oy("quarter",e))}function mme(e){if(dx(e)&&(e=+e),at(e))return e-1;{const t=e.toLowerCase(),n=bU.indexOf(t);if(n!==-1)return n;const r=t.substr(0,3),i=hme.indexOf(r);if(i!==-1)return i;throw new Error(Oy("month",e))}}function yme(e){if(dx(e)&&(e=+e),at(e))return e%7;{const t=e.toLowerCase(),n=SU.indexOf(t);if(n!==-1)return n;const r=t.substr(0,3),i=pme.indexOf(r);if(i!==-1)return i;throw new Error(Oy("day",e))}}function AF(e,t){const n=[];if(t&&e.day!==void 0&&oe(e).length>1&&(ue(ime(e)),e=Ue(e),delete e.day),e.year!==void 0?n.push(e.year):n.push(2012),e.month!==void 0){const r=t?mme(e.month):e.month;n.push(r)}else if(e.quarter!==void 0){const r=t?gme(e.quarter):e.quarter;n.push(at(r)?r*3:`${r}*3`)}else n.push(0);if(e.date!==void 0)n.push(e.date);else if(e.day!==void 0){const r=t?yme(e.day):e.day;n.push(at(r)?r+1:`${r}+1`)}else n.push(1);for(const r of["hours","minutes","seconds","milliseconds"]){const i=e[r];n.push(typeof i>"u"?0:i)}return n}function Ll(e){const n=AF(e,!0).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function vme(e){const n=AF(e,!1).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function xme(e){const t=AF(e,!0);return e.utc?+new Date(Date.UTC(...t)):+new Date(...t)}const _U={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},CF=oe(_U);function wme(e){return Ee(_U,e)}function sc(e){return ye(e)?e.binned:AU(e)}function AU(e){return e&&e.startsWith("binned")}function kF(e){return e.startsWith("utc")}function Eme(e){return e.substring(3)}const bme={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function bx(e){return CF.filter(t=>kU(e,t))}function CU(e){const t=bx(e);return t[t.length-1]}function kU(e,t){const n=e.indexOf(t);return!(n<0||n>0&&t==="seconds"&&e.charAt(n-1)==="i"||e.length>n+3&&t==="day"&&e.charAt(n+3)==="o"||n>0&&t==="year"&&e.charAt(n-1)==="f")}function Sme(e,t,{end:n}={end:!1}){const r=fF(t),i=kF(e)?"utc":"";function o(u){return u==="quarter"?`(${i}quarter(${r})-1)`:`${i}${u}(${r})`}let s;const a={};for(const u of CF)kU(e,u)&&(a[u]=o(u),s=u);return n&&(a[s]+="+1"),vme(a)}function $U(e){if(!e)return;const t=bx(e);return`timeUnitSpecifier(${xt(t)}, ${xt(bme)})`}function _me(e,t,n){if(!e)return;const r=$U(e);return`${n||kF(e)?"utc":"time"}Format(${t}, ${r})`}function wn(e){if(!e)return;let t;return ve(e)?AU(e)?t={unit:e.substring(6),binned:!0}:t={unit:e}:ye(e)&&(t={...e,...e.unit?{unit:e.unit}:{}}),kF(t.unit)&&(t.utc=!0,t.unit=Eme(t.unit)),t}function Ame(e){const{utc:t,...n}=wn(e);return n.unit?(t?"utc":"")+oe(n).map(r=>Mt(`${r==="unit"?"":`_${r}_`}${n[r]}`)).join(""):(t?"utc":"")+"timeunit"+oe(n).map(r=>Mt(`_${r}_${n[r]}`)).join("")}function FU(e,t=n=>n){const n=wn(e),r=CU(n.unit);if(r&&r!=="day"){const i={year:2001,month:1,date:1,hours:0,minutes:0,seconds:0,milliseconds:0},{step:o,part:s}=DU(r,n.step),a={...i,[s]:+i[s]+o};return`${t(Ll(a))} - ${t(Ll(i))}`}}const Cme={year:1,month:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1};function kme(e){return Ee(Cme,e)}function DU(e,t=1){if(kme(e))return{part:e,step:t};switch(e){case"day":case"dayofyear":return{part:"date",step:t};case"quarter":return{part:"month",step:t*3};case"week":return{part:"date",step:t*7}}}function $me(e){return se(e,"param")}function $F(e){return!!(e!=null&&e.field)&&e.equal!==void 0}function FF(e){return!!(e!=null&&e.field)&&e.lt!==void 0}function DF(e){return!!(e!=null&&e.field)&&e.lte!==void 0}function MF(e){return!!(e!=null&&e.field)&&e.gt!==void 0}function TF(e){return!!(e!=null&&e.field)&&e.gte!==void 0}function NF(e){if(e!=null&&e.field){if(ne(e.range)&&e.range.length===2)return!0;if(Fe(e.range))return!0}return!1}function RF(e){return!!(e!=null&&e.field)&&(ne(e.oneOf)||ne(e.in))}function Fme(e){return!!(e!=null&&e.field)&&e.valid!==void 0}function MU(e){return RF(e)||$F(e)||NF(e)||FF(e)||MF(e)||DF(e)||TF(e)}function Fo(e,t){return Tx(e,{timeUnit:t,wrapTime:!0})}function Dme(e,t){return e.map(n=>Fo(n,t))}function TU(e,t=!0){const{field:n}=e,r=wn(e.timeUnit),{unit:i,binned:o}=r||{},s=ge(e,{expr:"datum"}),a=i?`time(${o?s:Sme(i,n)})`:s;if($F(e))return`${a}===${Fo(e.equal,i)}`;if(FF(e)){const u=e.lt;return`${a}<${Fo(u,i)}`}else if(MF(e)){const u=e.gt;return`${a}>${Fo(u,i)}`}else if(DF(e)){const u=e.lte;return`${a}<=${Fo(u,i)}`}else if(TF(e)){const u=e.gte;return`${a}>=${Fo(u,i)}`}else{if(RF(e))return`indexof([${Dme(e.oneOf,i).join(",")}], ${a}) !== -1`;if(Fme(e))return Sx(a,e.valid);if(NF(e)){const{range:u}=kn(e),c=Fe(u)?{signal:`${u.signal}[0]`}:u[0],f=Fe(u)?{signal:`${u.signal}[1]`}:u[1];if(c!==null&&f!==null&&t)return"inrange("+a+", ["+Fo(c,i)+", "+Fo(f,i)+"])";const h=[];return c!==null&&h.push(`${a} >= ${Fo(c,i)}`),f!==null&&h.push(`${a} <= ${Fo(f,i)}`),h.length>0?h.join(" && "):"true"}}throw new Error(`Invalid field predicate: ${xt(e)}`)}function Sx(e,t=!0){return t?`isValid(${e}) && isFinite(+${e})`:`!isValid(${e}) || !isFinite(+${e})`}function Mme(e){return MU(e)&&e.timeUnit?{...e,timeUnit:wn(e.timeUnit)}:e}const Pg={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"};function Tme(e){return e==="quantitative"||e==="temporal"}function NU(e){return e==="ordinal"||e==="nominal"}const zl=Pg.quantitative,OF=Pg.ordinal,Bf=Pg.temporal,PF=Pg.nominal,yd=Pg.geojson;function Nme(e){if(e)switch(e=e.toLowerCase(),e){case"q":case zl:return"quantitative";case"t":case Bf:return"temporal";case"o":case OF:return"ordinal";case"n":case PF:return"nominal";case yd:return"geojson"}}const $n={LINEAR:"linear",LOG:"log",POW:"pow",SQRT:"sqrt",TIME:"time",UTC:"utc",POINT:"point",BAND:"band"},z_={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"};function Rme(e,t){const n=z_[e],r=z_[t];return n===r||n==="ordinal-position"&&r==="time"||r==="ordinal-position"&&n==="time"}const Ome={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function z6(e){return Ome[e]}const RU=new Set(["linear","log","pow","sqrt","symlog"]),OU=new Set([...RU,"time","utc"]);function PU(e){return RU.has(e)}const LU=new Set(["quantile","quantize","threshold"]),Pme=new Set([...OU,...LU,"sequential","identity"]),Lme=new Set(["ordinal","bin-ordinal","point","band"]);function En(e){return Lme.has(e)}function uo(e){return Pme.has(e)}function zo(e){return OU.has(e)}function Uf(e){return LU.has(e)}const zme={pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,tickBandPaddingInner:.25,bandWithNestedOffsetPaddingInner:.2,bandWithNestedOffsetPaddingOuter:.2,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:4,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4,zero:!0,framesPerSecond:2,animationDuration:5};function Ime(e){return!ve(e)&&se(e,"name")}function zU(e){return se(e,"param")}function Bme(e){return se(e,"unionWith")}function Ume(e){return ye(e)&&"field"in e}const jme={type:1,domain:1,domainMax:1,domainMin:1,domainMid:1,domainRaw:1,align:1,range:1,rangeMax:1,rangeMin:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},{type:$_e,domain:F_e,range:D_e,rangeMax:M_e,rangeMin:T_e,scheme:N_e,...Wme}=jme,qme=oe(Wme);function I_(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!["point","band","identity"].includes(e);case"bins":return!["point","band","identity","ordinal"].includes(e);case"round":return zo(e)||e==="band"||e==="point";case"padding":case"rangeMin":case"rangeMax":return zo(e)||["point","band"].includes(e);case"paddingOuter":case"align":return["point","band"].includes(e);case"paddingInner":return e==="band";case"domainMax":case"domainMid":case"domainMin":case"domainRaw":case"clamp":return zo(e);case"nice":return zo(e)||e==="quantize"||e==="threshold";case"exponent":return e==="pow";case"base":return e==="log";case"constant":return e==="symlog";case"zero":return uo(e)&&!Qe(["log","time","utc","threshold","quantile"],e)}}function IU(e,t){switch(t){case"interpolate":case"scheme":case"domainMid":return df(e)?void 0:B0e(t);case"align":case"type":case"bins":case"domain":case"domainMax":case"domainMin":case"domainRaw":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"rangeMax":case"rangeMin":case"reverse":case"round":case"clamp":case"zero":return}}function Hme(e,t){return Qe([OF,PF],t)?e===void 0||En(e):t===Bf?Qe([$n.TIME,$n.UTC,void 0],e):t===zl?PU(e)||Uf(e)||e===void 0:!0}function Gme(e,t,n=!1){if(!fs(e))return!1;switch(e){case Tt:case Sn:case wu:case md:case Oi:case yo:return zo(t)||t==="band"?!0:t==="point"?!n:!1;case Eu:return Qe(["linear","band"],t);case ra:case _u:case ia:case bu:case Su:case tc:return zo(t)||Uf(t)||Qe(["band","point","ordinal"],t);case Ur:case us:case ls:return t!=="band";case Au:case jr:return t==="ordinal"||Uf(t)}}function Vme(e){return ye(e)&&"value"in e}const Er={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},BU=Er.arc,_x=Er.area,Ax=Er.bar,Yme=Er.image,Cx=Er.line,kx=Er.point,Xme=Er.rect,Py=Er.rule,UU=Er.text,LF=Er.tick,Qme=Er.trail,zF=Er.circle,IF=Er.square,jU=Er.geoshape;function ku(e){return["line","area","trail"].includes(e)}function Gp(e){return["rect","bar","image","arc","tick"].includes(e)}const Kme=new Set(oe(Er));function Jo(e){return se(e,"type")}const Jme=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit"],Zme=["fill","fillOpacity"],e1e=[...Jme,...Zme],t1e={color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBandSize:1,timeUnitBandPosition:1},I6=oe(t1e),hb=["binSpacing","continuousBandSize","discreteBandSize","minBandSize"],n1e={area:["line","point"],bar:hb,rect:hb,line:["point"],tick:["bandSize","thickness",...hb]},r1e={color:"#4c78a8",invalid:"break-paths-show-path-domains",timeUnitBandSize:1},i1e={mark:1,arc:1,area:1,bar:1,circle:1,image:1,line:1,point:1,rect:1,rule:1,square:1,text:1,tick:1,trail:1,geoshape:1},WU=oe(i1e);function Il(e){return se(e,"band")}const o1e={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},s1e=5,BF={binSpacing:0,continuousBandSize:s1e,minBandSize:.25,timeUnitBandPosition:.5},a1e={...BF,binSpacing:1},u1e={...BF,thickness:1};function l1e(e){return Jo(e)?e.type:e}function qU(e,{isPath:t}){return e===void 0||e==="break-paths-show-path-domains"?t?"break-paths-show-domains":"filter":e===null?"show":e}function UF({markDef:e,config:t,scaleChannel:n,scaleType:r,isCountAggregate:i}){var a,u;if(!r||!uo(r)||i)return"always-valid";const o=qU(yt("invalid",e,t),{isPath:ku(e.type)});return((u=(a=t.scale)==null?void 0:a.invalid)==null?void 0:u[n])!==void 0?"show":o}function c1e(e){return e==="break-paths-filter-domains"||e==="break-paths-show-domains"}function HU({scaleName:e,scale:t,mode:n}){const r=`domain('${e}')`;if(!t||!e)return;const i=`${r}[0]`,o=`peek(${r})`,s=t.domainHasZero();return s==="definitely"?{scale:e,value:0}:s==="maybe"?{signal:`scale('${e}', inrange(0, ${r}) ? 0 : ${n==="zeroOrMin"?i:o})`}:{signal:`scale('${e}', ${n==="zeroOrMin"?i:o})`}}function GU({scaleChannel:e,channelDef:t,scale:n,scaleName:r,markDef:i,config:o}){var f;const s=n==null?void 0:n.get("type"),a=co(t),u=xx(a==null?void 0:a.aggregate),c=UF({scaleChannel:e,markDef:i,config:o,scaleType:s,isCountAggregate:u});if(a&&c==="show"){const h=((f=o.scale.invalid)==null?void 0:f[e])??"zero-or-min";return{test:Sx(ge(a,{expr:"datum"}),!1),...f1e(h,n,r)}}}function f1e(e,t,n){if(Vme(e)){const{value:r}=e;return Fe(r)?{signal:r.signal}:{value:r}}return HU({scale:t,scaleName:n,mode:"zeroOrMin"})}function jF(e){const{channel:t,channelDef:n,markDef:r,scale:i,scaleName:o,config:s}=e,a=nc(t),u=WF(e),c=GU({scaleChannel:a,channelDef:n,scale:i,scaleName:o,markDef:r,config:s});return c!==void 0?[c,u]:u}function d1e(e){const{datum:t}=e;return oc(t)?Ll(t):`${xt(t)}`}function yl(e,t,n,r){const i={};if(t&&(i.scale=t),ds(e)){const{datum:o}=e;oc(o)?i.signal=Ll(o):Fe(o)?i.signal=o.signal:Og(o)?i.signal=o.expr:i.value=o}else i.field=ge(e,n);if(r){const{offset:o,band:s}=r;o&&(i.offset=o),s&&(i.band=s)}return i}function Ly({scaleName:e,fieldOrDatumDef:t,fieldOrDatumDef2:n,offset:r,startSuffix:i,endSuffix:o="end",bandPosition:s=.5}){const a=!Fe(s)&&0<s&&s<1?"datum":void 0,u=ge(t,{expr:a,suffix:i}),c=n!==void 0?ge(n,{expr:a}):ge(t,{suffix:o,expr:a}),f={};if(s===0||s===1){f.scale=e;const h=s===0?u:c;f.field=h}else{const h=Fe(s)?`(1-${s.signal}) * ${u} + ${s.signal} * ${c}`:`${1-s} * ${u} + ${s} * ${c}`;f.signal=`scale("${e}", ${h})`}return r&&(f.offset=r),f}function h1e({scaleName:e,fieldDef:t}){const n=ge(t,{expr:"datum"}),r=ge(t,{expr:"datum",suffix:"end"});return`abs(scale("${e}", ${r}) - scale("${e}", ${n}))`}function WF({channel:e,channelDef:t,channel2Def:n,markDef:r,config:i,scaleName:o,scale:s,stack:a,offset:u,defaultRef:c,bandPosition:f}){if(t){if(je(t)){const h=s==null?void 0:s.get("type");if(xr(t)){f??(f=cu({fieldDef:t,fieldDef2:n,markDef:r,config:i}));const{bin:p,timeUnit:m,type:y}=t;if(St(p)||f&&m&&y===Bf)return a!=null&&a.impute?yl(t,o,{binSuffix:"mid"},{offset:u}):f&&!En(h)?Ly({scaleName:o,fieldOrDatumDef:t,bandPosition:f,offset:u}):yl(t,o,Ug(t,e)?{binSuffix:"range"}:{},{offset:u});if(Cn(p)){if(ce(n))return Ly({scaleName:o,fieldOrDatumDef:t,fieldOrDatumDef2:n,bandPosition:f,offset:u});ue(wU(e===Tt?mo:as))}}return yl(t,o,En(h)?{binSuffix:"range"}:{},{offset:u,band:h==="band"?f??t.bandPosition??.5:void 0})}else if(lo(t)){const h=t.value,p=u?{offset:u}:{};return{...vp(e,h),...p}}}return He(c)&&(c=c()),c&&{...c,...u?{offset:u}:{}}}function vp(e,t){return Qe(["x","x2"],e)&&t==="width"?{field:{group:"width"}}:Qe(["y","y2"],e)&&t==="height"?{field:{group:"height"}}:kt(t)}function Bl(e){return e&&e!=="number"&&e!=="time"}function VU(e,t,n){return`${e}(${t}${n?`, ${xt(n)}`:""})`}const p1e=" – ";function qF({fieldOrDatumDef:e,format:t,formatType:n,expr:r,normalizeStack:i,config:o}){var u,c;if(Bl(n))return no({fieldOrDatumDef:e,format:t,formatType:n,expr:r,config:o});const s=YU(e,r,i),a=jf(e);if(t===void 0&&n===void 0&&o.customFormatTypes){if(a==="quantitative"){if(i&&o.normalizedNumberFormatType)return no({fieldOrDatumDef:e,format:o.normalizedNumberFormat,formatType:o.normalizedNumberFormatType,expr:r,config:o});if(o.numberFormatType)return no({fieldOrDatumDef:e,format:o.numberFormat,formatType:o.numberFormatType,expr:r,config:o})}if(a==="temporal"&&o.timeFormatType&&ce(e)&&e.timeUnit===void 0)return no({fieldOrDatumDef:e,format:o.timeFormat,formatType:o.timeFormatType,expr:r,config:o})}if(qf(e)){const f=m1e({field:s,timeUnit:ce(e)?(u=wn(e.timeUnit))==null?void 0:u.unit:void 0,format:t,formatType:o.timeFormatType,rawTimeFormat:o.timeFormat,isUTCScale:ac(e)&&((c=e.scale)==null?void 0:c.type)===$n.UTC});return f?{signal:f}:void 0}if(t=B_({type:a,specifiedFormat:t,config:o,normalizeStack:i}),ce(e)&&St(e.bin)){const f=ge(e,{expr:r,binSuffix:"end"});return{signal:Lg(s,f,t,n,o)}}else return t||jf(e)==="quantitative"?{signal:`${KU(s,t)}`}:{signal:`isValid(${s}) ? ${s} : ""+${s}`}}function YU(e,t,n){return ce(e)?n?`${ge(e,{expr:t,suffix:"end"})}-${ge(e,{expr:t,suffix:"start"})}`:ge(e,{expr:t}):d1e(e)}function no({fieldOrDatumDef:e,format:t,formatType:n,expr:r,normalizeStack:i,config:o,field:s}){if(s??(s=YU(e,r,i)),s!=="datum.value"&&ce(e)&&St(e.bin)){const a=ge(e,{expr:r,binSuffix:"end"});return{signal:Lg(s,a,t,n,o)}}return{signal:VU(n,s,t)}}function XU(e,t,n,r,i,o){var s;if(!(ve(r)&&Bl(r))&&!(n===void 0&&r===void 0&&i.customFormatTypes&&jf(e)==="quantitative"&&(i.normalizedNumberFormatType&&Wf(e)&&e.stack==="normalize"||i.numberFormatType))){if(Wf(e)&&e.stack==="normalize"&&i.normalizedNumberFormat)return B_({type:"quantitative",config:i,normalizeStack:!0});if(qf(e)){const a=ce(e)?(s=wn(e.timeUnit))==null?void 0:s.unit:void 0;return a===void 0&&i.customFormatTypes&&i.timeFormatType?void 0:g1e({specifiedFormat:n,timeUnit:a,config:i,omitTimeFormatConfig:o})}return B_({type:t,specifiedFormat:n,config:i})}}function QU(e,t,n){var r;if(e&&(Fe(e)||e==="number"||e==="time"))return e;if(qf(t)&&n!=="time"&&n!=="utc")return ce(t)&&((r=wn(t==null?void 0:t.timeUnit))!=null&&r.utc)?"utc":"time"}function B_({type:e,specifiedFormat:t,config:n,normalizeStack:r}){if(ve(t))return t;if(e===zl)return r?n.normalizedNumberFormat:n.numberFormat}function g1e({specifiedFormat:e,timeUnit:t,config:n,omitTimeFormatConfig:r}){return e||(t?{signal:$U(t)}:r?void 0:n.timeFormat)}function KU(e,t){return`format(${e}, "${t||""}")`}function B6(e,t,n,r){return Bl(n)?VU(n,e,t):KU(e,(ve(t)?t:void 0)??r.numberFormat)}function Lg(e,t,n,r,i){if(n===void 0&&r===void 0&&i.customFormatTypes&&i.numberFormatType)return Lg(e,t,i.numberFormat,i.numberFormatType,i);const o=B6(e,n,r,i),s=B6(t,n,r,i);return`${Sx(e,!1)} ? "null" : ${o} + "${p1e}" + ${s}`}function m1e({field:e,timeUnit:t,format:n,formatType:r,rawTimeFormat:i,isUTCScale:o}){return!t||n?!t&&r?`${r}(${e}, '${n}')`:(n=ve(n)?n:i,`${o?"utc":"time"}Format(${e}, '${n}')`):_me(t,e,o)}const $x="min",y1e={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function U6(e){return Ee(y1e,e)}function v1e(e){return se(e,"encoding")}function qs(e){return e&&(e.op==="count"||se(e,"field"))}function JU(e){return e&&ne(e)}function zg(e){return se(e,"row")||se(e,"column")}function HF(e){return se(e,"header")}function Fx(e){return se(e,"facet")}function x1e(e){return se(e,"param")}function w1e(e){return!ve(e)&&se(e,"repeat")}function j6(e){const{field:t,timeUnit:n,bin:r,aggregate:i}=e;return{...n?{timeUnit:n}:{},...r?{bin:r}:{},...i?{aggregate:i}:{},field:t}}function GF(e){return se(e,"sort")}function cu({fieldDef:e,fieldDef2:t,markDef:n,config:r}){if(je(e)&&e.bandPosition!==void 0)return e.bandPosition;if(ce(e)){const{timeUnit:i,bin:o}=e;if(i&&!t)return Ko("timeUnitBandPosition",n,r);if(St(o))return .5}}function ZU({channel:e,fieldDef:t,fieldDef2:n,markDef:r,config:i,scaleType:o,useVlSizeChannel:s}){var c,f,h;const a=Wr(e),u=yt(s?"size":a,r,i,{vgChannel:a});if(u!==void 0)return u;if(ce(t)){const{timeUnit:p,bin:m}=t;if(p&&!n)return{band:Ko("timeUnitBandSize",r,i)};if(St(m)&&!En(o))return{band:1}}if(Gp(r.type))return o?En(o)?((c=i[r.type])==null?void 0:c.discreteBandSize)||{band:1}:(f=i[r.type])==null?void 0:f.continuousBandSize:(h=i[r.type])==null?void 0:h.discreteBandSize}function ej(e,t,n,r){return St(e.bin)||e.timeUnit&&xr(e)&&e.type==="temporal"?cu({fieldDef:e,fieldDef2:t,markDef:n,config:r})!==void 0:!1}function tj(e){return se(e,"sort")&&!se(e,"field")}function Ig(e){return se(e,"condition")}function Dx(e){const t=e==null?void 0:e.condition;return!!t&&!ne(t)&&ce(t)}function Bg(e){const t=e==null?void 0:e.condition;return!!t&&!ne(t)&&je(t)}function E1e(e){const t=e==null?void 0:e.condition;return!!t&&(ne(t)||lo(t))}function ce(e){return se(e,"field")||(e==null?void 0:e.aggregate)==="count"}function jf(e){return e==null?void 0:e.type}function ds(e){return se(e,"datum")}function Ha(e){return xr(e)&&!Iy(e)||zy(e)}function W6(e){return xr(e)&&e.type==="quantitative"&&!e.bin||zy(e)}function zy(e){return ds(e)&&at(e.datum)}function je(e){return ce(e)||ds(e)}function xr(e){return e&&(se(e,"field")||e.aggregate==="count")&&se(e,"type")}function lo(e){return se(e,"value")}function ac(e){return se(e,"scale")||se(e,"sort")}function Wf(e){return se(e,"axis")||se(e,"stack")||se(e,"impute")}function nj(e){return se(e,"legend")}function rj(e){return se(e,"format")||se(e,"formatType")}function b1e(e){return Pr(e,["legend","axis","header","scale"])}function S1e(e){return se(e,"op")}function ge(e,t={}){let n=e.field;const r=t.prefix;let i=t.suffix,o="";if(A1e(e))n=GB("count");else{let s;if(!t.nofn)if(S1e(e))s=e.op;else{const{bin:a,aggregate:u,timeUnit:c}=e;St(a)?(s=sU(a),i=(t.binSuffix??"")+(t.suffix??"")):u?Cu(u)?(o=`["${n}"]`,n=`argmax_${u.argmax}`):Qs(u)?(o=`["${n}"]`,n=`argmin_${u.argmin}`):s=String(u):c&&!sc(c)&&(s=Ame(c),i=(!["range","mid"].includes(t.binSuffix)&&t.binSuffix||"")+(t.suffix??""))}s&&(n=n?`${s}_${n}`:s)}return i&&(n=`${n}_${i}`),r&&(n=`${r}_${n}`),t.forAs?gd(n):t.expr?WB(n,t.expr)+o:Ti(n)+o}function Iy(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return ce(e)&&!!e.bin;case"temporal":return!1}throw new Error(mU(e.type))}function _1e(e){var t;return ac(e)&&Uf((t=e.scale)==null?void 0:t.type)}function A1e(e){return e.aggregate==="count"}function C1e(e,t){var s;const{field:n,bin:r,timeUnit:i,aggregate:o}=e;if(o==="count")return t.countTitle;if(St(r))return`${n} (binned)`;if(i&&!sc(i)){const a=(s=wn(i))==null?void 0:s.unit;if(a)return`${n} (${bx(a).join("-")})`}else if(o)return Cu(o)?`${n} for max ${o.argmax}`:Qs(o)?`${n} for min ${o.argmin}`:`${Mg(o)} of ${n}`;return n}function k1e(e){const{aggregate:t,bin:n,timeUnit:r,field:i}=e;if(Cu(t))return`${i} for argmax(${t.argmax})`;if(Qs(t))return`${i} for argmin(${t.argmin})`;const o=r&&!sc(r)?wn(r):void 0,s=t||(o==null?void 0:o.unit)||(o==null?void 0:o.maxbins)&&"timeunit"||St(n)&&"bin";return s?`${s.toUpperCase()}(${i})`:i}const ij=(e,t)=>{switch(t.fieldTitle){case"plain":return e.field;case"functional":return k1e(e);default:return C1e(e,t)}};let oj=ij;function sj(e){oj=e}function $1e(){sj(ij)}function hf(e,t,{allowDisabling:n,includeDefault:r=!0}){var a;const i=(a=VF(e))==null?void 0:a.title;if(!ce(e))return i??e.title;const o=e,s=r?YF(o,t):void 0;return n?Yt(i,o.title,s):i??o.title??s}function VF(e){if(Wf(e)&&e.axis)return e.axis;if(nj(e)&&e.legend)return e.legend;if(HF(e)&&e.header)return e.header}function YF(e,t){return oj(e,t)}function By(e){if(rj(e)){const{format:t,formatType:n}=e;return{format:t,formatType:n}}else{const t=VF(e)??{},{format:n,formatType:r}=t;return{format:n,formatType:r}}}function F1e(e,t){var o;switch(t){case"latitude":case"longitude":return"quantitative";case"row":case"column":case"facet":case"shape":case"strokeDash":return"nominal";case"order":return"ordinal"}if(GF(e)&&ne(e.sort))return"ordinal";const{aggregate:n,bin:r,timeUnit:i}=e;if(i)return"temporal";if(r||n&&!Cu(n)&&!Qs(n))return"quantitative";if(ac(e)&&((o=e.scale)!=null&&o.type))switch(z_[e.scale.type]){case"numeric":case"discretizing":return"quantitative";case"time":return"temporal"}return"nominal"}function co(e){if(ce(e))return e;if(Dx(e))return e.condition}function sn(e){if(je(e))return e;if(Bg(e))return e.condition}function aj(e,t,n,r={}){if(ve(e)||at(e)||hu(e)){const i=ve(e)?"string":at(e)?"number":"boolean";return ue($0e(t,i,e)),{value:e}}return je(e)?Uy(e,t,n,r):Bg(e)?{...e,condition:Uy(e.condition,t,n,r)}:e}function Uy(e,t,n,r){if(rj(e)){const{format:i,formatType:o,...s}=e;if(Bl(o)&&!n.customFormatTypes)return ue(O6(t)),Uy(s,t,n,r)}else{const i=Wf(e)?"axis":nj(e)?"legend":HF(e)?"header":null;if(i&&e[i]){const{format:o,formatType:s,...a}=e[i];if(Bl(s)&&!n.customFormatTypes)return ue(O6(t)),Uy({...e,[i]:a},t,n,r)}}return ce(e)?XF(e,t,r):D1e(e)}function D1e(e){let t=e.type;if(t)return e;const{datum:n}=e;return t=at(n)?"quantitative":ve(n)?"nominal":oc(n)?"temporal":void 0,{...e,type:t}}function XF(e,t,{compositeMark:n=!1}={}){const{aggregate:r,timeUnit:i,bin:o,field:s}=e,a={...e};if(!n&&r&&!wF(r)&&!Cu(r)&&!Qs(r)&&(ue(D0e(r)),delete a.aggregate),i&&(a.timeUnit=wn(i)),s&&(a.field=`${s}`),St(o)&&(a.bin=Mx(o,t)),Cn(o)&&!Xt(t)&&ue(ume(t)),xr(a)){const{type:u}=a,c=Nme(u);u!==c&&(a.type=c),u!=="quantitative"&&xx(r)&&(ue(F0e(u,r)),a.type="quantitative")}else if(!eU(t)){const u=F1e(a,t);a.type=u}if(xr(a)){const{compatible:u,warning:c}=M1e(a,t)||{};u===!1&&ue(c)}if(GF(a)&&ve(a.sort)){const{sort:u}=a;if(U6(u))return{...a,sort:{encoding:u}};const c=u.substring(1);if(u.charAt(0)==="-"&&U6(c))return{...a,sort:{encoding:c,order:"descending"}}}if(HF(a)){const{header:u}=a;if(u){const{orient:c,...f}=u;if(c)return{...a,header:{...f,labelOrient:u.labelOrient||c,titleOrient:u.titleOrient||c}}}}return a}function Mx(e,t){return hu(e)?{maxbins:C6(t)}:e==="binned"?{binned:!0}:!e.maxbins&&!e.step?{...e,maxbins:C6(t)}:e}const Hc={compatible:!0};function M1e(e,t){const n=e.type;if(n==="geojson"&&t!=="shape")return{compatible:!1,warning:`Channel ${t} should not be used with a geojson data.`};switch(t){case js:case Ws:case hx:return Iy(e)?Hc:{compatible:!1,warning:R0e(t)};case Tt:case Sn:case wu:case md:case Ur:case us:case ls:case Tg:case Ng:case px:case Ol:case gx:case mx:case tc:case Oi:case yo:case yx:return Hc;case xo:case Ni:case vo:case wo:return n!==zl?{compatible:!1,warning:`Channel ${t} should be used with a quantitative field only, not ${e.type} field.`}:Hc;case ia:case bu:case Su:case _u:case ra:case na:case ta:case mo:case as:case Eu:return n==="nominal"&&!e.sort?{compatible:!1,warning:`Channel ${t} should not be used with an unsorted discrete field.`}:Hc;case jr:case Au:return!Iy(e)&&!_1e(e)?{compatible:!1,warning:O0e(t)}:Hc;case If:return e.type==="nominal"&&!("sort"in e)?{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}:Hc}}function qf(e){const{formatType:t}=By(e);return t==="time"||!t&&T1e(e)}function T1e(e){return e&&(e.type==="temporal"||ce(e)&&!!e.timeUnit)}function Tx(e,{timeUnit:t,type:n,wrapTime:r,undefinedIfExprNotRequired:i}){var u;const o=t&&((u=wn(t))==null?void 0:u.unit);let s=o||n==="temporal",a;return Og(e)?a=e.expr:Fe(e)?a=e.signal:oc(e)?(s=!0,a=Ll(e)):(ve(e)||at(e))&&s&&(a=`datetime(${xt(e)})`,wme(o)&&(at(e)&&e<1e4||ve(e)&&isNaN(Date.parse(e)))&&(a=Ll({[o]:e}))),a?r&&s?`time(${a})`:a:i?void 0:xt(e)}function uj(e,t){const{type:n}=e;return t.map(r=>{const i=ce(e)&&!sc(e.timeUnit)?e.timeUnit:void 0,o=Tx(r,{timeUnit:i,type:n,undefinedIfExprNotRequired:!0});return o!==void 0?{signal:o}:r})}function Ug(e,t){return St(e.bin)?fs(t)&&["ordinal","nominal"].includes(e.type):(console.warn("Only call this method for binned field defs."),!1)}const q6={labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDashOffset"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDashOffset"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"}};function jg(e){return e==null?void 0:e.condition}const lj=["domain","grid","labels","ticks","title"],N1e={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"both",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},cj={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},R1e={...cj,style:1,labelExpr:1,encoding:1};function H6(e){return Ee(R1e,e)}const O1e={axis:1,axisBand:1,axisBottom:1,axisDiscrete:1,axisLeft:1,axisPoint:1,axisQuantitative:1,axisRight:1,axisTemporal:1,axisTop:1,axisX:1,axisXBand:1,axisXDiscrete:1,axisXPoint:1,axisXQuantitative:1,axisXTemporal:1,axisY:1,axisYBand:1,axisYDiscrete:1,axisYPoint:1,axisYQuantitative:1,axisYTemporal:1},fj=oe(O1e);function sa(e){return se(e,"mark")}class Nx{constructor(t,n){this.name=t,this.run=n}hasMatchingType(t){return sa(t)?l1e(t.mark)===this.name:!1}}function vl(e,t){const n=e&&e[t];return n?ne(n)?Lf(n,r=>!!r.field):ce(n)||Dx(n):!1}function dj(e,t){const n=e&&e[t];return n?ne(n)?Lf(n,r=>!!r.field):ce(n)||ds(n)||Bg(n):!1}function hj(e,t){if(Xt(t)){const n=e[t];if((ce(n)||ds(n))&&(NU(n.type)||ce(n)&&n.timeUnit)){const r=gF(t);return dj(e,r)}}return!1}function pj(e){return Lf(Dge,t=>{if(vl(e,t)){const n=e[t];if(ne(n))return Lf(n,r=>!!r.aggregate);{const r=co(n);return r&&!!r.aggregate}}return!1})}function gj(e,t){const n=[],r=[],i=[],o=[],s={};return QF(e,(a,u)=>{if(ce(a)){const{field:c,aggregate:f,bin:h,timeUnit:p,...m}=a;if(f||p||h){const y=VF(a),v=y==null?void 0:y.title;let w=ge(a,{forAs:!0});const E={...v?[]:{title:hf(a,t,{allowDisabling:!0})},...m,field:w};if(f){let S;if(Cu(f)?(S="argmax",w=ge({op:"argmax",field:f.argmax},{forAs:!0}),E.field=`${w}.${c}`):Qs(f)?(S="argmin",w=ge({op:"argmin",field:f.argmin},{forAs:!0}),E.field=`${w}.${c}`):f!=="boxplot"&&f!=="errorbar"&&f!=="errorband"&&(S=f),S){const A={op:S,as:w};c&&(A.field=c),o.push(A)}}else if(n.push(w),xr(a)&&St(h)){if(r.push({bin:h,field:c,as:w}),n.push(ge(a,{binSuffix:"end"})),Ug(a,u)&&n.push(ge(a,{binSuffix:"range"})),Xt(u)){const S={field:`${w}_end`};s[`${u}2`]=S}E.bin="binned",eU(u)||(E.type=zl)}else if(p&&!sc(p)){i.push({timeUnit:p,field:c,as:w});const S=xr(a)&&a.type!==Bf&&"time";S&&(u===Tg||u===Ol?E.formatType=S:Uge(u)?E.legend={formatType:S,...E.legend}:Xt(u)&&(E.axis={formatType:S,...E.axis}))}s[u]=E}else n.push(c),s[u]=e[u]}else s[u]=e[u]}),{bins:r,timeUnits:i,aggregate:o,groupby:n,encoding:s}}function P1e(e,t,n){const r=Wge(t,n);if(r){if(r==="binned"){const i=e[t===mo?Tt:Sn];return!!(ce(i)&&ce(e[t])&&Cn(i.bin))}}else return!1;return!0}function L1e(e,t,n,r){const i={};for(const o of oe(e))ZB(o)||ue(N0e(o));for(let o of Pge){if(!e[o])continue;const s=e[o];if(Rg(o)){const a=Oge(o),u=i[a];if(ce(u)&&Tme(u.type)&&ce(s)&&!u.timeUnit){ue(k0e(a));continue}}if(o==="angle"&&t==="arc"&&!e.theta&&(ue(C0e),o=Oi),!P1e(e,o,t)){ue(Ex(o,t));continue}if(o===ra&&t==="line"){const a=co(e[o]);if(a!=null&&a.aggregate){ue(T0e);continue}}if(o===Ur&&(n?"fill"in e:"stroke"in e)){ue(yU("encoding",{fill:"fill"in e,stroke:"stroke"in e}));continue}if(o===Ng||o===If&&!ne(s)&&!lo(s)||o===Ol&&ne(s)){if(s){if(o===If){const a=e[o];if(tj(a)){i[o]=a;continue}}i[o]=xe(s).reduce((a,u)=>(ce(u)?a.push(XF(u,o)):ue(L_(u,o)),a),[])}}else{if(o===Ol&&s===null)i[o]=null;else if(!ce(s)&&!ds(s)&&!lo(s)&&!Ig(s)&&!Fe(s)){ue(L_(s,o));continue}i[o]=aj(s,o,r)}}return i}function Rx(e,t){const n={};for(const r of oe(e)){const i=aj(e[r],r,t,{compositeMark:!0});n[r]=i}return n}function z1e(e){const t=[];for(const n of oe(e))if(vl(e,n)){const r=e[n],i=xe(r);for(const o of i)ce(o)?t.push(o):Dx(o)&&t.push(o.condition)}return t}function QF(e,t,n){if(e)for(const r of oe(e)){const i=e[r];if(ne(i))for(const o of i)t.call(n,o,r);else t.call(n,i,r)}}function I1e(e,t,n,r){return e?oe(e).reduce((i,o)=>{const s=e[o];return ne(s)?s.reduce((a,u)=>t.call(r,a,u,o),i):t.call(r,i,s,o)},n):n}function mj(e,t){return oe(t).reduce((n,r)=>{switch(r){case Tt:case Sn:case gx:case yx:case mx:case mo:case as:case wu:case md:case Oi:case na:case yo:case ta:case Eu:case vo:case xo:case wo:case Ni:case Tg:case jr:case tc:case Ol:return n;case If:if(e==="line"||e==="trail")return n;case Ng:case px:{const i=t[r];if(ne(i)||ce(i))for(const o of xe(i))o.aggregate||n.push(ge(o,{}));return n}case ra:if(e==="trail")return n;case Ur:case us:case ls:case ia:case bu:case Su:case Au:case _u:{const i=co(t[r]);return i&&!i.aggregate&&n.push(ge(i,{})),n}}},[])}function B1e(e){const{tooltip:t,...n}=e;if(!t)return{filteredEncoding:n};let r,i;if(ne(t)){for(const o of t)o.aggregate?(r||(r=[]),r.push(o)):(i||(i=[]),i.push(o));r&&(n.tooltip=r)}else t.aggregate?n.tooltip=t:i=t;return ne(i)&&i.length===1&&(i=i[0]),{customTooltipWithoutAggregatedField:i,filteredEncoding:n}}function U_(e,t,n,r=!0){if("tooltip"in n)return{tooltip:n.tooltip};const i=e.map(({fieldPrefix:s,titlePrefix:a})=>{const u=r?` of ${KF(t)}`:"";return{field:s+t.field,type:t.type,title:Fe(a)?{signal:`${a}"${escape(u)}"`}:a+u}}),o=z1e(n).map(b1e);return{tooltip:[...i,...Lo(o,Ke)]}}function KF(e){const{title:t,field:n}=e;return Yt(t,n)}function JF(e,t,n,r,i){const{scale:o,axis:s}=n;return({partName:a,mark:u,positionPrefix:c,endPositionPrefix:f=void 0,extraEncoding:h={}})=>{const p=KF(n);return yj(e,a,i,{mark:u,encoding:{[t]:{field:`${c}_${n.field}`,type:n.type,...p!==void 0?{title:p}:{},...o!==void 0?{scale:o}:{},...s!==void 0?{axis:s}:{}},...ve(f)?{[`${t}2`]:{field:`${f}_${n.field}`}}:{},...r,...h}})}}function yj(e,t,n,r){const{clip:i,color:o,opacity:s}=e,a=e.type;return e[t]||e[t]===void 0&&n[t]?[{...r,mark:{...n[t],...i?{clip:i}:{},...o?{color:o}:{},...s?{opacity:s}:{},...Jo(r.mark)?r.mark:{type:r.mark},style:`${a}-${String(t)}`,...hu(e[t])?{}:e[t]}}]:[]}function vj(e,t,n){const{encoding:r}=e,i=t==="vertical"?"y":"x",o=r[i],s=r[`${i}2`],a=r[`${i}Error`],u=r[`${i}Error2`];return{continuousAxisChannelDef:Nm(o,n),continuousAxisChannelDef2:Nm(s,n),continuousAxisChannelDefError:Nm(a,n),continuousAxisChannelDefError2:Nm(u,n),continuousAxis:i}}function Nm(e,t){if(e!=null&&e.aggregate){const{aggregate:n,...r}=e;return n!==t&&ue(ame(n,t)),r}else return e}function xj(e,t){const{mark:n,encoding:r}=e,{x:i,y:o}=r;if(Jo(n)&&n.orient)return n.orient;if(Ha(i)){if(Ha(o)){const s=ce(i)&&i.aggregate,a=ce(o)&&o.aggregate;if(!s&&a===t)return"vertical";if(!a&&s===t)return"horizontal";if(s===t&&a===t)throw new Error("Both x and y cannot have aggregate");return qf(o)&&!qf(i)?"horizontal":"vertical"}return"horizontal"}else{if(Ha(o))return"vertical";throw new Error(`Need a valid continuous axis for ${t}s`)}}const jy="boxplot",U1e=["box","median","outliers","rule","ticks"],j1e=new Nx(jy,Ej);function wj(e){return at(e)?"tukey":e}function Ej(e,{config:t}){e={...e,encoding:Rx(e.encoding,t)};const{mark:n,encoding:r,params:i,projection:o,...s}=e,a=Jo(n)?n:{type:n};i&&ue(gU("boxplot"));const u=a.extent??t.boxplot.extent,c=yt("size",a,t),f=a.invalid,h=wj(u),{bins:p,timeUnits:m,transform:y,continuousAxisChannelDef:v,continuousAxis:w,groupby:E,aggregate:S,encodingWithoutContinuousAxis:A,ticksOrient:C,boxOrient:k,customTooltipWithoutAggregatedField:D}=W1e(e,u,t),$=gd(v.field),{color:M,size:T,...L}=A,O=Fu=>JF(a,w,v,Fu,t.boxplot),X=O(L),W=O(A),I=(ye(t.boxplot.box)?t.boxplot.box.color:t.mark.color)||"#4c78a8",N=O({...L,...T?{size:T}:{},color:{condition:{test:`${ht(`lower_box_${v.field}`)} >= ${ht(`upper_box_${v.field}`)}`,...M||{value:I}}}}),U=U_([{fieldPrefix:h==="min-max"?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:h==="min-max"?"lower_whisker_":"min_",titlePrefix:"Min"}],v,A),Y={type:"tick",color:"black",opacity:1,orient:C,invalid:f,aria:!1},j=h==="min-max"?U:U_([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],v,A),q=[...X({partName:"rule",mark:{type:"rule",invalid:f,aria:!1},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",extraEncoding:j}),...X({partName:"rule",mark:{type:"rule",invalid:f,aria:!1},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",extraEncoding:j}),...X({partName:"ticks",mark:Y,positionPrefix:"lower_whisker",extraEncoding:j}),...X({partName:"ticks",mark:Y,positionPrefix:"upper_whisker",extraEncoding:j})],K=[...h!=="tukey"?q:[],...W({partName:"box",mark:{type:"bar",...c?{size:c}:{},orient:k,invalid:f,ariaRoleDescription:"box"},positionPrefix:"lower_box",endPositionPrefix:"upper_box",extraEncoding:U}),...N({partName:"median",mark:{type:"tick",invalid:f,...ye(t.boxplot.median)&&t.boxplot.median.color?{color:t.boxplot.median.color}:{},...c?{size:c}:{},orient:C,aria:!1},positionPrefix:"mid_box",extraEncoding:U})];if(h==="min-max")return{...s,transform:(s.transform??[]).concat(y),layer:K};const P=ht(`lower_box_${v.field}`),G=ht(`upper_box_${v.field}`),me=`(${G} - ${P})`,_e=`${P} - ${u} * ${me}`,we=`${G} + ${u} * ${me}`,Ie=ht(v.field),et={joinaggregate:bj(v.field),groupby:E},Ve={transform:[{filter:`(${_e} <= ${Ie}) && (${Ie} <= ${we})`},{aggregate:[{op:"min",field:v.field,as:`lower_whisker_${$}`},{op:"max",field:v.field,as:`upper_whisker_${$}`},{op:"min",field:`lower_box_${v.field}`,as:`lower_box_${$}`},{op:"max",field:`upper_box_${v.field}`,as:`upper_box_${$}`},...S],groupby:E}],layer:q},{tooltip:fe,...Re}=L,{scale:We,axis:le}=v,zt=KF(v),nt=Pr(le,["title"]),Zt=yj(a,"outliers",t.boxplot,{transform:[{filter:`(${Ie} < ${_e}) || (${Ie} > ${we})`}],mark:"point",encoding:{[w]:{field:v.field,type:v.type,...zt!==void 0?{title:zt}:{},...We!==void 0?{scale:We}:{},...vt(nt)?{}:{axis:nt}},...Re,...M?{color:M}:{},...D?{tooltip:D}:{}}})[0];let qt;const br=[...p,...m,et];return Zt?qt={transform:br,layer:[Zt,Ve]}:(qt=Ve,qt.transform.unshift(...br)),{...s,layer:[qt,{transform:y,layer:K}]}}function bj(e){const t=gd(e);return[{op:"q1",field:e,as:`lower_box_${t}`},{op:"q3",field:e,as:`upper_box_${t}`}]}function W1e(e,t,n){const r=xj(e,jy),{continuousAxisChannelDef:i,continuousAxis:o}=vj(e,r,jy),s=i.field,a=gd(s),u=wj(t),c=[...bj(s),{op:"median",field:s,as:`mid_box_${a}`},{op:"min",field:s,as:(u==="min-max"?"lower_whisker_":"min_")+a},{op:"max",field:s,as:(u==="min-max"?"upper_whisker_":"max_")+a}],f=u==="min-max"||u==="tukey"?[]:[{calculate:`${ht(`upper_box_${a}`)} - ${ht(`lower_box_${a}`)}`,as:`iqr_${a}`},{calculate:`min(${ht(`upper_box_${a}`)} + ${ht(`iqr_${a}`)} * ${t}, ${ht(`max_${a}`)})`,as:`upper_whisker_${a}`},{calculate:`max(${ht(`lower_box_${a}`)} - ${ht(`iqr_${a}`)} * ${t}, ${ht(`min_${a}`)})`,as:`lower_whisker_${a}`}],{[o]:h,...p}=e.encoding,{customTooltipWithoutAggregatedField:m,filteredEncoding:y}=B1e(p),{bins:v,timeUnits:w,aggregate:E,groupby:S,encoding:A}=gj(y,n),C=r==="vertical"?"horizontal":"vertical",k=r,D=[...v,...w,{aggregate:[...E,...c],groupby:S},...f];return{bins:v,timeUnits:w,transform:D,groupby:S,aggregate:E,continuousAxisChannelDef:i,continuousAxis:o,encodingWithoutContinuousAxis:A,ticksOrient:C,boxOrient:k,customTooltipWithoutAggregatedField:m}}const ZF="errorbar",q1e=["ticks","rule"],H1e=new Nx(ZF,Sj);function Sj(e,{config:t}){e={...e,encoding:Rx(e.encoding,t)};const{transform:n,continuousAxisChannelDef:r,continuousAxis:i,encodingWithoutContinuousAxis:o,ticksOrient:s,markDef:a,outerSpec:u,tooltipEncoding:c}=_j(e,ZF,t);delete o.size;const f=JF(a,i,r,o,t.errorbar),h=a.thickness,p=a.size,m={type:"tick",orient:s,aria:!1,...h!==void 0?{thickness:h}:{},...p!==void 0?{size:p}:{}},y=[...f({partName:"ticks",mark:m,positionPrefix:"lower",extraEncoding:c}),...f({partName:"ticks",mark:m,positionPrefix:"upper",extraEncoding:c}),...f({partName:"rule",mark:{type:"rule",ariaRoleDescription:"errorbar",...h!==void 0?{size:h}:{}},positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:c})];return{...u,transform:n,...y.length>1?{layer:y}:{...y[0]}}}function G1e(e,t){const{encoding:n}=e;if(V1e(n))return{orient:xj(e,t),inputType:"raw"};const r=Y1e(n),i=X1e(n),o=n.x,s=n.y;if(r){if(i)throw new Error(`${t} cannot be both type aggregated-upper-lower and aggregated-error`);const a=n.x2,u=n.y2;if(je(a)&&je(u))throw new Error(`${t} cannot have both x2 and y2`);if(je(a)){if(Ha(o))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error(`Both x and x2 have to be quantitative in ${t}`)}else if(je(u)){if(Ha(s))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error(`Both y and y2 have to be quantitative in ${t}`)}throw new Error("No ranged axis")}else{const a=n.xError,u=n.xError2,c=n.yError,f=n.yError2;if(je(u)&&!je(a))throw new Error(`${t} cannot have xError2 without xError`);if(je(f)&&!je(c))throw new Error(`${t} cannot have yError2 without yError`);if(je(a)&&je(c))throw new Error(`${t} cannot have both xError and yError with both are quantiative`);if(je(a)){if(Ha(o))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}else if(je(c)){if(Ha(s))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}function V1e(e){return(je(e.x)||je(e.y))&&!je(e.x2)&&!je(e.y2)&&!je(e.xError)&&!je(e.xError2)&&!je(e.yError)&&!je(e.yError2)}function Y1e(e){return je(e.x2)||je(e.y2)}function X1e(e){return je(e.xError)||je(e.xError2)||je(e.yError)||je(e.yError2)}function _j(e,t,n){const{mark:r,encoding:i,params:o,projection:s,...a}=e,u=Jo(r)?r:{type:r};o&&ue(gU(t));const{orient:c,inputType:f}=G1e(e,t),{continuousAxisChannelDef:h,continuousAxisChannelDef2:p,continuousAxisChannelDefError:m,continuousAxisChannelDefError2:y,continuousAxis:v}=vj(e,c,t),{errorBarSpecificAggregate:w,postAggregateCalculates:E,tooltipSummary:S,tooltipTitleWithFieldName:A}=Q1e(u,h,p,m,y,f,t,n),{[v]:C,[v==="x"?"x2":"y2"]:k,[v==="x"?"xError":"yError"]:D,[v==="x"?"xError2":"yError2"]:$,...M}=i,{bins:T,timeUnits:L,aggregate:O,groupby:X,encoding:W}=gj(M,n),I=[...O,...w],N=f!=="raw"?[]:X,U=U_(S,h,W,A);return{transform:[...a.transform??[],...T,...L,...I.length===0?[]:[{aggregate:I,groupby:N}],...E],groupby:N,continuousAxisChannelDef:h,continuousAxis:v,encodingWithoutContinuousAxis:W,ticksOrient:c==="vertical"?"horizontal":"vertical",markDef:u,outerSpec:a,tooltipEncoding:U}}function Q1e(e,t,n,r,i,o,s,a){let u=[],c=[];const f=t.field;let h,p=!1;if(o==="raw"){const m=e.center?e.center:e.extent?e.extent==="iqr"?"median":"mean":a.errorbar.center,y=e.extent?e.extent:m==="mean"?"stderr":"iqr";if(m==="median"!=(y==="iqr")&&ue(sme(m,y,s)),y==="stderr"||y==="stdev")u=[{op:y,field:f,as:`extent_${f}`},{op:m,field:f,as:`center_${f}`}],c=[{calculate:`${ht(`center_${f}`)} + ${ht(`extent_${f}`)}`,as:`upper_${f}`},{calculate:`${ht(`center_${f}`)} - ${ht(`extent_${f}`)}`,as:`lower_${f}`}],h=[{fieldPrefix:"center_",titlePrefix:Mg(m)},{fieldPrefix:"upper_",titlePrefix:G6(m,y,"+")},{fieldPrefix:"lower_",titlePrefix:G6(m,y,"-")}],p=!0;else{let v,w,E;y==="ci"?(v="mean",w="ci0",E="ci1"):(v="median",w="q1",E="q3"),u=[{op:w,field:f,as:`lower_${f}`},{op:E,field:f,as:`upper_${f}`},{op:v,field:f,as:`center_${f}`}],h=[{fieldPrefix:"upper_",titlePrefix:hf({field:f,aggregate:E,type:"quantitative"},a,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:hf({field:f,aggregate:w,type:"quantitative"},a,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:hf({field:f,aggregate:v,type:"quantitative"},a,{allowDisabling:!1})}]}}else{(e.center||e.extent)&&ue(ome(e.center,e.extent)),o==="aggregated-upper-lower"?(h=[],c=[{calculate:ht(n.field),as:`upper_${f}`},{calculate:ht(f),as:`lower_${f}`}]):o==="aggregated-error"&&(h=[{fieldPrefix:"",titlePrefix:f}],c=[{calculate:`${ht(f)} + ${ht(r.field)}`,as:`upper_${f}`}],i?c.push({calculate:`${ht(f)} + ${ht(i.field)}`,as:`lower_${f}`}):c.push({calculate:`${ht(f)} - ${ht(r.field)}`,as:`lower_${f}`}));for(const m of c)h.push({fieldPrefix:m.as.substring(0,6),titlePrefix:Rl(Rl(m.calculate,"datum['",""),"']","")})}return{postAggregateCalculates:c,errorBarSpecificAggregate:u,tooltipSummary:h,tooltipTitleWithFieldName:p}}function G6(e,t,n){return`${Mg(e)} ${n} ${t}`}const e3="errorband",K1e=["band","borders"],J1e=new Nx(e3,Aj);function Aj(e,{config:t}){e={...e,encoding:Rx(e.encoding,t)};const{transform:n,continuousAxisChannelDef:r,continuousAxis:i,encodingWithoutContinuousAxis:o,markDef:s,outerSpec:a,tooltipEncoding:u}=_j(e,e3,t),c=s,f=JF(c,i,r,o,t.errorband),h=e.encoding.x!==void 0&&e.encoding.y!==void 0;let p={type:h?"area":"rect"},m={type:h?"line":"rule"};const y={...c.interpolate?{interpolate:c.interpolate}:{},...c.tension&&c.interpolate?{tension:c.tension}:{}};return h?(p={...p,...y,ariaRoleDescription:"errorband"},m={...m,...y,aria:!1}):c.interpolate?ue(L6("interpolate")):c.tension&&ue(L6("tension")),{...a,transform:n,layer:[...f({partName:"band",mark:p,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:u}),...f({partName:"borders",mark:m,positionPrefix:"lower",extraEncoding:u}),...f({partName:"borders",mark:m,positionPrefix:"upper",extraEncoding:u})]}}const Cj={};function t3(e,t,n){const r=new Nx(e,t);Cj[e]={normalizer:r,parts:n}}function Z1e(){return oe(Cj)}t3(jy,Ej,U1e);t3(ZF,Sj,q1e);t3(e3,Aj,K1e);const eye=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],kj={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},$j={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},tye=oe(kj),nye=oe($j),rye={header:1,headerRow:1,headerColumn:1,headerFacet:1},Fj=oe(rye),Dj=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],iye={gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},oye={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},fo="_vgsid_",sye={point:{on:"click",fields:[fo],toggle:"event.shiftKey",resolve:"global",clear:"dblclick"},interval:{on:"[pointerdown, window:pointerup] > window:pointermove!",encodings:["x","y"],translate:"[pointerdown, window:pointerup] > window:pointermove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function n3(e){return e==="legend"||!!(e!=null&&e.legend)}function pb(e){return n3(e)&&ye(e)}function r3(e){return!!(e!=null&&e.select)}function Mj(e){const t=[];for(const n of e||[]){if(r3(n))continue;const{expr:r,bind:i,...o}=n;if(i&&r){const s={...o,bind:i,init:r};t.push(s)}else{const s={...o,...r?{update:r}:{},...i?{bind:i}:{}};t.push(s)}}return t}function aye(e){return Ox(e)||o3(e)||i3(e)}function i3(e){return se(e,"concat")}function Ox(e){return se(e,"vconcat")}function o3(e){return se(e,"hconcat")}function Tj({step:e,offsetIsDiscrete:t}){return t?e.for??"offset":"position"}function Zo(e){return se(e,"step")}function V6(e){return se(e,"view")||se(e,"width")||se(e,"height")}const Y6=20,uye={align:1,bounds:1,center:1,columns:1,spacing:1},lye=oe(uye);function cye(e,t,n){const r=n[t],i={},{spacing:o,columns:s}=r;o!==void 0&&(i.spacing=o),s!==void 0&&(Fx(e)&&!zg(e.facet)||i3(e))&&(i.columns=s),Ox(e)&&(i.columns=1);for(const a of lye)if(e[a]!==void 0)if(a==="spacing"){const u=e[a];i[a]=at(u)?u:{row:u.row??o,column:u.column??o}}else i[a]=e[a];return i}function j_(e,t){return e[t]??e[t==="width"?"continuousWidth":"continuousHeight"]}function W_(e,t){const n=Wy(e,t);return Zo(n)?n.step:Nj}function Wy(e,t){const n=e[t]??e[t==="width"?"discreteWidth":"discreteHeight"];return Yt(n,{step:e.step})}const Nj=20,fye={continuousWidth:200,continuousHeight:200,step:Nj},dye={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:fye,mark:r1e,arc:{},area:{},bar:a1e,circle:{},geoshape:{},image:{},line:{},point:{},rect:BF,rule:{color:"black"},square:{},text:{color:"black"},tick:u1e,trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:zme,projection:{},legend:iye,header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:sye,style:{},title:{},facet:{spacing:Y6},concat:{spacing:Y6},normalizedNumberFormat:".0%"},As=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],X6={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},Q6={blue:As[0],orange:As[1],red:As[2],teal:As[3],green:As[4],yellow:As[5],purple:As[6],pink:As[7],brown:As[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function hye(e={}){return{signals:[{name:"color",value:ye(e)?{...Q6,...e}:Q6}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}function pye(e){return{signals:[{name:"fontSize",value:ye(e)?{...X6,...e}:X6}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}function gye(e){return{text:{font:e},style:{"guide-label":{font:e},"guide-title":{font:e},"group-title":{font:e},"group-subtitle":{font:e}}}}function Rj(e){const t=oe(e||{}),n={};for(const r of t){const i=e[r];n[r]=jg(i)?uU(i):Zr(i)}return n}function mye(e){const t=oe(e),n={};for(const r of t)n[r]=Rj(e[r]);return n}const yye=[...WU,...fj,...Fj,"background","padding","legend","lineBreak","scale","style","title","view"];function Oj(e={}){const{color:t,font:n,fontSize:r,selection:i,...o}=e,s=Jf({},Ue(dye),n?gye(n):{},t?hye(t):{},r?pye(r):{},o||{});i&&Zf(s,"selection",i,!0);const a=Pr(s,yye);for(const u of["background","lineBreak","padding"])s[u]&&(a[u]=Zr(s[u]));for(const u of WU)s[u]&&(a[u]=kn(s[u]));for(const u of fj)s[u]&&(a[u]=Rj(s[u]));for(const u of Fj)s[u]&&(a[u]=kn(s[u]));if(s.legend&&(a.legend=kn(s.legend)),s.scale){const{invalid:u,...c}=s.scale,f=kn(u,{level:1});a.scale={...kn(c),...oe(f).length>0?{invalid:f}:{}}}return s.style&&(a.style=mye(s.style)),s.title&&(a.title=kn(s.title)),s.view&&(a.view=kn(s.view)),a}const vye=new Set(["view",...Kme]),xye=["color","fontSize","background","padding","facet","concat","numberFormat","numberFormatType","normalizedNumberFormat","normalizedNumberFormatType","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],wye={view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"],...n1e};function Eye(e){e=Ue(e);for(const t of xye)delete e[t];if(e.axis)for(const t in e.axis)jg(e.axis[t])&&delete e.axis[t];if(e.legend)for(const t of eye)delete e.legend[t];if(e.mark){for(const t of I6)delete e.mark[t];e.mark.tooltip&&ye(e.mark.tooltip)&&delete e.mark.tooltip}e.params&&(e.signals=(e.signals||[]).concat(Mj(e.params)),delete e.params);for(const t of vye){for(const r of I6)delete e[t][r];const n=wye[t];if(n)for(const r of n)delete e[t][r];Sye(e,t)}for(const t of Z1e())delete e[t];bye(e);for(const t in e)ye(e[t])&&vt(e[t])&&delete e[t];return vt(e)?void 0:e}function bye(e){const{titleMarkConfig:t,subtitleMarkConfig:n,subtitle:r}=aU(e.title);vt(t)||(e.style["group-title"]={...e.style["group-title"],...t}),vt(n)||(e.style["group-subtitle"]={...e.style["group-subtitle"],...n}),vt(r)?delete e.title:e.title=r}function Sye(e,t,n,r){const i=e[t];t==="view"&&(n="cell");const o={...i,...e.style[n??t]};vt(o)||(e.style[n??t]=o),delete e[t]}function Px(e){return se(e,"layer")}function _ye(e){return se(e,"repeat")}function Aye(e){return!ne(e.repeat)&&se(e.repeat,"layer")}class s3{map(t,n){return Fx(t)?this.mapFacet(t,n):_ye(t)?this.mapRepeat(t,n):o3(t)?this.mapHConcat(t,n):Ox(t)?this.mapVConcat(t,n):i3(t)?this.mapConcat(t,n):this.mapLayerOrUnit(t,n)}mapLayerOrUnit(t,n){if(Px(t))return this.mapLayer(t,n);if(sa(t))return this.mapUnit(t,n);throw new Error(EF(t))}mapLayer(t,n){return{...t,layer:t.layer.map(r=>this.mapLayerOrUnit(r,n))}}mapHConcat(t,n){return{...t,hconcat:t.hconcat.map(r=>this.map(r,n))}}mapVConcat(t,n){return{...t,vconcat:t.vconcat.map(r=>this.map(r,n))}}mapConcat(t,n){const{concat:r,...i}=t;return{...i,concat:r.map(o=>this.map(o,n))}}mapFacet(t,n){return{...t,spec:this.map(t.spec,n)}}mapRepeat(t,n){return{...t,spec:this.map(t.spec,n)}}}const Cye={zero:1,center:1,normalize:1};function kye(e){return Ee(Cye,e)}const $ye=new Set([BU,Ax,_x,Py,kx,zF,IF,Cx,UU,LF]),Fye=new Set([Ax,_x,BU]);function Gc(e){return ce(e)&&jf(e)==="quantitative"&&!e.bin}function K6(e,t,{orient:n,type:r}){const i=t==="x"?"y":"radius",o=t==="x"&&["bar","area"].includes(r),s=e[t],a=e[i];if(ce(s)&&ce(a))if(Gc(s)&&Gc(a)){if(s.stack)return t;if(a.stack)return i;const u=ce(s)&&!!s.aggregate,c=ce(a)&&!!a.aggregate;if(u!==c)return u?t:i;if(o){if(n==="vertical")return i;if(n==="horizontal")return t}}else{if(Gc(s))return t;if(Gc(a))return i}else{if(Gc(s))return o&&n==="vertical"?void 0:t;if(Gc(a))return o&&n==="horizontal"?void 0:i}}function Dye(e){switch(e){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}function Pj(e,t){var v,w;const n=Jo(e)?e:{type:e},r=n.type;if(!$ye.has(r))return null;const i=K6(t,"x",n)||K6(t,"theta",n);if(!i)return null;const o=t[i],s=ce(o)?ge(o,{}):void 0,a=Dye(i),u=[],c=new Set;if(t[a]){const E=t[a],S=ce(E)?ge(E,{}):void 0;S&&S!==s&&(u.push(a),c.add(S))}const f=a==="x"?"xOffset":"yOffset",h=t[f],p=ce(h)?ge(h,{}):void 0;p&&p!==s&&(u.push(f),c.add(p));const m=Lge.reduce((E,S)=>{if(S!=="tooltip"&&vl(t,S)){const A=t[S];for(const C of xe(A)){const k=co(C);if(k.aggregate)continue;const D=ge(k,{});(!D||!c.has(D))&&E.push({channel:S,fieldDef:k})}}return E},[]);let y;return o.stack!==void 0?hu(o.stack)?y=o.stack?"zero":null:y=o.stack:Fye.has(r)&&(y="zero"),!y||!kye(y)||pj(t)&&m.length===0?null:((v=o==null?void 0:o.scale)!=null&&v.type&&((w=o==null?void 0:o.scale)==null?void 0:w.type)!==$n.LINEAR&&o!=null&&o.stack&&ue(nme(o.scale.type)),je(t[cs(i)])?(o.stack!==void 0&&ue(tme(i)),null):(ce(o)&&o.aggregate&&!Qge.has(o.aggregate)&&ue(rme(o.aggregate)),{groupbyChannels:u,groupbyFields:c,fieldChannel:i,impute:o.impute===null?!1:ku(r),stackBy:m,offset:y}))}function Lj(e,t,n){const r=kn(e),i=yt("orient",r,n);if(r.orient=Rye(r.type,t,i),i!==void 0&&i!==r.orient&&ue(I0e(r.orient,i)),r.type==="bar"&&r.orient){const u=yt("cornerRadiusEnd",r,n);if(u!==void 0){const c=r.orient==="horizontal"&&t.x2||r.orient==="vertical"&&t.y2?["cornerRadius"]:o1e[r.orient];for(const f of c)r[f]=u;r.cornerRadiusEnd!==void 0&&delete r.cornerRadiusEnd}}const o=yt("opacity",r,n),s=yt("fillOpacity",r,n);return o===void 0&&s===void 0&&(r.opacity=Tye(r.type,t)),yt("cursor",r,n)===void 0&&(r.cursor=Mye(r,t,n)),r}function Mye(e,t,n){return t.href||e.href||yt("href",e,n)?"pointer":e.cursor}function Tye(e,t){if(Qe([kx,LF,zF,IF],e)&&!pj(t))return .7}function Nye(e,t,{graticule:n}){if(n)return!1;const r=Ko("filled",e,t),i=e.type;return Yt(r,i!==kx&&i!==Cx&&i!==Py)}function Rye(e,t,n){switch(e){case kx:case zF:case IF:case UU:case Xme:case Yme:return}const{x:r,y:i,x2:o,y2:s}=t;switch(e){case Ax:if(ce(r)&&(Cn(r.bin)||ce(i)&&i.aggregate&&!r.aggregate))return"vertical";if(ce(i)&&(Cn(i.bin)||ce(r)&&r.aggregate&&!i.aggregate))return"horizontal";if(s||o){if(n)return n;if(!o)return(ce(r)&&r.type===zl&&!St(r.bin)||zy(r))&&ce(i)&&Cn(i.bin)?"horizontal":"vertical";if(!s)return(ce(i)&&i.type===zl&&!St(i.bin)||zy(i))&&ce(r)&&Cn(r.bin)?"vertical":"horizontal"}case Py:if(o&&!(ce(r)&&Cn(r.bin))&&s&&!(ce(i)&&Cn(i.bin)))return;case _x:if(s)return ce(i)&&Cn(i.bin)?"horizontal":"vertical";if(o)return ce(r)&&Cn(r.bin)?"vertical":"horizontal";if(e===Py){if(r&&!i)return"vertical";if(i&&!r)return"horizontal"}case Cx:case LF:{const a=W6(r),u=W6(i);if(n)return n;if(a&&!u)return e!=="tick"?"horizontal":"vertical";if(!a&&u)return e!=="tick"?"vertical":"horizontal";if(a&&u)return"vertical";{const c=xr(r)&&r.type===Bf,f=xr(i)&&i.type===Bf;if(c&&!f)return"vertical";if(!c&&f)return"horizontal"}return}}return"vertical"}function Oye(e){const{point:t,line:n,...r}=e;return oe(r).length>1?r:r.type}function Pye(e){for(const t of["line","area","rule","trail"])e[t]&&(e={...e,[t]:Pr(e[t],["point","line"])});return e}function gb(e,t={},n){return e.point==="transparent"?{opacity:0}:e.point?ye(e.point)?e.point:{}:e.point!==void 0?null:t.point||n.shape?ye(t.point)?t.point:{}:void 0}function J6(e,t={}){return e.line?e.line===!0?{}:e.line:e.line!==void 0?null:t.line?t.line===!0?{}:t.line:void 0}class Lye{constructor(){this.name="path-overlay"}hasMatchingType(t,n){if(sa(t)){const{mark:r,encoding:i}=t,o=Jo(r)?r:{type:r};switch(o.type){case"line":case"rule":case"trail":return!!gb(o,n[o.type],i);case"area":return!!gb(o,n[o.type],i)||!!J6(o,n[o.type])}}return!1}run(t,n,r){const{config:i}=n,{params:o,projection:s,mark:a,name:u,encoding:c,...f}=t,h=Rx(c,i),p=Jo(a)?a:{type:a},m=gb(p,i[p.type],h),y=p.type==="area"&&J6(p,i[p.type]),v=[{name:u,...o?{params:o}:{},mark:Oye({...p.type==="area"&&p.opacity===void 0&&p.fillOpacity===void 0?{opacity:.7}:{},...p}),encoding:Pr(h,["shape"])}],w=Pj(Lj(p,h,i),h);let E=h;if(w){const{fieldChannel:S,offset:A}=w;E={...h,[S]:{...h[S],...A?{stack:A}:{}}}}return E=Pr(E,["y2","x2"]),y&&v.push({...s?{projection:s}:{},mark:{type:"line",...Pf(p,["clip","interpolate","tension","tooltip"]),...y},encoding:E}),m&&v.push({...s?{projection:s}:{},mark:{type:"point",opacity:1,filled:!0,...Pf(p,["clip","tooltip"]),...m},encoding:E}),r({...f,layer:v},{...n,config:Pye(i)})}}function zye(e,t){return t?zg(e)?Ij(e,t):zj(e,t):e}function mb(e,t){return t?Ij(e,t):e}function q_(e,t,n){const r=t[e];if(w1e(r)){if(r.repeat in n)return{...t,[e]:n[r.repeat]};ue(m0e(r.repeat));return}return t}function zj(e,t){if(e=q_("field",e,t),e!==void 0){if(e===null)return null;if(GF(e)&&qs(e.sort)){const n=q_("field",e.sort,t);e={...e,...n?{sort:n}:{}}}return e}}function Z6(e,t){if(ce(e))return zj(e,t);{const n=q_("datum",e,t);return n!==e&&!n.type&&(n.type="nominal"),n}}function eO(e,t){if(je(e)){const n=Z6(e,t);if(n)return n;if(Ig(e))return{condition:e.condition}}else{if(Bg(e)){const n=Z6(e.condition,t);if(n)return{...e,condition:n};{const{condition:r,...i}=e;return i}}return e}}function Ij(e,t){const n={};for(const r in e)if(se(e,r)){const i=e[r];if(ne(i))n[r]=i.map(o=>eO(o,t)).filter(o=>o);else{const o=eO(i,t);o!==void 0&&(n[r]=o)}}return n}class Iye{constructor(){this.name="RuleForRangedLine"}hasMatchingType(t){if(sa(t)){const{encoding:n,mark:r}=t;if(r==="line"||Jo(r)&&r.type==="line")for(const i of Rge){const o=nc(i),s=n[o];if(n[i]&&(ce(s)&&!Cn(s.bin)||ds(s)))return!0}}return!1}run(t,n,r){const{encoding:i,mark:o}=t;return ue(z0e(!!i.x2,!!i.y2)),r({...t,mark:ye(o)?{...o,type:"rule"}:"rule"},n)}}class Bye extends s3{constructor(){super(...arguments),this.nonFacetUnitNormalizers=[j1e,H1e,J1e,new Lye,new Iye]}map(t,n){if(sa(t)){const r=vl(t.encoding,js),i=vl(t.encoding,Ws),o=vl(t.encoding,hx);if(r||i||o)return this.mapFacetedUnit(t,n)}return super.map(t,n)}mapUnit(t,n){const{parentEncoding:r,parentProjection:i}=n,o=mb(t.encoding,n.repeater),s={...t,...t.name?{name:[n.repeaterPrefix,t.name].filter(u=>u).join("_")}:{},...o?{encoding:o}:{}};if(r||i)return this.mapUnitWithParentEncodingOrProjection(s,n);const a=this.mapLayerOrUnit.bind(this);for(const u of this.nonFacetUnitNormalizers)if(u.hasMatchingType(s,n.config))return u.run(s,n,a);return s}mapRepeat(t,n){return Aye(t)?this.mapLayerRepeat(t,n):this.mapNonLayerRepeat(t,n)}mapLayerRepeat(t,n){const{repeat:r,spec:i,...o}=t,{row:s,column:a,layer:u}=r,{repeater:c={},repeaterPrefix:f=""}=n;return s||a?this.mapRepeat({...t,repeat:{...s?{row:s}:{},...a?{column:a}:{}},spec:{repeat:{layer:u},spec:i}},n):{...o,layer:u.map(h=>{const p={...c,layer:h},m=`${(i.name?`${i.name}_`:"")+f}child__layer_${Mt(h)}`,y=this.mapLayerOrUnit(i,{...n,repeater:p,repeaterPrefix:m});return y.name=m,y})}}mapNonLayerRepeat(t,n){const{repeat:r,spec:i,data:o,...s}=t;!ne(r)&&t.columns&&(t=Pr(t,["columns"]),ue(N6("repeat")));const a=[],{repeater:u={},repeaterPrefix:c=""}=n,f=!ne(r)&&r.row||[u?u.row:null],h=!ne(r)&&r.column||[u?u.column:null],p=ne(r)&&r||[u?u.repeat:null];for(const y of p)for(const v of f)for(const w of h){const E={repeat:y,row:v,column:w,layer:u.layer},S=(i.name?`${i.name}_`:"")+c+"child__"+(ne(r)?`${Mt(y)}`:(r.row?`row_${Mt(v)}`:"")+(r.column?`column_${Mt(w)}`:"")),A=this.map(i,{...n,repeater:E,repeaterPrefix:S});A.name=S,a.push(Pr(A,["data"]))}const m=ne(r)?t.columns:r.column?r.column.length:1;return{data:i.data??o,align:"all",...s,columns:m,concat:a}}mapFacet(t,n){const{facet:r}=t;return zg(r)&&t.columns&&(t=Pr(t,["columns"]),ue(N6("facet"))),super.mapFacet(t,n)}mapUnitWithParentEncodingOrProjection(t,n){const{encoding:r,projection:i}=t,{parentEncoding:o,parentProjection:s,config:a}=n,u=nO({parentProjection:s,projection:i}),c=tO({parentEncoding:o,encoding:mb(r,n.repeater)});return this.mapUnit({...t,...u?{projection:u}:{},...c?{encoding:c}:{}},{config:a})}mapFacetedUnit(t,n){const{row:r,column:i,facet:o,...s}=t.encoding,{mark:a,width:u,projection:c,height:f,view:h,params:p,encoding:m,...y}=t,{facetMapping:v,layout:w}=this.getFacetMappingAndLayout({row:r,column:i,facet:o},n),E=mb(s,n.repeater);return this.mapFacet({...y,...w,facet:v,spec:{...u?{width:u}:{},...f?{height:f}:{},...h?{view:h}:{},...c?{projection:c}:{},mark:a,encoding:E,...p?{params:p}:{}}},n)}getFacetMappingAndLayout(t,n){const{row:r,column:i,facet:o}=t;if(r||i){o&&ue(P0e([...r?[js]:[],...i?[Ws]:[]]));const s={},a={};for(const u of[js,Ws]){const c=t[u];if(c){const{align:f,center:h,spacing:p,columns:m,...y}=c;s[u]=y;for(const v of["align","center","spacing"])c[v]!==void 0&&(a[v]??(a[v]={}),a[v][u]=c[v])}}return{facetMapping:s,layout:a}}else{const{align:s,center:a,spacing:u,columns:c,...f}=o;return{facetMapping:zye(f,n.repeater),layout:{...s?{align:s}:{},...a?{center:a}:{},...u?{spacing:u}:{},...c?{columns:c}:{}}}}}mapLayer(t,{parentEncoding:n,parentProjection:r,...i}){const{encoding:o,projection:s,...a}=t,u={...i,parentEncoding:tO({parentEncoding:n,encoding:o,layer:!0}),parentProjection:nO({parentProjection:r,projection:s})};return super.mapLayer({...a,...t.name?{name:[u.repeaterPrefix,t.name].filter(c=>c).join("_")}:{}},u)}}function tO({parentEncoding:e,encoding:t={},layer:n}){let r={};if(e){const i=new Set([...oe(e),...oe(t)]);for(const o of i){const s=t[o],a=e[o];if(je(s)){const u={...a,...s};r[o]=u}else Bg(s)?r[o]={...s,condition:{...a,...s.condition}}:s||s===null?r[o]=s:(n||lo(a)||Fe(a)||je(a)||ne(a))&&(r[o]=a)}}else r=t;return!r||vt(r)?void 0:r}function nO(e){const{parentProjection:t,projection:n}=e;return t&&n&&ue(A0e({parentProjection:t,projection:n})),n??t}function a3(e){return se(e,"filter")}function Uye(e){return se(e,"stop")}function Bj(e){return se(e,"lookup")}function jye(e){return se(e,"data")}function Wye(e){return se(e,"param")}function qye(e){return se(e,"pivot")}function Hye(e){return se(e,"density")}function Gye(e){return se(e,"quantile")}function Vye(e){return se(e,"regression")}function Yye(e){return se(e,"loess")}function Xye(e){return se(e,"sample")}function Qye(e){return se(e,"window")}function Kye(e){return se(e,"joinaggregate")}function Jye(e){return se(e,"flatten")}function Zye(e){return se(e,"calculate")}function Uj(e){return se(e,"bin")}function eve(e){return se(e,"impute")}function tve(e){return se(e,"timeUnit")}function nve(e){return se(e,"aggregate")}function rve(e){return se(e,"stack")}function ive(e){return se(e,"fold")}function ove(e){return se(e,"extent")&&!se(e,"density")&&!se(e,"regression")}function sve(e){return e.map(t=>a3(t)?{filter:ff(t.filter,Mme)}:t)}class ave extends s3{map(t,n){return n.emptySelections??(n.emptySelections={}),n.selectionPredicates??(n.selectionPredicates={}),t=rO(t,n),super.map(t,n)}mapLayerOrUnit(t,n){if(t=rO(t,n),t.encoding){const r={};for(const[i,o]of uu(t.encoding))r[i]=jj(o,n);t={...t,encoding:r}}return super.mapLayerOrUnit(t,n)}mapUnit(t,n){const{selection:r,...i}=t;return r?{...i,params:uu(r).map(([o,s])=>{const{init:a,bind:u,empty:c,...f}=s;f.type==="single"?(f.type="point",f.toggle=!1):f.type==="multi"&&(f.type="point"),n.emptySelections[o]=c!=="none";for(const h of Rn(n.selectionPredicates[o]??{}))h.empty=c!=="none";return{name:o,value:a,select:f,bind:u}})}:t}}function rO(e,t){const{transform:n,...r}=e;if(n){const i=n.map(o=>{if(a3(o))return{filter:H_(o,t)};if(Uj(o)&&rc(o.bin))return{...o,bin:Wj(o.bin)};if(Bj(o)){const{selection:s,...a}=o.from;return s?{...o,from:{param:s,...a}}:o}return o});return{...r,transform:i}}return e}function jj(e,t){var r,i;const n=Ue(e);if(ce(n)&&rc(n.bin)&&(n.bin=Wj(n.bin)),ac(n)&&((i=(r=n.scale)==null?void 0:r.domain)!=null&&i.selection)){const{selection:o,...s}=n.scale.domain;n.scale.domain={...s,...o?{param:o}:{}}}if(Ig(n))if(ne(n.condition))n.condition=n.condition.map(o=>{const{selection:s,param:a,test:u,...c}=o;return a?o:{...c,test:H_(o,t)}});else{const{selection:o,param:s,test:a,...u}=jj(n.condition,t);n.condition=s?n.condition:{...u,test:H_(n.condition,t)}}return n}function Wj(e){const t=e.extent;if(t!=null&&t.selection){const{selection:n,...r}=t;return{...e,extent:{...r,param:n}}}return e}function H_(e,t){const n=r=>ff(r,i=>{var o;const s=t.emptySelections[i]??!0,a={param:i,empty:s};return(o=t.selectionPredicates)[i]??(o[i]=[]),t.selectionPredicates[i].push(a),a});return e.selection?n(e.selection):ff(e.test||e.filter,r=>r.selection?n(r.selection):r)}class G_ extends s3{map(t,n){const r=n.selections??[];if(t.params&&!sa(t)){const i=[];for(const o of t.params)r3(o)?r.push(o):i.push(o);t.params=i}return n.selections=r,super.map(t,n)}mapUnit(t,n){const r=n.selections;if(!r||!r.length)return t;const i=(n.path??[]).concat(t.name),o=[];for(const s of r)if(!s.views||!s.views.length)o.push(s);else for(const a of s.views)(ve(a)&&(a===t.name||i.includes(a))||ne(a)&&a.map(u=>i.indexOf(u)).every((u,c,f)=>u!==-1&&(c===0||u>f[c-1])))&&o.push(s);return o.length&&(t.params=o),t}}for(const e of["mapFacet","mapRepeat","mapHConcat","mapVConcat","mapLayer"]){const t=G_.prototype[e];G_.prototype[e]=function(n,r){return t.call(this,n,uve(n,r))}}function uve(e,t){return e.name?{...t,path:(t.path??[]).concat(e.name)}:t}function qj(e,t){t===void 0&&(t=Oj(e.config));const n=dve(e,t),{width:r,height:i}=e,o=hve(n,{width:r,height:i,autosize:e.autosize},t);return{...n,...o?{autosize:o}:{}}}const lve=new Bye,cve=new ave,fve=new G_;function dve(e,t={}){const n={config:t};return fve.map(lve.map(cve.map(e,n),n),n)}function iO(e){return ve(e)?{type:e}:e??{}}function hve(e,t,n){let{width:r,height:i}=t;const o=sa(e)||Px(e),s={};o?r=="container"&&i=="container"?(s.type="fit",s.contains="padding"):r=="container"?(s.type="fit-x",s.contains="padding"):i=="container"&&(s.type="fit-y",s.contains="padding"):(r=="container"&&(ue(F6("width")),r=void 0),i=="container"&&(ue(F6("height")),i=void 0));const a={type:"pad",...s,...n?iO(n.autosize):{},...iO(e.autosize)};if(a.type==="fit"&&!o&&(ue(o0e),a.type="pad"),r=="container"&&!(a.type=="fit"||a.type=="fit-x")&&ue(D6("width")),i=="container"&&!(a.type=="fit"||a.type=="fit-y")&&ue(D6("height")),!ti(a,{type:"pad"}))return a}function pve(e){return["fit","fit-x","fit-y"].includes(e)}function gve(e){return e?`fit-${vx(e)}`:"fit"}const mve=["background","padding"];function oO(e,t){const n={};for(const r of mve)e&&e[r]!==void 0&&(n[r]=Zr(e[r]));return t&&(n.params=e.params),n}class aa{constructor(t={},n={}){this.explicit=t,this.implicit=n}clone(){return new aa(Ue(this.explicit),Ue(this.implicit))}combine(){return{...this.explicit,...this.implicit}}get(t){return Yt(this.explicit[t],this.implicit[t])}getWithExplicit(t){return this.explicit[t]!==void 0?{explicit:!0,value:this.explicit[t]}:this.implicit[t]!==void 0?{explicit:!1,value:this.implicit[t]}:{explicit:!1,value:void 0}}setWithExplicit(t,{value:n,explicit:r}){n!==void 0&&this.set(t,n,r)}set(t,n,r){return delete this[r?"implicit":"explicit"][t],this[r?"explicit":"implicit"][t]=n,this}copyKeyFromSplit(t,{explicit:n,implicit:r}){n[t]!==void 0?this.set(t,n[t],!0):r[t]!==void 0&&this.set(t,r[t],!1)}copyKeyFromObject(t,n){n[t]!==void 0&&this.set(t,n[t],!0)}copyAll(t){for(const n of oe(t.combine())){const r=t.getWithExplicit(n);this.setWithExplicit(n,r)}}}function To(e){return{explicit:!0,value:e}}function Qr(e){return{explicit:!1,value:e}}function Hj(e){return(t,n,r,i)=>{const o=e(t.value,n.value);return o>0?t:o<0?n:Lx(t,n,r,i)}}function Lx(e,t,n,r){return e.explicit&&t.explicit&&ue(Y0e(n,r,e.value,t.value)),e}function fu(e,t,n,r,i=Lx){return e===void 0||e.value===void 0?t:e.explicit&&!t.explicit?e:t.explicit&&!e.explicit?t:ti(e.value,t.value)?e:i(e,t,n,r)}class yve extends aa{constructor(t={},n={},r=!1){super(t,n),this.explicit=t,this.implicit=n,this.parseNothing=r}clone(){const t=super.clone();return t.parseNothing=this.parseNothing,t}}function Hf(e){return se(e,"url")}function Vp(e){return se(e,"values")}function Gj(e){return se(e,"name")&&!Hf(e)&&!Vp(e)&&!Ka(e)}function Ka(e){return e&&(Vj(e)||Yj(e)||u3(e))}function Vj(e){return se(e,"sequence")}function Yj(e){return se(e,"sphere")}function u3(e){return se(e,"graticule")}var Lt;(function(e){e[e.Raw=0]="Raw",e[e.Main=1]="Main",e[e.Row=2]="Row",e[e.Column=3]="Column",e[e.Lookup=4]="Lookup",e[e.PreFilterInvalid=5]="PreFilterInvalid",e[e.PostFilterInvalid=6]="PostFilterInvalid"})(Lt||(Lt={}));function Xj({invalid:e,isPath:t}){switch(qU(e,{isPath:t})){case"filter":return{marks:"exclude-invalid-values",scales:"exclude-invalid-values"};case"break-paths-show-domains":return{marks:t?"include-invalid-values":"exclude-invalid-values",scales:"include-invalid-values"};case"break-paths-filter-domains":return{marks:t?"include-invalid-values":"exclude-invalid-values",scales:"exclude-invalid-values"};case"show":return{marks:"include-invalid-values",scales:"include-invalid-values"}}}function vve(e){const{marks:t,scales:n}=Xj(e);return t===n?Lt.Main:n==="include-invalid-values"?Lt.PreFilterInvalid:Lt.PostFilterInvalid}class mt{constructor(t,n){this.debugName=n,this._children=[],this._parent=null,t&&(this.parent=t)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(t){this._parent=t,t&&t.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(t,n){if(this._children.includes(t)){ue(b0e);return}n!==void 0?this._children.splice(n,0,t):this._children.push(t)}removeChild(t){const n=this._children.indexOf(t);return this._children.splice(n,1),n}remove(){let t=this._parent.removeChild(this);for(const n of this._children)n._parent=this._parent,this._parent.addChild(n,t++)}insertAsParentOf(t){const n=t.parent;n.removeChild(this),this.parent=n,t.parent=this}swapWithParent(){const t=this._parent,n=t.parent;for(const i of this._children)i.parent=t;this._children=[],t.removeChild(this);const r=t.parent.removeChild(t);this._parent=n,n.addChild(this,r),t.parent=this}}class Lr extends mt{clone(){const t=new this.constructor;return t.debugName=`clone_${this.debugName}`,t._source=this._source,t._name=`clone_${this._name}`,t.type=this.type,t.refCounts=this.refCounts,t.refCounts[t._name]=0,t}constructor(t,n,r,i){super(t,n),this.type=r,this.refCounts=i,this._source=this._name=n,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}dependentFields(){return new Set}producedFields(){return new Set}hash(){return this._hash===void 0&&(this._hash=`Output ${HB()}`),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(t){this._source=t}}function yb(e){return e.as!==void 0}function sO(e){return`${e}_end`}class jo extends mt{clone(){return new jo(null,Ue(this.timeUnits))}constructor(t,n){super(t),this.timeUnits=n}static makeFromEncoding(t,n){const r=n.reduceFieldDef((i,o,s)=>{const{field:a,timeUnit:u}=o;if(u){let c;if(sc(u)){if(Pt(n)){const{mark:f,markDef:h,config:p}=n,m=cu({fieldDef:o,markDef:h,config:p});(Gp(f)||m)&&(c={timeUnit:wn(u),field:a})}}else c={as:ge(o,{forAs:!0}),field:a,timeUnit:u};if(Pt(n)){const{mark:f,markDef:h,config:p}=n,m=cu({fieldDef:o,markDef:h,config:p});Gp(f)&&Xt(s)&&m!==.5&&(c.rectBandPosition=m)}c&&(i[Ke(c)]=c)}return i},{});return vt(r)?null:new jo(t,r)}static makeFromTransform(t,n){const{timeUnit:r,...i}={...n},o=wn(r),s={...i,timeUnit:o};return new jo(t,{[Ke(s)]:s})}merge(t){this.timeUnits={...this.timeUnits};for(const n in t.timeUnits)this.timeUnits[n]||(this.timeUnits[n]=t.timeUnits[n]);for(const n of t.children)t.removeChild(n),n.parent=this;t.remove()}removeFormulas(t){const n={};for(const[r,i]of uu(this.timeUnits)){const o=yb(i)?i.as:`${i.field}_end`;t.has(o)||(n[r]=i)}this.timeUnits=n}producedFields(){return new Set(Rn(this.timeUnits).map(t=>yb(t)?t.as:sO(t.field)))}dependentFields(){return new Set(Rn(this.timeUnits).map(t=>t.field))}hash(){return`TimeUnit ${Ke(this.timeUnits)}`}assemble(){const t=[];for(const n of Rn(this.timeUnits)){const{rectBandPosition:r}=n,i=wn(n.timeUnit);if(yb(n)){const{field:o,as:s}=n,{unit:a,utc:u,...c}=i,f=[s,`${s}_end`];t.push({field:Ti(o),type:"timeunit",...a?{units:bx(a)}:{},...u?{timezone:"utc"}:{},...c,as:f}),t.push(...aO(f,r,i))}else if(n){const{field:o}=n,s=o.replaceAll("\\.","."),a=Qj({timeUnit:i,field:s}),u=sO(s);t.push({type:"formula",expr:a,as:u}),t.push(...aO([s,u],r,i))}}return t}}const zx="offsetted_rect_start",Ix="offsetted_rect_end";function Qj({timeUnit:e,field:t,reverse:n}){const{unit:r,utc:i}=e,o=CU(r),{part:s,step:a}=DU(o,e.step);return`${i?"utcOffset":"timeOffset"}('${s}', ${ht(t)}, ${n?-a:a})`}function aO([e,t],n,r){if(n!==void 0&&n!==.5){const i=ht(e),o=ht(t);return[{type:"formula",expr:uO([Qj({timeUnit:r,field:e,reverse:!0}),i],n+.5),as:`${e}_${zx}`},{type:"formula",expr:uO([i,o],n+.5),as:`${e}_${Ix}`}]}return[]}function uO([e,t],n){return`${1-n} * ${e} + ${n} * ${t}`}const Wg="_tuple_fields";class xve{constructor(...t){this.items=t,this.hasChannel={},this.hasField={},this.hasSelectionId=!1}}const wve={defined:()=>!0,parse:(e,t,n)=>{const r=t.name,i=t.project??(t.project=new xve),o={},s={},a=new Set,u=(y,v)=>{const w=v==="visual"?y.channel:y.field;let E=Mt(`${r}_${w}`);for(let S=1;a.has(E);S++)E=Mt(`${r}_${w}_${S}`);return a.add(E),{[v]:E}},c=t.type,f=e.config.selection[c],h=n.value!==void 0?xe(n.value):null;let{fields:p,encodings:m}=ye(n.select)?n.select:{};if(!p&&!m&&h){for(const y of h)if(ye(y))for(const v of oe(y))Nge(v)?(m||(m=[])).push(v):c==="interval"?(ue(g0e),m=f.encodings):(p??(p=[])).push(v)}!p&&!m&&(m=f.encodings,"fields"in f&&(p=f.fields));for(const y of m??[]){const v=e.fieldDef(y);if(v){let w=v.field;if(v.aggregate){ue(s0e(y,v.aggregate));continue}else if(!w){ue(T6(y));continue}if(v.timeUnit&&!sc(v.timeUnit)){w=e.vgField(y);const E={timeUnit:v.timeUnit,as:w,field:v.field};s[Ke(E)]=E}if(!o[w]){const E=c==="interval"&&fs(y)&&uo(e.getScaleComponent(y).get("type"))?"R":v.bin?"R-RE":"E",S={field:w,channel:y,type:E,index:i.items.length};S.signals={...u(S,"data"),...u(S,"visual")},i.items.push(o[w]=S),i.hasField[w]=o[w],i.hasSelectionId=i.hasSelectionId||w===fo,KB(y)?(S.geoChannel=y,S.channel=QB(y),i.hasChannel[S.channel]=o[w]):i.hasChannel[y]=o[w]}}else ue(T6(y))}for(const y of p??[]){if(i.hasField[y])continue;const v={type:"E",field:y,index:i.items.length};v.signals={...u(v,"data")},i.items.push(v),i.hasField[y]=v,i.hasSelectionId=i.hasSelectionId||y===fo}h&&(t.init=h.map(y=>i.items.map(v=>ye(y)?y[v.geoChannel||v.channel]!==void 0?y[v.geoChannel||v.channel]:y[v.field]:y))),vt(s)||(i.timeUnit=new jo(null,s))},signals:(e,t,n)=>{const r=t.name+Wg;return n.filter(o=>o.name===r).length>0||t.project.hasSelectionId?n:n.concat({name:r,value:t.project.items.map(eW)})}},Kj="_curr",m1="anim_value",Kc="anim_clock",V_="eased_anim_clock",Jj="min_extent",Zj="max_range_extent",vb="last_tick_at",xb="is_playing",Eve=1/60*1e3,bve=(e,t)=>[{name:V_,update:Kc},{name:`${e}_domain`,init:`domain('${t}')`},{name:Jj,init:`extent(${e}_domain)[0]`},{name:Zj,init:`extent(range('${t}'))[1]`},{name:m1,update:`invert('${t}', ${V_})`}],Sve={defined:e=>e.type==="point",topLevelSignals:(e,t,n)=>(Wo(t)&&(n=n.concat([{name:Kc,init:"0",on:[{events:{type:"timer",throttle:Eve},update:`${xb} ? (${Kc} + (now() - ${vb}) > ${Zj} ? 0 : ${Kc} + (now() - ${vb})) : ${Kc}`}]},{name:vb,init:"now()",on:[{events:[{signal:Kc},{signal:xb}],update:"now()"}]},{name:xb,init:"true"}])),n),signals:(e,t,n)=>{const r=t.name,i=r+Wg,o=t.project,s="(item().isVoronoi ? datum.datum : datum)",a=Rn(e.component.selection??{}).reduce((f,h)=>h.type==="interval"?f.concat(h.name+pf):f,[]).map(f=>`indexof(item().mark.name, '${f}') < 0`).join(" && "),u=`datum && item().mark.marktype !== 'group' && indexof(item().mark.role, 'legend') < 0${a?` && ${a}`:""}`;let c=`unit: ${xl(e)}, `;if(t.project.hasSelectionId)c+=`${fo}: ${s}[${de(fo)}]`;else if(Wo(t))c+=`fields: ${i}, values: [${m1} ? ${m1} : ${Jj}]`;else{const f=o.items.map(h=>{const p=e.fieldDef(h.channel);return p!=null&&p.bin?`[${s}[${de(e.vgField(h.channel,{}))}], ${s}[${de(e.vgField(h.channel,{binSuffix:"end"}))}]]`:`${s}[${de(h.field)}]`}).join(", ");c+=`fields: ${i}, values: [${f}]`}if(Wo(t))return n.concat(bve(t.name,e.scaleName(Eu)),[{name:r+Js,on:[{events:[{signal:V_},{signal:m1}],update:`{${c}}`,force:!0}]}]);{const f=t.events;return n.concat([{name:r+Js,on:f?[{events:f,update:`${u} ? {${c}} : null`,force:!0}]:[]}])}}};function eW(e){const{signals:t,hasLegend:n,index:r,...i}=e;return i.field=Ti(i.field),i}function Ul(e,t=!0,n=tr){if(ne(e)){const r=e.map(i=>Ul(i,t,n));return t?`[${r.join(", ")}]`:r}else if(oc(e))return n(t?Ll(e):xme(e));return t?n(xt(e)):e}function _ve(e,t){for(const n of Rn(e.component.selection??{})){const r=n.name;let i=`${r}${Js}, ${n.resolve==="global"?"true":`{unit: ${xl(e)}}`}`;for(const o of Ux)o.defined(n)&&(o.signals&&(t=o.signals(e,n,t)),o.modifyExpr&&(i=o.modifyExpr(e,n,i)));t.push({name:r+Kve,on:[{events:{signal:n.name+Js},update:`modify(${de(n.name+jl)}, ${i})`}]})}return l3(t)}function Ave(e,t){if(e.component.selection&&oe(e.component.selection).length){const n=de(e.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:xu("pointermove","scope"),update:`isTuple(facet) ? facet : group(${n}).datum`}]})}return l3(t)}function Cve(e,t){let n=!1;for(const r of Rn(e.component.selection??{})){const i=r.name,o=de(i+jl);if(t.filter(a=>a.name===i).length===0){const a=r.resolve==="global"?"union":r.resolve,u=r.type==="point"?", true, true)":")";t.push({name:r.name,update:`${yW}(${o}, ${de(a)}${u}`})}n=!0;for(const a of Ux)a.defined(r)&&a.topLevelSignals&&(t=a.topLevelSignals(e,r,t))}return n&&t.filter(i=>i.name==="unit").length===0&&t.unshift({name:"unit",value:{},on:[{events:"pointermove",update:"isTuple(group()) ? group() : unit"}]}),l3(t)}function kve(e,t){const n=[],r=[],i=xl(e,{escape:!1});for(const o of Rn(e.component.selection??{})){const s={name:o.name+jl};if(o.project.hasSelectionId&&(s.transform=[{type:"collect",sort:{field:fo}}]),o.init){const u=o.project.items.map(eW);s.values=o.project.hasSelectionId?o.init.map(c=>({unit:i,[fo]:Ul(c,!1)[0]})):o.init.map(c=>({unit:i,fields:u,values:Ul(c,!1)}))}if([...n,...t].filter(u=>u.name===o.name+jl).length||n.push(s),Wo(o)&&t.length){const u=e.lookupDataSource(e.getDataName(Lt.Main)),c=t.find(h=>h.name===u),f=c.transform.find(h=>h.type==="filter"&&h.expr.includes("vlSelectionTest"));if(f){c.transform=c.transform.filter(p=>p!==f);const h={name:c.name+Kj,source:c.name,transform:[f]};r.push(h)}}}return n.concat(t,r)}function tW(e,t){for(const n of Rn(e.component.selection??{}))for(const r of Ux)r.defined(n)&&r.marks&&(t=r.marks(e,n,t));return t}function $ve(e,t){for(const n of e.children)Pt(n)&&(t=tW(n,t));return t}function Fve(e,t,n,r){const i=$W(e,t.param,t);return{signal:uo(n.get("type"))&&ne(r)&&r[0]>r[1]?`isValid(${i}) && reverse(${i})`:i}}function l3(e){return e.map(t=>(t.on&&!t.on.length&&delete t.on,t))}const Hs={defined:e=>e.type==="interval"&&e.resolve==="global"&&e.bind&&e.bind==="scales",parse:(e,t)=>{const n=t.scales=[];for(const r of t.project.items){const i=r.channel;if(!fs(i))continue;const o=e.getScaleComponent(i),s=o?o.get("type"):void 0;if(s=="sequential"&&ue(c0e),!o||!uo(s)){ue(l0e);continue}o.set("selectionExtent",{param:t.name,field:r.field},!0),n.push(r)}},topLevelSignals:(e,t,n)=>{const r=t.scales.filter(s=>n.filter(a=>a.name===s.signals.data).length===0);if(!e.parent||X_(e)||r.length===0)return n;const i=n.find(s=>s.name===t.name);let o=i.update;if(o.includes(yW))i.update=`{${r.map(s=>`${de(Ti(s.field))}: ${s.signals.data}`).join(", ")}}`;else{for(const s of r){const a=`${de(Ti(s.field))}: ${s.signals.data}`;o.includes(a)||(o=`${o.substring(0,o.length-1)}, ${a}}`)}i.update=o}return n.concat(r.map(s=>({name:s.signals.data})))},signals:(e,t,n)=>{if(e.parent&&!X_(e))for(const r of t.scales){const i=n.find(o=>o.name===r.signals.data);i.push="outer",delete i.value,delete i.update}return n}};function Y_(e,t){return`domain(${de(e.scaleName(t))})`}function X_(e){return e.parent&&bd(e.parent)&&(!e.parent.parent||X_(e.parent.parent))}const pf="_brush",nW="_scale_trigger",Dh="geo_interval_init_tick",rW="_init",Dve="_center",Mve={defined:e=>e.type==="interval",parse:(e,t,n)=>{var r;if(e.hasProjection){const i={...ye(n.select)?n.select:{}};i.fields=[fo],i.encodings||(i.encodings=n.value?oe(n.value):[xo,vo]),n.select={type:"interval",...i}}if(t.translate&&!Hs.defined(t)){const i=`!event.item || event.item.mark.name !== ${de(t.name+pf)}`;for(const o of t.events){if(!o.between){ue(`${o} is not an ordered event stream for interval selections.`);continue}const s=xe((r=o.between[0]).filter??(r.filter=[]));s.includes(i)||s.push(i)}}},signals:(e,t,n)=>{const r=t.name,i=r+Js,o=Rn(t.project.hasChannel).filter(a=>a.channel===Tt||a.channel===Sn),s=t.init?t.init[0]:null;if(n.push(...o.reduce((a,u)=>a.concat(Tve(e,t,u,s&&s[u.index])),[])),e.hasProjection){const a=de(e.projectionName()),u=e.projectionName()+Dve,{x:c,y:f}=t.project.hasChannel,h=c&&c.signals.visual,p=f&&f.signals.visual,m=c?s&&s[c.index]:`${u}[0]`,y=f?s&&s[f.index]:`${u}[1]`,v=k=>e.getSizeSignalRef(k).signal,w=`[[${h?h+"[0]":"0"}, ${p?p+"[0]":"0"}],[${h?h+"[1]":v("width")}, ${p?p+"[1]":v("height")}]]`;s&&(n.unshift({name:r+rW,init:`[scale(${a}, [${c?m[0]:m}, ${f?y[0]:y}]), scale(${a}, [${c?m[1]:m}, ${f?y[1]:y}])]`}),(!c||!f)&&(n.find(D=>D.name===u)||n.unshift({name:u,update:`invert(${a}, [${v("width")}/2, ${v("height")}/2])`})));const E=`intersect(${w}, {markname: ${de(e.getName("marks"))}}, unit.mark)`,S=`{unit: ${xl(e)}}`,A=`vlSelectionTuples(${E}, ${S})`,C=o.map(k=>k.signals.visual);return n.concat({name:i,on:[{events:[...C.length?[{signal:C.join(" || ")}]:[],...s?[{signal:Dh}]:[]],update:A}]})}else{if(!Hs.defined(t)){const c=r+nW,f=o.map(h=>{const p=h.channel,{data:m,visual:y}=h.signals,v=de(e.scaleName(p)),w=e.getScaleComponent(p).get("type"),E=uo(w)?"+":"";return`(!isArray(${m}) || (${E}invert(${v}, ${y})[0] === ${E}${m}[0] && ${E}invert(${v}, ${y})[1] === ${E}${m}[1]))`});f.length&&n.push({name:c,value:{},on:[{events:o.map(h=>({scale:e.scaleName(h.channel)})),update:f.join(" && ")+` ? ${c} : {}`}]})}const a=o.map(c=>c.signals.data),u=`unit: ${xl(e)}, fields: ${r+Wg}, values`;return n.concat({name:i,...s?{init:`{${u}: ${Ul(s)}}`}:{},...a.length?{on:[{events:[{signal:a.join(" || ")}],update:`${a.join(" && ")} ? {${u}: [${a}]} : null`}]}:{}})}},topLevelSignals:(e,t,n)=>(Pt(e)&&e.hasProjection&&t.init&&(n.filter(i=>i.name===Dh).length||n.unshift({name:Dh,value:null,on:[{events:"timer{1}",update:`${Dh} === null ? {} : ${Dh}`}]})),n),marks:(e,t,n)=>{const r=t.name,{x:i,y:o}=t.project.hasChannel,s=i==null?void 0:i.signals.visual,a=o==null?void 0:o.signals.visual,u=`data(${de(t.name+jl)})`;if(Hs.defined(t)||!i&&!o)return n;const c={x:i!==void 0?{signal:`${s}[0]`}:{value:0},y:o!==void 0?{signal:`${a}[0]`}:{value:0},x2:i!==void 0?{signal:`${s}[1]`}:{field:{group:"width"}},y2:o!==void 0?{signal:`${a}[1]`}:{field:{group:"height"}}};if(t.resolve==="global")for(const w of oe(c))c[w]=[{test:`${u}.length && ${u}[0].unit === ${xl(e)}`,...c[w]},{value:0}];const{fill:f,fillOpacity:h,cursor:p,...m}=t.mark,y=oe(m).reduce((w,E)=>(w[E]=[{test:[i!==void 0&&`${s}[0] !== ${s}[1]`,o!==void 0&&`${a}[0] !== ${a}[1]`].filter(S=>S).join(" && "),value:m[E]},{value:null}],w),{}),v=p??(t.translate?"move":null);return[{name:`${r+pf}_bg`,type:"rect",clip:!0,encode:{enter:{fill:{value:f},fillOpacity:{value:h}},update:c}},...n,{name:r+pf,type:"rect",clip:!0,encode:{enter:{...v?{cursor:{value:v}}:{},fill:{value:"transparent"}},update:{...c,...y}}}]}};function Tve(e,t,n,r){const i=!e.hasProjection,o=n.channel,s=n.signals.visual,a=de(i?e.scaleName(o):e.projectionName()),u=p=>`scale(${a}, ${p})`,c=e.getSizeSignalRef(o===Tt?"width":"height").signal,f=`${o}(unit)`,h=t.events.reduce((p,m)=>[...p,{events:m.between[0],update:`[${f}, ${f}]`},{events:m,update:`[${s}[0], clamp(${f}, 0, ${c})]`}],[]);if(i){const p=n.signals.data,m=Hs.defined(t),y=e.getScaleComponent(o),v=y?y.get("type"):void 0,w=r?{init:Ul(r,!0,u)}:{value:[]};return h.push({events:{signal:t.name+nW},update:uo(v)?`[${u(`${p}[0]`)}, ${u(`${p}[1]`)}]`:"[0, 0]"}),m?[{name:p,on:[]}]:[{name:s,...w,on:h},{name:p,...r?{init:Ul(r)}:{},on:[{events:{signal:s},update:`${s}[0] === ${s}[1] ? null : invert(${a}, ${s})`}]}]}else{const p=o===Tt?0:1,m=t.name+rW,y=r?{init:`[${m}[0][${p}], ${m}[1][${p}]]`}:{value:[]};return[{name:s,...y,on:h}]}}function vd({model:e,channelDef:t,vgChannel:n,invalidValueRef:r,mainRefFn:i}){const o=Ig(t)&&t.condition;let s=[];o&&(s=xe(o).map(c=>{const f=i(c);if(x1e(c)){const{param:h,empty:p}=c;return{test:kW(e,{param:h,empty:p}),...f}}else return{test:Vy(e,c.test),...f}})),r!==void 0&&s.push(r);const a=i(t);return a!==void 0&&s.push(a),s.length>1||s.length===1&&s[0].test?{[n]:s}:s.length===1?{[n]:s[0]}:{}}function c3(e,t="text"){const n=e.encoding[t];return vd({model:e,channelDef:n,vgChannel:t,mainRefFn:r=>Bx(r,e.config),invalidValueRef:void 0})}function Bx(e,t,n="datum"){if(e){if(lo(e))return kt(e.value);if(je(e)){const{format:r,formatType:i}=By(e);return qF({fieldOrDatumDef:e,format:r,formatType:i,expr:n,config:t})}}}function iW(e,t={}){const{encoding:n,markDef:r,config:i,stack:o}=e,s=n.tooltip;if(ne(s))return{tooltip:lO({tooltip:s},o,i,t)};{const a=t.reactiveGeom?"datum.datum":"datum";return vd({model:e,channelDef:s,vgChannel:"tooltip",mainRefFn:c=>{const f=Bx(c,i,a);if(f)return f;if(c===null)return;let h=yt("tooltip",r,i);if(h===!0&&(h={content:"encoding"}),ve(h))return{value:h};if(ye(h))return Fe(h)?h:h.content==="encoding"?lO(n,o,i,t):{signal:a}},invalidValueRef:void 0})}}function oW(e,t,n,{reactiveGeom:r}={}){const i={...n,...n.tooltipFormat},o=new Set,s=r?"datum.datum":"datum",a=[];function u(f,h){const p=nc(h),m=xr(f)?f:{...f,type:e[p].type},y=m.title||YF(m,i),v=xe(y).join(", ").replaceAll(/"/g,'\\"');let w;if(Xt(h)){const E=h==="x"?"x2":"y2",S=co(e[E]);if(Cn(m.bin)&&S){const A=ge(m,{expr:s}),C=ge(S,{expr:s}),{format:k,formatType:D}=By(m);w=Lg(A,C,k,D,i),o.add(E)}}if((Xt(h)||h===Oi||h===yo)&&t&&t.fieldChannel===h&&t.offset==="normalize"){const{format:E,formatType:S}=By(m);w=qF({fieldOrDatumDef:m,format:E,formatType:S,expr:s,config:i,normalizeStack:!0}).signal}w??(w=Bx(m,i,s).signal),a.push({channel:h,key:v,value:w})}QF(e,(f,h)=>{ce(f)?u(f,h):Dx(f)&&u(f.condition,h)});const c={};for(const{channel:f,key:h,value:p}of a)!o.has(f)&&!c[h]&&(c[h]=p);return c}function lO(e,t,n,{reactiveGeom:r}={}){const i=oW(e,t,n,{reactiveGeom:r}),o=uu(i).map(([s,a])=>`"${s}": ${a}`);return o.length>0?{signal:`{${o.join(", ")}}`}:void 0}function Nve(e){const{markDef:t,config:n}=e,r=yt("aria",t,n);return r===!1?{}:{...r?{aria:r}:{},...Rve(e),...Ove(e)}}function Rve(e){const{mark:t,markDef:n,config:r}=e;if(r.aria===!1)return{};const i=yt("ariaRoleDescription",n,r);return i!=null?{ariaRoleDescription:{value:i}}:Ee(n0e,t)?{}:{ariaRoleDescription:{value:t}}}function Ove(e){const{encoding:t,markDef:n,config:r,stack:i}=e,o=t.description;if(o)return vd({model:e,channelDef:o,vgChannel:"description",mainRefFn:u=>Bx(u,e.config),invalidValueRef:void 0});const s=yt("description",n,r);if(s!=null)return{description:kt(s)};if(r.aria===!1)return{};const a=oW(t,i,r);if(!vt(a))return{description:{signal:uu(a).map(([u,c],f)=>`"${f>0?"; ":""}${u}: " + (${c})`).join(" + ")}}}function Fn(e,t,n={}){const{markDef:r,encoding:i,config:o}=t,{vgChannel:s}=n;let{defaultRef:a,defaultValue:u}=n;const c=i[e];a===void 0&&(u??(u=yt(e,r,o,{vgChannel:s,ignoreVgConfig:!Ig(c)})),u!==void 0&&(a=kt(u)));const f={markDef:r,config:o,scaleName:t.scaleName(e),scale:t.getScaleComponent(e)},h=GU({...f,scaleChannel:e,channelDef:c});return vd({model:t,channelDef:c,vgChannel:s??e,invalidValueRef:h,mainRefFn:m=>WF({...f,channel:e,channelDef:m,stack:null,defaultRef:a})})}function sW(e,t={filled:void 0}){const{markDef:n,encoding:r,config:i}=e,{type:o}=n,s=t.filled??yt("filled",n,i),a=Qe(["bar","point","circle","square","geoshape"],o)?"transparent":void 0,u=yt(s===!0?"color":void 0,n,i,{vgChannel:"fill"})??i.mark[s===!0&&"color"]??a,c=yt(s===!1?"color":void 0,n,i,{vgChannel:"stroke"})??i.mark[s===!1&&"color"],f=s?"fill":"stroke",h={...u?{fill:kt(u)}:{},...c?{stroke:kt(c)}:{}};return n.color&&(s?n.fill:n.stroke)&&ue(yU("property",{fill:"fill"in n,stroke:"stroke"in n})),{...h,...Fn("color",e,{vgChannel:f,defaultValue:s?u:c}),...Fn("fill",e,{defaultValue:r.fill?u:void 0}),...Fn("stroke",e,{defaultValue:r.stroke?c:void 0})}}function Pve(e){const{encoding:t,mark:n}=e,r=t.order;return!ku(n)&&lo(r)?vd({model:e,channelDef:r,vgChannel:"zindex",mainRefFn:i=>kt(i.value),invalidValueRef:void 0}):{}}function Gf({channel:e,markDef:t,encoding:n={},model:r,bandPosition:i}){const o=`${e}Offset`,s=t[o],a=n[o];if((o==="xOffset"||o==="yOffset")&&a)return{offsetType:"encoding",offset:WF({channel:o,channelDef:a,markDef:t,config:r==null?void 0:r.config,scaleName:r.scaleName(o),scale:r.getScaleComponent(o),stack:null,defaultRef:kt(s),bandPosition:i})};const u=t[o];return u?{offsetType:"visual",offset:u}:{}}function pr(e,t,{defaultPos:n,vgChannel:r}){const{encoding:i,markDef:o,config:s,stack:a}=t,u=i[e],c=i[cs(e)],f=t.scaleName(e),h=t.getScaleComponent(e),{offset:p,offsetType:m}=Gf({channel:e,markDef:o,encoding:i,model:t,bandPosition:.5}),y=f3({model:t,defaultPos:n,channel:e,scaleName:f,scale:h}),v=!u&&Xt(e)&&(i.latitude||i.longitude)?{field:t.getName(e)}:Lve({channel:e,channelDef:u,channel2Def:c,markDef:o,config:s,scaleName:f,scale:h,stack:a,offset:p,defaultRef:y,bandPosition:m==="encoding"?0:void 0});return v?{[r||e]:v}:void 0}function Lve(e){const{channel:t,channelDef:n,scaleName:r,stack:i,offset:o,markDef:s}=e;if(je(n)&&i&&t===i.fieldChannel){if(ce(n)){let a=n.bandPosition;if(a===void 0&&s.type==="text"&&(t==="radius"||t==="theta")&&(a=.5),a!==void 0)return Ly({scaleName:r,fieldOrDatumDef:n,startSuffix:"start",bandPosition:a,offset:o})}return yl(n,r,{suffix:"end"},{offset:o})}return jF(e)}function f3({model:e,defaultPos:t,channel:n,scaleName:r,scale:i}){const{markDef:o,config:s}=e;return()=>{const a=nc(n),u=lu(n),c=yt(n,o,s,{vgChannel:u});if(c!==void 0)return vp(n,c);switch(t){case"zeroOrMin":return cO({scaleName:r,scale:i,mode:"zeroOrMin",mainChannel:a,config:s});case"zeroOrMax":return cO({scaleName:r,scale:i,mode:{zeroOrMax:{widthSignal:e.width.signal,heightSignal:e.height.signal}},mainChannel:a,config:s});case"mid":return{...e[Wr(n)],mult:.5}}}}function cO({mainChannel:e,config:t,...n}){const r=HU(n),{mode:i}=n;if(r)return r;switch(e){case"radius":{if(i==="zeroOrMin")return{value:0};const{widthSignal:o,heightSignal:s}=i.zeroOrMax;return{signal:`min(${o},${s})/2`}}case"theta":return i==="zeroOrMin"?{value:0}:{signal:"2*PI"};case"x":return i==="zeroOrMin"?{value:0}:{field:{group:"width"}};case"y":return i==="zeroOrMin"?{field:{group:"height"}}:{value:0}}}const zve={left:"x",center:"xc",right:"x2"},Ive={top:"y",middle:"yc",bottom:"y2"};function aW(e,t,n,r="middle"){if(e==="radius"||e==="theta")return lu(e);const i=e==="x"?"align":"baseline",o=yt(i,t,n);let s;return Fe(o)?(ue(L0e(i)),s=void 0):s=o,e==="x"?zve[s||(r==="top"?"left":"center")]:Ive[s||r]}function qy(e,t,{defaultPos:n,defaultPos2:r,range:i}){return i?uW(e,t,{defaultPos:n,defaultPos2:r}):pr(e,t,{defaultPos:n})}function uW(e,t,{defaultPos:n,defaultPos2:r}){const{markDef:i,config:o}=t,s=cs(e),a=Wr(e),u=Bve(t,r,s),c=u[a]?aW(e,i,o):lu(e);return{...pr(e,t,{defaultPos:n,vgChannel:c}),...u}}function Bve(e,t,n){const{encoding:r,mark:i,markDef:o,stack:s,config:a}=e,u=nc(n),c=Wr(n),f=lu(n),h=r[u],p=e.scaleName(u),m=e.getScaleComponent(u),{offset:y}=n in r||n in o?Gf({channel:n,markDef:o,encoding:r,model:e}):Gf({channel:u,markDef:o,encoding:r,model:e});if(!h&&(n==="x2"||n==="y2")&&(r.latitude||r.longitude)){const w=Wr(n),E=e.markDef[w];return E!=null?{[w]:{value:E}}:{[f]:{field:e.getName(n)}}}const v=Uve({channel:n,channelDef:h,channel2Def:r[n],markDef:o,config:a,scaleName:p,scale:m,stack:s,offset:y,defaultRef:void 0});return v!==void 0?{[f]:v}:Rm(n,o)||Rm(n,{[n]:P_(n,o,a.style),[c]:P_(c,o,a.style)})||Rm(n,a[i])||Rm(n,a.mark)||{[f]:f3({model:e,defaultPos:t,channel:n,scaleName:p,scale:m})()}}function Uve({channel:e,channelDef:t,channel2Def:n,markDef:r,config:i,scaleName:o,scale:s,stack:a,offset:u,defaultRef:c}){return je(t)&&a&&e.charAt(0)===a.fieldChannel.charAt(0)?yl(t,o,{suffix:"start"},{offset:u}):jF({channel:e,channelDef:n,scaleName:o,scale:s,stack:a,markDef:r,config:i,offset:u,defaultRef:c})}function Rm(e,t){const n=Wr(e),r=lu(e);if(t[r]!==void 0)return{[r]:vp(e,t[r])};if(t[e]!==void 0)return{[r]:vp(e,t[e])};if(t[n]){const i=t[n];if(Il(i))ue(M0e(n));else return{[n]:vp(e,i)}}}function Ks(e,t){const{config:n,encoding:r,markDef:i}=e,o=i.type,s=cs(t),a=Wr(t),u=r[t],c=r[s],f=e.getScaleComponent(t),h=f?f.get("type"):void 0,p=i.orient,m=r[a]??r.size??yt("size",i,n,{vgChannel:a}),y=tU(t),v=o==="bar"&&(t==="x"?p==="vertical":p==="horizontal")||o==="tick"&&(t==="y"?p==="vertical":p==="horizontal");return ce(u)&&(St(u.bin)||Cn(u.bin)||u.timeUnit&&!c)&&!(m&&!Il(m))&&!r[y]&&!En(h)?qve({fieldDef:u,fieldDef2:c,channel:t,model:e}):(je(u)&&En(h)||v)&&!c?Wve(u,t,e):uW(t,e,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"})}function jve(e,t,n,r,i,o,s){if(Il(i))if(n){const u=n.get("type");if(u==="band"){let c=`bandwidth('${t}')`;i.band!==1&&(c=`${i.band} * ${c}`);const f=Ko("minBandSize",{type:s},r);return{signal:f?`max(${to(f)}, ${c})`:c}}else i.band!==1&&(ue(U0e(u)),i=void 0)}else return{mult:i.band,field:{group:e}};else{if(Fe(i))return i;if(i)return{value:i}}if(n){const u=n.get("range");if(ic(u)&&at(u.step))return{value:u.step-2}}if(!o){const{bandPaddingInner:u,barBandPaddingInner:c,rectBandPaddingInner:f,tickBandPaddingInner:h}=r.scale,p=Yt(u,s==="tick"?h:s==="bar"?c:f);if(Fe(p))return{signal:`(1 - (${p.signal})) * ${e}`};if(at(p))return{signal:`${1-p} * ${e}`}}return{value:W_(r.view,e)-2}}function Wve(e,t,n){var T,L;const{markDef:r,encoding:i,config:o,stack:s}=n,a=r.orient,u=n.scaleName(t),c=n.getScaleComponent(t),f=Wr(t),h=cs(t),p=tU(t),m=n.scaleName(p),y=n.getScaleComponent(gF(t)),v=r.type==="tick"||a==="horizontal"&&t==="y"||a==="vertical"&&t==="x";let w;(i.size||r.size)&&(v?w=Fn("size",n,{vgChannel:f,defaultRef:kt(r.size)}):ue(H0e(r.type)));const E=!!w,S=ZU({channel:t,fieldDef:e,markDef:r,config:o,scaleType:(T=c||y)==null?void 0:T.get("type"),useVlSizeChannel:v});w=w||{[f]:jve(f,m||u,y||c,o,S,!!e,r.type)};const A=((L=c||y)==null?void 0:L.get("type"))==="band"&&Il(S)&&!E?"top":"middle",C=aW(t,r,o,A),k=C==="xc"||C==="yc",{offset:D,offsetType:$}=Gf({channel:t,markDef:r,encoding:i,model:n,bandPosition:k?.5:0}),M=jF({channel:t,channelDef:e,markDef:r,config:o,scaleName:u,scale:c,stack:s,offset:D,defaultRef:f3({model:n,defaultPos:"mid",channel:t,scaleName:u,scale:c}),bandPosition:k?$==="encoding"?0:.5:Fe(S)?{signal:`(1-${S})/2`}:Il(S)?(1-S.band)/2:0});if(f)return{[C]:M,...w};{const O=lu(h),X=w[f],W=D?{...X,offset:D}:X;return{[C]:M,[O]:ne(M)?[M[0],{...M[1],offset:W}]:{...M,offset:W}}}}function fO(e,t,n,r,i,o,s){if(XB(e))return 0;const a=e==="x"||e==="y2",u=a?-t/2:t/2;if(Fe(n)||Fe(i)||Fe(r)||o){const c=to(n),f=to(i),h=to(r),p=to(o),y=o?`(${s} < ${p} ? ${a?"":"-"}0.5 * (${p} - (${s})) : ${u})`:u,v=h?`${h} + `:"",w=c?`(${c} ? -1 : 1) * `:"",E=f?`(${f} + ${y})`:y;return{signal:v+w+E}}else return i=i||0,r+(n?-i-u:+i+u)}function qve({fieldDef:e,fieldDef2:t,channel:n,model:r}){var L;const{config:i,markDef:o,encoding:s}=r,a=r.getScaleComponent(n),u=r.scaleName(n),c=a?a.get("type"):void 0,f=a.get("reverse"),h=ZU({channel:n,fieldDef:e,markDef:o,config:i,scaleType:c}),p=(L=r.component.axes[n])==null?void 0:L[0],m=(p==null?void 0:p.get("translate"))??.5,y=Xt(n)?yt("binSpacing",o,i)??0:0,v=cs(n),w=lu(n),E=lu(v),S=Ko("minBandSize",o,i),{offset:A}=Gf({channel:n,markDef:o,encoding:s,model:r,bandPosition:0}),{offset:C}=Gf({channel:v,markDef:o,encoding:s,model:r,bandPosition:0}),k=h1e({fieldDef:e,scaleName:u}),D=fO(n,y,f,m,A,S,k),$=fO(v,y,f,m,C??A,S,k),M=Fe(h)?{signal:`(1-${h.signal})/2`}:Il(h)?(1-h.band)/2:.5,T=cu({fieldDef:e,fieldDef2:t,markDef:o,config:i});if(St(e.bin)||e.timeUnit){const O=e.timeUnit&&T!==.5;return{[E]:dO({fieldDef:e,scaleName:u,bandPosition:M,offset:$,useRectOffsetField:O}),[w]:dO({fieldDef:e,scaleName:u,bandPosition:Fe(M)?{signal:`1-${M.signal}`}:1-M,offset:D,useRectOffsetField:O})}}else if(Cn(e.bin)){const O=yl(e,u,{},{offset:$});if(ce(t))return{[E]:O,[w]:yl(t,u,{},{offset:D})};if(rc(e.bin)&&e.bin.step)return{[E]:O,[w]:{signal:`scale("${u}", ${ge(e,{expr:"datum"})} + ${e.bin.step})`,offset:D}}}ue(wU(v))}function dO({fieldDef:e,scaleName:t,bandPosition:n,offset:r,useRectOffsetField:i}){return Ly({scaleName:t,fieldOrDatumDef:e,bandPosition:n,offset:r,...i?{startSuffix:zx,endSuffix:Ix}:{}})}const Hve=new Set(["aria","width","height"]);function Pi(e,t){const{fill:n=void 0,stroke:r=void 0}=t.color==="include"?sW(e):{};return{...Gve(e.markDef,t),...hO("fill",n),...hO("stroke",r),...Fn("opacity",e),...Fn("fillOpacity",e),...Fn("strokeOpacity",e),...Fn("strokeWidth",e),...Fn("strokeDash",e),...Pve(e),...iW(e),...c3(e,"href"),...Nve(e)}}function hO(e,t){return t?{[e]:t}:{}}function Gve(e,t){return t0e.reduce((n,r)=>(!Hve.has(r)&&se(e,r)&&t[r]!=="ignore"&&(n[r]=kt(e[r])),n),{})}function d3(e){const{config:t,markDef:n}=e,r=new Set;if(e.forEachFieldDef((i,o)=>{var c;let s;if(!fs(o)||!(s=e.getScaleType(o)))return;const a=xx(i.aggregate),u=UF({scaleChannel:o,markDef:n,config:t,scaleType:s,isCountAggregate:a});if(c1e(u)){const f=e.vgField(o,{expr:"datum",binSuffix:(c=e.stack)!=null&&c.impute?"mid":void 0});f&&r.add(f)}}),r.size>0)return{defined:{signal:[...r].map(o=>Sx(o,!0)).join(" && ")}}}function pO(e,t){if(t!==void 0)return{[e]:kt(t)}}const wb="voronoi",lW={defined:e=>e.type==="point"&&e.nearest,parse:(e,t)=>{if(t.events)for(const n of t.events)n.markname=e.getName(wb)},marks:(e,t,n)=>{const{x:r,y:i}=t.project.hasChannel,o=e.mark;if(ku(o))return ue(a0e(o)),n;const s={name:e.getName(wb),type:"path",interactive:!0,from:{data:e.getName("marks")},encode:{update:{fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0},...iW(e,{reactiveGeom:!0})}},transform:[{type:"voronoi",x:{expr:r||!i?"datum.datum.x || 0":"0"},y:{expr:i||!r?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]};let a=0,u=!1;return n.forEach((c,f)=>{const h=c.name??"";h===e.component.mark[0].name?a=f:h.includes(wb)&&(u=!0)}),u||n.splice(a+1,0,s),n}},cW={defined:e=>e.type==="point"&&e.resolve==="global"&&e.bind&&e.bind!=="scales"&&!n3(e.bind),parse:(e,t,n)=>vW(t,n),topLevelSignals:(e,t,n)=>{const r=t.name,i=t.project,o=t.bind,s=t.init&&t.init[0],a=lW.defined(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";return i.items.forEach((u,c)=>{const f=Mt(`${r}_${u.field}`);n.filter(p=>p.name===f).length||n.unshift({name:f,...s?{init:Ul(s[c])}:{value:null},on:t.events?[{events:t.events,update:`datum && item().mark.marktype !== 'group' ? ${a}[${de(u.field)}] : null`}]:[],bind:o[u.field]??o[u.channel]??o})}),n},signals:(e,t,n)=>{const r=t.name,i=t.project,o=n.find(c=>c.name===r+Js),s=r+Wg,a=i.items.map(c=>Mt(`${r}_${c.field}`)),u=a.map(c=>`${c} !== null`).join(" && ");return a.length&&(o.update=`${u} ? {fields: ${s}, values: [${a.join(", ")}]} : null`),delete o.value,delete o.on,n}},Hy="_toggle",fW={defined:e=>e.type==="point"&&!Wo(e)&&!!e.toggle,signals:(e,t,n)=>n.concat({name:t.name+Hy,value:!1,on:[{events:t.events,update:t.toggle}]}),modifyExpr:(e,t)=>{const n=t.name+Js,r=t.name+Hy;return`${r} ? null : ${n}, `+(t.resolve==="global"?`${r} ? null : true, `:`${r} ? null : {unit: ${xl(e)}}, `)+`${r} ? ${n} : null`}},Vve={defined:e=>e.clear!==void 0&&e.clear!==!1&&!Wo(e),parse:(e,t)=>{t.clear&&(t.clear=ve(t.clear)?xu(t.clear,"view"):t.clear)},topLevelSignals:(e,t,n)=>{if(cW.defined(t))for(const r of t.project.items){const i=n.findIndex(o=>o.name===Mt(`${t.name}_${r.field}`));i!==-1&&n[i].on.push({events:t.clear,update:"null"})}return n},signals:(e,t,n)=>{function r(i,o){i!==-1&&n[i].on&&n[i].on.push({events:t.clear,update:o})}if(t.type==="interval")for(const i of t.project.items){const o=n.findIndex(s=>s.name===i.signals.visual);if(r(o,"[0, 0]"),o===-1){const s=n.findIndex(a=>a.name===i.signals.data);r(s,"null")}}else{let i=n.findIndex(o=>o.name===t.name+Js);r(i,"null"),fW.defined(t)&&(i=n.findIndex(o=>o.name===t.name+Hy),r(i,"false"))}return n}},dW={defined:e=>{const t=e.resolve==="global"&&e.bind&&n3(e.bind),n=e.project.items.length===1&&e.project.items[0].field!==fo;return t&&!n&&ue(f0e),t&&n},parse:(e,t,n)=>{const r=Ue(n);if(r.select=ve(r.select)?{type:r.select,toggle:t.toggle}:{...r.select,toggle:t.toggle},vW(t,r),ye(n.select)&&(n.select.on||n.select.clear)){const s='event.item && indexof(event.item.mark.role, "legend") < 0';for(const a of t.events)a.filter=xe(a.filter??[]),a.filter.includes(s)||a.filter.push(s)}const i=pb(t.bind)?t.bind.legend:"click",o=ve(i)?xu(i,"view"):xe(i);t.bind={legend:{merge:o}}},topLevelSignals:(e,t,n)=>{const r=t.name,i=pb(t.bind)&&t.bind.legend,o=s=>a=>{const u=Ue(a);return u.markname=s,u};for(const s of t.project.items){if(!s.hasLegend)continue;const a=`${Mt(s.field)}_legend`,u=`${r}_${a}`;if(n.filter(f=>f.name===u).length===0){const f=i.merge.map(o(`${a}_symbols`)).concat(i.merge.map(o(`${a}_labels`))).concat(i.merge.map(o(`${a}_entries`)));n.unshift({name:u,...t.init?{}:{value:null},on:[{events:f,update:"isDefined(datum.value) ? datum.value : item().items[0].items[0].datum.value",force:!0},{events:i.merge,update:`!event.item || !datum ? null : ${u}`,force:!0}]})}}return n},signals:(e,t,n)=>{const r=t.name,i=t.project,o=n.find(p=>p.name===r+Js),s=r+Wg,a=i.items.filter(p=>p.hasLegend).map(p=>Mt(`${r}_${Mt(p.field)}_legend`)),c=`${a.map(p=>`${p} !== null`).join(" && ")} ? {fields: ${s}, values: [${a.join(", ")}]} : null`;t.events&&a.length>0?o.on.push({events:a.map(p=>({signal:p})),update:c}):a.length>0&&(o.update=c,delete o.value,delete o.on);const f=n.find(p=>p.name===r+Hy),h=pb(t.bind)&&t.bind.legend;return f&&(t.events?f.on.push({...f.on[0],events:h}):f.on[0].events=h),n}};function Yve(e,t,n){var i;const r=(i=e.fieldDef(t))==null?void 0:i.field;for(const o of Rn(e.component.selection??{})){const s=o.project.hasField[r]??o.project.hasChannel[t];if(s&&dW.defined(o)){const a=n.get("selections")??[];a.push(o.name),n.set("selections",a,!1),s.hasLegend=!0}}}const hW="_translate_anchor",pW="_translate_delta",Xve={defined:e=>e.type==="interval"&&e.translate,signals:(e,t,n)=>{const r=t.name,i=Hs.defined(t),o=r+hW,{x:s,y:a}=t.project.hasChannel;let u=xu(t.translate,"scope");return i||(u=u.map(c=>(c.between[0].markname=r+pf,c))),n.push({name:o,value:{},on:[{events:u.map(c=>c.between[0]),update:"{x: x(unit), y: y(unit)"+(s!==void 0?`, extent_x: ${i?Y_(e,Tt):`slice(${s.signals.visual})`}`:"")+(a!==void 0?`, extent_y: ${i?Y_(e,Sn):`slice(${a.signals.visual})`}`:"")+"}"}]},{name:r+pW,value:{},on:[{events:u,update:`{x: ${o}.x - x(unit), y: ${o}.y - y(unit)}`}]}),s!==void 0&&gO(e,t,s,"width",n),a!==void 0&&gO(e,t,a,"height",n),n}};function gO(e,t,n,r,i){const o=t.name,s=o+hW,a=o+pW,u=n.channel,c=Hs.defined(t),f=i.find(k=>k.name===n.signals[c?"data":"visual"]),h=e.getSizeSignalRef(r).signal,p=e.getScaleComponent(u),m=p&&p.get("type"),y=p&&p.get("reverse"),v=c?u===Tt?y?"":"-":y?"-":"":"",w=`${s}.extent_${u}`,E=`${v}${a}.${u} / ${c?`${h}`:`span(${w})`}`,S=!c||!p?"panLinear":m==="log"?"panLog":m==="symlog"?"panSymlog":m==="pow"?"panPow":"panLinear",A=c?m==="pow"?`, ${p.get("exponent")??1}`:m==="symlog"?`, ${p.get("constant")??1}`:"":"",C=`${S}(${w}, ${E}${A})`;f.on.push({events:{signal:a},update:c?C:`clampRange(${C}, 0, ${h})`})}const gW="_zoom_anchor",mW="_zoom_delta",Qve={defined:e=>e.type==="interval"&&e.zoom,signals:(e,t,n)=>{const r=t.name,i=Hs.defined(t),o=r+mW,{x:s,y:a}=t.project.hasChannel,u=de(e.scaleName(Tt)),c=de(e.scaleName(Sn));let f=xu(t.zoom,"scope");return i||(f=f.map(h=>(h.markname=r+pf,h))),n.push({name:r+gW,on:[{events:f,update:i?"{"+[u?`x: invert(${u}, x(unit))`:"",c?`y: invert(${c}, y(unit))`:""].filter(h=>h).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:o,on:[{events:f,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),s!==void 0&&mO(e,t,s,"width",n),a!==void 0&&mO(e,t,a,"height",n),n}};function mO(e,t,n,r,i){const o=t.name,s=n.channel,a=Hs.defined(t),u=i.find(S=>S.name===n.signals[a?"data":"visual"]),c=e.getSizeSignalRef(r).signal,f=e.getScaleComponent(s),h=f&&f.get("type"),p=a?Y_(e,s):u.name,m=o+mW,y=`${o}${gW}.${s}`,v=!a||!f?"zoomLinear":h==="log"?"zoomLog":h==="symlog"?"zoomSymlog":h==="pow"?"zoomPow":"zoomLinear",w=a?h==="pow"?`, ${f.get("exponent")??1}`:h==="symlog"?`, ${f.get("constant")??1}`:"":"",E=`${v}(${p}, ${y}, ${m}${w})`;u.on.push({events:{signal:m},update:a?E:`clampRange(${E}, 0, ${c})`})}const jl="_store",Js="_tuple",Kve="_modify",yW="vlSelectionResolve",Ux=[Sve,Mve,wve,fW,cW,Hs,dW,Vve,Xve,Qve,lW];function Jve(e){let t=e.parent;for(;t&&!oi(t);)t=t.parent;return t}function xl(e,{escape:t}={escape:!0}){let n=t?de(e.name):e.name;const r=Jve(e);if(r){const{facet:i}=r;for(const o of _i)i[o]&&(n+=` + '__facet_${o}_' + (facet[${de(r.vgField(o))}])`)}return n}function h3(e){return Rn(e.component.selection??{}).reduce((t,n)=>t||n.project.hasSelectionId,!1)}function vW(e,t){(ve(t.select)||!t.select.on)&&delete e.events,(ve(t.select)||!t.select.clear)&&delete e.clear,(ve(t.select)||!t.select.toggle)&&delete e.toggle}function Wo(e){var t;return(t=e.events)==null?void 0:t.find(n=>"type"in n&&n.type==="timer")}const Zve="RawCode",exe="Literal",txe="Property",nxe="Identifier",rxe="ArrayExpression",ixe="BinaryExpression",oxe="CallExpression",sxe="ConditionalExpression",axe="LogicalExpression",uxe="MemberExpression",lxe="ObjectExpression",cxe="UnaryExpression";function Eo(e){this.type=e}Eo.prototype.visit=function(e){let t,n,r;if(e(this))return 1;for(t=fxe(this),n=0,r=t.length;n<r;++n)if(t[n].visit(e))return 1};function fxe(e){switch(e.type){case rxe:return e.elements;case ixe:case axe:return[e.left,e.right];case oxe:return[e.callee].concat(e.arguments);case sxe:return[e.test,e.consequent,e.alternate];case uxe:return[e.object,e.property];case lxe:return e.properties;case txe:return[e.key,e.value];case cxe:return[e.argument];case nxe:case exe:case Zve:default:return[]}}var hs,$e,ee,Zn,gt,jx=1,qg=2,Wl=3,$u=4,Wx=5,uc=6,Mr=7,Hg=8,dxe=9;hs={};hs[jx]="Boolean";hs[qg]="<end>";hs[Wl]="Identifier";hs[$u]="Keyword";hs[Wx]="Null";hs[uc]="Numeric";hs[Mr]="Punctuator";hs[Hg]="String";hs[dxe]="RegularExpression";var hxe="ArrayExpression",pxe="BinaryExpression",gxe="CallExpression",mxe="ConditionalExpression",xW="Identifier",yxe="Literal",vxe="LogicalExpression",xxe="MemberExpression",wxe="ObjectExpression",Exe="Property",bxe="UnaryExpression",xn="Unexpected token %0",Sxe="Unexpected number",_xe="Unexpected string",Axe="Unexpected identifier",Cxe="Unexpected reserved word",kxe="Unexpected end of input",Q_="Invalid regular expression",Eb="Invalid regular expression: missing /",wW="Octal literals are not allowed in strict mode.",$xe="Duplicate data property in object literal not allowed in strict mode",Tn="ILLEGAL",Yp="Disabled.",Fxe=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),Dxe=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function qx(e,t){if(!e)throw new Error("ASSERT: "+t)}function Ds(e){return e>=48&&e<=57}function p3(e){return"0123456789abcdefABCDEF".includes(e)}function xp(e){return"01234567".includes(e)}function Mxe(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].includes(e)}function Xp(e){return e===10||e===13||e===8232||e===8233}function Gg(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&Fxe.test(String.fromCharCode(e))}function Gy(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&Dxe.test(String.fromCharCode(e))}const Txe={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function EW(){for(;ee<Zn;){const e=$e.charCodeAt(ee);if(Mxe(e)||Xp(e))++ee;else break}}function K_(e){var t,n,r,i=0;for(n=e==="u"?4:2,t=0;t<n;++t)ee<Zn&&p3($e[ee])?(r=$e[ee++],i=i*16+"0123456789abcdef".indexOf(r.toLowerCase())):st({},xn,Tn);return String.fromCharCode(i)}function Nxe(){var e,t,n,r;for(e=$e[ee],t=0,e==="}"&&st({},xn,Tn);ee<Zn&&(e=$e[ee++],!!p3(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&st({},xn,Tn),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,r=(t-65536&1023)+56320,String.fromCharCode(n,r))}function bW(){var e,t;for(e=$e.charCodeAt(ee++),t=String.fromCharCode(e),e===92&&($e.charCodeAt(ee)!==117&&st({},xn,Tn),++ee,e=K_("u"),(!e||e==="\\"||!Gg(e.charCodeAt(0)))&&st({},xn,Tn),t=e);ee<Zn&&(e=$e.charCodeAt(ee),!!Gy(e));)++ee,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),$e.charCodeAt(ee)!==117&&st({},xn,Tn),++ee,e=K_("u"),(!e||e==="\\"||!Gy(e.charCodeAt(0)))&&st({},xn,Tn),t+=e);return t}function Rxe(){var e,t;for(e=ee++;ee<Zn;){if(t=$e.charCodeAt(ee),t===92)return ee=e,bW();if(Gy(t))++ee;else break}return $e.slice(e,ee)}function Oxe(){var e,t,n;return e=ee,t=$e.charCodeAt(ee)===92?bW():Rxe(),t.length===1?n=Wl:Txe.hasOwnProperty(t)?n=$u:t==="null"?n=Wx:t==="true"||t==="false"?n=jx:n=Wl,{type:n,value:t,start:e,end:ee}}function bb(){var e=ee,t=$e.charCodeAt(ee),n,r=$e[ee],i,o,s;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++ee,{type:Mr,value:String.fromCharCode(t),start:e,end:ee};default:if(n=$e.charCodeAt(ee+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return ee+=2,{type:Mr,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:ee};case 33:case 61:return ee+=2,$e.charCodeAt(ee)===61&&++ee,{type:Mr,value:$e.slice(e,ee),start:e,end:ee}}}if(s=$e.substr(ee,4),s===">>>=")return ee+=4,{type:Mr,value:s,start:e,end:ee};if(o=s.substr(0,3),o===">>>"||o==="<<="||o===">>=")return ee+=3,{type:Mr,value:o,start:e,end:ee};if(i=o.substr(0,2),r===i[1]&&"+-<>&|".includes(r)||i==="=>")return ee+=2,{type:Mr,value:i,start:e,end:ee};if(i==="//"&&st({},xn,Tn),"<>=!+-*%&|^/".includes(r))return++ee,{type:Mr,value:r,start:e,end:ee};st({},xn,Tn)}function Pxe(e){let t="";for(;ee<Zn&&p3($e[ee]);)t+=$e[ee++];return t.length===0&&st({},xn,Tn),Gg($e.charCodeAt(ee))&&st({},xn,Tn),{type:uc,value:parseInt("0x"+t,16),start:e,end:ee}}function Lxe(e){let t="0"+$e[ee++];for(;ee<Zn&&xp($e[ee]);)t+=$e[ee++];return(Gg($e.charCodeAt(ee))||Ds($e.charCodeAt(ee)))&&st({},xn,Tn),{type:uc,value:parseInt(t,8),octal:!0,start:e,end:ee}}function yO(){var e,t,n;if(n=$e[ee],qx(Ds(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=ee,e="",n!=="."){if(e=$e[ee++],n=$e[ee],e==="0"){if(n==="x"||n==="X")return++ee,Pxe(t);if(xp(n))return Lxe(t);n&&Ds(n.charCodeAt(0))&&st({},xn,Tn)}for(;Ds($e.charCodeAt(ee));)e+=$e[ee++];n=$e[ee]}if(n==="."){for(e+=$e[ee++];Ds($e.charCodeAt(ee));)e+=$e[ee++];n=$e[ee]}if(n==="e"||n==="E")if(e+=$e[ee++],n=$e[ee],(n==="+"||n==="-")&&(e+=$e[ee++]),Ds($e.charCodeAt(ee)))for(;Ds($e.charCodeAt(ee));)e+=$e[ee++];else st({},xn,Tn);return Gg($e.charCodeAt(ee))&&st({},xn,Tn),{type:uc,value:parseFloat(e),start:t,end:ee}}function zxe(){var e="",t,n,r,i,o=!1;for(t=$e[ee],qx(t==="'"||t==='"',"String literal must starts with a quote"),n=ee,++ee;ee<Zn;)if(r=$e[ee++],r===t){t="";break}else if(r==="\\")if(r=$e[ee++],!r||!Xp(r.charCodeAt(0)))switch(r){case"u":case"x":$e[ee]==="{"?(++ee,e+=Nxe()):e+=K_(r);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:xp(r)?(i="01234567".indexOf(r),i!==0&&(o=!0),ee<Zn&&xp($e[ee])&&(o=!0,i=i*8+"01234567".indexOf($e[ee++]),"0123".includes(r)&&ee<Zn&&xp($e[ee])&&(i=i*8+"01234567".indexOf($e[ee++]))),e+=String.fromCharCode(i)):e+=r;break}else r==="\r"&&$e[ee]===`
`&&++ee;else{if(Xp(r.charCodeAt(0)))break;e+=r}return t!==""&&st({},xn,Tn),{type:Hg,value:e,octal:o,start:n,end:ee}}function Ixe(e,t){let n=e;t.includes("u")&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(r,i)=>{if(parseInt(i,16)<=1114111)return"x";st({},Q_)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch{st({},Q_)}try{return new RegExp(e,t)}catch{return null}}function Bxe(){var e,t,n,r,i;for(e=$e[ee],qx(e==="/","Regular expression literal must start with a slash"),t=$e[ee++],n=!1,r=!1;ee<Zn;)if(e=$e[ee++],t+=e,e==="\\")e=$e[ee++],Xp(e.charCodeAt(0))&&st({},Eb),t+=e;else if(Xp(e.charCodeAt(0)))st({},Eb);else if(n)e==="]"&&(n=!1);else if(e==="/"){r=!0;break}else e==="["&&(n=!0);return r||st({},Eb),i=t.substr(1,t.length-2),{value:i,literal:t}}function Uxe(){var e,t,n;for(t="",n="";ee<Zn&&(e=$e[ee],!!Gy(e.charCodeAt(0)));)++ee,e==="\\"&&ee<Zn?st({},xn,Tn):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&st({},Q_,n),{value:n,literal:t}}function jxe(){var e,t,n,r;return gt=null,EW(),e=ee,t=Bxe(),n=Uxe(),r=Ixe(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:ee}}function Wxe(e){return e.type===Wl||e.type===$u||e.type===jx||e.type===Wx}function SW(){if(EW(),ee>=Zn)return{type:qg,start:ee,end:ee};const e=$e.charCodeAt(ee);return Gg(e)?Oxe():e===40||e===41||e===59?bb():e===39||e===34?zxe():e===46?Ds($e.charCodeAt(ee+1))?yO():bb():Ds(e)?yO():bb()}function Rr(){const e=gt;return ee=e.end,gt=SW(),ee=e.end,e}function _W(){const e=ee;gt=SW(),ee=e}function qxe(e){const t=new Eo(hxe);return t.elements=e,t}function vO(e,t,n){const r=new Eo(e==="||"||e==="&&"?vxe:pxe);return r.operator=e,r.left=t,r.right=n,r}function Hxe(e,t){const n=new Eo(gxe);return n.callee=e,n.arguments=t,n}function Gxe(e,t,n){const r=new Eo(mxe);return r.test=e,r.consequent=t,r.alternate=n,r}function g3(e){const t=new Eo(xW);return t.name=e,t}function np(e){const t=new Eo(yxe);return t.value=e.value,t.raw=$e.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function xO(e,t,n){const r=new Eo(xxe);return r.computed=e==="[",r.object=t,r.property=n,r.computed||(n.member=!0),r}function Vxe(e){const t=new Eo(wxe);return t.properties=e,t}function wO(e,t,n){const r=new Eo(Exe);return r.key=t,r.value=n,r.kind=e,r}function Yxe(e,t){const n=new Eo(bxe);return n.operator=e,n.argument=t,n.prefix=!0,n}function st(e,t){var n,r=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,(o,s)=>(qx(s<r.length,"Message reference must be in range"),r[s]));throw n=new Error(i),n.index=ee,n.description=i,n}function Hx(e){e.type===qg&&st(e,kxe),e.type===uc&&st(e,Sxe),e.type===Hg&&st(e,_xe),e.type===Wl&&st(e,Axe),e.type===$u&&st(e,Cxe),st(e,xn,e.value)}function er(e){const t=Rr();(t.type!==Mr||t.value!==e)&&Hx(t)}function $t(e){return gt.type===Mr&&gt.value===e}function Sb(e){return gt.type===$u&&gt.value===e}function Xxe(){const e=[];for(ee=gt.start,er("[");!$t("]");)$t(",")?(Rr(),e.push(null)):(e.push(ql()),$t("]")||er(","));return Rr(),qxe(e)}function EO(){ee=gt.start;const e=Rr();return e.type===Hg||e.type===uc?(e.octal&&st(e,wW),np(e)):g3(e.value)}function Qxe(){var e,t,n,r;if(ee=gt.start,e=gt,e.type===Wl)return n=EO(),er(":"),r=ql(),wO("init",n,r);if(e.type===qg||e.type===Mr)Hx(e);else return t=EO(),er(":"),r=ql(),wO("init",t,r)}function Kxe(){var e=[],t,n,r,i={},o=String;for(ee=gt.start,er("{");!$t("}");)t=Qxe(),t.key.type===xW?n=t.key.name:n=o(t.key.value),r="$"+n,Object.prototype.hasOwnProperty.call(i,r)?st({},$xe):i[r]=!0,e.push(t),$t("}")||er(",");return er("}"),Vxe(e)}function Jxe(){er("(");const e=m3();return er(")"),e}const Zxe={if:1};function e2e(){var e,t,n;if($t("("))return Jxe();if($t("["))return Xxe();if($t("{"))return Kxe();if(e=gt.type,ee=gt.start,e===Wl||Zxe[gt.value])n=g3(Rr().value);else if(e===Hg||e===uc)gt.octal&&st(gt,wW),n=np(Rr());else{if(e===$u)throw new Error(Yp);e===jx?(t=Rr(),t.value=t.value==="true",n=np(t)):e===Wx?(t=Rr(),t.value=null,n=np(t)):$t("/")||$t("/=")?(n=np(jxe()),_W()):Hx(Rr())}return n}function t2e(){const e=[];if(er("("),!$t(")"))for(;ee<Zn&&(e.push(ql()),!$t(")"));)er(",");return er(")"),e}function n2e(){ee=gt.start;const e=Rr();return Wxe(e)||Hx(e),g3(e.value)}function r2e(){return er("."),n2e()}function i2e(){er("[");const e=m3();return er("]"),e}function o2e(){var e,t,n;for(e=e2e();;)if($t("."))n=r2e(),e=xO(".",e,n);else if($t("("))t=t2e(),e=Hxe(e,t);else if($t("["))n=i2e(),e=xO("[",e,n);else break;return e}function bO(){const e=o2e();if(gt.type===Mr&&($t("++")||$t("--")))throw new Error(Yp);return e}function y1(){var e,t;if(gt.type!==Mr&&gt.type!==$u)t=bO();else{if($t("++")||$t("--"))throw new Error(Yp);if($t("+")||$t("-")||$t("~")||$t("!"))e=Rr(),t=y1(),t=Yxe(e.value,t);else{if(Sb("delete")||Sb("void")||Sb("typeof"))throw new Error(Yp);t=bO()}}return t}function SO(e){let t=0;if(e.type!==Mr&&e.type!==$u)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function s2e(){var e,t,n,r,i,o,s,a,u,c;if(e=gt,u=y1(),r=gt,i=SO(r),i===0)return u;for(r.prec=i,Rr(),t=[e,gt],s=y1(),o=[u,r,s];(i=SO(gt))>0;){for(;o.length>2&&i<=o[o.length-2].prec;)s=o.pop(),a=o.pop().value,u=o.pop(),t.pop(),n=vO(a,u,s),o.push(n);r=Rr(),r.prec=i,o.push(r),t.push(gt),n=y1(),o.push(n)}for(c=o.length-1,n=o[c],t.pop();c>1;)t.pop(),n=vO(o[c-1].value,o[c-2],n),c-=2;return n}function ql(){var e,t,n;return e=s2e(),$t("?")&&(Rr(),t=ql(),er(":"),n=ql(),e=Gxe(e,t,n)),e}function m3(){const e=ql();if($t(","))throw new Error(Yp);return e}function a2e(e){$e=e,ee=0,Zn=$e.length,gt=null,_W();const t=m3();if(gt.type!==qg)throw new Error("Unexpect token after expression.");return t}function J_(e){const t=[];return e.type==="Identifier"?[e.name]:e.type==="Literal"?[e.value]:(e.type==="MemberExpression"&&(t.push(...J_(e.object)),t.push(...J_(e.property))),t)}function AW(e){return e.object.type==="MemberExpression"?AW(e.object):e.object.name==="datum"}function CW(e){const t=a2e(e),n=new Set;return t.visit(r=>{r.type==="MemberExpression"&&AW(r)&&n.add(J_(r).slice(1).join("."))}),n}class xd extends mt{clone(){return new xd(null,this.model,Ue(this.filter))}constructor(t,n,r){super(t),this.model=n,this.filter=r,this.expr=Vy(this.model,this.filter,this),this._dependentFields=CW(this.expr)}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return`Filter ${this.expr}`}}function u2e(e,t){const n={},r=e.config.selection;if(!t||!t.length)return n;let i=0;for(const o of t){const s=Mt(o.name),a=o.select,u=ve(a)?a:a.type,c=ye(a)?Ue(a):{type:u},f=r[u];for(const m in f)m==="fields"||m==="encodings"||(m==="mark"&&(c.mark={...f.mark,...c.mark}),(c[m]===void 0||c[m]===!0)&&(c[m]=Ue(f[m]??c[m])));const h=n[s]={...c,name:s,type:u,init:o.value,bind:o.bind,events:ve(c.on)?xu(c.on,"scope"):xe(Ue(c.on))};if(Wo(h)&&(i++,i>1)){delete n[s];continue}const p=Ue(o);for(const m of Ux)m.defined(h)&&m.parse&&m.parse(e,h,p)}return i>1&&ue(y0e),n}function kW(e,t,n,r="datum"){const i=ve(t)?t:t.param,o=Mt(i),s=de(o+jl);let a;try{a=e.getSelectionComponent(o,i)}catch{return`!!${o}`}if(a.project.timeUnit){const p=n??e.component.data.raw,m=a.project.timeUnit.clone();p.parent?m.insertAsParentOf(p):p.parent=m}const u=a.project.hasSelectionId?"vlSelectionIdTest(":"vlSelectionTest(",c=a.resolve==="global"?")":`, ${de(a.resolve)})`,f=`${u}${s}, ${r}${c}`,h=`length(data(${s}))`;return t.empty===!1?`${h} && ${f}`:`!${h} || ${f}`}function $W(e,t,n){const r=Mt(t),i=n.encoding;let o=n.field,s;try{s=e.getSelectionComponent(r,t)}catch{return r}if(!i&&!o)o=s.project.items[0].field,s.project.items.length>1&&ue(v0e(o));else if(i&&!o){const a=s.project.items.filter(u=>u.channel===i);!a.length||a.length>1?(o=s.project.items[0].field,ue(x0e(a,i,n,o))):o=a[0].field}return`${s.name}[${de(Ti(o))}]`}function l2e(e,t){for(const[n,r]of uu(e.component.selection??{})){const i=e.getName(`lookup_${n}`);e.component.data.outputNodes[i]=r.materialized=new Lr(new xd(t,e,{param:n}),i,Lt.Lookup,e.component.data.outputNodeRefCounts)}}function Vy(e,t,n){return yp(t,r=>ve(r)?r:$me(r)?kW(e,r,n):TU(r))}function c2e(e,t){if(e)return ne(e)&&!Oa(e)?e.map(n=>YF(n,t)).join(", "):e}function _b(e,t,n,r){var i,o;e.encode??(e.encode={}),(i=e.encode)[t]??(i[t]={}),(o=e.encode[t]).update??(o.update={}),e.encode[t].update[n]=r}function rp(e,t,n,r={header:!1}){var h,p;const{disable:i,orient:o,scale:s,labelExpr:a,title:u,zindex:c,...f}=e.combine();if(!i){for(const m in f){const y=m,v=N1e[y],w=f[y];if(v&&v!==t&&v!=="both")delete f[y];else if(jg(w)){const{condition:E,...S}=w,A=xe(E),C=q6[y];if(C){const{vgProp:k,part:D}=C,$=[...A.map(M=>{const{test:T,...L}=M;return{test:Vy(null,T),...L}}),S];_b(f,D,k,$),delete f[y]}else if(C===null){const k={signal:A.map(D=>{const{test:$,...M}=D;return`${Vy(null,$)} ? ${$6(M)} : `}).join("")+$6(S)};f[y]=k}}else if(Fe(w)){const E=q6[y];if(E){const{vgProp:S,part:A}=E;_b(f,A,S,w),delete f[y]}}Qe(["labelAlign","labelBaseline"],y)&&f[y]===null&&delete f[y]}if(t==="grid"){if(!f.grid)return;if(f.encode){const{grid:m}=f.encode;f.encode={...m?{grid:m}:{}},vt(f.encode)&&delete f.encode}return{scale:s,orient:o,...f,domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:Yt(c,0)}}else{if(!r.header&&e.mainExtracted)return;if(a!==void 0){let y=a;(p=(h=f.encode)==null?void 0:h.labels)!=null&&p.update&&Fe(f.encode.labels.update.text)&&(y=Rl(a,"datum.label",f.encode.labels.update.text.signal)),_b(f,"labels","text",{signal:y})}if(f.labelAlign===null&&delete f.labelAlign,f.encode){for(const y of lj)e.hasAxisPart(y)||delete f.encode[y];vt(f.encode)&&delete f.encode}const m=c2e(u,n);return{scale:s,orient:o,grid:!1,...m?{title:m}:{},...f,...n.aria===!1?{aria:!1}:{},zindex:Yt(c,0)}}}}function FW(e){const{axes:t}=e.component,n=[];for(const r of oa)if(t[r]){for(const i of t[r])if(!i.get("disable")&&!i.get("gridScale")){const o=r==="x"?"height":"width",s=e.getSizeSignalRef(o).signal;o!==s&&n.push({name:o,update:s})}}return n}function f2e(e,t){const{x:n=[],y:r=[]}=e;return[...n.map(i=>rp(i,"grid",t)),...r.map(i=>rp(i,"grid",t)),...n.map(i=>rp(i,"main",t)),...r.map(i=>rp(i,"main",t))].filter(i=>i)}function _O(e,t,n,r){return Object.assign.apply(null,[{},...e.map(i=>{if(i==="axisOrient"){const o=n==="x"?"bottom":"left",s=t[n==="x"?"axisBottom":"axisLeft"]||{},a=t[n==="x"?"axisTop":"axisRight"]||{},u=new Set([...oe(s),...oe(a)]),c={};for(const f of u.values())c[f]={signal:`${r.signal} === "${o}" ? ${to(s[f])} : ${to(a[f])}`};return c}return t[i]})])}function d2e(e,t,n,r){const i=t==="band"?["axisDiscrete","axisBand"]:t==="point"?["axisDiscrete","axisPoint"]:PU(t)?["axisQuantitative"]:t==="time"||t==="utc"?["axisTemporal"]:[],o=e==="x"?"axisX":"axisY",s=Fe(n)?"axisOrient":`axis${Mg(n)}`,a=[...i,...i.map(c=>o+c.substr(4))],u=["axis",s,o];return{vlOnlyAxisConfig:_O(a,r,e,n),vgAxisConfig:_O(u,r,e,n),axisConfigStyle:h2e([...u,...a],r)}}function h2e(e,t){var r;const n=[{}];for(const i of e){let o=(r=t[i])==null?void 0:r.style;if(o){o=xe(o);for(const s of o)n.push(t.style[s])}}return Object.assign.apply(null,n)}function Z_(e,t,n,r={}){var o;const i=cU(e,n,t);if(i!==void 0)return{configFrom:"style",configValue:i};for(const s of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"])if(((o=r[s])==null?void 0:o[e])!==void 0)return{configFrom:s,configValue:r[s][e]};return{}}const AO={scale:({model:e,channel:t})=>e.scaleName(t),format:({format:e})=>e,formatType:({formatType:e})=>e,grid:({fieldOrDatumDef:e,axis:t,scaleType:n})=>t.grid??p2e(n,e),gridScale:({model:e,channel:t})=>g2e(e,t),labelAlign:({axis:e,labelAngle:t,orient:n,channel:r})=>e.labelAlign||MW(t,n,r),labelAngle:({labelAngle:e})=>e,labelBaseline:({axis:e,labelAngle:t,orient:n,channel:r})=>e.labelBaseline||DW(t,n,r),labelFlush:({axis:e,fieldOrDatumDef:t,channel:n})=>e.labelFlush??y2e(t.type,n),labelOverlap:({axis:e,fieldOrDatumDef:t,scaleType:n})=>e.labelOverlap??v2e(t.type,n,ce(t)&&!!t.timeUnit,ce(t)?t.sort:void 0),orient:({orient:e})=>e,tickCount:({channel:e,model:t,axis:n,fieldOrDatumDef:r,scaleType:i})=>{const o=e==="x"?"width":e==="y"?"height":void 0,s=o?t.getSizeSignalRef(o):void 0;return n.tickCount??w2e({fieldOrDatumDef:r,scaleType:i,size:s,values:n.values})},tickMinStep:E2e,title:({axis:e,model:t,channel:n})=>{if(e.title!==void 0)return e.title;const r=TW(t,n);if(r!==void 0)return r;const i=t.typedFieldDef(n),o=n==="x"?"x2":"y2",s=t.fieldDef(o);return dU(i?[j6(i)]:[],ce(s)?[j6(s)]:[])},values:({axis:e,fieldOrDatumDef:t})=>b2e(e,t),zindex:({axis:e,fieldOrDatumDef:t,mark:n})=>e.zindex??S2e(n,t)};function p2e(e,t){return!En(e)&&ce(t)&&!St(t==null?void 0:t.bin)&&!Cn(t==null?void 0:t.bin)}function g2e(e,t){const n=t==="x"?"y":"x";if(e.getScaleComponent(n))return e.scaleName(n)}function m2e(e,t,n,r,i){const o=t==null?void 0:t.labelAngle;if(o!==void 0)return Fe(o)?o:Hp(o);{const{configValue:s}=Z_("labelAngle",r,t==null?void 0:t.style,i);return s!==void 0?Hp(s):n===Tt&&Qe([PF,OF],e.type)&&!(ce(e)&&e.timeUnit)?270:void 0}}function eA(e){return`(((${e.signal} % 360) + 360) % 360)`}function DW(e,t,n,r){if(e!==void 0)if(n==="x"){if(Fe(e)){const i=eA(e),o=Fe(t)?`(${t.signal} === "top")`:t==="top";return{signal:`(45 < ${i} && ${i} < 135) || (225 < ${i} && ${i} < 315) ? "middle" :(${i} <= 45 || 315 <= ${i}) === ${o} ? "bottom" : "top"`}}if(45<e&&e<135||225<e&&e<315)return"middle";if(Fe(t)){const i=e<=45||315<=e?"===":"!==";return{signal:`${t.signal} ${i} "top" ? "bottom" : "top"`}}return(e<=45||315<=e)==(t==="top")?"bottom":"top"}else{if(Fe(e)){const i=eA(e),o=Fe(t)?`(${t.signal} === "left")`:t==="left";return{signal:`${i} <= 45 || 315 <= ${i} || (135 <= ${i} && ${i} <= 225) ? ${r?'"middle"':"null"} : (45 <= ${i} && ${i} <= 135) === ${o} ? "top" : "bottom"`}}if(e<=45||315<=e||135<=e&&e<=225)return r?"middle":null;if(Fe(t)){const i=45<=e&&e<=135?"===":"!==";return{signal:`${t.signal} ${i} "left" ? "top" : "bottom"`}}return(45<=e&&e<=135)==(t==="left")?"top":"bottom"}}function MW(e,t,n){if(e===void 0)return;const r=n==="x",i=r?0:90,o=r?"bottom":"left";if(Fe(e)){const s=eA(e),a=Fe(t)?`(${t.signal} === "${o}")`:t===o;return{signal:`(${i?`(${s} + 90)`:s} % 180 === 0) ? ${r?null:'"center"'} :(${i} < ${s} && ${s} < ${180+i}) === ${a} ? "left" : "right"`}}if((e+i)%180===0)return r?null:"center";if(Fe(t)){const s=i<e&&e<180+i?"===":"!==";return{signal:`${`${t.signal} ${s} "${o}"`} ? "left" : "right"`}}return(i<e&&e<180+i)==(t===o)?"left":"right"}function y2e(e,t){if(t==="x"&&Qe(["quantitative","temporal"],e))return!0}function v2e(e,t,n,r){if(n&&!ye(r)||e!=="nominal"&&e!=="ordinal")return t==="log"||t==="symlog"?"greedy":!0}function x2e(e){return e==="x"?"bottom":"left"}function w2e({fieldOrDatumDef:e,scaleType:t,size:n,values:r}){var i;if(!r&&!En(t)&&t!=="log"){if(ce(e)){if(St(e.bin))return{signal:`ceil(${n.signal}/10)`};if(e.timeUnit&&Qe(["month","hours","day","quarter"],(i=wn(e.timeUnit))==null?void 0:i.unit))return}return{signal:`ceil(${n.signal}/40)`}}}function E2e({format:e,fieldOrDatumDef:t}){if(e==="d")return 1;if(ce(t)){const{timeUnit:n}=t;if(n){const r=FU(n);if(r)return{signal:r}}}}function TW(e,t){const n=t==="x"?"x2":"y2",r=e.fieldDef(t),i=e.fieldDef(n),o=r?r.title:void 0,s=i?i.title:void 0;if(o&&s)return hU(o,s);if(o)return o;if(s)return s;if(o!==void 0)return o;if(s!==void 0)return s}function b2e(e,t){const n=e.values;if(ne(n))return uj(t,n);if(Fe(n))return n}function S2e(e,t){return e==="rect"&&Iy(t)?1:0}class Vf extends mt{clone(){return new Vf(null,Ue(this.transform))}constructor(t,n){super(t),this.transform=n,this._dependentFields=CW(this.transform.calculate)}static parseAllForSortIndex(t,n){return n.forEachFieldDef((r,i)=>{if(ac(r)&&JU(r.sort)){const{field:o,timeUnit:s}=r,a=r.sort,u=a.map((c,f)=>`${TU({field:o,timeUnit:s,equal:c})} ? ${f} : `).join("")+a.length;t=new Vf(t,{calculate:u,as:Yf(r,i,{forAs:!0})})}}),t}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return`Calculate ${Ke(this.transform)}`}}function Yf(e,t,n){return ge(e,{prefix:t,suffix:"sort_index",...n})}function Gx(e,t){return Qe(["top","bottom"],t)?"column":Qe(["left","right"],t)||e==="row"?"row":"column"}function Xf(e,t,n,r){const i=r==="row"?n.headerRow:r==="column"?n.headerColumn:n.headerFacet;return Yt((t||{})[e],i[e],n.header[e])}function Vx(e,t,n,r){const i={};for(const o of e){const s=Xf(o,t||{},n,r);s!==void 0&&(i[o]=s)}return i}const y3=["row","column"],v3=["header","footer"];function _2e(e,t){const n=e.component.layoutHeaders[t].title,r=e.config?e.config:void 0,i=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:void 0,{titleAnchor:o,titleAngle:s,titleOrient:a}=Vx(["titleAnchor","titleAngle","titleOrient"],i.header,r,t),u=Gx(t,a),c=Hp(s);return{name:`${t}-title`,type:"group",role:`${u}-title`,title:{text:n,...t==="row"?{orient:"left"}:{},style:"guide-title",...RW(c,u),...NW(u,c,o),...OW(r,i,t,tye,kj)}}}function NW(e,t,n="middle"){switch(n){case"start":return{align:"left"};case"end":return{align:"right"}}const r=MW(t,e==="row"?"left":"top",e==="row"?"y":"x");return r?{align:r}:{}}function RW(e,t){const n=DW(e,t==="row"?"left":"top",t==="row"?"y":"x",!0);return n?{baseline:n}:{}}function A2e(e,t){const n=e.component.layoutHeaders[t],r=[];for(const i of v3)if(n[i])for(const o of n[i]){const s=k2e(e,t,i,n,o);s!=null&&r.push(s)}return r}function C2e(e,t){const{sort:n}=e;return qs(n)?{field:ge(n,{expr:"datum"}),order:n.order??"ascending"}:ne(n)?{field:Yf(e,t,{expr:"datum"}),order:"ascending"}:{field:ge(e,{expr:"datum"}),order:n??"ascending"}}function tA(e,t,n){const{format:r,formatType:i,labelAngle:o,labelAnchor:s,labelOrient:a,labelExpr:u}=Vx(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],e.header,n,t),c=qF({fieldOrDatumDef:e,format:r,formatType:i,expr:"parent",config:n}).signal,f=Gx(t,a);return{text:{signal:u?Rl(Rl(u,"datum.label",c),"datum.value",ge(e,{expr:"parent"})):c},...t==="row"?{orient:"left"}:{},style:"guide-label",frame:"group",...RW(o,f),...NW(f,o,s),...OW(n,e,t,nye,$j)}}function k2e(e,t,n,r,i){if(i){let o=null;const{facetFieldDef:s}=r,a=e.config?e.config:void 0;if(s&&i.labels){const{labelOrient:h}=Vx(["labelOrient"],s.header,a,t);(t==="row"&&!Qe(["top","bottom"],h)||t==="column"&&!Qe(["left","right"],h))&&(o=tA(s,t,a))}const u=oi(e)&&!zg(e.facet),c=i.axes,f=(c==null?void 0:c.length)>0;if(o||f){const h=t==="row"?"height":"width";return{name:e.getName(`${t}_${n}`),type:"group",role:`${t}-${n}`,...r.facetFieldDef?{from:{data:e.getName(`${t}_domain`)},sort:C2e(s,t)}:{},...f&&u?{from:{data:e.getName(`facet_domain_${t}`)}}:{},...o?{title:o}:{},...i.sizeSignal?{encode:{update:{[h]:i.sizeSignal}}}:{},...f?{axes:c}:{}}}}return null}const $2e={column:{start:0,end:1},row:{start:1,end:0}};function F2e(e,t){return $2e[t][e]}function D2e(e,t){const n={};for(const r of _i){const i=e[r];if(i!=null&&i.facetFieldDef){const{titleAnchor:o,titleOrient:s}=Vx(["titleAnchor","titleOrient"],i.facetFieldDef.header,t,r),a=Gx(r,s),u=F2e(o,a);u!==void 0&&(n[a]=u)}}return vt(n)?void 0:n}function OW(e,t,n,r,i){const o={};for(const s of r){if(!i[s])continue;const a=Xf(s,t==null?void 0:t.header,e,n);a!==void 0&&(o[i[s]]=a)}return o}function x3(e){return[...Om(e,"width"),...Om(e,"height"),...Om(e,"childWidth"),...Om(e,"childHeight")]}function Om(e,t){const n=t==="width"?"x":"y",r=e.component.layoutSize.get(t);if(!r||r==="merged")return[];const i=e.getSizeSignalRef(t).signal;if(r==="step"){const o=e.getScaleComponent(n);if(o){const s=o.get("type"),a=o.get("range");if(En(s)&&ic(a)){const u=e.scaleName(n);return oi(e.parent)&&e.parent.component.resolve.scale[n]==="independent"?[CO(u,a)]:[CO(u,a),{name:i,update:PW(u,o,`domain('${u}').length`)}]}}throw new Error("layout size is step although width/height is not step.")}else if(r=="container"){const o=i.endsWith("width"),s=o?"containerSize()[0]":"containerSize()[1]",a=j_(e.config.view,o?"width":"height"),u=`isFinite(${s}) ? ${s} : ${a}`;return[{name:i,init:u,on:[{update:u,events:"window:resize"}]}]}else return[{name:i,value:r}]}function CO(e,t){const n=`${e}_step`;return Fe(t.step)?{name:n,update:t.step.signal}:{name:n,value:t.step}}function PW(e,t,n){const r=t.get("type"),i=t.get("padding"),o=Yt(t.get("paddingOuter"),i);let s=t.get("paddingInner");return s=r==="band"?s!==void 0?s:i:1,`bandspace(${n}, ${to(s)}, ${to(o)}) * ${e}_step`}function LW(e){return e==="childWidth"?"width":e==="childHeight"?"height":e}function zW(e,t){return oe(e).reduce((n,r)=>({...n,...vd({model:t,channelDef:e[r],vgChannel:r,mainRefFn:i=>kt(i.value),invalidValueRef:void 0})}),{})}function IW(e,t){if(oi(t))return e==="theta"?"independent":"shared";if(bd(t))return"shared";if(C3(t))return Xt(e)||e==="theta"||e==="radius"?"independent":"shared";throw new Error("invalid model type for resolve")}function w3(e,t){const n=e.scale[t],r=Xt(t)?"axis":"legend";return n==="independent"?(e[r][t]==="shared"&&ue(Q0e(t)),"independent"):e[r][t]||"shared"}const M2e={...oye,disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1},BW=oe(M2e);class T2e extends aa{}const kO={symbols:N2e,gradient:R2e,labels:O2e,entries:P2e};function N2e(e,{fieldOrDatumDef:t,model:n,channel:r,legendCmpt:i,legendType:o}){if(o!=="symbol")return;const{markDef:s,encoding:a,config:u,mark:c}=n,f=s.filled&&c!=="trail";let h={...i0e({},n,e1e),...sW(n,{filled:f})};const p=i.get("symbolOpacity")??u.legend.symbolOpacity,m=i.get("symbolFillColor")??u.legend.symbolFillColor,y=i.get("symbolStrokeColor")??u.legend.symbolStrokeColor,v=p===void 0?UW(a.opacity)??s.opacity:void 0;if(h.fill){if(r==="fill"||f&&r===Ur)delete h.fill;else if(se(h.fill,"field"))m?delete h.fill:(h.fill=kt(u.legend.symbolBaseFillColor??"black"),h.fillOpacity=kt(v??1));else if(ne(h.fill)){const w=nA(a.fill??a.color)??s.fill??(f&&s.color);w&&(h.fill=kt(w))}}if(h.stroke){if(r==="stroke"||!f&&r===Ur)delete h.stroke;else if(se(h.stroke,"field")||y)delete h.stroke;else if(ne(h.stroke)){const w=Yt(nA(a.stroke||a.color),s.stroke,f?s.color:void 0);w&&(h.stroke={value:w})}}if(r!==ia){const w=ce(t)&&WW(n,i,t);w?h.opacity=[{test:w,...kt(v??1)},kt(u.legend.unselectedOpacity)]:v&&(h.opacity=kt(v))}return h={...h,...e},vt(h)?void 0:h}function R2e(e,{model:t,legendType:n,legendCmpt:r}){if(n!=="gradient")return;const{config:i,markDef:o,encoding:s}=t;let a={};const c=(r.get("gradientOpacity")??i.legend.gradientOpacity)===void 0?UW(s.opacity)||o.opacity:void 0;return c&&(a.opacity=kt(c)),a={...a,...e},vt(a)?void 0:a}function O2e(e,{fieldOrDatumDef:t,model:n,channel:r,legendCmpt:i}){const o=n.legend(r)||{},s=n.config,a=ce(t)?WW(n,i,t):void 0,u=a?[{test:a,value:1},{value:s.legend.unselectedOpacity}]:void 0,{format:c,formatType:f}=o;let h;Bl(f)?h=no({fieldOrDatumDef:t,field:"datum.value",format:c,formatType:f,config:s}):c===void 0&&f===void 0&&s.customFormatTypes&&(t.type==="quantitative"&&s.numberFormatType?h=no({fieldOrDatumDef:t,field:"datum.value",format:s.numberFormat,formatType:s.numberFormatType,config:s}):t.type==="temporal"&&s.timeFormatType&&ce(t)&&t.timeUnit===void 0&&(h=no({fieldOrDatumDef:t,field:"datum.value",format:s.timeFormat,formatType:s.timeFormatType,config:s})));const p={...u?{opacity:u}:{},...h?{text:h}:{},...e};return vt(p)?void 0:p}function P2e(e,{legendCmpt:t}){const n=t.get("selections");return n!=null&&n.length?{...e,fill:{value:"transparent"}}:e}function UW(e){return jW(e,(t,n)=>Math.max(t,n.value))}function nA(e){return jW(e,(t,n)=>Yt(t,n.value))}function jW(e,t){if(E1e(e))return xe(e.condition).reduce(t,e.value);if(lo(e))return e.value}function WW(e,t,n){const r=t.get("selections");if(!(r!=null&&r.length))return;const i=de(n.field);return r.map(o=>`(!length(data(${de(Mt(o)+jl)})) || (${o}[${i}] && indexof(${o}[${i}], datum.value) >= 0))`).join(" || ")}const $O={direction:({direction:e})=>e,format:({fieldOrDatumDef:e,legend:t,config:n})=>{const{format:r,formatType:i}=t;return XU(e,e.type,r,i,n,!1)},formatType:({legend:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:r}=e;return QU(r,t,n)},gradientLength:e=>{const{legend:t,legendConfig:n}=e;return t.gradientLength??n.gradientLength??W2e(e)},labelOverlap:({legend:e,legendConfig:t,scaleType:n})=>e.labelOverlap??t.labelOverlap??q2e(n),symbolType:({legend:e,markDef:t,channel:n,encoding:r})=>e.symbolType??z2e(t.type,n,r.shape,t.shape),title:({fieldOrDatumDef:e,config:t})=>hf(e,t,{allowDisabling:!0}),type:({legendType:e,scaleType:t,channel:n})=>{if(df(n)&&zo(t)){if(e==="gradient")return}else if(e==="symbol")return;return e},values:({fieldOrDatumDef:e,legend:t})=>L2e(t,e)};function L2e(e,t){const n=e.values;if(ne(n))return uj(t,n);if(Fe(n))return n}function z2e(e,t,n,r){if(t!=="shape"){const i=nA(n)??r;if(i)return i}switch(e){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}function I2e(e){const{legend:t}=e;return Yt(t.type,B2e(e))}function B2e({channel:e,timeUnit:t,scaleType:n}){if(df(e)){if(Qe(["quarter","month","day"],t))return"symbol";if(zo(n))return"gradient"}return"symbol"}function U2e({legendConfig:e,legendType:t,orient:n,legend:r}){return r.direction??e[t?"gradientDirection":"symbolDirection"]??j2e(n,t)}function j2e(e,t){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return t==="gradient"?"horizontal":void 0}}function W2e({legendConfig:e,model:t,direction:n,orient:r,scaleType:i}){const{gradientHorizontalMaxLength:o,gradientHorizontalMinLength:s,gradientVerticalMaxLength:a,gradientVerticalMinLength:u}=e;if(zo(i))return n==="horizontal"?r==="top"||r==="bottom"?FO(t,"width",s,o):s:FO(t,"height",u,a)}function FO(e,t,n,r){return{signal:`clamp(${e.getSizeSignalRef(t).signal}, ${n}, ${r})`}}function q2e(e){if(Qe(["quantile","threshold","log","symlog"],e))return"greedy"}function qW(e){const t=Pt(e)?H2e(e):X2e(e);return e.component.legends=t,t}function H2e(e){const{encoding:t}=e,n={};for(const r of[Ur,...Dj]){const i=sn(t[r]);!i||!e.getScaleComponent(r)||r===jr&&ce(i)&&i.type===yd||(n[r]=Y2e(e,r))}return n}function G2e(e,t){const n=e.scaleName(t);if(e.mark==="trail"){if(t==="color")return{stroke:n};if(t==="size")return{strokeWidth:n}}return t==="color"?e.markDef.filled?{fill:n}:{stroke:n}:{[t]:n}}function V2e(e,t,n,r){switch(t){case"disable":return n!==void 0;case"values":return!!(n!=null&&n.values);case"title":if(t==="title"&&e===(r==null?void 0:r.title))return!0}return e===(n||{})[t]}function Y2e(e,t){var C;let n=e.legend(t);const{markDef:r,encoding:i,config:o}=e,s=o.legend,a=new T2e({},G2e(e,t));Yve(e,t,a);const u=n!==void 0?!n:s.disable;if(a.set("disable",u,n!==void 0),u)return a;n=n||{};const c=e.getScaleComponent(t).get("type"),f=sn(i[t]),h=ce(f)?(C=wn(f.timeUnit))==null?void 0:C.unit:void 0,p=n.orient||o.legend.orient||"right",m=I2e({legend:n,channel:t,timeUnit:h,scaleType:c}),y=U2e({legend:n,legendType:m,orient:p,legendConfig:s}),v={legend:n,channel:t,model:e,markDef:r,encoding:i,fieldOrDatumDef:f,legendConfig:s,config:o,scaleType:c,orient:p,legendType:m,direction:y};for(const k of BW){if(m==="gradient"&&k.startsWith("symbol")||m==="symbol"&&k.startsWith("gradient"))continue;const D=k in $O?$O[k](v):n[k];if(D!==void 0){const $=V2e(D,k,n,e.fieldDef(t));($||o.legend[k]===void 0)&&a.set(k,D,$)}}const w=(n==null?void 0:n.encoding)??{},E=a.get("selections"),S={},A={fieldOrDatumDef:f,model:e,channel:t,legendCmpt:a,legendType:m};for(const k of["labels","legend","title","symbols","gradient","entries"]){const D=zW(w[k]??{},e),$=k in kO?kO[k](D,A):D;$!==void 0&&!vt($)&&(S[k]={...E!=null&&E.length&&ce(f)?{name:`${Mt(f.field)}_legend_${k}`}:{},...E!=null&&E.length?{interactive:!!E}:{},update:$})}return vt(S)||a.set("encode",S,!!(n!=null&&n.encoding)),a}function X2e(e){const{legends:t,resolve:n}=e.component;for(const r of e.children){qW(r);for(const i of oe(r.component.legends))n.legend[i]=w3(e.component.resolve,i),n.legend[i]==="shared"&&(t[i]=HW(t[i],r.component.legends[i]),t[i]||(n.legend[i]="independent",delete t[i]))}for(const r of oe(t))for(const i of e.children)i.component.legends[r]&&n.legend[r]==="shared"&&delete i.component.legends[r];return t}function HW(e,t){var o,s,a,u;if(!e)return t.clone();const n=e.getWithExplicit("orient"),r=t.getWithExplicit("orient");if(n.explicit&&r.explicit&&n.value!==r.value)return;let i=!1;for(const c of BW){const f=fu(e.getWithExplicit(c),t.getWithExplicit(c),c,"legend",(h,p)=>{switch(c){case"symbolType":return Q2e(h,p);case"title":return pU(h,p);case"type":return i=!0,Qr("symbol")}return Lx(h,p,c,"legend")});e.setWithExplicit(c,f)}return i&&((s=(o=e.implicit)==null?void 0:o.encode)!=null&&s.gradient&&Ry(e.implicit,["encode","gradient"]),(u=(a=e.explicit)==null?void 0:a.encode)!=null&&u.gradient&&Ry(e.explicit,["encode","gradient"])),e}function Q2e(e,t){return t.value==="circle"?t:e}function K2e(e,t,n,r){var i,o;e.encode??(e.encode={}),(i=e.encode)[t]??(i[t]={}),(o=e.encode[t]).update??(o.update={}),e.encode[t].update[n]=r}function GW(e){const t=e.component.legends,n={};for(const i of oe(t)){const o=e.getScaleComponent(i),s=xt(o.get("domains"));if(n[s])for(const a of n[s])HW(a,t[i])||n[s].push(t[i]);else n[s]=[t[i].clone()]}return Rn(n).flat().map(i=>J2e(i,e.config)).filter(i=>i!==void 0)}function J2e(e,t){var s,a,u;const{disable:n,labelExpr:r,selections:i,...o}=e.combine();if(!n){if(t.aria===!1&&o.aria==null&&(o.aria=!1),(s=o.encode)!=null&&s.symbols){const c=o.encode.symbols.update;c.fill&&c.fill.value!=="transparent"&&!c.stroke&&!o.stroke&&(c.stroke={value:"transparent"});for(const f of Dj)o[f]&&delete c[f]}if(o.title||delete o.title,r!==void 0){let c=r;(u=(a=o.encode)==null?void 0:a.labels)!=null&&u.update&&Fe(o.encode.labels.update.text)&&(c=Rl(r,"datum.label",o.encode.labels.update.text.signal)),K2e(o,"labels","text",{signal:c})}return o}}function Z2e(e){return bd(e)||C3(e)?ewe(e):VW(e)}function ewe(e){return e.children.reduce((t,n)=>t.concat(n.assembleProjections()),VW(e))}function VW(e){const t=e.component.projection;if(!t||t.merged)return[];const n=t.combine(),{name:r}=n;if(t.data){const i={signal:`[${t.size.map(s=>s.signal).join(", ")}]`},o=t.data.reduce((s,a)=>{const u=Fe(a)?a.signal:`data('${e.lookupDataSource(a)}')`;return Qe(s,u)||s.push(u),s},[]);if(o.length<=0)throw new Error("Projection's fit didn't find any data sources");return[{name:r,size:i,fit:{signal:o.length>1?`[${o.join(", ")}]`:o[0]},...n}]}else return[{name:r,translate:{signal:"[width / 2, height / 2]"},...n}]}const twe=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class YW extends aa{constructor(t,n,r,i){super({...n},{name:t}),this.specifiedProjection=n,this.size=r,this.data=i,this.merged=!1}get isFit(){return!!this.data}}function XW(e){e.component.projection=Pt(e)?nwe(e):owe(e)}function nwe(e){if(e.hasProjection){const t=kn(e.specifiedProjection),n=!(t&&(t.scale!=null||t.translate!=null)),r=n?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:void 0,i=n?rwe(e):void 0,o=new YW(e.projectionName(!0),{...kn(e.config.projection),...t},r,i);return o.get("type")||o.set("type","equalEarth",!1),o}}function rwe(e){const t=[],{encoding:n}=e;for(const r of[[xo,vo],[Ni,wo]])(sn(n[r[0]])||sn(n[r[1]]))&&t.push({signal:e.getName(`geojson_${t.length}`)});return e.channelHasField(jr)&&e.typedFieldDef(jr).type===yd&&t.push({signal:e.getName(`geojson_${t.length}`)}),t.length===0&&t.push(e.requestDataName(Lt.Main)),t}function iwe(e,t){const n=uF(twe,i=>!!(!Ee(e.explicit,i)&&!Ee(t.explicit,i)||Ee(e.explicit,i)&&Ee(t.explicit,i)&&ti(e.get(i),t.get(i))));if(ti(e.size,t.size)){if(n)return e;if(ti(e.explicit,{}))return t;if(ti(t.explicit,{}))return e}return null}function owe(e){if(e.children.length===0)return;let t;for(const r of e.children)XW(r);const n=uF(e.children,r=>{const i=r.component.projection;if(i)if(t){const o=iwe(t,i);return o&&(t=o),!!o}else return t=i,!0;else return!0});if(t&&n){const r=e.projectionName(!0),i=new YW(r,t.specifiedProjection,t.size,Ue(t.data));for(const o of e.children){const s=o.component.projection;s&&(s.isFit&&i.data.push(...o.component.projection.data),o.renameProjection(s.get("name"),r),s.merged=!0)}return i}}function swe(e,t,n,r){if(Ug(t,n)){const i=Pt(e)?e.axis(n)??e.legend(n)??{}:{},o=ge(t,{expr:"datum"}),s=ge(t,{expr:"datum",binSuffix:"end"});return{formulaAs:ge(t,{binSuffix:"range",forAs:!0}),formula:Lg(o,s,i.format,i.formatType,r)}}return{}}function QW(e,t){return`${sU(e)}_${t}`}function awe(e,t){return{signal:e.getName(`${t}_bins`),extentSignal:e.getName(`${t}_extent`)}}function E3(e,t,n){const r=Mx(n,void 0)??{},i=QW(r,t);return e.getName(`${i}_bins`)}function uwe(e){return"as"in e}function DO(e,t,n){let r,i;uwe(e)?r=ve(e.as)?[e.as,`${e.as}_end`]:[e.as[0],e.as[1]]:r=[ge(e,{forAs:!0}),ge(e,{binSuffix:"end",forAs:!0})];const o={...Mx(t,void 0)},s=QW(o,e.field),{signal:a,extentSignal:u}=awe(n,s);if(wx(o.extent)){const f=o.extent;i=$W(n,f.param,f),delete o.extent}const c={bin:o,field:e.field,as:[r],...a?{signal:a}:{},...u?{extentSignal:u}:{},...i?{span:i}:{}};return{key:s,binComponent:c}}class qo extends mt{clone(){return new qo(null,Ue(this.bins))}constructor(t,n){super(t),this.bins=n}static makeFromEncoding(t,n){const r=n.reduceFieldDef((i,o,s)=>{if(xr(o)&&St(o.bin)){const{key:a,binComponent:u}=DO(o,o.bin,n);i[a]={...u,...i[a],...swe(n,o,s,n.config)}}return i},{});return vt(r)?null:new qo(t,r)}static makeFromTransform(t,n,r){const{key:i,binComponent:o}=DO(n,n.bin,r);return new qo(t,{[i]:o})}merge(t,n){for(const r of oe(t.bins))r in this.bins?(n(t.bins[r].signal,this.bins[r].signal),this.bins[r].as=Lo([...this.bins[r].as,...t.bins[r].as],Ke)):this.bins[r]=t.bins[r];for(const r of t.children)t.removeChild(r),r.parent=this;t.remove()}producedFields(){return new Set(Rn(this.bins).map(t=>t.as).flat(2))}dependentFields(){return new Set(Rn(this.bins).map(t=>t.field))}hash(){return`Bin ${Ke(this.bins)}`}assemble(){return Rn(this.bins).flatMap(t=>{const n=[],[r,...i]=t.as,{extent:o,...s}=t.bin,a={type:"bin",field:Ti(t.field),as:r,signal:t.signal,...wx(o)?{extent:null}:{extent:o},...t.span?{span:{signal:`span(${t.span})`}}:{},...s};!o&&t.extentSignal&&(n.push({type:"extent",field:Ti(t.field),signal:t.extentSignal}),a.extent={signal:t.extentSignal}),n.push(a);for(const u of i)for(let c=0;c<2;c++)n.push({type:"formula",expr:ge({field:r[c]},{expr:"datum"}),as:u[c]});return t.formula&&n.push({type:"formula",expr:t.formula,as:t.formulaAs}),n})}}function lwe(e,t,n,r){var o;const i=Pt(r)?r.encoding[cs(t)]:void 0;if(xr(n)&&Pt(r)&&ej(n,i,r.markDef,r.config)){e.add(ge(n,{})),e.add(ge(n,{suffix:"end"}));const{mark:s,markDef:a,config:u}=r,c=cu({fieldDef:n,markDef:a,config:u});Gp(s)&&c!==.5&&Xt(t)&&(e.add(ge(n,{suffix:zx})),e.add(ge(n,{suffix:Ix}))),n.bin&&Ug(n,t)&&e.add(ge(n,{binSuffix:"range"}))}else if(KB(t)){const s=QB(t);e.add(r.getName(s))}else e.add(ge(n));return ac(n)&&Ume((o=n.scale)==null?void 0:o.range)&&e.add(n.scale.range.field),e}function cwe(e,t){for(const n of oe(t)){const r=t[n];for(const i of oe(r))n in e?e[n][i]=new Set([...e[n][i]??[],...r[i]]):e[n]={[i]:r[i]}}}class io extends mt{clone(){return new io(null,new Set(this.dimensions),Ue(this.measures))}constructor(t,n,r){super(t),this.dimensions=n,this.measures=r}get groupBy(){return this.dimensions}static makeFromEncoding(t,n){let r=!1;n.forEachFieldDef(s=>{s.aggregate&&(r=!0)});const i={},o=new Set;return!r||(n.forEachFieldDef((s,a)=>{const{aggregate:u,field:c}=s;if(u)if(u==="count")i["*"]??(i["*"]={}),i["*"].count=new Set([ge(s,{forAs:!0})]);else{if(Qs(u)||Cu(u)){const f=Qs(u)?"argmin":"argmax",h=u[f];i[h]??(i[h]={}),i[h][f]=new Set([ge({op:f,field:h},{forAs:!0})])}else i[c]??(i[c]={}),i[c][u]=new Set([ge(s,{forAs:!0})]);fs(a)&&n.scaleDomain(a)==="unaggregated"&&(i[c]??(i[c]={}),i[c].min=new Set([ge({field:c,aggregate:"min"},{forAs:!0})]),i[c].max=new Set([ge({field:c,aggregate:"max"},{forAs:!0})]))}else lwe(o,a,s,n)}),o.size+oe(i).length===0)?null:new io(t,o,i)}static makeFromTransform(t,n){var r;const i=new Set,o={};for(const s of n.aggregate){const{op:a,field:u,as:c}=s;a&&(a==="count"?(o["*"]??(o["*"]={}),o["*"].count=new Set([c||ge(s,{forAs:!0})])):(o[u]??(o[u]={}),(r=o[u])[a]??(r[a]=new Set),o[u][a].add(c||ge(s,{forAs:!0}))))}for(const s of n.groupby??[])i.add(s);return i.size+oe(o).length===0?null:new io(t,i,o)}merge(t){return jB(this.dimensions,t.dimensions)?(cwe(this.measures,t.measures),!0):(dme("different dimensions, cannot merge"),!1)}addDimensions(t){t.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...oe(this.measures)])}producedFields(){const t=new Set;for(const n of oe(this.measures))for(const r of oe(this.measures[n])){const i=this.measures[n][r];i.size===0?t.add(`${r}_${n}`):i.forEach(t.add,t)}return t}hash(){return`Aggregate ${Ke({dimensions:this.dimensions,measures:this.measures})}`}assemble(){const t=[],n=[],r=[];for(const o of oe(this.measures))for(const s of oe(this.measures[o]))for(const a of this.measures[o][s])r.push(a),t.push(s),n.push(o==="*"?null:Ti(o));return{type:"aggregate",groupby:[...this.dimensions].map(Ti),ops:t,fields:n,as:r}}}class wd extends mt{constructor(t,n,r,i){super(t),this.model=n,this.name=r,this.data=i;for(const o of _i){const s=n.facet[o];if(s){const{bin:a,sort:u}=s;this[o]={name:n.getName(`${o}_domain`),fields:[ge(s),...St(a)?[ge(s,{binSuffix:"end"})]:[]],...qs(u)?{sortField:u}:ne(u)?{sortIndexField:Yf(s,o)}:{}}}}this.childModel=n.child}hash(){let t="Facet";for(const n of _i)this[n]&&(t+=` ${n.charAt(0)}:${Ke(this[n])}`);return t}get fields(){var n;const t=[];for(const r of _i)(n=this[r])!=null&&n.fields&&t.push(...this[r].fields);return t}dependentFields(){const t=new Set(this.fields);for(const n of _i)this[n]&&(this[n].sortField&&t.add(this[n].sortField.field),this[n].sortIndexField&&t.add(this[n].sortIndexField));return t}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){const t={};for(const n of oa){const r=this.childModel.component.scales[n];if(r&&!r.merged){const i=r.get("type"),o=r.get("range");if(En(i)&&ic(o)){const s=Yx(this.childModel,n),a=A3(s);a?t[n]=a:ue(bF(n))}}}return t}assembleRowColumnHeaderData(t,n,r){const i={row:"y",column:"x",facet:void 0}[t],o=[],s=[],a=[];i&&r&&r[i]&&(n?(o.push(`distinct_${r[i]}`),s.push("max")):(o.push(r[i]),s.push("distinct")),a.push(`distinct_${r[i]}`));const{sortField:u,sortIndexField:c}=this[t];if(u){const{op:f=$x,field:h}=u;o.push(h),s.push(f),a.push(ge(u,{forAs:!0}))}else c&&(o.push(c),s.push("max"),a.push(c));return{name:this[t].name,source:n??this.data,transform:[{type:"aggregate",groupby:this[t].fields,...o.length?{fields:o,ops:s,as:a}:{}}]}}assembleFacetHeaderData(t){var u;const{columns:n}=this.model.layout,{layoutHeaders:r}=this.model.component,i=[],o={};for(const c of y3){for(const f of v3){const h=(r[c]&&r[c][f])??[];for(const p of h)if(((u=p.axes)==null?void 0:u.length)>0){o[c]=!0;break}}if(o[c]){const f=`length(data("${this.facet.name}"))`,h=c==="row"?n?{signal:`ceil(${f} / ${n})`}:1:n?{signal:`min(${f}, ${n})`}:{signal:f};i.push({name:`${this.facet.name}_${c}`,transform:[{type:"sequence",start:0,stop:h}]})}}const{row:s,column:a}=o;return(s||a)&&i.unshift(this.assembleRowColumnHeaderData("facet",null,t)),i}assemble(){const t=[];let n=null;const r=this.getChildIndependentFieldsWithStep(),{column:i,row:o,facet:s}=this;if(i&&o&&(r.x||r.y)){n=`cross_${this.column.name}_${this.row.name}`;const a=[].concat(r.x??[],r.y??[]),u=a.map(()=>"distinct");t.push({name:n,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:a,ops:u}]})}for(const a of[Ws,js])this[a]&&t.push(this.assembleRowColumnHeaderData(a,n,r));if(s){const a=this.assembleFacetHeaderData(r);a&&t.push(...a)}return t}}function MO(e){return e.startsWith("'")&&e.endsWith("'")||e.startsWith('"')&&e.endsWith('"')?e.slice(1,-1):e}function fwe(e,t){const n=fF(e);if(t==="number")return`toNumber(${n})`;if(t==="boolean")return`toBoolean(${n})`;if(t==="string")return`toString(${n})`;if(t==="date")return`toDate(${n})`;if(t==="flatten")return n;if(t.startsWith("date:")){const r=MO(t.slice(5,t.length));return`timeParse(${n},'${r}')`}else if(t.startsWith("utc:")){const r=MO(t.slice(4,t.length));return`utcParse(${n},'${r}')`}else return ue(E0e(t)),null}function dwe(e){const t={};return g1(e.filter,n=>{if(MU(n)){let r=null;$F(n)?r=Zr(n.equal):DF(n)?r=Zr(n.lte):FF(n)?r=Zr(n.lt):MF(n)?r=Zr(n.gt):TF(n)?r=Zr(n.gte):NF(n)?r=n.range[0]:RF(n)&&(r=(n.oneOf??n.in)[0]),r&&(oc(r)?t[n.field]="date":at(r)?t[n.field]="number":ve(r)&&(t[n.field]="string")),n.timeUnit&&(t[n.field]="date")}}),t}function hwe(e){const t={};function n(r){qf(r)?t[r.field]="date":r.type==="quantitative"&&Xge(r.aggregate)?t[r.field]="number":zf(r.field)>1?r.field in t||(t[r.field]="flatten"):ac(r)&&qs(r.sort)&&zf(r.sort.field)>1&&(r.sort.field in t||(t[r.sort.field]="flatten"))}if((Pt(e)||oi(e))&&e.forEachFieldDef((r,i)=>{if(xr(r))n(r);else{const o=nc(i),s=e.fieldDef(o);n({...r,type:s.type})}}),Pt(e)){const{mark:r,markDef:i,encoding:o}=e;if(ku(r)&&!e.encoding.order){const s=i.orient==="horizontal"?"y":"x",a=o[s];ce(a)&&a.type==="quantitative"&&!(a.field in t)&&(t[a.field]="number")}}return t}function pwe(e){const t={};if(Pt(e)&&e.component.selection)for(const n of oe(e.component.selection)){const r=e.component.selection[n];for(const i of r.project.items)!i.channel&&zf(i.field)>1&&(t[i.field]="flatten")}return t}class Yn extends mt{clone(){return new Yn(null,Ue(this._parse))}constructor(t,n){super(t),this._parse=n}hash(){return`Parse ${Ke(this._parse)}`}static makeExplicit(t,n,r){var s;let i={};const o=n.data;return!Ka(o)&&((s=o==null?void 0:o.format)!=null&&s.parse)&&(i=o.format.parse),this.makeWithAncestors(t,i,{},r)}static makeWithAncestors(t,n,r,i){for(const a of oe(r)){const u=i.getWithExplicit(a);u.value!==void 0&&(u.explicit||u.value===r[a]||u.value==="derived"||r[a]==="flatten"?delete r[a]:ue(R6(a,r[a],u.value)))}for(const a of oe(n)){const u=i.get(a);u!==void 0&&(u===n[a]?delete n[a]:ue(R6(a,n[a],u)))}const o=new aa(n,r);i.copyAll(o);const s={};for(const a of oe(o.combine())){const u=o.get(a);u!==null&&(s[a]=u)}return oe(s).length===0||i.parseNothing?null:new Yn(t,s)}get parse(){return this._parse}merge(t){this._parse={...this._parse,...t.parse},t.remove()}assembleFormatParse(){const t={};for(const n of oe(this._parse)){const r=this._parse[n];zf(n)===1&&(t[n]=r)}return t}producedFields(){return new Set(oe(this._parse))}dependentFields(){return new Set(oe(this._parse))}assembleTransforms(t=!1){return oe(this._parse).filter(n=>t?zf(n)>1:!0).map(n=>{const r=fwe(n,this._parse[n]);return r?{type:"formula",expr:r,as:gd(n)}:null}).filter(n=>n!==null)}}class du extends mt{clone(){return new du(null)}constructor(t){super(t)}dependentFields(){return new Set}producedFields(){return new Set([fo])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:fo}}}class Vg extends mt{clone(){return new Vg(null,this.params)}constructor(t,n){super(t),this.params=n}dependentFields(){return new Set}producedFields(){}hash(){return`Graticule ${Ke(this.params)}`}assemble(){return{type:"graticule",...this.params===!0?{}:this.params}}}class Yg extends mt{clone(){return new Yg(null,this.params)}constructor(t,n){super(t),this.params=n}dependentFields(){return new Set}producedFields(){return new Set([this.params.as??"data"])}hash(){return`Hash ${Ke(this.params)}`}assemble(){return{type:"sequence",...this.params}}}class Hl extends mt{constructor(t){super(null),t??(t={name:"source"});let n;if(Ka(t)||(n=t.format?{...Pr(t.format,["parse"])}:{}),Vp(t))this._data={values:t.values};else if(Hf(t)){if(this._data={url:t.url},!n.type){let r=/(?:\.([^.]+))?$/.exec(t.url)[1];Qe(["json","csv","tsv","dsv","topojson"],r)||(r="json"),n.type=r}}else Yj(t)?this._data={values:[{type:"Sphere"}]}:(Gj(t)||Ka(t))&&(this._data={});this._generator=Ka(t),t.name&&(this._name=t.name),n&&!vt(n)&&(this._data.format=n)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(t){this._name=t}set parent(t){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return{name:this._name,...this._data,transform:[]}}}var TO=function(e,t,n,r,i){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?i.call(e,n):i?i.value=n:t.set(e,n),n},gwe=function(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)},ip;function b3(e){return e instanceof Hl||e instanceof Vg||e instanceof Yg}class S3{constructor(){ip.set(this,void 0),TO(this,ip,!1,"f")}setModified(){TO(this,ip,!0,"f")}get modifiedFlag(){return gwe(this,ip,"f")}}ip=new WeakMap;class lc extends S3{getNodeDepths(t,n,r){r.set(t,n);for(const i of t.children)this.getNodeDepths(i,n+1,r);return r}optimize(t){const r=[...this.getNodeDepths(t,0,new Map).entries()].sort((i,o)=>o[1]-i[1]);for(const i of r)this.run(i[0]);return this.modifiedFlag}}class _3 extends S3{optimize(t){this.run(t);for(const n of t.children)this.optimize(n);return this.modifiedFlag}}class mwe extends _3{mergeNodes(t,n){const r=n.shift();for(const i of n)t.removeChild(i),i.parent=r,i.remove()}run(t){const n=t.children.map(i=>i.hash()),r={};for(let i=0;i<n.length;i++)r[n[i]]===void 0?r[n[i]]=[t.children[i]]:r[n[i]].push(t.children[i]);for(const i of oe(r))r[i].length>1&&(this.setModified(),this.mergeNodes(t,r[i]))}}class ywe extends _3{constructor(t){super(),this.requiresSelectionId=t&&h3(t)}run(t){t instanceof du&&(this.requiresSelectionId&&(b3(t.parent)||t.parent instanceof io||t.parent instanceof Yn)||(this.setModified(),t.remove()))}}class vwe extends S3{optimize(t){return this.run(t,new Set),this.modifiedFlag}run(t,n){let r=new Set;t instanceof jo&&(r=t.producedFields(),lF(r,n)&&(this.setModified(),t.removeFormulas(n),t.producedFields.length===0&&t.remove()));for(const i of t.children)this.run(i,new Set([...n,...r]))}}class xwe extends _3{constructor(){super()}run(t){t instanceof Lr&&!t.isRequired()&&(this.setModified(),t.remove())}}class wwe extends lc{run(t){if(!b3(t)&&!(t.numChildren()>1)){for(const n of t.children)if(n instanceof Yn)if(t instanceof Yn)this.setModified(),t.merge(n);else{if(cF(t.producedFields(),n.dependentFields()))continue;this.setModified(),n.swapWithParent()}}}}class Ewe extends lc{run(t){const n=[...t.children],r=t.children.filter(i=>i instanceof Yn);if(t.numChildren()>1&&r.length>=1){const i={},o=new Set;for(const s of r){const a=s.parse;for(const u of oe(a))u in i?i[u]!==a[u]&&o.add(u):i[u]=a[u]}for(const s of o)delete i[s];if(!vt(i)){this.setModified();const s=new Yn(t,i);for(const a of n){if(a instanceof Yn)for(const u of oe(i))delete a.parse[u];t.removeChild(a),a.parent=s,a instanceof Yn&&oe(a.parse).length===0&&a.remove()}}}}}class bwe extends lc{run(t){t instanceof Lr||t.numChildren()>0||t instanceof wd||t instanceof Hl||(this.setModified(),t.remove())}}class Swe extends lc{run(t){const n=t.children.filter(i=>i instanceof jo),r=n.pop();for(const i of n)this.setModified(),r.merge(i)}}class _we extends lc{run(t){const n=t.children.filter(i=>i instanceof io),r={};for(const i of n){const o=Ke(i.groupBy);o in r||(r[o]=[]),r[o].push(i)}for(const i of oe(r)){const o=r[i];if(o.length>1){const s=o.pop();for(const a of o)s.merge(a)&&(t.removeChild(a),a.parent=s,a.remove(),this.setModified())}}}}class Awe extends lc{constructor(t){super(),this.model=t}run(t){const n=!(b3(t)||t instanceof xd||t instanceof Yn||t instanceof du),r=[],i=[];for(const o of t.children)o instanceof qo&&(n&&!cF(t.producedFields(),o.dependentFields())?r.push(o):i.push(o));if(r.length>0){const o=r.pop();for(const s of r)o.merge(s,this.model.renameSignal.bind(this.model));this.setModified(),t instanceof qo?t.merge(o,this.model.renameSignal.bind(this.model)):o.swapWithParent()}if(i.length>1){const o=i.pop();for(const s of i)o.merge(s,this.model.renameSignal.bind(this.model));this.setModified()}}}class Cwe extends lc{run(t){const n=[...t.children];if(!Lf(n,s=>s instanceof Lr)||t.numChildren()<=1)return;const i=[];let o;for(const s of n)if(s instanceof Lr){let a=s;for(;a.numChildren()===1;){const[u]=a.children;if(u instanceof Lr)a=u;else break}i.push(...a.children),o?(t.removeChild(s),s.parent=o.parent,o.parent.removeChild(o),o.parent=a,this.setModified()):o=a}else i.push(s);if(i.length){this.setModified();for(const s of i)s.parent.removeChild(s),s.parent=o}}}class cc extends mt{clone(){return new cc(null,Ue(this.transform))}constructor(t,n){super(t),this.transform=n}addDimensions(t){this.transform.groupby=Lo(this.transform.groupby.concat(t),n=>n)}dependentFields(){const t=new Set;return this.transform.groupby&&this.transform.groupby.forEach(t.add,t),this.transform.joinaggregate.map(n=>n.field).filter(n=>n!==void 0).forEach(t.add,t),t}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(t){return t.as??ge(t)}hash(){return`JoinAggregateTransform ${Ke(this.transform)}`}assemble(){const t=[],n=[],r=[];for(const o of this.transform.joinaggregate)n.push(o.op),r.push(this.getDefaultName(o)),t.push(o.field===void 0?null:o.field);const i=this.transform.groupby;return{type:"joinaggregate",as:r,ops:n,fields:t,...i!==void 0?{groupby:i}:{}}}}class Qf extends mt{clone(){return new Qf(null,{...this.filter})}constructor(t,n){super(t),this.filter=n}static make(t,n,r){const{config:i,markDef:o}=n,{marks:s,scales:a}=r;if(s==="include-invalid-values"&&a==="include-invalid-values")return null;const u=n.reduceFieldDef((c,f,h)=>{const p=fs(h)&&n.getScaleComponent(h);if(p){const m=p.get("type"),{aggregate:y}=f,v=UF({scaleChannel:h,markDef:o,config:i,scaleType:m,isCountAggregate:xx(y)});v!=="show"&&v!=="always-valid"&&(c[f.field]=f)}return c},{});return oe(u).length?new Qf(t,u):null}dependentFields(){return new Set(oe(this.filter))}producedFields(){return new Set}hash(){return`FilterInvalid ${Ke(this.filter)}`}assemble(){const t=oe(this.filter).reduce((n,r)=>{const i=this.filter[r],o=ge(i,{expr:"datum"});return i!==null&&(i.type==="temporal"?n.push(`(isDate(${o}) || (${rA(o)}))`):i.type==="quantitative"&&n.push(rA(o))),n},[]);return t.length>0?{type:"filter",expr:t.join(" && ")}:null}}function rA(e){return`isValid(${e}) && isFinite(+${e})`}function kwe(e){return e.stack.stackBy.reduce((t,n)=>{const r=n.fieldDef,i=ge(r);return i&&t.push(i),t},[])}function $we(e){return ne(e)&&e.every(t=>ve(t))&&e.length>1}class Gs extends mt{clone(){return new Gs(null,Ue(this._stack))}constructor(t,n){super(t),this._stack=n}static makeFromTransform(t,n){const{stack:r,groupby:i,as:o,offset:s="zero"}=n,a=[],u=[];if(n.sort!==void 0)for(const h of n.sort)a.push(h.field),u.push(Yt(h.order,"ascending"));const c={field:a,order:u};let f;return $we(o)?f=o:ve(o)?f=[o,`${o}_end`]:f=[`${n.stack}_start`,`${n.stack}_end`],new Gs(t,{dimensionFieldDefs:[],stackField:r,groupby:i,offset:s,sort:c,facetby:[],as:f})}static makeFromEncoding(t,n){const r=n.stack,{encoding:i}=n;if(!r)return null;const{groupbyChannels:o,fieldChannel:s,offset:a,impute:u}=r,c=o.map(m=>{const y=i[m];return co(y)}).filter(m=>!!m),f=kwe(n),h=n.encoding.order;let p;if(ne(h)||ce(h))p=fU(h);else{const m=tj(h)?h.sort:s==="y"?"descending":"ascending";p=f.reduce((y,v)=>(y.field.includes(v)||(y.field.push(v),y.order.push(m)),y),{field:[],order:[]})}return new Gs(t,{dimensionFieldDefs:c,stackField:n.vgField(s),facetby:[],stackby:f,sort:p,offset:a,impute:u,as:[n.vgField(s,{suffix:"start",forAs:!0}),n.vgField(s,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(t){this._stack.facetby.push(...t)}dependentFields(){const t=new Set;return t.add(this._stack.stackField),this.getGroupbyFields().forEach(t.add,t),this._stack.facetby.forEach(t.add,t),this._stack.sort.field.forEach(t.add,t),t}producedFields(){return new Set(this._stack.as)}hash(){return`Stack ${Ke(this._stack)}`}getGroupbyFields(){const{dimensionFieldDefs:t,impute:n,groupby:r}=this._stack;return t.length>0?t.map(i=>i.bin?n?[ge(i,{binSuffix:"mid"})]:[ge(i,{}),ge(i,{binSuffix:"end"})]:[ge(i)]).flat():r??[]}assemble(){const t=[],{facetby:n,dimensionFieldDefs:r,stackField:i,stackby:o,sort:s,offset:a,impute:u,as:c}=this._stack;if(u)for(const f of r){const{bandPosition:h=.5,bin:p}=f;if(p){const m=ge(f,{expr:"datum"}),y=ge(f,{expr:"datum",binSuffix:"end"});t.push({type:"formula",expr:`${rA(m)} ? ${h}*${m}+${1-h}*${y} : ${m}`,as:ge(f,{binSuffix:"mid",forAs:!0})})}t.push({type:"impute",field:i,groupby:[...o,...n],key:ge(f,{binSuffix:"mid"}),method:"value",value:0})}return t.push({type:"stack",groupby:[...this.getGroupbyFields(),...n],field:i,sort:s,as:c,offset:a}),t}}class Ed extends mt{clone(){return new Ed(null,Ue(this.transform))}constructor(t,n){super(t),this.transform=n}addDimensions(t){this.transform.groupby=Lo(this.transform.groupby.concat(t),n=>n)}dependentFields(){const t=new Set;return(this.transform.groupby??[]).forEach(t.add,t),(this.transform.sort??[]).forEach(n=>t.add(n.field)),this.transform.window.map(n=>n.field).filter(n=>n!==void 0).forEach(t.add,t),t}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(t){return t.as??ge(t)}hash(){return`WindowTransform ${Ke(this.transform)}`}assemble(){const t=[],n=[],r=[],i=[];for(const h of this.transform.window)n.push(h.op),r.push(this.getDefaultName(h)),i.push(h.param===void 0?null:h.param),t.push(h.field===void 0?null:h.field);const o=this.transform.frame,s=this.transform.groupby;if(o&&o[0]===null&&o[1]===null&&n.every(h=>wF(h)))return{type:"joinaggregate",as:r,ops:n,fields:t,...s!==void 0?{groupby:s}:{}};const a=[],u=[];if(this.transform.sort!==void 0)for(const h of this.transform.sort)a.push(h.field),u.push(h.order??"ascending");const c={field:a,order:u},f=this.transform.ignorePeers;return{type:"window",params:i,as:r,ops:n,fields:t,sort:c,...f!==void 0?{ignorePeers:f}:{},...s!==void 0?{groupby:s}:{},...o!==void 0?{frame:o}:{}}}}function Fwe(e){function t(n){if(!(n instanceof wd)){const r=n.clone();if(r instanceof Lr){const i=oA+r.getSource();r.setSource(i),e.model.component.data.outputNodes[i]=r}else(r instanceof io||r instanceof Gs||r instanceof Ed||r instanceof cc)&&r.addDimensions(e.fields);for(const i of n.children.flatMap(t))i.parent=r;return[r]}return n.children.flatMap(t)}return t}function iA(e){if(e instanceof wd)if(e.numChildren()===1&&!(e.children[0]instanceof Lr)){const t=e.children[0];(t instanceof io||t instanceof Gs||t instanceof Ed||t instanceof cc)&&t.addDimensions(e.fields),t.swapWithParent(),iA(e)}else{const t=e.model.component.data.main;KW(t);const n=Fwe(e),r=e.children.map(n).flat();for(const i of r)i.parent=t}else e.children.map(iA)}function KW(e){if(e instanceof Lr&&e.type===Lt.Main&&e.numChildren()===1){const t=e.children[0];t instanceof wd||(t.swapWithParent(),KW(e))}}const oA="scale_",Pm=5;function sA(e){for(const t of e){for(const n of t.children)if(n.parent!==t)return!1;if(!sA(t.children))return!1}return!0}function qi(e,t){let n=!1;for(const r of t)n=e.optimize(r)||n;return n}function NO(e,t,n){let r=e.sources,i=!1;return i=qi(new xwe,r)||i,i=qi(new ywe(t),r)||i,r=r.filter(o=>o.numChildren()>0),i=qi(new bwe,r)||i,r=r.filter(o=>o.numChildren()>0),n||(i=qi(new wwe,r)||i,i=qi(new Awe(t),r)||i,i=qi(new vwe,r)||i,i=qi(new Ewe,r)||i,i=qi(new _we,r)||i,i=qi(new Swe,r)||i,i=qi(new mwe,r)||i,i=qi(new Cwe,r)||i),e.sources=r,i}function Dwe(e,t){sA(e.sources);let n=0,r=0;for(let i=0;i<Pm&&NO(e,t,!0);i++)n++;e.sources.map(iA);for(let i=0;i<Pm&&NO(e,t,!1);i++)r++;sA(e.sources),Math.max(n,r)===Pm&&ue(`Maximum optimization runs(${Pm}) reached.`)}class hn{constructor(t){Object.defineProperty(this,"signal",{enumerable:!0,get:t})}static fromName(t,n){return new hn(()=>t(n))}}function JW(e){Pt(e)?Mwe(e):Twe(e)}function Mwe(e){const t=e.component.scales;for(const n of oe(t)){const r=Rwe(e,n);if(t[n].setWithExplicit("domains",r),Pwe(e,n),e.component.data.isFaceted){let o=e;for(;!oi(o)&&o.parent;)o=o.parent;if(o.component.resolve.scale[n]==="shared")for(const a of r.value)zs(a)&&(a.data=oA+a.data.replace(oA,""))}}}function Twe(e){for(const n of e.children)JW(n);const t=e.component.scales;for(const n of oe(t)){let r,i=null;for(const o of e.children){const s=o.component.scales[n];if(s){r===void 0?r=s.getWithExplicit("domains"):r=fu(r,s.getWithExplicit("domains"),"domains","scale",aA);const a=s.get("selectionExtent");i&&a&&i.param!==a.param&&ue(p0e),i=a}}t[n].setWithExplicit("domains",r),i&&t[n].set("selectionExtent",i,!0)}}function Nwe(e,t,n,r){if(e==="unaggregated"){const{valid:i,reason:o}=RO(t,n);if(!i){ue(o);return}}else if(e===void 0&&r.useUnaggregatedDomain){const{valid:i}=RO(t,n);if(i)return"unaggregated"}return e}function Rwe(e,t){const n=e.getScaleComponent(t).get("type"),{encoding:r}=e,i=Nwe(e.scaleDomain(t),e.typedFieldDef(t),n,e.config.scale);return i!==e.scaleDomain(t)&&(e.specifiedScales[t]={...e.specifiedScales[t],domain:i}),t==="x"&&sn(r.x2)?sn(r.x)?fu(Da(n,i,e,"x"),Da(n,i,e,"x2"),"domain","scale",aA):Da(n,i,e,"x2"):t==="y"&&sn(r.y2)?sn(r.y)?fu(Da(n,i,e,"y"),Da(n,i,e,"y2"),"domain","scale",aA):Da(n,i,e,"y2"):Da(n,i,e,t)}function Owe(e,t,n){return e.map(r=>({signal:`{data: ${Tx(r,{timeUnit:n,type:t})}}`}))}function Ab(e,t,n){var i;const r=(i=wn(n))==null?void 0:i.unit;return t==="temporal"||r?Owe(e,t,r):[e]}function Da(e,t,n,r){const{encoding:i,markDef:o,mark:s,config:a,stack:u}=n,c=sn(i[r]),{type:f}=c,h=c.timeUnit,p=vve({invalid:Ko("invalid",o,a),isPath:ku(s)});if(Bme(t)){const v=Da(e,void 0,n,r),w=Ab(t.unionWith,f,h);return To([...w,...v.value])}else{if(Fe(t))return To([t]);if(t&&t!=="unaggregated"&&!zU(t))return To(Ab(t,f,h))}if(u&&r===u.fieldChannel){if(u.offset==="normalize")return Qr([[0,1]]);const v=n.requestDataName(p);return Qr([{data:v,field:n.vgField(r,{suffix:"start"})},{data:v,field:n.vgField(r,{suffix:"end"})}])}const m=fs(r)&&ce(c)?Lwe(n,r,e):void 0;if(ds(c)){const v=Ab([c.datum],f,h);return Qr(v)}const y=c;if(t==="unaggregated"){const{field:v}=c;return Qr([{data:n.requestDataName(p),field:ge({field:v,aggregate:"min"})},{data:n.requestDataName(p),field:ge({field:v,aggregate:"max"})}])}else if(St(y.bin)){if(En(e))return Qr(e==="bin-ordinal"?[]:[{data:qp(m)?n.requestDataName(p):n.requestDataName(Lt.Raw),field:n.vgField(r,Ug(y,r)?{binSuffix:"range"}:{}),sort:m===!0||!ye(m)?{field:n.vgField(r,{}),op:"min"}:m}]);{const{bin:v}=y;if(St(v)){const w=E3(n,y.field,v);return Qr([new hn(()=>{const E=n.getSignalName(w);return`[${E}.start, ${E}.stop]`})])}else return Qr([{data:n.requestDataName(p),field:n.vgField(r,{})}])}}else if(y.timeUnit&&Qe(["time","utc"],e)){const v=i[cs(r)];if(ej(y,v,o,a)){const w=n.requestDataName(p),E=cu({fieldDef:y,fieldDef2:v,markDef:o,config:a}),S=Gp(s)&&E!==.5&&Xt(r);return Qr([{data:w,field:n.vgField(r,S?{suffix:zx}:{})},{data:w,field:n.vgField(r,{suffix:S?Ix:"end"})}])}}return Qr(m?[{data:qp(m)?n.requestDataName(p):n.requestDataName(Lt.Raw),field:n.vgField(r),sort:m}]:[{data:n.requestDataName(p),field:n.vgField(r)}])}function Cb(e,t){const{op:n,field:r,order:i}=e;return{op:n??(t?"sum":$x),...r?{field:Ti(r)}:{},...i?{order:i}:{}}}function Pwe(e,t){var a;const n=e.component.scales[t],r=e.specifiedScales[t].domain,i=(a=e.fieldDef(t))==null?void 0:a.bin,o=zU(r)?r:void 0,s=rc(i)&&wx(i.extent)?i.extent:void 0;(o||s)&&n.set("selectionExtent",o??s,!0)}function Lwe(e,t,n){if(!En(n))return;const r=e.fieldDef(t),i=r.sort;if(JU(i))return{op:"min",field:Yf(r,t),order:"ascending"};const{stack:o}=e,s=o?new Set([...o.groupbyFields,...o.stackBy.map(a=>a.fieldDef.field)]):void 0;if(qs(i)){const a=o&&!s.has(i.field);return Cb(i,a)}else if(v1e(i)){const{encoding:a,order:u}=i,c=e.fieldDef(a),{aggregate:f,field:h}=c,p=o&&!s.has(h);if(Qs(f)||Cu(f))return Cb({field:ge(c),order:u},p);if(wF(f)||!f)return Cb({op:f,field:h,order:u},p)}else{if(i==="descending")return{op:"min",field:e.vgField(t),order:"descending"};if(Qe(["ascending",void 0],i))return!0}}function RO(e,t){const{aggregate:n,type:r}=e;return n?ve(n)&&!Kge.has(n)?{valid:!1,reason:W0e(n)}:r==="quantitative"&&t==="log"?{valid:!1,reason:q0e(e)}:{valid:!0}:{valid:!1,reason:j0e(e)}}function aA(e,t,n,r){return e.explicit&&t.explicit&&ue(X0e(n,r,e.value,t.value)),{explicit:e.explicit,value:[...e.value,...t.value]}}function zwe(e){const t=Lo(e.map(s=>{if(zs(s)){const{sort:a,...u}=s;return u}return s}),Ke),n=Lo(e.map(s=>{if(zs(s)){const a=s.sort;return a!==void 0&&!qp(a)&&("op"in a&&a.op==="count"&&delete a.field,a.order==="ascending"&&delete a.order),a}}).filter(s=>s!==void 0),Ke);if(t.length===0)return;if(t.length===1){const s=e[0];if(zs(s)&&n.length>0){let a=n[0];if(n.length>1){ue(P6);const u=n.filter(c=>ye(c)&&"op"in c&&c.op!=="min");n.every(c=>ye(c)&&"op"in c)&&u.length===1?a=u[0]:a=!0}else if(ye(a)&&"field"in a){const u=a.field;s.field===u&&(a=a.order?{order:a.order}:!0)}return{...s,sort:a}}return s}const r=Lo(n.map(s=>qp(s)||!("op"in s)||ve(s.op)&&Ee(Vge,s.op)?s:(ue(K0e(s)),!0)),Ke);let i;r.length===1?i=r[0]:r.length>1&&(ue(P6),i=!0);const o=Lo(e.map(s=>zs(s)?s.data:null),s=>s);return o.length===1&&o[0]!==null?{data:o[0],fields:t.map(a=>a.field),...i?{sort:i}:{}}:{fields:t,...i?{sort:i}:{}}}function A3(e){if(zs(e)&&ve(e.field))return e.field;if(Jge(e)){let t;for(const n of e.fields)if(zs(n)&&ve(n.field)){if(!t)t=n.field;else if(t!==n.field)return ue(J0e),t}return ue(Z0e),t}else if(Zge(e)){ue(eme);const t=e.fields[0];return ve(t)?t:void 0}}function Yx(e,t){const r=e.component.scales[t].get("domains").map(i=>(zs(i)&&(i.data=e.lookupDataSource(i.data)),i));return zwe(r)}function ZW(e){return bd(e)||C3(e)?e.children.reduce((t,n)=>t.concat(ZW(n)),OO(e)):OO(e)}function OO(e){return oe(e.component.scales).reduce((t,n)=>{const r=e.component.scales[n];if(r.merged)return t;const i=r.combine(),{name:o,type:s,selectionExtent:a,domains:u,range:c,reverse:f,...h}=i,p=Iwe(i.range,o,n,e),m=Yx(e,n),y=a?Fve(e,a,r,m):null;return t.push({name:o,type:s,...m?{domain:m}:{},...y?{domainRaw:y}:{},range:p,...f!==void 0?{reverse:f}:{},...h}),t},[])}function Iwe(e,t,n,r){if(Xt(n)){if(ic(e))return{step:{signal:`${t}_step`}}}else if(ye(e)&&zs(e))return{...e,data:r.lookupDataSource(e.data)};return e}class eq extends aa{constructor(t,n){super({},{name:t}),this.merged=!1,this.setWithExplicit("type",n)}domainHasZero(){const t=this.get("type");if(Qe([$n.LOG,$n.TIME,$n.UTC],t))return"definitely-not";const n=this.get("zero");if(n===!0||n===void 0&&Qe([$n.LINEAR,$n.SQRT,$n.POW],t))return"definitely";const r=this.get("domains");if(r.length>0){let i=!1,o=!1,s=!1;for(const a of r){if(ne(a)){const u=a[0],c=a[a.length-1];if(at(u)&&at(c))if(u<=0&&c>=0){i=!0;continue}else{o=!0;continue}}s=!0}if(i)return"definitely";if(o&&!s)return"definitely-not"}return"maybe"}}const Bwe=["range","scheme"];function Uwe(e){const t=e.component.scales;for(const n of xF){const r=t[n];if(!r)continue;const i=jwe(n,e);r.setWithExplicit("range",i)}}function PO(e,t){const n=e.fieldDef(t);if(n!=null&&n.bin){const{bin:r,field:i}=n,o=Wr(t),s=e.getName(o);if(ye(r)&&r.binned&&r.step!==void 0)return new hn(()=>{const a=e.scaleName(t),u=`(domain("${a}")[1] - domain("${a}")[0]) / ${r.step}`;return`${e.getSignalName(s)} / (${u})`});if(St(r)){const a=E3(e,i,r);return new hn(()=>{const u=e.getSignalName(a),c=`(${u}.stop - ${u}.start) / ${u}.step`;return`${e.getSignalName(s)} / (${c})`})}}}function jwe(e,t){const n=t.specifiedScales[e],{size:r}=t,o=t.getScaleComponent(e).get("type");for(const h of Bwe)if(n[h]!==void 0){const p=I_(o,h),m=IU(e,h);if(!p)ue(vU(o,h,e));else if(m)ue(m);else switch(h){case"range":{const y=n.range;if(ne(y)){if(Xt(e))return To(y.map(v=>{if(v==="width"||v==="height"){const w=t.getName(v),E=t.getSignalName.bind(t);return hn.fromName(E,w)}return v}))}else if(ye(y))return To({data:t.requestDataName(Lt.Main),field:y.field,sort:{op:"min",field:t.vgField(e)}});return To(y)}case"scheme":return To(Wwe(n[h]))}}const s=e===Tt||e==="xOffset"?"width":"height",a=r[s];if(Zo(a)){if(Xt(e))if(En(o)){const h=nq(a,t,e);if(h)return To({step:h})}else ue(xU(s));else if(Rg(e)){const h=e===wu?"x":"y";if(t.getScaleComponent(h).get("type")==="band"){const y=rq(a,o);if(y)return To(y)}}}const{rangeMin:u,rangeMax:c}=n,f=qwe(e,t);return(u!==void 0||c!==void 0)&&I_(o,"rangeMin")&&ne(f)&&f.length===2?To([u??f[0],c??f[1]]):Qr(f)}function Wwe(e){return Ime(e)?{scheme:e.name,...Pr(e,["name"])}:{scheme:e}}function tq(e,t,n,{center:r}={}){const i=Wr(e),o=t.getName(i),s=t.getSignalName.bind(t);return e===Sn&&uo(n)?r?[hn.fromName(a=>`${s(a)}/2`,o),hn.fromName(a=>`-${s(a)}/2`,o)]:[hn.fromName(s,o),0]:r?[hn.fromName(a=>`-${s(a)}/2`,o),hn.fromName(a=>`${s(a)}/2`,o)]:[0,hn.fromName(s,o)]}function qwe(e,t){const{size:n,config:r,mark:i,encoding:o}=t,{type:s}=sn(o[e]),u=t.getScaleComponent(e).get("type"),{domain:c,domainMid:f}=t.specifiedScales[e];switch(e){case Tt:case Sn:{if(Qe(["point","band"],u)){const h=iq(e,n,r.view);if(Zo(h))return{step:nq(h,t,e)}}return tq(e,t,u)}case wu:case md:return Hwe(e,t,u);case ra:{const h=Ywe(i,r),p=Xwe(i,n,t,r);return Uf(u)?Vwe(h,p,Gwe(u,r,c,e)):[h,p]}case Oi:return[0,Math.PI*2];case tc:return[0,360];case yo:return[0,new hn(()=>{const h=t.getSignalName(oi(t.parent)?"child_width":"width"),p=t.getSignalName(oi(t.parent)?"child_height":"height");return`min(${h},${p})/2`})];case Eu:return{step:1e3/r.scale.framesPerSecond};case _u:return[r.scale.minStrokeWidth,r.scale.maxStrokeWidth];case Au:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case jr:return"symbol";case Ur:case us:case ls:return u==="ordinal"?s==="nominal"?"category":"ordinal":f!==void 0?"diverging":i==="rect"||i==="geoshape"?"heatmap":"ramp";case ia:case bu:case Su:return[r.scale.minOpacity,r.scale.maxOpacity]}}function nq(e,t,n){const{encoding:r}=t,i=t.getScaleComponent(n),o=gF(n),s=r[o];if(Tj({step:e,offsetIsDiscrete:je(s)&&NU(s.type)})==="offset"&&dj(r,o)){const u=t.getScaleComponent(o);let f=`domain('${t.scaleName(o)}').length`;if(u.get("type")==="band"){const p=u.get("paddingInner")??u.get("padding")??0,m=u.get("paddingOuter")??u.get("padding")??0;f=`bandspace(${f}, ${p}, ${m})`}const h=i.get("paddingInner")??i.get("padding");return{signal:`${e.step} * ${f} / (1-${r0e(h)})`}}else return e.step}function rq(e,t){if(Tj({step:e,offsetIsDiscrete:En(t)})==="offset")return{step:e.step}}function Hwe(e,t,n){const r=e===wu?"x":"y",i=t.getScaleComponent(r);if(!i)return tq(r,t,n,{center:!0});const o=i.get("type"),s=t.scaleName(r),{markDef:a,config:u}=t;if(o==="band"){const c=iq(r,t.size,t.config.view);if(Zo(c)){const f=rq(c,n);if(f)return f}return[0,{signal:`bandwidth('${s}')`}]}else{const c=t.encoding[r];if(ce(c)&&c.timeUnit){const f=FU(c.timeUnit,y=>`scale('${s}', ${y})`),h=t.config.scale.bandWithNestedOffsetPaddingInner,p=cu({fieldDef:c,markDef:a,config:u})-.5,m=p!==0?` + ${p}`:"";if(h){const y=Fe(h)?`${h.signal}/2`+m:`${h/2+p}`,v=Fe(h)?`(1 - ${h.signal}/2)`+m:`${1-h/2+p}`;return[{signal:`${y} * (${f})`},{signal:`${v} * (${f})`}]}return[0,{signal:f}]}return BB(`Cannot use ${e} scale if ${r} scale is not discrete.`)}}function iq(e,t,n){const r=e===Tt?"width":"height",i=t[r];return i||Wy(n,r)}function Gwe(e,t,n,r){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":return n!==void 0&&ne(n)?n.length+1:(ue(lme(r)),3)}}function Vwe(e,t,n){const r=()=>{const i=to(t),o=to(e),s=`(${i} - ${o}) / (${n} - 1)`;return`sequence(${o}, ${i} + ${s}, ${s})`};return Fe(t)?new hn(r):{signal:r()}}function Ywe(e,t){switch(e){case"bar":case"tick":return t.scale.minBandSize;case"line":case"trail":case"rule":return t.scale.minStrokeWidth;case"text":return t.scale.minFontSize;case"point":case"square":case"circle":return t.scale.minSize}throw new Error(Ex("size",e))}const LO=.95;function Xwe(e,t,n,r){const i={x:PO(n,"x"),y:PO(n,"y")};switch(e){case"bar":case"tick":{if(r.scale.maxBandSize!==void 0)return r.scale.maxBandSize;const o=zO(t,i,r.view);return at(o)?o-1:new hn(()=>`${o.signal} - 1`)}case"line":case"trail":case"rule":return r.scale.maxStrokeWidth;case"text":return r.scale.maxFontSize;case"point":case"square":case"circle":{if(r.scale.maxSize)return r.scale.maxSize;const o=zO(t,i,r.view);return at(o)?Math.pow(LO*o,2):new hn(()=>`pow(${LO} * ${o.signal}, 2)`)}}throw new Error(Ex("size",e))}function zO(e,t,n){const r=Zo(e.width)?e.width.step:W_(n,"width"),i=Zo(e.height)?e.height.step:W_(n,"height");return t.x||t.y?new hn(()=>`min(${[t.x?t.x.signal:r,t.y?t.y.signal:i].join(", ")})`):Math.min(r,i)}function oq(e,t){Pt(e)?Qwe(e,t):aq(e,t)}function Qwe(e,t){const n=e.component.scales,{config:r,encoding:i,markDef:o,specifiedScales:s}=e;for(const a of oe(n)){const u=s[a],c=n[a],f=e.getScaleComponent(a),h=sn(i[a]),p=u[t],m=f.get("type"),y=f.get("padding"),v=f.get("paddingInner"),w=I_(m,t),E=IU(a,t);if(p!==void 0&&(w?E&&ue(E):ue(vU(m,t,a))),w&&E===void 0)if(p!==void 0){const S=h.timeUnit,A=h.type;switch(t){case"domainMax":case"domainMin":oc(u[t])||A==="temporal"||S?c.set(t,{signal:Tx(u[t],{type:A,timeUnit:S})},!0):c.set(t,u[t],!0);break;default:c.copyKeyFromObject(t,u)}}else{const S=se(IO,t)?IO[t]({model:e,channel:a,fieldOrDatumDef:h,scaleType:m,scalePadding:y,scalePaddingInner:v,domain:u.domain,domainMin:u.domainMin,domainMax:u.domainMax,markDef:o,config:r,hasNestedOffsetScale:hj(i,a),hasSecondaryRangeChannel:!!i[cs(a)]}):r.scale[t];S!==void 0&&c.set(t,S,!1)}}}const IO={bins:({model:e,fieldOrDatumDef:t})=>ce(t)?Kwe(e,t):void 0,interpolate:({channel:e,fieldOrDatumDef:t})=>Jwe(e,t.type),nice:({scaleType:e,channel:t,domain:n,domainMin:r,domainMax:i,fieldOrDatumDef:o})=>Zwe(e,t,n,r,i,o),padding:({channel:e,scaleType:t,fieldOrDatumDef:n,markDef:r,config:i})=>eEe(e,t,i.scale,n,r,i.bar),paddingInner:({scalePadding:e,channel:t,markDef:n,scaleType:r,config:i,hasNestedOffsetScale:o})=>tEe(e,t,n.type,r,i.scale,o),paddingOuter:({scalePadding:e,channel:t,scaleType:n,scalePaddingInner:r,config:i,hasNestedOffsetScale:o})=>nEe(e,t,n,r,i.scale,o),reverse:({fieldOrDatumDef:e,scaleType:t,channel:n,config:r})=>{const i=ce(e)?e.sort:void 0;return rEe(t,i,n,r.scale)},zero:({channel:e,fieldOrDatumDef:t,domain:n,markDef:r,scaleType:i,config:o,hasSecondaryRangeChannel:s})=>iEe(e,t,n,r,i,o.scale,s)};function sq(e){Pt(e)?Uwe(e):aq(e,"range")}function aq(e,t){const n=e.component.scales;for(const r of e.children)t==="range"?sq(r):oq(r,t);for(const r of oe(n)){let i;for(const o of e.children){const s=o.component.scales[r];if(s){const a=s.getWithExplicit(t);i=fu(i,a,t,"scale",Hj((u,c)=>{switch(t){case"range":return u.step&&c.step?u.step-c.step:0}return 0}))}}n[r].setWithExplicit(t,i)}}function Kwe(e,t){const n=t.bin;if(St(n)){const r=E3(e,t.field,n);return new hn(()=>e.getSignalName(r))}else if(Cn(n)&&rc(n)&&n.step!==void 0)return{step:n.step}}function Jwe(e,t){if(Qe([Ur,us,ls],e)&&t!=="nominal")return"hcl"}function Zwe(e,t,n,r,i,o){var s;if(!((s=co(o))!=null&&s.bin||ne(n)||i!=null||r!=null||Qe([$n.TIME,$n.UTC],e)))return Xt(t)?!0:void 0}function eEe(e,t,n,r,i,o){if(Xt(e)){if(zo(t)){if(n.continuousPadding!==void 0)return n.continuousPadding;const{type:s,orient:a}=i;if(s==="bar"&&!(ce(r)&&(r.bin||r.timeUnit))&&(a==="vertical"&&e==="x"||a==="horizontal"&&e==="y"))return o.continuousBandSize}if(t===$n.POINT)return n.pointPadding}}function tEe(e,t,n,r,i,o=!1){if(e===void 0){if(Xt(t)){const{bandPaddingInner:s,barBandPaddingInner:a,rectBandPaddingInner:u,tickBandPaddingInner:c,bandWithNestedOffsetPaddingInner:f}=i;return o?f:Yt(s,n==="bar"?a:n==="tick"?c:u)}else if(Rg(t)&&r===$n.BAND)return i.offsetBandPaddingInner}}function nEe(e,t,n,r,i,o=!1){if(e===void 0){if(Xt(t)){const{bandPaddingOuter:s,bandWithNestedOffsetPaddingOuter:a}=i;if(o)return a;if(n===$n.BAND)return Yt(s,Fe(r)?{signal:`${r.signal}/2`}:r/2)}else if(Rg(t)){if(n===$n.POINT)return .5;if(n===$n.BAND)return i.offsetBandPaddingOuter}}}function rEe(e,t,n,r){if(n==="x"&&r.xReverse!==void 0)return uo(e)&&t==="descending"?Fe(r.xReverse)?{signal:`!${r.xReverse.signal}`}:!r.xReverse:r.xReverse;if(uo(e)&&t==="descending")return!0}function iEe(e,t,n,r,i,o,s){if(!!n&&n!=="unaggregated"&&uo(i)){if(ne(n)){const u=n[0],c=n[n.length-1];if(at(u)&&u<=0&&at(c)&&c>=0)return!0}return!1}if(e==="size"&&t.type==="quantitative"&&!Uf(i))return!0;if(!(ce(t)&&t.bin)&&Qe([...oa,...zge],e)){const{orient:u,type:c}=r;return Qe(["bar","area","line","trail"],c)&&(u==="horizontal"&&e==="y"||u==="vertical"&&e==="x")?!1:Qe(["bar","area"],c)&&!s?!0:o==null?void 0:o.zero}return!1}function oEe(e,t,n,r,i=!1){const o=sEe(t,n,r,i),{type:s}=e;return fs(t)?s!==void 0?Gme(t,s)?ce(n)&&!Hme(s,n.type)?(ue(V0e(s,o)),o):s:(ue(G0e(t,s,o)),o):o:null}function sEe(e,t,n,r){var i;switch(t.type){case"nominal":case"ordinal":{if(df(e)||fb(e)==="discrete")return e==="shape"&&t.type==="ordinal"&&ue(db(e,"ordinal")),"ordinal";if(cb(e))return"band";if(Xt(e)||Rg(e)){if(Qe(["rect","bar","image","rule","tick"],n.type)||r)return"band"}else if(n.type==="arc"&&e in vF)return"band";const o=n[Wr(e)];return Il(o)||Wf(t)&&((i=t.axis)!=null&&i.tickBand)?"band":"point"}case"temporal":return df(e)?"time":fb(e)==="discrete"?(ue(db(e,"temporal")),"ordinal"):ce(t)&&t.timeUnit&&wn(t.timeUnit).utc?"utc":cb(e)?"band":"time";case"quantitative":return df(e)?ce(t)&&St(t.bin)?"bin-ordinal":"linear":fb(e)==="discrete"?(ue(db(e,"quantitative")),"ordinal"):cb(e)?"band":"linear";case"geojson":return}throw new Error(mU(t.type))}function aEe(e,{ignoreRange:t}={}){uq(e),JW(e);for(const n of qme)oq(e,n);t||sq(e)}function uq(e){Pt(e)?e.component.scales=uEe(e):e.component.scales=cEe(e)}function uEe(e){const{encoding:t,mark:n,markDef:r}=e,i={};for(const o of xF){const s=sn(t[o]);if(s&&n===jU&&o===jr&&s.type===yd)continue;let a=s&&s.scale;if(s&&a!==null&&a!==!1){a??(a={});const u=hj(t,o),c=oEe(a,o,s,r,u);i[o]=new eq(e.scaleName(`${o}`,!0),{value:c,explicit:a.type===c})}}return i}const lEe=Hj((e,t)=>z6(e)-z6(t));function cEe(e){var t;const n=e.component.scales={},r={},i=e.component.resolve;for(const o of e.children){uq(o);for(const s of oe(o.component.scales))if((t=i.scale)[s]??(t[s]=IW(s,e)),i.scale[s]==="shared"){const a=r[s],u=o.component.scales[s].getWithExplicit("type");a?Rme(a.value,u.value)?r[s]=fu(a,u,"type","scale",lEe):(i.scale[s]="independent",delete r[s]):r[s]=u}}for(const o of oe(r)){const s=e.scaleName(o,!0),a=r[o];n[o]=new eq(s,a);for(const u of e.children){const c=u.component.scales[o];c&&(u.renameScale(c.get("name"),s),c.merged=!0)}}return n}class kb{constructor(){this.nameMap={}}rename(t,n){this.nameMap[t]=n}has(t){return this.nameMap[t]!==void 0}get(t){for(;this.nameMap[t]&&t!==this.nameMap[t];)t=this.nameMap[t];return t}}function Pt(e){return(e==null?void 0:e.type)==="unit"}function oi(e){return(e==null?void 0:e.type)==="facet"}function C3(e){return(e==null?void 0:e.type)==="concat"}function bd(e){return(e==null?void 0:e.type)==="layer"}class k3{constructor(t,n,r,i,o,s,a){this.type=n,this.parent=r,this.config=o,this.parent=r,this.config=o,this.view=kn(a),this.name=t.name??i,this.title=Oa(t.title)?{text:t.title}:t.title?kn(t.title):void 0,this.scaleNameMap=r?r.scaleNameMap:new kb,this.projectionNameMap=r?r.projectionNameMap:new kb,this.signalNameMap=r?r.signalNameMap:new kb,this.data=t.data,this.description=t.description,this.transforms=sve(t.transform??[]),this.layout=n==="layer"||n==="unit"?{}:cye(t,n,o),this.component={data:{sources:r?r.component.data.sources:[],outputNodes:r?r.component.data.outputNodes:{},outputNodeRefCounts:r?r.component.data.outputNodeRefCounts:{},isFaceted:Fx(t)||(r==null?void 0:r.component.data.isFaceted)&&t.data===void 0},layoutSize:new aa,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:{scale:{},axis:{},legend:{},...s?Ue(s):{}},selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){aEe(this)}parseProjection(){XW(this)}renameTopLevelLayoutSizeSignal(){this.getName("width")!=="width"&&this.renameSignal(this.getName("width"),"width"),this.getName("height")!=="height"&&this.renameSignal(this.getName("height"),"height")}parseLegends(){qW(this)}assembleEncodeFromView(t){const{style:n,...r}=t,i={};for(const o of oe(r)){const s=r[o];s!==void 0&&(i[o]=kt(s))}return i}assembleGroupEncodeEntry(t){let n={};return this.view&&(n=this.assembleEncodeFromView(this.view)),!t&&(this.description&&(n.description=kt(this.description)),this.type==="unit"||this.type==="layer")?{width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height"),...n}:vt(n)?void 0:n}assembleLayout(){if(!this.layout)return;const{spacing:t,...n}=this.layout,{component:r,config:i}=this,o=D2e(r.layoutHeaders,i);return{padding:t,...this.assembleDefaultLayout(),...n,...o?{titleBand:o}:{}}}assembleDefaultLayout(){return{}}assembleHeaderMarks(){const{layoutHeaders:t}=this.component;let n=[];for(const r of _i)t[r].title&&n.push(_2e(this,r));for(const r of y3)n=n.concat(A2e(this,r));return n}assembleAxes(){return f2e(this.component.axes,this.config)}assembleLegends(){return GW(this)}assembleProjections(){return Z2e(this)}assembleTitle(){const{encoding:t,...n}=this.title??{},r={...aU(this.config.title).nonMarkTitleProperties,...n,...t?{encode:{update:t}}:{}};if(r.text)return Qe(["unit","layer"],this.type)?Qe(["middle",void 0],r.anchor)&&(r.frame??(r.frame="group")):r.anchor??(r.anchor="start"),vt(r)?void 0:r}assembleGroup(t=[]){const n={};t=t.concat(this.assembleSignals()),t.length>0&&(n.signals=t);const r=this.assembleLayout();r&&(n.layout=r),n.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const i=!this.parent||oi(this.parent)?ZW(this):[];i.length>0&&(n.scales=i);const o=this.assembleAxes();o.length>0&&(n.axes=o);const s=this.assembleLegends();return s.length>0&&(n.legends=s),n}getName(t){return Mt((this.name?`${this.name}_`:"")+t)}getDataName(t){return this.getName(Lt[t].toLowerCase())}requestDataName(t){const n=this.getDataName(t),r=this.component.data.outputNodeRefCounts;return r[n]=(r[n]||0)+1,n}getSizeSignalRef(t){if(oi(this.parent)){const n=LW(t),r=vx(n),i=this.component.scales[r];if(i&&!i.merged){const o=i.get("type"),s=i.get("range");if(En(o)&&ic(s)){const a=i.get("name"),u=Yx(this,r),c=A3(u);if(c){const f=ge({aggregate:"distinct",field:c},{expr:"datum"});return{signal:PW(a,i,f)}}else return ue(bF(r)),null}}}return{signal:this.signalNameMap.get(this.getName(t))}}lookupDataSource(t){const n=this.component.data.outputNodes[t];return n?n.getSource():t}getSignalName(t){return this.signalNameMap.get(t)}renameSignal(t,n){this.signalNameMap.rename(t,n)}renameScale(t,n){this.scaleNameMap.rename(t,n)}renameProjection(t,n){this.projectionNameMap.rename(t,n)}scaleName(t,n){if(n)return this.getName(t);if(ZB(t)&&fs(t)&&this.component.scales[t]||this.scaleNameMap.has(this.getName(t)))return this.scaleNameMap.get(this.getName(t))}projectionName(t){if(t)return this.getName("projection");if(this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection")))return this.projectionNameMap.get(this.getName("projection"))}getScaleComponent(t){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");const n=this.component.scales[t];return n&&!n.merged?n:this.parent?this.parent.getScaleComponent(t):void 0}getScaleType(t){const n=this.getScaleComponent(t);return n?n.get("type"):void 0}getSelectionComponent(t,n){let r=this.component.selection[t];if(!r&&this.parent&&(r=this.parent.getSelectionComponent(t,n)),!r)throw new Error(u0e(n));return r}hasAxisOrientSignalRef(){var t,n;return((t=this.component.axes.x)==null?void 0:t.some(r=>r.hasOrientSignalRef()))||((n=this.component.axes.y)==null?void 0:n.some(r=>r.hasOrientSignalRef()))}}class lq extends k3{vgField(t,n={}){const r=this.fieldDef(t);if(r)return ge(r,n)}reduceFieldDef(t,n){return I1e(this.getMapping(),(r,i,o)=>{const s=co(i);return s?t(r,s,o):r},n)}forEachFieldDef(t,n){QF(this.getMapping(),(r,i)=>{const o=co(r);o&&t(o,i)},n)}}class Xx extends mt{clone(){return new Xx(null,Ue(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=Ue(n);const r=this.transform.as??[void 0,void 0];this.transform.as=[r[0]??"value",r[1]??"density"];const i=this.transform.resolve??"shared";this.transform.resolve=i}dependentFields(){return new Set([this.transform.density,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`DensityTransform ${Ke(this.transform)}`}assemble(){const{density:t,...n}=this.transform,r={type:"kde",field:t,...n};return r.resolve=this.transform.resolve,r}}class Qx extends mt{clone(){return new Qx(null,Ue(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=Ue(n)}dependentFields(){return new Set([this.transform.extent])}producedFields(){return new Set([])}hash(){return`ExtentTransform ${Ke(this.transform)}`}assemble(){const{extent:t,param:n}=this.transform;return{type:"extent",field:t,signal:n}}}class Kx extends mt{clone(){return new Kx(this.parent,Ue(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=Ue(n);const{flatten:r,as:i=[]}=this.transform;this.transform.as=r.map((o,s)=>i[s]??o)}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return`FlattenTransform ${Ke(this.transform)}`}assemble(){const{flatten:t,as:n}=this.transform;return{type:"flatten",fields:t,as:n}}}class Jx extends mt{clone(){return new Jx(null,Ue(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=Ue(n);const r=this.transform.as??[void 0,void 0];this.transform.as=[r[0]??"key",r[1]??"value"]}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return`FoldTransform ${Ke(this.transform)}`}assemble(){const{fold:t,as:n}=this.transform;return{type:"fold",fields:t,as:n}}}class gf extends mt{clone(){return new gf(null,Ue(this.fields),this.geojson,this.signal)}static parseAll(t,n){if(n.component.projection&&!n.component.projection.isFit)return t;let r=0;for(const i of[[xo,vo],[Ni,wo]]){const o=i.map(s=>{const a=sn(n.encoding[s]);return ce(a)?a.field:ds(a)?{expr:`${a.datum}`}:lo(a)?{expr:`${a.value}`}:void 0});(o[0]||o[1])&&(t=new gf(t,o,null,n.getName(`geojson_${r++}`)))}if(n.channelHasField(jr)){const i=n.typedFieldDef(jr);i.type===yd&&(t=new gf(t,null,i.field,n.getName(`geojson_${r++}`)))}return t}constructor(t,n,r,i){super(t),this.fields=n,this.geojson=r,this.signal=i}dependentFields(){const t=(this.fields??[]).filter(ve);return new Set([...this.geojson?[this.geojson]:[],...t])}producedFields(){return new Set}hash(){return`GeoJSON ${this.geojson} ${this.signal} ${Ke(this.fields)}`}assemble(){return[...this.geojson?[{type:"filter",expr:`isValid(datum["${this.geojson}"])`}]:[],{type:"geojson",...this.fields?{fields:this.fields}:{},...this.geojson?{geojson:this.geojson}:{},signal:this.signal}]}}class Qp extends mt{clone(){return new Qp(null,this.projection,Ue(this.fields),Ue(this.as))}constructor(t,n,r,i){super(t),this.projection=n,this.fields=r,this.as=i}static parseAll(t,n){if(!n.projectionName())return t;for(const r of[[xo,vo],[Ni,wo]]){const i=r.map(s=>{const a=sn(n.encoding[s]);return ce(a)?a.field:ds(a)?{expr:`${a.datum}`}:lo(a)?{expr:`${a.value}`}:void 0}),o=r[0]===Ni?"2":"";(i[0]||i[1])&&(t=new Qp(t,n.projectionName(),i,[n.getName(`x${o}`),n.getName(`y${o}`)]))}return t}dependentFields(){return new Set(this.fields.filter(ve))}producedFields(){return new Set(this.as)}hash(){return`Geopoint ${this.projection} ${Ke(this.fields)} ${Ke(this.as)}`}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}class wl extends mt{clone(){return new wl(null,Ue(this.transform))}constructor(t,n){super(t),this.transform=n}dependentFields(){return new Set([this.transform.impute,this.transform.key,...this.transform.groupby??[]])}producedFields(){return new Set([this.transform.impute])}processSequence(t){const{start:n=0,stop:r,step:i}=t;return{signal:`sequence(${[n,r,...i?[i]:[]].join(",")})`}}static makeFromTransform(t,n){return new wl(t,n)}static makeFromEncoding(t,n){const r=n.encoding,i=r.x,o=r.y;if(ce(i)&&ce(o)){const s=i.impute?i:o.impute?o:void 0;if(s===void 0)return;const a=i.impute?o:o.impute?i:void 0,{method:u,value:c,frame:f,keyvals:h}=s.impute,p=mj(n.mark,r);return new wl(t,{impute:s.field,key:a.field,...u?{method:u}:{},...c!==void 0?{value:c}:{},...f?{frame:f}:{},...h!==void 0?{keyvals:h}:{},...p.length?{groupby:p}:{}})}return null}hash(){return`Impute ${Ke(this.transform)}`}assemble(){const{impute:t,key:n,keyvals:r,method:i,groupby:o,value:s,frame:a=[null,null]}=this.transform,u={type:"impute",field:t,key:n,...r?{keyvals:Uye(r)?this.processSequence(r):r}:{},method:"value",...o?{groupby:o}:{},value:!i||i==="value"?s:null};if(i&&i!=="value"){const c={type:"window",as:[`imputed_${t}_value`],ops:[i],fields:[t],frame:a,ignorePeers:!1,...o?{groupby:o}:{}},f={type:"formula",expr:`datum.${t} === null ? datum.imputed_${t}_value : datum.${t}`,as:t};return[u,c,f]}else return[u]}}class Zx extends mt{clone(){return new Zx(null,Ue(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=Ue(n);const r=this.transform.as??[void 0,void 0];this.transform.as=[r[0]??n.on,r[1]??n.loess]}dependentFields(){return new Set([this.transform.loess,this.transform.on,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`LoessTransform ${Ke(this.transform)}`}assemble(){const{loess:t,on:n,...r}=this.transform;return{type:"loess",x:n,y:t,...r}}}class Kp extends mt{clone(){return new Kp(null,Ue(this.transform),this.secondary)}constructor(t,n,r){super(t),this.transform=n,this.secondary=r}static make(t,n,r,i){const o=n.component.data.sources,{from:s}=r;let a=null;if(jye(s)){let u=dq(s.data,o);u||(u=new Hl(s.data),o.push(u));const c=n.getName(`lookup_${i}`);a=new Lr(u,c,Lt.Lookup,n.component.data.outputNodeRefCounts),n.component.data.outputNodes[c]=a}else if(Wye(s)){const u=s.param;r={as:u,...r};let c;try{c=n.getSelectionComponent(Mt(u),u)}catch{throw new Error(d0e(u))}if(a=c.materialized,!a)throw new Error(h0e(u))}return new Kp(t,r,a.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?xe(this.transform.as):this.transform.from.fields)}hash(){return`Lookup ${Ke({transform:this.transform,secondary:this.secondary})}`}assemble(){let t;if(this.transform.from.fields)t={values:this.transform.from.fields,...this.transform.as?{as:xe(this.transform.as)}:{}};else{let n=this.transform.as;ve(n)||(ue(_0e),n="_lookup"),t={as:[n]}}return{type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup],...t,...this.transform.default?{default:this.transform.default}:{}}}}class e2 extends mt{clone(){return new e2(null,Ue(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=Ue(n);const r=this.transform.as??[void 0,void 0];this.transform.as=[r[0]??"prob",r[1]??"value"]}dependentFields(){return new Set([this.transform.quantile,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`QuantileTransform ${Ke(this.transform)}`}assemble(){const{quantile:t,...n}=this.transform;return{type:"quantile",field:t,...n}}}class t2 extends mt{clone(){return new t2(null,Ue(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=Ue(n);const r=this.transform.as??[void 0,void 0];this.transform.as=[r[0]??n.on,r[1]??n.regression]}dependentFields(){return new Set([this.transform.regression,this.transform.on,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`RegressionTransform ${Ke(this.transform)}`}assemble(){const{regression:t,on:n,...r}=this.transform;return{type:"regression",x:n,y:t,...r}}}class n2 extends mt{clone(){return new n2(null,Ue(this.transform))}constructor(t,n){super(t),this.transform=n}addDimensions(t){this.transform.groupby=Lo((this.transform.groupby??[]).concat(t),n=>n)}producedFields(){}dependentFields(){return new Set([this.transform.pivot,this.transform.value,...this.transform.groupby??[]])}hash(){return`PivotTransform ${Ke(this.transform)}`}assemble(){const{pivot:t,value:n,groupby:r,limit:i,op:o}=this.transform;return{type:"pivot",field:t,value:n,...i!==void 0?{limit:i}:{},...o!==void 0?{op:o}:{},...r!==void 0?{groupby:r}:{}}}}class r2 extends mt{clone(){return new r2(null,Ue(this.transform))}constructor(t,n){super(t),this.transform=n}dependentFields(){return new Set}producedFields(){return new Set}hash(){return`SampleTransform ${Ke(this.transform)}`}assemble(){return{type:"sample",size:this.transform.sample}}}function cq(e){let t=0;function n(r,i){if(r instanceof Hl&&!r.isGenerator&&!Hf(r.data)&&(e.push(i),i={name:null,source:i.name,transform:[]}),r instanceof Yn&&(r.parent instanceof Hl&&!i.source?(i.format={...i.format,parse:r.assembleFormatParse()},i.transform.push(...r.assembleTransforms(!0))):i.transform.push(...r.assembleTransforms())),r instanceof wd){i.name||(i.name=`data_${t++}`),!i.source||i.transform.length>0?(e.push(i),r.data=i.name):r.data=i.source,e.push(...r.assemble());return}switch((r instanceof Vg||r instanceof Yg||r instanceof Qf||r instanceof xd||r instanceof Vf||r instanceof Qp||r instanceof io||r instanceof Kp||r instanceof Ed||r instanceof cc||r instanceof Jx||r instanceof Kx||r instanceof Xx||r instanceof Zx||r instanceof e2||r instanceof t2||r instanceof du||r instanceof r2||r instanceof n2||r instanceof Qx)&&i.transform.push(r.assemble()),(r instanceof qo||r instanceof jo||r instanceof wl||r instanceof Gs||r instanceof gf)&&i.transform.push(...r.assemble()),r instanceof Lr&&(i.source&&i.transform.length===0?r.setSource(i.source):r.parent instanceof Lr?r.setSource(i.name):(i.name||(i.name=`data_${t++}`),r.setSource(i.name),r.numChildren()===1&&(e.push(i),i={name:null,source:i.name,transform:[]}))),r.numChildren()){case 0:r instanceof Lr&&(!i.source||i.transform.length>0)&&e.push(i);break;case 1:n(r.children[0],i);break;default:{i.name||(i.name=`data_${t++}`);let o=i.name;!i.source||i.transform.length>0?e.push(i):o=i.source;for(const s of r.children)n(s,{name:null,source:o,transform:[]});break}}}return n}function fEe(e){const t=[],n=cq(t);for(const r of e.children)n(r,{source:e.name,name:null,transform:[]});return t}function dEe(e,t){const n=[],r=cq(n);let i=0;for(const s of e.sources){s.hasName()||(s.dataName=`source_${i++}`);const a=s.assemble();r(s,a)}for(const s of n)s.transform.length===0&&delete s.transform;let o=0;for(const[s,a]of n.entries())(a.transform??[]).length===0&&!a.source&&n.splice(o++,0,n.splice(s,1)[0]);for(const s of n)for(const a of s.transform??[])a.type==="lookup"&&(a.from=e.outputNodes[a.from].getSource());for(const s of n)s.name in t&&(s.values=t[s.name]);return n}function hEe(e){return e==="top"||e==="left"||Fe(e)?"header":"footer"}function pEe(e){for(const t of _i)gEe(e,t);BO(e,"x"),BO(e,"y")}function gEe(e,t){var s;const{facet:n,config:r,child:i,component:o}=e;if(e.channelHasField(t)){const a=n[t],u=Xf("title",null,r,t);let c=hf(a,r,{allowDisabling:!0,includeDefault:u===void 0||!!u});i.component.layoutHeaders[t].title&&(c=ne(c)?c.join(", "):c,c+=` / ${i.component.layoutHeaders[t].title}`,i.component.layoutHeaders[t].title=null);const f=Xf("labelOrient",a.header,r,t),h=a.header!==null?Yt((s=a.header)==null?void 0:s.labels,r.header.labels,!0):!1,p=Qe(["bottom","right"],f)?"footer":"header";o.layoutHeaders[t]={title:a.header!==null?c:null,facetFieldDef:a,[p]:t==="facet"?[]:[fq(e,t,h)]}}}function fq(e,t,n){const r=t==="row"?"height":"width";return{labels:n,sizeSignal:e.child.component.layoutSize.get(r)?e.child.getSizeSignalRef(r):void 0,axes:[]}}function BO(e,t){const{child:n}=e;if(n.component.axes[t]){const{layoutHeaders:r,resolve:i}=e.component;if(i.axis[t]=w3(i,t),i.axis[t]==="shared"){const o=t==="x"?"column":"row",s=r[o];for(const a of n.component.axes[t]){const u=hEe(a.get("orient"));s[u]??(s[u]=[fq(e,o,!1)]);const c=rp(a,"main",e.config,{header:!0});c&&s[u][0].axes.push(c),a.mainExtracted=!0}}}}function mEe(e){$3(e),Yy(e,"width"),Yy(e,"height")}function yEe(e){$3(e);const t=e.layout.columns===1?"width":"childWidth",n=e.layout.columns===void 0?"height":"childHeight";Yy(e,t),Yy(e,n)}function $3(e){for(const t of e.children)t.parseLayoutSize()}function Yy(e,t){const n=LW(t),r=vx(n),i=e.component.resolve,o=e.component.layoutSize;let s;for(const a of e.children){const u=a.component.layoutSize.getWithExplicit(n),c=i.scale[r]??IW(r,e);if(c==="independent"&&u.value==="step"){s=void 0;break}if(s){if(c==="independent"&&s.value!==u.value){s=void 0;break}s=fu(s,u,n,"")}else s=u}if(s){for(const a of e.children)e.renameSignal(a.getName(n),e.getName(t)),a.component.layoutSize.set(n,"merged",!1);o.setWithExplicit(t,s)}else o.setWithExplicit(t,{explicit:!1,value:void 0})}function vEe(e){const{size:t,component:n}=e;for(const r of oa){const i=Wr(r);if(t[i]){const o=t[i];n.layoutSize.set(i,Zo(o)?"step":o,!0)}else{const o=xEe(e,i);n.layoutSize.set(i,o,!1)}}}function xEe(e,t){const n=t==="width"?"x":"y",r=e.config,i=e.getScaleComponent(n);if(i){const o=i.get("type"),s=i.get("range");if(En(o)){const a=Wy(r.view,t);return ic(s)||Zo(a)?"step":a}else return j_(r.view,t)}else{if(e.hasProjection||e.mark==="arc")return j_(r.view,t);{const o=Wy(r.view,t);return Zo(o)?o.step:o}}}function uA(e,t,n){return ge(t,{suffix:`by_${ge(e)}`,...n})}class wp extends lq{constructor(t,n,r,i){super(t,"facet",n,r,i,t.resolve),this.child=N3(t.spec,this,this.getName("child"),void 0,i),this.children=[this.child],this.facet=this.initFacet(t.facet)}initFacet(t){if(!zg(t))return{facet:this.initFacetFieldDef(t,"facet")};const n=oe(t),r={};for(const i of n){if(![js,Ws].includes(i)){ue(Ex(i,"facet"));break}const o=t[i];if(o.field===void 0){ue(L_(o,i));break}r[i]=this.initFacetFieldDef(o,i)}return r}initFacetFieldDef(t,n){const r=XF(t,n);return r.header?r.header=kn(r.header):r.header===null&&(r.header=null),r}channelHasField(t){return se(this.facet,t)}fieldDef(t){return this.facet[t]}parseData(){this.component.data=i2(this),this.child.parseData()}parseLayoutSize(){$3(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection,Object.values(this.component.selection).some(t=>Wo(t))&&_F(SF)}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),pEe(this)}assembleSelectionTopLevelSignals(t){return this.child.assembleSelectionTopLevelSignals(t)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(t){return this.child.assembleSelectionData(t)}getHeaderLayoutMixins(){const t={};for(const n of _i)for(const r of v3){const i=this.component.layoutHeaders[n],o=i[r],{facetFieldDef:s}=i;if(s){const a=Xf("titleOrient",s.header,this.config,n);if(["right","bottom"].includes(a)){const u=Gx(n,a);t.titleAnchor??(t.titleAnchor={}),t.titleAnchor[u]="end"}}if(o!=null&&o[0]){const a=n==="row"?"height":"width",u=r==="header"?"headerBand":"footerBand";n!=="facet"&&!this.child.component.layoutSize.get(a)&&(t[u]??(t[u]={}),t[u][n]=.5),i.title&&(t.offset??(t.offset={}),t.offset[n==="row"?"rowTitle":"columnTitle"]=10)}}return t}assembleDefaultLayout(){const{column:t,row:n}=this.facet,r=t?this.columnDistinctSignal():n?1:void 0;let i="all";return(!n&&this.component.resolve.scale.x==="independent"||!t&&this.component.resolve.scale.y==="independent")&&(i="none"),{...this.getHeaderLayoutMixins(),...r?{columns:r}:{},bounds:"full",align:i}}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof wp))return{signal:`length(data('${this.getName("column_domain")}'))`}}assembleGroupStyle(){}assembleGroup(t){return this.parent&&this.parent instanceof wp?{...this.channelHasField("column")?{encode:{update:{columns:{field:ge(this.facet.column,{prefix:"distinct"})}}}}:{},...super.assembleGroup(t)}:super.assembleGroup(t)}getCardinalityAggregateForChild(){const t=[],n=[],r=[];if(this.child instanceof wp){if(this.child.channelHasField("column")){const i=ge(this.child.facet.column);t.push(i),n.push("distinct"),r.push(`distinct_${i}`)}}else for(const i of oa){const o=this.child.component.scales[i];if(o&&!o.merged){const s=o.get("type"),a=o.get("range");if(En(s)&&ic(a)){const u=Yx(this.child,i),c=A3(u);c?(t.push(c),n.push("distinct"),r.push(`distinct_${c}`)):ue(bF(i))}}}return{fields:t,ops:n,as:r}}assembleFacet(){const{name:t,data:n}=this.component.data.facetRoot,{row:r,column:i}=this.facet,{fields:o,ops:s,as:a}=this.getCardinalityAggregateForChild(),u=[];for(const f of _i){const h=this.facet[f];if(h){u.push(ge(h));const{bin:p,sort:m}=h;if(St(p)&&u.push(ge(h,{binSuffix:"end"})),qs(m)){const{field:y,op:v=$x}=m,w=uA(h,m);r&&i?(o.push(w),s.push("max"),a.push(w)):(o.push(y),s.push(v),a.push(w))}else if(ne(m)){const y=Yf(h,f);o.push(y),s.push("max"),a.push(y)}}}const c=!!r&&!!i;return{name:t,data:n,groupby:u,...c||o.length>0?{aggregate:{...c?{cross:c}:{},...o.length?{fields:o,ops:s,as:a}:{}}}:{}}}facetSortFields(t){const{facet:n}=this,r=n[t];return r?qs(r.sort)?[uA(r,r.sort,{expr:"datum"})]:ne(r.sort)?[Yf(r,t,{expr:"datum"})]:[ge(r,{expr:"datum"})]:[]}facetSortOrder(t){const{facet:n}=this,r=n[t];if(r){const{sort:i}=r;return[(qs(i)?i.order:!ne(i)&&i)||"ascending"]}return[]}assembleLabelTitle(){var i;const{facet:t,config:n}=this;if(t.facet)return tA(t.facet,"facet",n);const r={row:["top","bottom"],column:["left","right"]};for(const o of y3)if(t[o]){const s=Xf("labelOrient",(i=t[o])==null?void 0:i.header,n,o);if(r[o].includes(s))return tA(t[o],o,n)}}assembleMarks(){const{child:t}=this,n=this.component.data.facetRoot,r=fEe(n),i=t.assembleGroupEncodeEntry(!1),o=this.assembleLabelTitle()||t.assembleTitle(),s=t.assembleGroupStyle();return[{name:this.getName("cell"),type:"group",...o?{title:o}:{},...s?{style:s}:{},from:{facet:this.assembleFacet()},sort:{field:_i.map(u=>this.facetSortFields(u)).flat(),order:_i.map(u=>this.facetSortOrder(u)).flat()},...r.length>0?{data:r}:{},...i?{encode:{update:i}}:{},...t.assembleGroup(Ave(this,[]))}]}getMapping(){return this.facet}}function wEe(e,t){const{row:n,column:r}=t;if(n&&r){let i=null;for(const o of[n,r])if(qs(o.sort)){const{field:s,op:a=$x}=o.sort;e=i=new cc(e,{joinaggregate:[{op:a,field:s,as:uA(o,o.sort,{forAs:!0})}],groupby:[ge(o)]})}return i}return null}function dq(e,t){var n,r,i,o;for(const s of t){const a=s.data;if(e.name&&s.hasName()&&e.name!==s.dataName)continue;const u=(n=e.format)==null?void 0:n.mesh,c=(r=a.format)==null?void 0:r.feature;if(u&&c)continue;const f=(i=e.format)==null?void 0:i.feature;if((f||c)&&f!==c)continue;const h=(o=a.format)==null?void 0:o.mesh;if(!((u||h)&&u!==h)){if(Vp(e)&&Vp(a)){if(ti(e.values,a.values))return s}else if(Hf(e)&&Hf(a)){if(e.url===a.url)return s}else if(Gj(e)&&e.name===s.dataName)return s}}return null}function EEe(e,t){if(e.data||!e.parent){if(e.data===null){const r=new Hl({values:[]});return t.push(r),r}const n=dq(e.data,t);if(n)return Ka(e.data)||(n.data.format=UB({},e.data.format,n.data.format)),!n.hasName()&&e.data.name&&(n.dataName=e.data.name),n;{const r=new Hl(e.data);return t.push(r),r}}else return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}function bEe(e,t,n){let r=0;for(const i of t.transforms){let o,s;if(Zye(i))s=e=new Vf(e,i),o="derived";else if(a3(i)){const a=dwe(i);s=e=Yn.makeWithAncestors(e,{},a,n)??e,e=new xd(e,t,i.filter)}else if(Uj(i))s=e=qo.makeFromTransform(e,i,t),o="number";else if(tve(i))o="date",n.getWithExplicit(i.field).value===void 0&&(e=new Yn(e,{[i.field]:o}),n.set(i.field,o,!1)),s=e=jo.makeFromTransform(e,i);else if(nve(i))s=e=io.makeFromTransform(e,i),o="number",h3(t)&&(e=new du(e));else if(Bj(i))s=e=Kp.make(e,t,i,r++),o="derived";else if(Qye(i))s=e=new Ed(e,i),o="number";else if(Kye(i))s=e=new cc(e,i),o="number";else if(rve(i))s=e=Gs.makeFromTransform(e,i),o="derived";else if(ive(i))s=e=new Jx(e,i),o="derived";else if(ove(i))s=e=new Qx(e,i),o="derived";else if(Jye(i))s=e=new Kx(e,i),o="derived";else if(qye(i))s=e=new n2(e,i),o="derived";else if(Xye(i))e=new r2(e,i);else if(eve(i))s=e=wl.makeFromTransform(e,i),o="derived";else if(Hye(i))s=e=new Xx(e,i),o="derived";else if(Gye(i))s=e=new e2(e,i),o="derived";else if(Vye(i))s=e=new t2(e,i),o="derived";else if(Yye(i))s=e=new Zx(e,i),o="derived";else{ue(S0e(i));continue}if(s&&o!==void 0)for(const a of s.producedFields()??[])n.set(a,o,!1)}return e}function i2(e){var w;let t=EEe(e,e.component.data.sources);const{outputNodes:n,outputNodeRefCounts:r}=e.component.data,i=e.data,s=!(i&&(Ka(i)||Hf(i)||Vp(i)))&&e.parent?e.parent.component.data.ancestorParse.clone():new yve;Ka(i)?(Vj(i)?t=new Yg(t,i.sequence):u3(i)&&(t=new Vg(t,i.graticule)),s.parseNothing=!0):((w=i==null?void 0:i.format)==null?void 0:w.parse)===null&&(s.parseNothing=!0),t=Yn.makeExplicit(t,e,s)??t,t=new du(t);const a=e.parent&&bd(e.parent);(Pt(e)||oi(e))&&a&&(t=qo.makeFromEncoding(t,e)??t),e.transforms.length>0&&(t=bEe(t,e,s));const u=pwe(e),c=hwe(e);t=Yn.makeWithAncestors(t,{},{...u,...c},s)??t,Pt(e)&&(t=gf.parseAll(t,e),t=Qp.parseAll(t,e)),(Pt(e)||oi(e))&&(a||(t=qo.makeFromEncoding(t,e)??t),t=jo.makeFromEncoding(t,e)??t,t=Vf.parseAllForSortIndex(t,e));const f=t=Lm(Lt.Raw,e,t);if(Pt(e)){const E=io.makeFromEncoding(t,e);E&&(t=E,h3(e)&&(t=new du(t))),t=wl.makeFromEncoding(t,e)??t,t=Gs.makeFromEncoding(t,e)??t}let h,p;if(Pt(e)){const{markDef:E,mark:S,config:A}=e,C=yt("invalid",E,A),{marks:k,scales:D}=p=Xj({invalid:C,isPath:ku(S)});k!==D&&D==="include-invalid-values"&&(h=t=Lm(Lt.PreFilterInvalid,e,t)),k==="exclude-invalid-values"&&(t=Qf.make(t,e,p)??t)}const m=t=Lm(Lt.Main,e,t);let y;if(Pt(e)&&p){const{marks:E,scales:S}=p;E==="include-invalid-values"&&S==="exclude-invalid-values"&&(t=Qf.make(t,e,p)??t,y=t=Lm(Lt.PostFilterInvalid,e,t))}Pt(e)&&l2e(e,m);let v=null;if(oi(e)){const E=e.getName("facet");t=wEe(t,e.facet)??t,v=new wd(t,e,E,m.getSource()),n[E]=v}return{...e.component.data,outputNodes:n,outputNodeRefCounts:r,raw:f,main:m,facetRoot:v,ancestorParse:s,preFilterInvalid:h,postFilterInvalid:y}}function Lm(e,t,n){const{outputNodes:r,outputNodeRefCounts:i}=t.component.data,o=t.getDataName(e),s=new Lr(n,o,e,i);return r[o]=s,s}class SEe extends k3{constructor(t,n,r,i){var o,s,a,u;super(t,"concat",n,r,i,t.resolve),(((s=(o=t.resolve)==null?void 0:o.axis)==null?void 0:s.x)==="shared"||((u=(a=t.resolve)==null?void 0:a.axis)==null?void 0:u.y)==="shared")&&ue(w0e),this.children=this.getChildren(t).map((c,f)=>N3(c,this,this.getName(`concat_${f}`),void 0,i))}parseData(){this.component.data=i2(this);for(const t of this.children)t.parseData()}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of oe(t.component.selection))this.component.selection[n]=t.component.selection[n]}Object.values(this.component.selection).some(t=>Wo(t))&&_F(SF)}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){for(const t of this.children)t.parseAxesAndHeaders()}getChildren(t){return Ox(t)?t.vconcat:o3(t)?t.hconcat:t.concat}parseLayoutSize(){yEe(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,r)=>r.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.forEach(t=>t.assembleSignals()),[]}assembleLayoutSignals(){const t=x3(this);for(const n of this.children)t.push(...n.assembleLayoutSignals());return t}assembleSelectionData(t){return this.children.reduce((n,r)=>r.assembleSelectionData(n),t)}assembleMarks(){return this.children.map(t=>{const n=t.assembleTitle(),r=t.assembleGroupStyle(),i=t.assembleGroupEncodeEntry(!1);return{type:"group",name:t.getName("group"),...n?{title:n}:{},...r?{style:r}:{},...i?{encode:{update:i}}:{},...t.assembleGroup()}})}assembleGroupStyle(){}assembleDefaultLayout(){const t=this.layout.columns;return{...t!=null?{columns:t}:{},bounds:"full",align:"each"}}}function _Ee(e){return e===!1||e===null}const AEe={disable:1,gridScale:1,scale:1,...cj,labelExpr:1,encode:1},hq=oe(AEe);class F3 extends aa{constructor(t={},n={},r=!1){super(),this.explicit=t,this.implicit=n,this.mainExtracted=r}clone(){return new F3(Ue(this.explicit),Ue(this.implicit),this.mainExtracted)}hasAxisPart(t){return t==="axis"?!0:t==="grid"||t==="title"?!!this.get(t):!_Ee(this.get(t))}hasOrientSignalRef(){return Fe(this.explicit.orient)}}function CEe(e,t,n){const{encoding:r,config:i}=e,o=sn(r[t])??sn(r[cs(t)]),s=e.axis(t)||{},{format:a,formatType:u}=s;if(Bl(u))return{text:no({fieldOrDatumDef:o,field:"datum.value",format:a,formatType:u,config:i}),...n};if(a===void 0&&u===void 0&&i.customFormatTypes){if(jf(o)==="quantitative"){if(Wf(o)&&o.stack==="normalize"&&i.normalizedNumberFormatType)return{text:no({fieldOrDatumDef:o,field:"datum.value",format:i.normalizedNumberFormat,formatType:i.normalizedNumberFormatType,config:i}),...n};if(i.numberFormatType)return{text:no({fieldOrDatumDef:o,field:"datum.value",format:i.numberFormat,formatType:i.numberFormatType,config:i}),...n}}if(jf(o)==="temporal"&&i.timeFormatType&&ce(o)&&!o.timeUnit)return{text:no({fieldOrDatumDef:o,field:"datum.value",format:i.timeFormat,formatType:i.timeFormatType,config:i}),...n}}return n}function kEe(e){return oa.reduce((t,n)=>(e.component.scales[n]&&(t[n]=[REe(n,e)]),t),{})}const $Ee={bottom:"top",top:"bottom",left:"right",right:"left"};function FEe(e){const{axes:t,resolve:n}=e.component,r={top:0,bottom:0,right:0,left:0};for(const i of e.children){i.parseAxesAndHeaders();for(const o of oe(i.component.axes))n.axis[o]=w3(e.component.resolve,o),n.axis[o]==="shared"&&(t[o]=DEe(t[o],i.component.axes[o]),t[o]||(n.axis[o]="independent",delete t[o]))}for(const i of oa){for(const o of e.children)if(o.component.axes[i]){if(n.axis[i]==="independent"){t[i]=(t[i]??[]).concat(o.component.axes[i]);for(const s of o.component.axes[i]){const{value:a,explicit:u}=s.getWithExplicit("orient");if(!Fe(a)){if(r[a]>0&&!u){const c=$Ee[a];r[a]>r[c]&&s.set("orient",c,!1)}r[a]++}}}delete o.component.axes[i]}if(n.axis[i]==="independent"&&t[i]&&t[i].length>1)for(const[o,s]of(t[i]||[]).entries())o>0&&s.get("grid")&&!s.explicit.grid&&(s.implicit.grid=!1)}}function DEe(e,t){if(e){if(e.length!==t.length)return;const n=e.length;for(let r=0;r<n;r++){const i=e[r],o=t[r];if(!!i!=!!o)return;if(i&&o){const s=i.getWithExplicit("orient"),a=o.getWithExplicit("orient");if(s.explicit&&a.explicit&&s.value!==a.value)return;e[r]=MEe(i,o)}}}else return t.map(n=>n.clone());return e}function MEe(e,t){for(const n of hq){const r=fu(e.getWithExplicit(n),t.getWithExplicit(n),n,"axis",(i,o)=>{switch(n){case"title":return pU(i,o);case"gridScale":return{explicit:i.explicit,value:Yt(i.value,o.value)}}return Lx(i,o,n,"axis")});e.setWithExplicit(n,r)}return e}function TEe(e,t,n,r,i){if(t==="disable")return n!==void 0;switch(n=n||{},t){case"titleAngle":case"labelAngle":return e===(Fe(n.labelAngle)?n.labelAngle:Hp(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(e===TW(r,i))return!0}return e===n[t]}const NEe=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function REe(e,t){var E,S;let n=t.axis(e);const r=new F3,i=sn(t.encoding[e]),{mark:o,config:s}=t,a=(n==null?void 0:n.orient)||((E=s[e==="x"?"axisX":"axisY"])==null?void 0:E.orient)||((S=s.axis)==null?void 0:S.orient)||x2e(e),u=t.getScaleComponent(e).get("type"),c=d2e(e,u,a,t.config),f=n!==void 0?!n:Z_("disable",s.style,n==null?void 0:n.style,c).configValue;if(r.set("disable",f,n!==void 0),f)return r;n=n||{};const h=m2e(i,n,e,s.style,c),p=QU(n.formatType,i,u),m=XU(i,i.type,n.format,n.formatType,s,!0),y={fieldOrDatumDef:i,axis:n,channel:e,model:t,scaleType:u,orient:a,labelAngle:h,format:m,formatType:p,mark:o,config:s};for(const A of hq){const C=A in AO?AO[A](y):H6(A)?n[A]:void 0,k=C!==void 0,D=TEe(C,A,n,t,e);if(k&&D)r.set(A,C,D);else{const{configValue:$=void 0,configFrom:M=void 0}=H6(A)&&A!=="values"?Z_(A,s.style,n.style,c):{},T=$!==void 0;k&&!T?r.set(A,C,D):(M!=="vgAxisConfig"||NEe.has(A)&&T||jg($)||Fe($))&&r.set(A,$,!1)}}const v=n.encoding??{},w=lj.reduce((A,C)=>{if(!r.hasAxisPart(C))return A;const k=zW(v[C]??{},t),D=C==="labels"?CEe(t,e,k):k;return D!==void 0&&!vt(D)&&(A[C]={update:D}),A},{});return vt(w)||r.set("encode",w,!!n.encoding||n.labelAngle!==void 0),r}function OEe({encoding:e,size:t}){for(const n of oa){const r=Wr(n);Zo(t[r])&&Ha(e[n])&&(delete t[r],ue(xU(r)))}return t}const PEe={vgMark:"arc",encodeEntry:e=>({...Pi(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"}),...pr("x",e,{defaultPos:"mid"}),...pr("y",e,{defaultPos:"mid"}),...Ks(e,"radius"),...Ks(e,"theta")})},LEe={vgMark:"area",encodeEntry:e=>({...Pi(e,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"}),...qy("x",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="horizontal"}),...qy("y",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="vertical"}),...d3(e)})},zEe={vgMark:"rect",encodeEntry:e=>({...Pi(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...Ks(e,"x"),...Ks(e,"y")})},IEe={vgMark:"shape",encodeEntry:e=>({...Pi(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})}),postEncodingTransform:e=>{const{encoding:t}=e,n=t.shape;return[{type:"geoshape",projection:e.projectionName(),...n&&ce(n)&&n.type===yd?{field:ge(n,{expr:"datum"})}:{}}]}},BEe={vgMark:"image",encodeEntry:e=>({...Pi(e,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"}),...Ks(e,"x"),...Ks(e,"y"),...c3(e,"url")})},UEe={vgMark:"line",encodeEntry:e=>({...Pi(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"}),...pr("x",e,{defaultPos:"mid"}),...pr("y",e,{defaultPos:"mid"}),...Fn("size",e,{vgChannel:"strokeWidth"}),...d3(e)})},jEe={vgMark:"trail",encodeEntry:e=>({...Pi(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"}),...pr("x",e,{defaultPos:"mid"}),...pr("y",e,{defaultPos:"mid"}),...Fn("size",e),...d3(e)})};function D3(e,t){const{config:n}=e;return{...Pi(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"}),...pr("x",e,{defaultPos:"mid"}),...pr("y",e,{defaultPos:"mid"}),...Fn("size",e),...Fn("angle",e),...WEe(e,n,t)}}function WEe(e,t,n){return n?{shape:{value:n}}:Fn("shape",e)}const qEe={vgMark:"symbol",encodeEntry:e=>D3(e)},HEe={vgMark:"symbol",encodeEntry:e=>D3(e,"circle")},GEe={vgMark:"symbol",encodeEntry:e=>D3(e,"square")},VEe={vgMark:"rect",encodeEntry:e=>({...Pi(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...Ks(e,"x"),...Ks(e,"y")})},YEe={vgMark:"rule",encodeEntry:e=>{const{markDef:t}=e,n=t.orient;return!e.encoding.x&&!e.encoding.y&&!e.encoding.latitude&&!e.encoding.longitude?{}:{...Pi(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...qy("x",e,{defaultPos:n==="horizontal"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="vertical"}),...qy("y",e,{defaultPos:n==="vertical"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="horizontal"}),...Fn("size",e,{vgChannel:"strokeWidth"})}}},XEe={vgMark:"text",encodeEntry:e=>{const{config:t,encoding:n}=e;return{...Pi(e,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"}),...pr("x",e,{defaultPos:"mid"}),...pr("y",e,{defaultPos:"mid"}),...c3(e),...Fn("size",e,{vgChannel:"fontSize"}),...Fn("angle",e),...pO("align",QEe(e.markDef,n,t)),...pO("baseline",KEe(e.markDef,n,t)),...pr("radius",e,{defaultPos:null}),...pr("theta",e,{defaultPos:null})}}};function QEe(e,t,n){if(yt("align",e,n)===void 0)return"center"}function KEe(e,t,n){if(yt("baseline",e,n)===void 0)return"middle"}const JEe={vgMark:"rect",encodeEntry:e=>{const{config:t,markDef:n}=e,r=n.orient,i=r==="horizontal"?"x":"y",o=r==="horizontal"?"y":"x",s=r==="horizontal"?"height":"width";return{...Pi(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...Ks(e,i),...pr(o,e,{defaultPos:"mid",vgChannel:o==="y"?"yc":"xc"}),[s]:kt(yt("thickness",n,t))}}},zm={arc:PEe,area:LEe,bar:zEe,circle:HEe,geoshape:IEe,image:BEe,line:UEe,point:qEe,rect:VEe,rule:YEe,square:GEe,text:XEe,tick:JEe,trail:jEe};function ZEe(e){if(Qe([Cx,_x,Qme],e.mark)){const t=mj(e.mark,e.encoding);if(t.length>0)return ebe(e,t)}else if(e.mark===Ax){const t=O_.some(n=>yt(n,e.markDef,e.config));if(e.stack&&!e.fieldDef("size")&&t)return tbe(e)}return M3(e)}const UO="faceted_path_";function ebe(e,t){return[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:UO+e.requestDataName(Lt.Main),data:e.requestDataName(Lt.Main),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:M3(e,{fromPrefix:UO})}]}const jO="stack_group_";function tbe(e){var c;const[t]=M3(e,{fromPrefix:jO}),n=e.scaleName(e.stack.fieldChannel),r=(f={})=>e.vgField(e.stack.fieldChannel,f),i=(f,h)=>{const p=[r({prefix:"min",suffix:"start",expr:h}),r({prefix:"max",suffix:"start",expr:h}),r({prefix:"min",suffix:"end",expr:h}),r({prefix:"max",suffix:"end",expr:h})];return`${f}(${p.map(m=>`scale('${n}',${m})`).join(",")})`};let o,s;e.stack.fieldChannel==="x"?(o={...Pf(t.encode.update,["y","yc","y2","height",...O_]),x:{signal:i("min","datum")},x2:{signal:i("max","datum")},clip:{value:!0}},s={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},t.encode.update={...Pr(t.encode.update,["y","yc","y2"]),height:{field:{group:"height"}}}):(o={...Pf(t.encode.update,["x","xc","x2","width"]),y:{signal:i("min","datum")},y2:{signal:i("max","datum")},clip:{value:!0}},s={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},t.encode.update={...Pr(t.encode.update,["x","xc","x2"]),width:{field:{group:"width"}}});for(const f of O_){const h=Ko(f,e.markDef,e.config);t.encode.update[f]?(o[f]=t.encode.update[f],delete t.encode.update[f]):h&&(o[f]=kt(h)),h&&(t.encode.update[f]={value:0})}const a=[];if(((c=e.stack.groupbyChannels)==null?void 0:c.length)>0)for(const f of e.stack.groupbyChannels){const h=e.fieldDef(f),p=ge(h);p&&a.push(p),(h!=null&&h.bin||h!=null&&h.timeUnit)&&a.push(ge(h,{binSuffix:"end"}))}return o=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce((f,h)=>{if(t.encode.update[h])return{...f,[h]:t.encode.update[h]};{const p=Ko(h,e.markDef,e.config);return p!==void 0?{...f,[h]:kt(p)}:f}},o),o.stroke&&(o.strokeForeground={value:!0},o.strokeOffset={value:0}),[{type:"group",from:{facet:{data:e.requestDataName(Lt.Main),name:jO+e.requestDataName(Lt.Main),groupby:a,aggregate:{fields:[r({suffix:"start"}),r({suffix:"start"}),r({suffix:"end"}),r({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:o},marks:[{type:"group",encode:{update:s},marks:[t]}]}]}function nbe(e){const{encoding:t,stack:n,mark:r,markDef:i,config:o}=e,s=t.order;if(!(!ne(s)&&lo(s)&&N_(s.value)||!s&&N_(yt("order",i,o)))){if((ne(s)||ce(s))&&!n)return fU(s,{expr:"datum"});if(ku(r)){const a=i.orient==="horizontal"?"y":"x",u=t[a];if(ce(u))return{field:a}}}}function M3(e,t={fromPrefix:""}){const{mark:n,markDef:r,encoding:i,config:o}=e,s=Yt(r.clip,rbe(e),ibe(e)),a=lU(r),u=i.key,c=nbe(e),f=obe(e),h=yt("aria",r,o),p=zm[n].postEncodingTransform?zm[n].postEncodingTransform(e):null;return[{name:e.getName("marks"),type:zm[n].vgMark,...s?{clip:s}:{},...a?{style:a}:{},...u?{key:u.field}:{},...c?{sort:c}:{},...f||{},...h===!1?{aria:h}:{},from:{data:t.fromPrefix+e.requestDataName(Lt.Main)},encode:{update:zm[n].encodeEntry(e)},...p?{transform:p}:{}}]}function rbe(e){const t=e.getScaleComponent("x"),n=e.getScaleComponent("y");return t!=null&&t.get("selectionExtent")||n!=null&&n.get("selectionExtent")?!0:void 0}function ibe(e){const t=e.component.projection;return t&&!t.isFit?!0:void 0}function obe(e){if(!e.component.selection)return null;const t=oe(e.component.selection).length;let n=t,r=e.parent;for(;r&&n===0;)n=oe(r.component.selection).length,r=r.parent;return n?{interactive:t>0||e.mark==="geoshape"||!!e.encoding.tooltip||!!e.markDef.tooltip}:null}class pq extends lq{constructor(t,n,r,i={},o){super(t,"unit",n,r,o,void 0,V6(t)?t.view:void 0),this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection=[],this.children=[],this.correctDataNames=c=>{var f,h,p;return(f=c.from)!=null&&f.data&&(c.from.data=this.lookupDataSource(c.from.data),"time"in this.encoding&&(c.from.data=c.from.data+Kj)),(p=(h=c.from)==null?void 0:h.facet)!=null&&p.data&&(c.from.facet.data=this.lookupDataSource(c.from.facet.data)),c};const s=Jo(t.mark)?{...t.mark}:{type:t.mark},a=s.type;s.filled===void 0&&(s.filled=Nye(s,o,{graticule:t.data&&u3(t.data)}));const u=this.encoding=L1e(t.encoding||{},a,s.filled,o);this.markDef=Lj(s,u,o),this.size=OEe({encoding:u,size:V6(t)?{...i,...t.width?{width:t.width}:{},...t.height?{height:t.height}:{}}:i}),this.stack=Pj(this.markDef,u),this.specifiedScales=this.initScales(a,u),this.specifiedAxes=this.initAxes(u),this.specifiedLegends=this.initLegends(u),this.specifiedProjection=t.projection,this.selection=(t.params??[]).filter(c=>r3(c))}get hasProjection(){const{encoding:t}=this,n=this.mark===jU,r=t&&Fge.some(i=>je(t[i]));return n||r}scaleDomain(t){const n=this.specifiedScales[t];return n?n.domain:void 0}axis(t){return this.specifiedAxes[t]}legend(t){return this.specifiedLegends[t]}initScales(t,n){return xF.reduce((r,i)=>{const o=sn(n[i]);return o&&(r[i]=this.initScale(o.scale??{})),r},{})}initScale(t){const{domain:n,range:r}=t,i=kn(t);return ne(n)&&(i.domain=n.map(Zr)),ne(r)&&(i.range=r.map(Zr)),i}initAxes(t){return oa.reduce((n,r)=>{const i=t[r];if(je(i)||r===Tt&&je(t.x2)||r===Sn&&je(t.y2)){const o=je(i)?i.axis:void 0;n[r]=o&&this.initAxis({...o})}return n},{})}initAxis(t){const n=oe(t),r={};for(const i of n){const o=t[i];r[i]=jg(o)?uU(o):Zr(o)}return r}initLegends(t){return Bge.reduce((n,r)=>{const i=sn(t[r]);if(i&&jge(r)){const o=i.legend;n[r]=o&&kn(o)}return n},{})}parseData(){this.component.data=i2(this)}parseLayoutSize(){vEe(this)}parseSelections(){this.component.selection=u2e(this,this.selection)}parseMarkGroup(){this.component.mark=ZEe(this)}parseAxesAndHeaders(){this.component.axes=kEe(this)}assembleSelectionTopLevelSignals(t){return Cve(this,t)}assembleSignals(){return[...FW(this),..._ve(this,[])]}assembleSelectionData(t){return kve(this,t)}assembleLayout(){return null}assembleLayoutSignals(){return x3(this)}assembleMarks(){let t=this.component.mark??[];return(!this.parent||!bd(this.parent))&&(t=tW(this,t)),t.map(this.correctDataNames)}assembleGroupStyle(){const{style:t}=this.view||{};return t!==void 0?t:this.encoding.x||this.encoding.y?"cell":"view"}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(t){return vl(this.encoding,t)}fieldDef(t){const n=this.encoding[t];return co(n)}typedFieldDef(t){const n=this.fieldDef(t);return xr(n)?n:null}}class T3 extends k3{constructor(t,n,r,i,o){super(t,"layer",n,r,o,t.resolve,t.view);const s={...i,...t.width?{width:t.width}:{},...t.height?{height:t.height}:{}};this.children=t.layer.map((a,u)=>{if(Px(a))return new T3(a,this,this.getName(`layer_${u}`),s,o);if(sa(a))return new pq(a,this,this.getName(`layer_${u}`),s,o);throw new Error(EF(a))})}parseData(){this.component.data=i2(this);for(const t of this.children)t.parseData()}parseLayoutSize(){mEe(this)}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of oe(t.component.selection))this.component.selection[n]=t.component.selection[n]}Object.values(this.component.selection).some(t=>Wo(t))&&_F(SF)}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){FEe(this)}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,r)=>r.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleSignals()),FW(this))}assembleLayoutSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleLayoutSignals()),x3(this))}assembleSelectionData(t){return this.children.reduce((n,r)=>r.assembleSelectionData(n),t)}assembleGroupStyle(){const t=new Set;for(const r of this.children)for(const i of xe(r.assembleGroupStyle()))t.add(i);const n=Array.from(t);return n.length>1?n:n.length===1?n[0]:void 0}assembleTitle(){let t=super.assembleTitle();if(t)return t;for(const n of this.children)if(t=n.assembleTitle(),t)return t}assembleLayout(){return null}assembleMarks(){return $ve(this,this.children.flatMap(t=>t.assembleMarks()))}assembleLegends(){return this.children.reduce((t,n)=>t.concat(n.assembleLegends()),GW(this))}}function N3(e,t,n,r,i){if(Fx(e))return new wp(e,t,n,i);if(Px(e))return new T3(e,t,n,r,i);if(sa(e))return new pq(e,t,n,r,i);if(aye(e))return new SEe(e,t,n,i);throw new Error(EF(e))}function sbe(e,t={}){t.logger&&cme(t.logger),t.fieldTitle&&sj(t.fieldTitle);try{const n=Oj(Jf(t.config,e.config)),r=qj(e,n),i=N3(r,null,"",void 0,n);return i.parse(),Dwe(i.component.data,i),{spec:ube(i,abe(e,r.autosize,n,i),e.datasets,e.usermeta),normalized:r}}finally{t.logger&&fme(),t.fieldTitle&&$1e()}}function abe(e,t,n,r){const i=r.component.layoutSize.get("width"),o=r.component.layoutSize.get("height");if(t===void 0?(t={type:"pad"},r.hasAxisOrientSignalRef()&&(t.resize=!0)):ve(t)&&(t={type:t}),i&&o&&pve(t.type)){if(i==="step"&&o==="step")ue(M6()),t.type="pad";else if(i==="step"||o==="step"){const s=i==="step"?"width":"height";ue(M6(vx(s)));const a=s==="width"?"height":"width";t.type=gve(a)}}return{...oe(t).length===1&&t.type?t.type==="pad"?{}:{autosize:t.type}:{autosize:t},...oO(n,!1),...oO(e,!0)}}function ube(e,t,n={},r){const i=e.config?Eye(e.config):void 0,o=dEe(e.component.data,n),s=e.assembleSelectionData(o),a=e.assembleProjections(),u=e.assembleTitle(),c=e.assembleGroupStyle(),f=e.assembleGroupEncodeEntry(!0);let h=e.assembleLayoutSignals();h=h.filter(y=>(y.name==="width"||y.name==="height")&&y.value!==void 0?(t[y.name]=+y.value,!1):!0);const{params:p,...m}=t;return{$schema:"https://vega.github.io/schema/vega/v5.json",...e.description?{description:e.description}:{},...m,...u?{title:u}:{},...c?{style:c}:{},...f?{encode:{update:f}}:{},data:s,...a.length>0?{projections:a}:{},...e.assembleGroup([...h,...e.assembleSelectionTopLevelSignals([]),...Mj(p)]),...i?{config:i}:{},...r?{usermeta:r}:{}}}const lbe=Sge.version,cbe=Object.freeze(Object.defineProperty({__proto__:null,accessPathDepth:zf,accessPathWithDatum:fF,accessWithDatumToUnescapedPath:ht,compile:sbe,contains:Qe,deepEqual:ti,deleteNestedProperty:Ry,duplicate:Ue,entries:uu,every:uF,fieldIntersection:cF,flatAccessWithDatum:WB,getFirstDefined:Yt,hasIntersection:lF,hasProperty:se,hash:Ke,internalField:GB,isBoolean:qp,isEmpty:vt,isEqual:Age,isInternalField:VB,isNullOrFalse:N_,isNumeric:dx,keys:oe,logicalExpr:yp,mergeDeep:UB,never:BB,normalize:qj,normalizeAngle:Hp,omit:Pr,pick:Pf,prefixGenerator:R_,removePathFromField:gd,replaceAll:Rl,replacePathInField:Ti,resetIdCounter:kge,setEqual:jB,some:Lf,stringify:xt,titleCase:Mg,unique:Lo,uniqueId:HB,vals:Rn,varName:Mt,version:lbe},Symbol.toStringTag,{value:"Module"}));function gq(e){const[t,n]=/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(e).slice(1,3);return{library:t,version:n}}var fbe="2.15.0",dbe={version:fbe};const Vc="#fff",WO="#888",hbe={background:"#333",view:{stroke:WO},title:{color:Vc,subtitleColor:Vc},style:{"guide-label":{fill:Vc},"guide-title":{fill:Vc}},axis:{domainColor:Vc,gridColor:WO,tickColor:Vc}},Vu="#4572a7",pbe={background:"#fff",arc:{fill:Vu},area:{fill:Vu},line:{stroke:Vu,strokeWidth:2},path:{stroke:Vu},rect:{fill:Vu},shape:{stroke:Vu},symbol:{fill:Vu,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},Yu="#30a2da",$b="#cbcbcb",gbe="#999",mbe="#333",qO="#f0f0f0",HO="#333",ybe={arc:{fill:Yu},area:{fill:Yu},axis:{domainColor:$b,grid:!0,gridColor:$b,gridWidth:1,labelColor:gbe,labelFontSize:10,titleColor:mbe,tickColor:$b,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:qO,group:{fill:qO},legend:{labelColor:HO,labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:HO,titleFontSize:14,titlePadding:10},line:{stroke:Yu,strokeWidth:2},path:{stroke:Yu,strokeWidth:.5},rect:{fill:Yu},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:Yu},bar:{binSpacing:2,fill:Yu,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},Xu="#000",vbe={group:{fill:"#e5e5e5"},arc:{fill:Xu},area:{fill:Xu},line:{stroke:Xu},path:{stroke:Xu},rect:{fill:Xu},shape:{stroke:Xu},symbol:{fill:Xu,size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},xbe=22,wbe="normal",GO="Benton Gothic, sans-serif",VO=11.5,Ebe="normal",Qu="#82c6df",Fb="Benton Gothic Bold, sans-serif",YO="normal",XO=13,Mh={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"]},bbe={background:"#ffffff",title:{anchor:"start",color:"#000000",font:Fb,fontSize:xbe,fontWeight:wbe},arc:{fill:Qu},area:{fill:Qu},line:{stroke:Qu,strokeWidth:2},path:{stroke:Qu},rect:{fill:Qu},shape:{stroke:Qu},symbol:{fill:Qu,size:30},axis:{labelFont:GO,labelFontSize:VO,labelFontWeight:Ebe,titleFont:Fb,titleFontSize:XO,titleFontWeight:YO},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:GO,labelFontSize:VO,symbolType:"square",titleFont:Fb,titleFontSize:XO,titleFontWeight:YO},range:{category:Mh["category-6"],diverging:Mh["fireandice-6"],heatmap:Mh["fire-7"],ordinal:Mh["fire-7"],ramp:Mh["fire-7"]}},Ku="#ab5787",Im="#979797",Sbe={background:"#f9f9f9",arc:{fill:Ku},area:{fill:Ku},line:{stroke:Ku},path:{stroke:Ku},rect:{fill:Ku},shape:{stroke:Ku},symbol:{fill:Ku,size:30},axis:{domainColor:Im,domainWidth:.5,gridWidth:.2,labelColor:Im,tickColor:Im,tickWidth:.2,titleColor:Im},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},Ju="#3e5c69",_be={background:"#fff",arc:{fill:Ju},area:{fill:Ju},line:{stroke:Ju},path:{stroke:Ju},rect:{fill:Ju},shape:{stroke:Ju},symbol:{fill:Ju},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},yi="#1696d2",QO="#000000",Abe="#FFFFFF",Bm="Lato",Db="Lato",Cbe="Lato",kbe="#DEDDDD",$be=18,Th={"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},Fbe={background:Abe,title:{anchor:"start",fontSize:$be,font:Bm},axisX:{domain:!0,domainColor:QO,domainWidth:1,grid:!1,labelFontSize:12,labelFont:Db,labelAngle:0,tickColor:QO,tickSize:5,titleFontSize:12,titlePadding:10,titleFont:Bm},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:kbe,gridWidth:1,labelFontSize:12,labelFont:Db,labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:Bm,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:Db,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:Bm,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:Th["six-groups-cat-1"],diverging:Th["diverging-colors"],heatmap:Th["diverging-colors"],ordinal:Th["six-groups-seq"],ramp:Th["shades-blue"]},area:{fill:yi},rect:{fill:yi},line:{color:yi,stroke:yi,strokeWidth:5},trail:{color:yi,stroke:yi,strokeWidth:0,size:1},path:{stroke:yi,strokeWidth:.5},point:{filled:!0},text:{font:Cbe,color:yi,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:yi,stroke:null}},arc:{fill:yi},shape:{stroke:yi},symbol:{fill:yi,size:30}},Zu="#3366CC",KO="#ccc",Um="Arial, sans-serif",Dbe={arc:{fill:Zu},area:{fill:Zu},path:{stroke:Zu},rect:{fill:Zu},shape:{stroke:Zu},symbol:{stroke:Zu},circle:{fill:Zu},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:Um,fontSize:12},"guide-title":{font:Um,fontSize:12},"group-title":{font:Um,fontSize:12}},title:{font:Um,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:KO,tickColor:KO,domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},R3=e=>e*(1/3+1),JO=R3(9),ZO=R3(10),e4=R3(12),Nh="Segoe UI",t4="wf_standard-font, helvetica, arial, sans-serif",n4="#252423",Rh="#605E5C",r4="transparent",Mbe="#C8C6C4",Gi="#118DFF",Tbe="#12239E",Nbe="#E66C37",Rbe="#6B007B",Obe="#E044A7",Pbe="#744EC2",Lbe="#D9B300",zbe="#D64550",mq=Gi,yq="#DEEFFF",i4=[yq,mq],Ibe=[yq,"#c7e4ff","#b0d9ff","#9aceff","#83c3ff","#6cb9ff","#55aeff","#3fa3ff","#2898ff",mq],Bbe={view:{stroke:r4},background:r4,font:Nh,header:{titleFont:t4,titleFontSize:e4,titleColor:n4,labelFont:Nh,labelFontSize:ZO,labelColor:Rh},axis:{ticks:!1,grid:!1,domain:!1,labelColor:Rh,labelFontSize:JO,titleFont:t4,titleColor:n4,titleFontSize:e4,titleFontWeight:"normal"},axisQuantitative:{tickCount:3,grid:!0,gridColor:Mbe,gridDash:[1,5],labelFlush:!1},axisBand:{tickExtra:!0},axisX:{labelPadding:5},axisY:{labelPadding:10},bar:{fill:Gi},line:{stroke:Gi,strokeWidth:3,strokeCap:"round",strokeJoin:"round"},text:{font:Nh,fontSize:JO,fill:Rh},arc:{fill:Gi},area:{fill:Gi,line:!0,opacity:.6},path:{stroke:Gi},rect:{fill:Gi},point:{fill:Gi,filled:!0,size:75},shape:{stroke:Gi},symbol:{fill:Gi,strokeWidth:1.5,size:50},legend:{titleFont:Nh,titleFontWeight:"bold",titleColor:Rh,labelFont:Nh,labelFontSize:ZO,labelColor:Rh,symbolType:"circle",symbolSize:75},range:{category:[Gi,Tbe,Nbe,Rbe,Obe,Pbe,Lbe,zbe],diverging:i4,heatmap:i4,ordinal:Ibe}},Mb='IBM Plex Sans,system-ui,-apple-system,BlinkMacSystemFont,".sfnstext-regular",sans-serif',Ube='IBM Plex Sans Condensed, system-ui, -apple-system, BlinkMacSystemFont, ".SFNSText-Regular", sans-serif',Tb=400,jm={textPrimary:{g90:"#f4f4f4",g100:"#f4f4f4",white:"#161616",g10:"#161616"},textSecondary:{g90:"#c6c6c6",g100:"#c6c6c6",white:"#525252",g10:"#525252"},layerAccent01:{white:"#e0e0e0",g10:"#e0e0e0",g90:"#525252",g100:"#393939"},gridBg:{white:"#ffffff",g10:"#ffffff",g90:"#161616",g100:"#161616"}},jbe=["#8a3ffc","#33b1ff","#007d79","#ff7eb6","#fa4d56","#fff1f1","#6fdc8c","#4589ff","#d12771","#d2a106","#08bdba","#bae6ff","#ba4e00","#d4bbff"],Wbe=["#6929c4","#1192e8","#005d5d","#9f1853","#fa4d56","#570408","#198038","#002d9c","#ee538b","#b28600","#009d9a","#012749","#8a3800","#a56eff"];function o2({theme:e,background:t}){const n=["white","g10"].includes(e)?"light":"dark",r=jm.gridBg[e],i=jm.textPrimary[e],o=jm.textSecondary[e],s=n==="dark"?jbe:Wbe,a=n==="dark"?"#d4bbff":"#6929c4";return{background:t,arc:{fill:a},area:{fill:a},path:{stroke:a},rect:{fill:a},shape:{stroke:a},symbol:{stroke:a},circle:{fill:a},view:{fill:r,stroke:r},group:{fill:r},title:{color:i,anchor:"start",dy:-15,fontSize:16,font:Mb,fontWeight:600},axis:{labelColor:o,labelFontSize:12,labelFont:Ube,labelFontWeight:Tb,titleColor:i,titleFontWeight:600,titleFontSize:12,grid:!0,gridColor:jm.layerAccent01[e],labelAngle:0},axisX:{titlePadding:10},axisY:{titlePadding:2.5},style:{"guide-label":{font:Mb,fill:o,fontWeight:Tb},"guide-title":{font:Mb,fill:o,fontWeight:Tb}},range:{category:s,diverging:["#750e13","#a2191f","#da1e28","#fa4d56","#ff8389","#ffb3b8","#ffd7d9","#fff1f1","#e5f6ff","#bae6ff","#82cfff","#33b1ff","#1192e8","#0072c3","#00539a","#003a6d"],heatmap:["#f6f2ff","#e8daff","#d4bbff","#be95ff","#a56eff","#8a3ffc","#6929c4","#491d8b","#31135e","#1c0f30"]}}}const qbe=o2({theme:"white",background:"#ffffff"}),Hbe=o2({theme:"g10",background:"#f4f4f4"}),Gbe=o2({theme:"g90",background:"#262626"}),Vbe=o2({theme:"g100",background:"#161616"}),Ybe=dbe.version,Xbe=Object.freeze(Object.defineProperty({__proto__:null,carbong10:Hbe,carbong100:Vbe,carbong90:Gbe,carbonwhite:qbe,dark:hbe,excel:pbe,fivethirtyeight:ybe,ggplot2:vbe,googlecharts:Dbe,latimes:bbe,powerbi:Bbe,quartz:Sbe,urbaninstitute:Fbe,version:Ybe,vox:_be},Symbol.toStringTag,{value:"Module"}));function Qbe(e,t,n,r){if(ne(e))return`[${e.map(i=>t(ve(i)?i:o4(i,n))).join(", ")}]`;if(ye(e)){let i="";const{title:o,image:s,...a}=e;o&&(i+=`<h2>${t(o)}</h2>`),s&&(i+=`<img src="${new URL(t(s),r||location.href).href}">`);const u=Object.keys(a);if(u.length>0){i+="<table>";for(const c of u){let f=a[c];f!==void 0&&(ye(f)&&(f=o4(f,n)),i+=`<tr><td class="key">${t(c)}</td><td class="value">${t(f)}</td></tr>`)}i+="</table>"}return i||"{}"}return t(e)}function Kbe(e){const t=[];return function(n,r){if(typeof r!="object"||r===null)return r;const i=t.indexOf(this)+1;return t.length=i,t.length>e?"[Object]":t.indexOf(r)>=0?"[Circular]":(t.push(r),r)}}function o4(e,t){return JSON.stringify(e,Kbe(t))}var Jbe=`#vg-tooltip-element {
  visibility: hidden;
  padding: 8px;
  position: fixed;
  z-index: 1000;
  font-family: sans-serif;
  font-size: 11px;
  border-radius: 3px;
  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
  /* The default theme is the light theme. */
  background-color: rgba(255, 255, 255, 0.95);
  border: 1px solid #d9d9d9;
  color: black;
}
#vg-tooltip-element.visible {
  visibility: visible;
}
#vg-tooltip-element h2 {
  margin-top: 0;
  margin-bottom: 10px;
  font-size: 13px;
}
#vg-tooltip-element table {
  border-spacing: 0;
}
#vg-tooltip-element table tr {
  border: none;
}
#vg-tooltip-element table tr td {
  overflow: hidden;
  text-overflow: ellipsis;
  padding-top: 2px;
  padding-bottom: 2px;
}
#vg-tooltip-element table tr td.key {
  color: #808080;
  max-width: 150px;
  text-align: right;
  padding-right: 4px;
}
#vg-tooltip-element table tr td.value {
  display: block;
  max-width: 300px;
  max-height: 7em;
  text-align: left;
}
#vg-tooltip-element.dark-theme {
  background-color: rgba(32, 32, 32, 0.9);
  border: 1px solid #f5f5f5;
  color: white;
}
#vg-tooltip-element.dark-theme td.key {
  color: #bfbfbf;
}
`;const vq="vg-tooltip-element",Zbe={offsetX:10,offsetY:10,id:vq,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:eSe,maxDepth:2,formatTooltip:Qbe,baseURL:"",anchor:"cursor",position:["top","bottom","left","right","top-left","top-right","bottom-left","bottom-right"]};function eSe(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;")}function tSe(e){if(!/^[A-Za-z]+[-:.\w]*$/.test(e))throw new Error("Invalid HTML ID");return Jbe.toString().replace(vq,e)}function xq(e,t,{offsetX:n,offsetY:r}){const i=wq({x1:e.clientX,x2:e.clientX,y1:e.clientY,y2:e.clientY},t,n,r),o=["bottom-right","bottom-left","top-right","top-left"];for(const s of o)if(Eq(i[s],t))return i[s];return i["top-left"]}function nSe(e,t,n,r,i){const{position:o,offsetX:s,offsetY:a}=i,u=e._el.getBoundingClientRect(),c=e._origin,f=rSe(u,c,n),h=wq(f,r,s,a),p=Array.isArray(o)?o:[o];for(const m of p)if(Eq(h[m],r)&&!iSe(t,h[m],r))return h[m];return xq(t,r,i)}function rSe(e,t,n){const r=n.isVoronoi?n.datum.bounds:n.bounds;let i=e.left+t[0]+r.x1,o=e.top+t[1]+r.y1,s=n;for(;s.mark.group;)s=s.mark.group,i+=s.x??0,o+=s.y??0;const a=r.x2-r.x1,u=r.y2-r.y1;return{x1:i,x2:i+a,y1:o,y2:o+u}}function wq(e,t,n,r){const i=(e.x1+e.x2)/2,o=(e.y1+e.y2)/2,s=e.x1-t.width-n,a=i-t.width/2,u=e.x2+n,c=e.y1-t.height-r,f=o-t.height/2,h=e.y2+r;return{top:{x:a,y:c},bottom:{x:a,y:h},left:{x:s,y:f},right:{x:u,y:f},"top-left":{x:s,y:c},"top-right":{x:u,y:c},"bottom-left":{x:s,y:h},"bottom-right":{x:u,y:h}}}function Eq(e,t){return e.x>=0&&e.y>=0&&e.x+t.width<=window.innerWidth&&e.y+t.height<=window.innerHeight}function iSe(e,t,n){return e.clientX>=t.x&&e.clientX<=t.x+n.width&&e.clientY>=t.y&&e.clientY<=t.y+n.height}class oSe{constructor(t){this.options={...Zbe,...t};const n=this.options.id;if(this.el=null,this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){const r=document.createElement("style");r.setAttribute("id",this.options.styleId),r.innerHTML=tSe(n);const i=document.head;i.childNodes.length>0?i.insertBefore(r,i.childNodes[0]):i.appendChild(r)}}tooltipHandler(t,n,r,i){if(this.el=document.getElementById(this.options.id),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",this.options.id),this.el.classList.add("vg-tooltip"),(document.fullscreenElement??document.body).appendChild(this.el)),i==null||i===""){this.el.classList.remove("visible",`${this.options.theme}-theme`);return}this.el.innerHTML=this.options.formatTooltip(i,this.options.sanitize,this.options.maxDepth,this.options.baseURL),this.el.classList.add("visible",`${this.options.theme}-theme`);const{x:o,y:s}=this.options.anchor==="mark"?nSe(t,n,r,this.el.getBoundingClientRect(),this.options):xq(n,this.el.getBoundingClientRect(),this.options);this.el.style.top=`${s}px`,this.el.style.left=`${o}px`}}var Nb={};/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2022 Joachim Wester
 * MIT licensed
 */var sSe=(function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),aSe=Object.prototype.hasOwnProperty;function lA(e,t){return aSe.call(e,t)}function cA(e){if(Array.isArray(e)){for(var t=new Array(e.length),n=0;n<t.length;n++)t[n]=""+n;return t}if(Object.keys)return Object.keys(e);var r=[];for(var i in e)lA(e,i)&&r.push(i);return r}function ni(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function fA(e){for(var t=0,n=e.length,r;t<n;){if(r=e.charCodeAt(t),r>=48&&r<=57){t++;continue}return!1}return!0}function nl(e){return e.indexOf("/")===-1&&e.indexOf("~")===-1?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function bq(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function dA(e){if(e===void 0)return!0;if(e){if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(dA(e[t]))return!0}else if(typeof e=="object"){for(var r=cA(e),i=r.length,o=0;o<i;o++)if(dA(e[r[o]]))return!0}}return!1}function s4(e,t){var n=[e];for(var r in t){var i=typeof t[r]=="object"?JSON.stringify(t[r],null,2):t[r];typeof i<"u"&&n.push(r+": "+i)}return n.join(`
`)}var Sq=(function(e){sSe(t,e);function t(n,r,i,o,s){var a=this.constructor,u=e.call(this,s4(n,{name:r,index:i,operation:o,tree:s}))||this;return u.name=r,u.index=i,u.operation=o,u.tree=s,Object.setPrototypeOf(u,a.prototype),u.message=s4(n,{name:r,index:i,operation:o,tree:s}),u}return t})(Error),Ut=Sq,uSe=ni,of={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var r=e[t];return delete e[t],{newDocument:n,removed:r}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:function(e,t,n){var r=Xy(n,this.path);r&&(r=ni(r));var i=El(n,{op:"remove",path:this.from}).removed;return El(n,{op:"add",path:this.path,value:i}),{newDocument:n,removed:r}},copy:function(e,t,n){var r=Xy(n,this.from);return El(n,{op:"add",path:this.path,value:ni(r)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:Jp(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},lSe={add:function(e,t,n){return fA(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){var r=e.splice(t,1);return{newDocument:n,removed:r[0]}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:of.move,copy:of.copy,test:of.test,_get:of._get};function Xy(e,t){if(t=="")return e;var n={op:"_get",path:t};return El(e,n),n.value}function El(e,t,n,r,i,o){if(n===void 0&&(n=!1),r===void 0&&(r=!0),i===void 0&&(i=!0),o===void 0&&(o=0),n&&(typeof n=="function"?n(t,0,e,t.path):Qy(t,0)),t.path===""){var s={newDocument:e};if(t.op==="add")return s.newDocument=t.value,s;if(t.op==="replace")return s.newDocument=t.value,s.removed=e,s;if(t.op==="move"||t.op==="copy")return s.newDocument=Xy(e,t.from),t.op==="move"&&(s.removed=e),s;if(t.op==="test"){if(s.test=Jp(e,t.value),s.test===!1)throw new Ut("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return s.newDocument=e,s}else{if(t.op==="remove")return s.removed=e,s.newDocument=null,s;if(t.op==="_get")return t.value=e,s;if(n)throw new Ut("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",o,t,e);return s}}else{r||(e=ni(e));var a=t.path||"",u=a.split("/"),c=e,f=1,h=u.length,p=void 0,m=void 0,y=void 0;for(typeof n=="function"?y=n:y=Qy;;){if(m=u[f],m&&m.indexOf("~")!=-1&&(m=bq(m)),i&&(m=="__proto__"||m=="prototype"&&f>0&&u[f-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&p===void 0&&(c[m]===void 0?p=u.slice(0,f).join("/"):f==h-1&&(p=t.path),p!==void 0&&y(t,0,e,p)),f++,Array.isArray(c)){if(m==="-")m=c.length;else{if(n&&!fA(m))throw new Ut("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",o,t,e);fA(m)&&(m=~~m)}if(f>=h){if(n&&t.op==="add"&&m>c.length)throw new Ut("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",o,t,e);var s=lSe[t.op].call(t,c,m,e);if(s.test===!1)throw new Ut("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return s}}else if(f>=h){var s=of[t.op].call(t,c,m,e);if(s.test===!1)throw new Ut("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return s}if(c=c[m],n&&f<h&&(!c||typeof c!="object"))throw new Ut("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",o,t,e)}}}function s2(e,t,n,r,i){if(r===void 0&&(r=!0),i===void 0&&(i=!0),n&&!Array.isArray(t))throw new Ut("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(e=ni(e));for(var o=new Array(t.length),s=0,a=t.length;s<a;s++)o[s]=El(e,t[s],n,!0,i,s),e=o[s].newDocument;return o.newDocument=e,o}function cSe(e,t,n){var r=El(e,t);if(r.test===!1)throw new Ut("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return r.newDocument}function Qy(e,t,n,r){if(typeof e!="object"||e===null||Array.isArray(e))throw new Ut("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(of[e.op]){if(typeof e.path!="string")throw new Ut("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(e.path.indexOf("/")!==0&&e.path.length>0)throw new Ut('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if((e.op==="move"||e.op==="copy")&&typeof e.from!="string")throw new Ut("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&e.value===void 0)throw new Ut("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&dA(e.value))throw new Ut("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n){if(e.op=="add"){var i=e.path.split("/").length,o=r.split("/").length;if(i!==o+1&&i!==o)throw new Ut("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if(e.op==="replace"||e.op==="remove"||e.op==="_get"){if(e.path!==r)throw new Ut("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if(e.op==="move"||e.op==="copy"){var s={op:"_get",path:e.from,value:void 0},a=_q([s],n);if(a&&a.name==="OPERATION_PATH_UNRESOLVABLE")throw new Ut("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}}else throw new Ut("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n)}function _q(e,t,n){try{if(!Array.isArray(e))throw new Ut("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)s2(ni(t),ni(e),n||!0);else{n=n||Qy;for(var r=0;r<e.length;r++)n(e[r],r,t,void 0)}}catch(i){if(i instanceof Ut)return i;throw i}}function Jp(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){var n=Array.isArray(e),r=Array.isArray(t),i,o,s;if(n&&r){if(o=e.length,o!=t.length)return!1;for(i=o;i--!==0;)if(!Jp(e[i],t[i]))return!1;return!0}if(n!=r)return!1;var a=Object.keys(e);if(o=a.length,o!==Object.keys(t).length)return!1;for(i=o;i--!==0;)if(!t.hasOwnProperty(a[i]))return!1;for(i=o;i--!==0;)if(s=a[i],!Jp(e[s],t[s]))return!1;return!0}return e!==e&&t!==t}var fSe=Object.freeze({__proto__:null,JsonPatchError:Ut,_areEquals:Jp,applyOperation:El,applyPatch:s2,applyReducer:cSe,deepClone:uSe,getValueByPointer:Xy,validate:_q,validator:Qy});/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2021 Joachim Wester
 * MIT license
 */var O3=new WeakMap,dSe=(function(){function e(t){this.observers=new Map,this.obj=t}return e})(),hSe=(function(){function e(t,n){this.callback=t,this.observer=n}return e})();function pSe(e){return O3.get(e)}function gSe(e,t){return e.observers.get(t)}function mSe(e,t){e.observers.delete(t.callback)}function ySe(e,t){t.unobserve()}function vSe(e,t){var n=[],r,i=pSe(e);if(!i)i=new dSe(e),O3.set(e,i);else{var o=gSe(i,t);r=o&&o.observer}if(r)return r;if(r={},i.value=ni(e),t){r.callback=t,r.next=null;var s=function(){hA(r)},a=function(){clearTimeout(r.next),r.next=setTimeout(s)};typeof window<"u"&&(window.addEventListener("mouseup",a),window.addEventListener("keyup",a),window.addEventListener("mousedown",a),window.addEventListener("keydown",a),window.addEventListener("change",a))}return r.patches=n,r.object=e,r.unobserve=function(){hA(r),clearTimeout(r.next),mSe(i,r),typeof window<"u"&&(window.removeEventListener("mouseup",a),window.removeEventListener("keyup",a),window.removeEventListener("mousedown",a),window.removeEventListener("keydown",a),window.removeEventListener("change",a))},i.observers.set(t,new hSe(t,r)),r}function hA(e,t){t===void 0&&(t=!1);var n=O3.get(e.object);P3(n.value,e.object,e.patches,"",t),e.patches.length&&s2(n.value,e.patches);var r=e.patches;return r.length>0&&(e.patches=[],e.callback&&e.callback(r)),r}function P3(e,t,n,r,i){if(t!==e){typeof t.toJSON=="function"&&(t=t.toJSON());for(var o=cA(t),s=cA(e),a=!1,u=s.length-1;u>=0;u--){var c=s[u],f=e[c];if(lA(t,c)&&!(t[c]===void 0&&f!==void 0&&Array.isArray(t)===!1)){var h=t[c];typeof f=="object"&&f!=null&&typeof h=="object"&&h!=null&&Array.isArray(f)===Array.isArray(h)?P3(f,h,n,r+"/"+nl(c),i):f!==h&&(i&&n.push({op:"test",path:r+"/"+nl(c),value:ni(f)}),n.push({op:"replace",path:r+"/"+nl(c),value:ni(h)}))}else Array.isArray(e)===Array.isArray(t)?(i&&n.push({op:"test",path:r+"/"+nl(c),value:ni(f)}),n.push({op:"remove",path:r+"/"+nl(c)}),a=!0):(i&&n.push({op:"test",path:r,value:e}),n.push({op:"replace",path:r,value:t}))}if(!(!a&&o.length==s.length))for(var u=0;u<o.length;u++){var c=o[u];!lA(e,c)&&t[c]!==void 0&&n.push({op:"add",path:r+"/"+nl(c),value:ni(t[c])})}}}function xSe(e,t,n){n===void 0&&(n=!1);var r=[];return P3(e,t,r,"",n),r}var wSe=Object.freeze({__proto__:null,compare:xSe,generate:hA,observe:vSe,unobserve:ySe});Object.assign({},fSe,wSe,{JsonPatchError:Sq,deepClone:ni,escapePathComponent:nl,unescapePathComponent:bq});function ESe(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Rb,a4;function bSe(){if(a4)return Rb;a4=1;class e{constructor(){this.max=1e3,this.map=new Map}get(n){const r=this.map.get(n);if(r!==void 0)return this.map.delete(n),this.map.set(n,r),r}delete(n){return this.map.delete(n)}set(n,r){if(!this.delete(n)&&r!==void 0){if(this.map.size>=this.max){const o=this.map.keys().next().value;this.delete(o)}this.map.set(n,r)}return this}}return Rb=e,Rb}var Ob,u4;function L3(){if(u4)return Ob;u4=1;const e=Object.freeze({loose:!0}),t=Object.freeze({});return Ob=r=>r?typeof r!="object"?e:r:t,Ob}var Wm={exports:{}},Pb,l4;function z3(){if(l4)return Pb;l4=1;const e="2.0.0",t=256,n=Number.MAX_SAFE_INTEGER||9007199254740991,r=16,i=t-6;return Pb={MAX_LENGTH:t,MAX_SAFE_COMPONENT_LENGTH:r,MAX_SAFE_BUILD_LENGTH:i,MAX_SAFE_INTEGER:n,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:e,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},Pb}var Lb,c4;function a2(){return c4||(c4=1,Lb=typeof process=="object"&&Nb&&Nb.NODE_DEBUG&&/\bsemver\b/i.test(Nb.NODE_DEBUG)?(...t)=>console.error("SEMVER",...t):()=>{}),Lb}var f4;function I3(){return f4||(f4=1,(function(e,t){const{MAX_SAFE_COMPONENT_LENGTH:n,MAX_SAFE_BUILD_LENGTH:r,MAX_LENGTH:i}=z3(),o=a2();t=e.exports={};const s=t.re=[],a=t.safeRe=[],u=t.src=[],c=t.t={};let f=0;const h="[a-zA-Z0-9-]",p=[["\\s",1],["\\d",i],[h,r]],m=v=>{for(const[w,E]of p)v=v.split(`${w}*`).join(`${w}{0,${E}}`).split(`${w}+`).join(`${w}{1,${E}}`);return v},y=(v,w,E)=>{const S=m(w),A=f++;o(v,A,w),c[v]=A,u[A]=w,s[A]=new RegExp(w,E?"g":void 0),a[A]=new RegExp(S,E?"g":void 0)};y("NUMERICIDENTIFIER","0|[1-9]\\d*"),y("NUMERICIDENTIFIERLOOSE","\\d+"),y("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${h}*`),y("MAINVERSION",`(${u[c.NUMERICIDENTIFIER]})\\.(${u[c.NUMERICIDENTIFIER]})\\.(${u[c.NUMERICIDENTIFIER]})`),y("MAINVERSIONLOOSE",`(${u[c.NUMERICIDENTIFIERLOOSE]})\\.(${u[c.NUMERICIDENTIFIERLOOSE]})\\.(${u[c.NUMERICIDENTIFIERLOOSE]})`),y("PRERELEASEIDENTIFIER",`(?:${u[c.NUMERICIDENTIFIER]}|${u[c.NONNUMERICIDENTIFIER]})`),y("PRERELEASEIDENTIFIERLOOSE",`(?:${u[c.NUMERICIDENTIFIERLOOSE]}|${u[c.NONNUMERICIDENTIFIER]})`),y("PRERELEASE",`(?:-(${u[c.PRERELEASEIDENTIFIER]}(?:\\.${u[c.PRERELEASEIDENTIFIER]})*))`),y("PRERELEASELOOSE",`(?:-?(${u[c.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${u[c.PRERELEASEIDENTIFIERLOOSE]})*))`),y("BUILDIDENTIFIER",`${h}+`),y("BUILD",`(?:\\+(${u[c.BUILDIDENTIFIER]}(?:\\.${u[c.BUILDIDENTIFIER]})*))`),y("FULLPLAIN",`v?${u[c.MAINVERSION]}${u[c.PRERELEASE]}?${u[c.BUILD]}?`),y("FULL",`^${u[c.FULLPLAIN]}$`),y("LOOSEPLAIN",`[v=\\s]*${u[c.MAINVERSIONLOOSE]}${u[c.PRERELEASELOOSE]}?${u[c.BUILD]}?`),y("LOOSE",`^${u[c.LOOSEPLAIN]}$`),y("GTLT","((?:<|>)?=?)"),y("XRANGEIDENTIFIERLOOSE",`${u[c.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),y("XRANGEIDENTIFIER",`${u[c.NUMERICIDENTIFIER]}|x|X|\\*`),y("XRANGEPLAIN",`[v=\\s]*(${u[c.XRANGEIDENTIFIER]})(?:\\.(${u[c.XRANGEIDENTIFIER]})(?:\\.(${u[c.XRANGEIDENTIFIER]})(?:${u[c.PRERELEASE]})?${u[c.BUILD]}?)?)?`),y("XRANGEPLAINLOOSE",`[v=\\s]*(${u[c.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[c.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[c.XRANGEIDENTIFIERLOOSE]})(?:${u[c.PRERELEASELOOSE]})?${u[c.BUILD]}?)?)?`),y("XRANGE",`^${u[c.GTLT]}\\s*${u[c.XRANGEPLAIN]}$`),y("XRANGELOOSE",`^${u[c.GTLT]}\\s*${u[c.XRANGEPLAINLOOSE]}$`),y("COERCEPLAIN",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?`),y("COERCE",`${u[c.COERCEPLAIN]}(?:$|[^\\d])`),y("COERCEFULL",u[c.COERCEPLAIN]+`(?:${u[c.PRERELEASE]})?(?:${u[c.BUILD]})?(?:$|[^\\d])`),y("COERCERTL",u[c.COERCE],!0),y("COERCERTLFULL",u[c.COERCEFULL],!0),y("LONETILDE","(?:~>?)"),y("TILDETRIM",`(\\s*)${u[c.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",y("TILDE",`^${u[c.LONETILDE]}${u[c.XRANGEPLAIN]}$`),y("TILDELOOSE",`^${u[c.LONETILDE]}${u[c.XRANGEPLAINLOOSE]}$`),y("LONECARET","(?:\\^)"),y("CARETTRIM",`(\\s*)${u[c.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",y("CARET",`^${u[c.LONECARET]}${u[c.XRANGEPLAIN]}$`),y("CARETLOOSE",`^${u[c.LONECARET]}${u[c.XRANGEPLAINLOOSE]}$`),y("COMPARATORLOOSE",`^${u[c.GTLT]}\\s*(${u[c.LOOSEPLAIN]})$|^$`),y("COMPARATOR",`^${u[c.GTLT]}\\s*(${u[c.FULLPLAIN]})$|^$`),y("COMPARATORTRIM",`(\\s*)${u[c.GTLT]}\\s*(${u[c.LOOSEPLAIN]}|${u[c.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",y("HYPHENRANGE",`^\\s*(${u[c.XRANGEPLAIN]})\\s+-\\s+(${u[c.XRANGEPLAIN]})\\s*$`),y("HYPHENRANGELOOSE",`^\\s*(${u[c.XRANGEPLAINLOOSE]})\\s+-\\s+(${u[c.XRANGEPLAINLOOSE]})\\s*$`),y("STAR","(<|>)?=?\\s*\\*"),y("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),y("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")})(Wm,Wm.exports)),Wm.exports}var zb,d4;function SSe(){if(d4)return zb;d4=1;const e=/^[0-9]+$/,t=(r,i)=>{const o=e.test(r),s=e.test(i);return o&&s&&(r=+r,i=+i),r===i?0:o&&!s?-1:s&&!o?1:r<i?-1:1};return zb={compareIdentifiers:t,rcompareIdentifiers:(r,i)=>t(i,r)},zb}var Ib,h4;function B3(){if(h4)return Ib;h4=1;const e=a2(),{MAX_LENGTH:t,MAX_SAFE_INTEGER:n}=z3(),{safeRe:r,t:i}=I3(),o=L3(),{compareIdentifiers:s}=SSe();class a{constructor(c,f){if(f=o(f),c instanceof a){if(c.loose===!!f.loose&&c.includePrerelease===!!f.includePrerelease)return c;c=c.version}else if(typeof c!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof c}".`);if(c.length>t)throw new TypeError(`version is longer than ${t} characters`);e("SemVer",c,f),this.options=f,this.loose=!!f.loose,this.includePrerelease=!!f.includePrerelease;const h=c.trim().match(f.loose?r[i.LOOSE]:r[i.FULL]);if(!h)throw new TypeError(`Invalid Version: ${c}`);if(this.raw=c,this.major=+h[1],this.minor=+h[2],this.patch=+h[3],this.major>n||this.major<0)throw new TypeError("Invalid major version");if(this.minor>n||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>n||this.patch<0)throw new TypeError("Invalid patch version");h[4]?this.prerelease=h[4].split(".").map(p=>{if(/^[0-9]+$/.test(p)){const m=+p;if(m>=0&&m<n)return m}return p}):this.prerelease=[],this.build=h[5]?h[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(c){if(e("SemVer.compare",this.version,this.options,c),!(c instanceof a)){if(typeof c=="string"&&c===this.version)return 0;c=new a(c,this.options)}return c.version===this.version?0:this.compareMain(c)||this.comparePre(c)}compareMain(c){return c instanceof a||(c=new a(c,this.options)),s(this.major,c.major)||s(this.minor,c.minor)||s(this.patch,c.patch)}comparePre(c){if(c instanceof a||(c=new a(c,this.options)),this.prerelease.length&&!c.prerelease.length)return-1;if(!this.prerelease.length&&c.prerelease.length)return 1;if(!this.prerelease.length&&!c.prerelease.length)return 0;let f=0;do{const h=this.prerelease[f],p=c.prerelease[f];if(e("prerelease compare",f,h,p),h===void 0&&p===void 0)return 0;if(p===void 0)return 1;if(h===void 0)return-1;if(h===p)continue;return s(h,p)}while(++f)}compareBuild(c){c instanceof a||(c=new a(c,this.options));let f=0;do{const h=this.build[f],p=c.build[f];if(e("build compare",f,h,p),h===void 0&&p===void 0)return 0;if(p===void 0)return 1;if(h===void 0)return-1;if(h===p)continue;return s(h,p)}while(++f)}inc(c,f,h){switch(c){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",f,h);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",f,h);break;case"prepatch":this.prerelease.length=0,this.inc("patch",f,h),this.inc("pre",f,h);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",f,h),this.inc("pre",f,h);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const p=Number(h)?1:0;if(!f&&h===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[p];else{let m=this.prerelease.length;for(;--m>=0;)typeof this.prerelease[m]=="number"&&(this.prerelease[m]++,m=-2);if(m===-1){if(f===this.prerelease.join(".")&&h===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(p)}}if(f){let m=[f,p];h===!1&&(m=[f]),s(this.prerelease[0],f)===0?isNaN(this.prerelease[1])&&(this.prerelease=m):this.prerelease=m}break}default:throw new Error(`invalid increment argument: ${c}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}return Ib=a,Ib}var Bb,p4;function Sd(){if(p4)return Bb;p4=1;const e=B3();return Bb=(n,r,i)=>new e(n,i).compare(new e(r,i)),Bb}var Ub,g4;function _Se(){if(g4)return Ub;g4=1;const e=Sd();return Ub=(n,r,i)=>e(n,r,i)===0,Ub}var jb,m4;function ASe(){if(m4)return jb;m4=1;const e=Sd();return jb=(n,r,i)=>e(n,r,i)!==0,jb}var Wb,y4;function CSe(){if(y4)return Wb;y4=1;const e=Sd();return Wb=(n,r,i)=>e(n,r,i)>0,Wb}var qb,v4;function kSe(){if(v4)return qb;v4=1;const e=Sd();return qb=(n,r,i)=>e(n,r,i)>=0,qb}var Hb,x4;function $Se(){if(x4)return Hb;x4=1;const e=Sd();return Hb=(n,r,i)=>e(n,r,i)<0,Hb}var Gb,w4;function FSe(){if(w4)return Gb;w4=1;const e=Sd();return Gb=(n,r,i)=>e(n,r,i)<=0,Gb}var Vb,E4;function DSe(){if(E4)return Vb;E4=1;const e=_Se(),t=ASe(),n=CSe(),r=kSe(),i=$Se(),o=FSe();return Vb=(a,u,c,f)=>{switch(u){case"===":return typeof a=="object"&&(a=a.version),typeof c=="object"&&(c=c.version),a===c;case"!==":return typeof a=="object"&&(a=a.version),typeof c=="object"&&(c=c.version),a!==c;case"":case"=":case"==":return e(a,c,f);case"!=":return t(a,c,f);case">":return n(a,c,f);case">=":return r(a,c,f);case"<":return i(a,c,f);case"<=":return o(a,c,f);default:throw new TypeError(`Invalid operator: ${u}`)}},Vb}var Yb,b4;function MSe(){if(b4)return Yb;b4=1;const e=Symbol("SemVer ANY");class t{static get ANY(){return e}constructor(f,h){if(h=n(h),f instanceof t){if(f.loose===!!h.loose)return f;f=f.value}f=f.trim().split(/\s+/).join(" "),s("comparator",f,h),this.options=h,this.loose=!!h.loose,this.parse(f),this.semver===e?this.value="":this.value=this.operator+this.semver.version,s("comp",this)}parse(f){const h=this.options.loose?r[i.COMPARATORLOOSE]:r[i.COMPARATOR],p=f.match(h);if(!p)throw new TypeError(`Invalid comparator: ${f}`);this.operator=p[1]!==void 0?p[1]:"",this.operator==="="&&(this.operator=""),p[2]?this.semver=new a(p[2],this.options.loose):this.semver=e}toString(){return this.value}test(f){if(s("Comparator.test",f,this.options.loose),this.semver===e||f===e)return!0;if(typeof f=="string")try{f=new a(f,this.options)}catch{return!1}return o(f,this.operator,this.semver,this.options)}intersects(f,h){if(!(f instanceof t))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new u(f.value,h).test(this.value):f.operator===""?f.value===""?!0:new u(this.value,h).test(f.semver):(h=n(h),h.includePrerelease&&(this.value==="<0.0.0-0"||f.value==="<0.0.0-0")||!h.includePrerelease&&(this.value.startsWith("<0.0.0")||f.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&f.operator.startsWith(">")||this.operator.startsWith("<")&&f.operator.startsWith("<")||this.semver.version===f.semver.version&&this.operator.includes("=")&&f.operator.includes("=")||o(this.semver,"<",f.semver,h)&&this.operator.startsWith(">")&&f.operator.startsWith("<")||o(this.semver,">",f.semver,h)&&this.operator.startsWith("<")&&f.operator.startsWith(">")))}}Yb=t;const n=L3(),{safeRe:r,t:i}=I3(),o=DSe(),s=a2(),a=B3(),u=Aq();return Yb}var Xb,S4;function Aq(){if(S4)return Xb;S4=1;const e=/\s+/g;class t{constructor(N,U){if(U=i(U),N instanceof t)return N.loose===!!U.loose&&N.includePrerelease===!!U.includePrerelease?N:new t(N.raw,U);if(N instanceof o)return this.raw=N.value,this.set=[[N]],this.formatted=void 0,this;if(this.options=U,this.loose=!!U.loose,this.includePrerelease=!!U.includePrerelease,this.raw=N.trim().replace(e," "),this.set=this.raw.split("||").map(Y=>this.parseRange(Y.trim())).filter(Y=>Y.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const Y=this.set[0];if(this.set=this.set.filter(j=>!v(j[0])),this.set.length===0)this.set=[Y];else if(this.set.length>1){for(const j of this.set)if(j.length===1&&w(j[0])){this.set=[j];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let N=0;N<this.set.length;N++){N>0&&(this.formatted+="||");const U=this.set[N];for(let Y=0;Y<U.length;Y++)Y>0&&(this.formatted+=" "),this.formatted+=U[Y].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(N){const Y=((this.options.includePrerelease&&m)|(this.options.loose&&y))+":"+N,j=r.get(Y);if(j)return j;const q=this.options.loose,K=q?u[c.HYPHENRANGELOOSE]:u[c.HYPHENRANGE];N=N.replace(K,X(this.options.includePrerelease)),s("hyphen replace",N),N=N.replace(u[c.COMPARATORTRIM],f),s("comparator trim",N),N=N.replace(u[c.TILDETRIM],h),s("tilde trim",N),N=N.replace(u[c.CARETTRIM],p),s("caret trim",N);let P=N.split(" ").map(we=>S(we,this.options)).join(" ").split(/\s+/).map(we=>O(we,this.options));q&&(P=P.filter(we=>(s("loose invalid filter",we,this.options),!!we.match(u[c.COMPARATORLOOSE])))),s("range list",P);const G=new Map,me=P.map(we=>new o(we,this.options));for(const we of me){if(v(we))return[we];G.set(we.value,we)}G.size>1&&G.has("")&&G.delete("");const _e=[...G.values()];return r.set(Y,_e),_e}intersects(N,U){if(!(N instanceof t))throw new TypeError("a Range is required");return this.set.some(Y=>E(Y,U)&&N.set.some(j=>E(j,U)&&Y.every(q=>j.every(K=>q.intersects(K,U)))))}test(N){if(!N)return!1;if(typeof N=="string")try{N=new a(N,this.options)}catch{return!1}for(let U=0;U<this.set.length;U++)if(W(this.set[U],N,this.options))return!0;return!1}}Xb=t;const n=bSe(),r=new n,i=L3(),o=MSe(),s=a2(),a=B3(),{safeRe:u,t:c,comparatorTrimReplace:f,tildeTrimReplace:h,caretTrimReplace:p}=I3(),{FLAG_INCLUDE_PRERELEASE:m,FLAG_LOOSE:y}=z3(),v=I=>I.value==="<0.0.0-0",w=I=>I.value==="",E=(I,N)=>{let U=!0;const Y=I.slice();let j=Y.pop();for(;U&&Y.length;)U=Y.every(q=>j.intersects(q,N)),j=Y.pop();return U},S=(I,N)=>(s("comp",I,N),I=D(I,N),s("caret",I),I=C(I,N),s("tildes",I),I=M(I,N),s("xrange",I),I=L(I,N),s("stars",I),I),A=I=>!I||I.toLowerCase()==="x"||I==="*",C=(I,N)=>I.trim().split(/\s+/).map(U=>k(U,N)).join(" "),k=(I,N)=>{const U=N.loose?u[c.TILDELOOSE]:u[c.TILDE];return I.replace(U,(Y,j,q,K,P)=>{s("tilde",I,Y,j,q,K,P);let G;return A(j)?G="":A(q)?G=`>=${j}.0.0 <${+j+1}.0.0-0`:A(K)?G=`>=${j}.${q}.0 <${j}.${+q+1}.0-0`:P?(s("replaceTilde pr",P),G=`>=${j}.${q}.${K}-${P} <${j}.${+q+1}.0-0`):G=`>=${j}.${q}.${K} <${j}.${+q+1}.0-0`,s("tilde return",G),G})},D=(I,N)=>I.trim().split(/\s+/).map(U=>$(U,N)).join(" "),$=(I,N)=>{s("caret",I,N);const U=N.loose?u[c.CARETLOOSE]:u[c.CARET],Y=N.includePrerelease?"-0":"";return I.replace(U,(j,q,K,P,G)=>{s("caret",I,j,q,K,P,G);let me;return A(q)?me="":A(K)?me=`>=${q}.0.0${Y} <${+q+1}.0.0-0`:A(P)?q==="0"?me=`>=${q}.${K}.0${Y} <${q}.${+K+1}.0-0`:me=`>=${q}.${K}.0${Y} <${+q+1}.0.0-0`:G?(s("replaceCaret pr",G),q==="0"?K==="0"?me=`>=${q}.${K}.${P}-${G} <${q}.${K}.${+P+1}-0`:me=`>=${q}.${K}.${P}-${G} <${q}.${+K+1}.0-0`:me=`>=${q}.${K}.${P}-${G} <${+q+1}.0.0-0`):(s("no pr"),q==="0"?K==="0"?me=`>=${q}.${K}.${P}${Y} <${q}.${K}.${+P+1}-0`:me=`>=${q}.${K}.${P}${Y} <${q}.${+K+1}.0-0`:me=`>=${q}.${K}.${P} <${+q+1}.0.0-0`),s("caret return",me),me})},M=(I,N)=>(s("replaceXRanges",I,N),I.split(/\s+/).map(U=>T(U,N)).join(" ")),T=(I,N)=>{I=I.trim();const U=N.loose?u[c.XRANGELOOSE]:u[c.XRANGE];return I.replace(U,(Y,j,q,K,P,G)=>{s("xRange",I,Y,j,q,K,P,G);const me=A(q),_e=me||A(K),we=_e||A(P),Ie=we;return j==="="&&Ie&&(j=""),G=N.includePrerelease?"-0":"",me?j===">"||j==="<"?Y="<0.0.0-0":Y="*":j&&Ie?(_e&&(K=0),P=0,j===">"?(j=">=",_e?(q=+q+1,K=0,P=0):(K=+K+1,P=0)):j==="<="&&(j="<",_e?q=+q+1:K=+K+1),j==="<"&&(G="-0"),Y=`${j+q}.${K}.${P}${G}`):_e?Y=`>=${q}.0.0${G} <${+q+1}.0.0-0`:we&&(Y=`>=${q}.${K}.0${G} <${q}.${+K+1}.0-0`),s("xRange return",Y),Y})},L=(I,N)=>(s("replaceStars",I,N),I.trim().replace(u[c.STAR],"")),O=(I,N)=>(s("replaceGTE0",I,N),I.trim().replace(u[N.includePrerelease?c.GTE0PRE:c.GTE0],"")),X=I=>(N,U,Y,j,q,K,P,G,me,_e,we,Ie)=>(A(Y)?U="":A(j)?U=`>=${Y}.0.0${I?"-0":""}`:A(q)?U=`>=${Y}.${j}.0${I?"-0":""}`:K?U=`>=${U}`:U=`>=${U}${I?"-0":""}`,A(me)?G="":A(_e)?G=`<${+me+1}.0.0-0`:A(we)?G=`<${me}.${+_e+1}.0-0`:Ie?G=`<=${me}.${_e}.${we}-${Ie}`:I?G=`<${me}.${_e}.${+we+1}-0`:G=`<=${G}`,`${U} ${G}`.trim()),W=(I,N,U)=>{for(let Y=0;Y<I.length;Y++)if(!I[Y].test(N))return!1;if(N.prerelease.length&&!U.includePrerelease){for(let Y=0;Y<I.length;Y++)if(s(I[Y].semver),I[Y].semver!==o.ANY&&I[Y].semver.prerelease.length>0){const j=I[Y].semver;if(j.major===N.major&&j.minor===N.minor&&j.patch===N.patch)return!0}return!1}return!0};return Xb}var Qb,_4;function TSe(){if(_4)return Qb;_4=1;const e=Aq();return Qb=(n,r,i)=>{try{r=new e(r,i)}catch{return!1}return r.test(n)},Qb}var NSe=TSe(),Cq=ESe(NSe);function RSe(e,t,n){const r=e.open(t),i=250,{origin:o}=new URL(t);let s=40;function a(c){c.source===r&&(s=0,e.removeEventListener("message",a,!1))}e.addEventListener("message",a,!1);function u(){s<=0||(r.postMessage(n,o),setTimeout(u,i),s-=1)}setTimeout(u,i)}var OSe=`.vega-embed {
  position: relative;
  display: inline-block;
  box-sizing: border-box;
}
.vega-embed.has-actions {
  padding-right: 38px;
}
.vega-embed details:not([open]) > :not(summary) {
  display: none !important;
}
.vega-embed summary {
  list-style: none;
  position: absolute;
  top: 0;
  right: 0;
  padding: 6px;
  z-index: 1000;
  background: white;
  box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
  color: #1b1e23;
  border: 1px solid #aaa;
  border-radius: 999px;
  opacity: 0.2;
  transition: opacity 0.4s ease-in;
  cursor: pointer;
  line-height: 0px;
}
.vega-embed summary::-webkit-details-marker {
  display: none;
}
.vega-embed summary:active {
  box-shadow: #aaa 0px 0px 0px 1px inset;
}
.vega-embed summary svg {
  width: 14px;
  height: 14px;
}
.vega-embed details[open] summary {
  opacity: 0.7;
}
.vega-embed:hover summary, .vega-embed:focus-within summary {
  opacity: 1 !important;
  transition: opacity 0.2s ease;
}
.vega-embed .vega-actions {
  position: absolute;
  z-index: 1001;
  top: 35px;
  right: -9px;
  display: flex;
  flex-direction: column;
  padding-bottom: 8px;
  padding-top: 8px;
  border-radius: 4px;
  box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);
  border: 1px solid #d9d9d9;
  background: white;
  animation-duration: 0.15s;
  animation-name: scale-in;
  animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);
  text-align: left;
}
.vega-embed .vega-actions a {
  padding: 8px 16px;
  font-family: sans-serif;
  font-size: 14px;
  font-weight: 600;
  white-space: nowrap;
  color: #434a56;
  text-decoration: none;
}
.vega-embed .vega-actions a:hover, .vega-embed .vega-actions a:focus {
  background-color: #f7f7f9;
  color: black;
}
.vega-embed .vega-actions::before, .vega-embed .vega-actions::after {
  content: "";
  display: inline-block;
  position: absolute;
}
.vega-embed .vega-actions::before {
  left: auto;
  right: 14px;
  top: -16px;
  border: 8px solid rgba(0, 0, 0, 0);
  border-bottom-color: #d9d9d9;
}
.vega-embed .vega-actions::after {
  left: auto;
  right: 15px;
  top: -14px;
  border: 7px solid rgba(0, 0, 0, 0);
  border-bottom-color: #fff;
}
.vega-embed .chart-wrapper.fit-x {
  width: 100%;
}
.vega-embed .chart-wrapper.fit-y {
  height: 100%;
}

.vega-embed-wrapper {
  max-width: 100%;
  overflow: auto;
  padding-right: 14px;
}

@keyframes scale-in {
  from {
    opacity: 0;
    transform: scale(0.6);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}
`;function kq(e,...t){for(const n of t)PSe(e,n);return e}function PSe(e,t){for(const n of Object.keys(t))Zf(e,n,t[n],!0)}const Do=fge;let Zp=cbe;const qm=typeof window<"u"?window:void 0;var F4;Zp===void 0&&((F4=qm==null?void 0:qm.vl)!=null&&F4.compile)&&(Zp=qm.vl);const LSe={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},zSe={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},op={vega:"Vega","vega-lite":"Vega-Lite"},Ky={vega:Do.version,"vega-lite":Zp?Zp.version:"not available"},ISe={vega:e=>e,"vega-lite":(e,t)=>Zp.compile(e,{config:t}).spec},BSe=`
<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">
  <circle r="2" cy="8" cx="2"></circle>
  <circle r="2" cy="8" cx="8"></circle>
  <circle r="2" cy="8" cx="14"></circle>
</svg>`,USe="chart-wrapper";function jSe(e){return typeof e=="function"}function A4(e,t,n,r){const i=`<html><head>${t}</head><body><pre><code class="json">`,o=`</code></pre>${n}</body></html>`,s=window.open("");s.document.write(i+e+o),s.document.title=`${op[r]} JSON Source`}function WSe(e,t){if(e.$schema){const n=gq(e.$schema);t&&t!==n.library&&console.warn(`The given visualization spec is written in ${op[n.library]}, but mode argument sets ${op[t]??t}.`);const r=n.library;return Cq(Ky[r],`^${n.version.slice(1)}`)||console.warn(`The input spec uses ${op[r]} ${n.version}, but the current version of ${op[r]} is v${Ky[r]}.`),r}return"mark"in e||"encoding"in e||"layer"in e||"hconcat"in e||"vconcat"in e||"facet"in e||"repeat"in e?"vega-lite":"marks"in e||"signals"in e||"scales"in e||"axes"in e?"vega":t??"vega"}function $q(e){return!!(e&&"load"in e)}function C4(e){return $q(e)?e:Do.loader(e)}function qSe(e){var n;const t=((n=e.usermeta)==null?void 0:n.embedOptions)??{};return ve(t.defaultStyle)&&(t.defaultStyle=!1),t}async function HSe(e,t,n={}){let r,i;ve(t)?(i=C4(n.loader),r=JSON.parse(await i.load(t))):r=t;const o=qSe(r),s=o.loader;(!i||s)&&(i=C4(n.loader??s));const a=await k4(o,i),u=await k4(n,i),c={...kq(u,a),config:Jf(u.config??{},a.config??{})};return await VSe(e,r,c,i)}async function k4(e,t){const n=ve(e.config)?JSON.parse(await t.load(e.config)):e.config??{},r=ve(e.patch)?JSON.parse(await t.load(e.patch)):e.patch;return{...e,...r?{patch:r}:{},...n?{config:n}:{}}}function GSe(e){const t=e.getRootNode?e.getRootNode():document;return t instanceof ShadowRoot?{root:t,rootContainer:t}:{root:document,rootContainer:document.head??document.body}}async function VSe(e,t,n={},r){const i=n.theme?Jf(Xbe[n.theme],n.config??{}):n.config,o=hu(n.actions)?n.actions:kq({},LSe,n.actions??{}),s={...zSe,...n.i18n},a=n.renderer??"canvas",u=n.logLevel??Do.Warn,c=n.downloadFileName??"visualization",f=document.querySelector(e);if(!f)throw new Error(`${e} does not exist`);if(n.defaultStyle!==!1){const k="vega-embed-style",{root:D,rootContainer:$}=GSe(f);if(!D.getElementById(k)){const M=document.createElement("style");M.id=k,M.innerHTML=n.defaultStyle===void 0||n.defaultStyle===!0?OSe.toString():n.defaultStyle,$.appendChild(M)}}const h=WSe(t,n.mode);let p=ISe[h](t,i);if(h==="vega-lite"&&p.$schema){const k=gq(p.$schema);Cq(Ky.vega,`^${k.version.slice(1)}`)||console.warn(`The compiled spec uses Vega ${k.version}, but current version is v${Ky.vega}.`)}f.classList.add("vega-embed"),o&&f.classList.add("has-actions"),f.innerHTML="";let m=f;if(o){const k=document.createElement("div");k.classList.add(USe),f.appendChild(k),m=k}const y=n.patch;if(y&&(p=y instanceof Function?y(p):s2(p,y,!0,!1).newDocument),n.formatLocale&&Do.formatLocale(n.formatLocale),n.timeFormatLocale&&Do.timeFormatLocale(n.timeFormatLocale),n.expressionFunctions)for(const k in n.expressionFunctions){const D=n.expressionFunctions[k];"fn"in D?Do.expressionFunction(k,D.fn,D.visitor):D instanceof Function&&Do.expressionFunction(k,D)}const{ast:v}=n,w=Do.parse(p,h==="vega-lite"?{}:i,{ast:v}),E=new(n.viewClass||Do.View)(w,{loader:r,logLevel:u,renderer:a,...v?{expr:Do.expressionInterpreter??n.expr??Ege}:{}});if(E.addSignalListener("autosize",(k,D)=>{const{type:$}=D;$=="fit-x"?(m.classList.add("fit-x"),m.classList.remove("fit-y")):$=="fit-y"?(m.classList.remove("fit-x"),m.classList.add("fit-y")):$=="fit"?m.classList.add("fit-x","fit-y"):m.classList.remove("fit-x","fit-y")}),n.tooltip!==!1){const{loader:k,tooltip:D}=n,$=k&&!$q(k)?k==null?void 0:k.baseURL:void 0,M=jSe(D)?D:new oSe({baseURL:$,...D===!0?{}:D}).call;E.tooltip(M)}let{hover:S}=n;if(S===void 0&&(S=h==="vega"),S){const{hoverSet:k,updateSet:D}=typeof S=="boolean"?{}:S;E.hover(k,D)}n&&(n.width!=null&&E.width(n.width),n.height!=null&&E.height(n.height),n.padding!=null&&E.padding(n.padding)),await E.initialize(m,n.bind).runAsync();let A;if(o!==!1){let k=f;if(n.defaultStyle!==!1||n.forceActionsMenu){const $=document.createElement("details");$.title=s.CLICK_TO_VIEW_ACTIONS,f.append($),k=$;const M=document.createElement("summary");M.innerHTML=BSe,$.append(M),A=T=>{$.contains(T.target)||$.removeAttribute("open")},document.addEventListener("click",A)}const D=document.createElement("div");if(k.append(D),D.classList.add("vega-actions"),o===!0||o.export!==!1){for(const $ of["svg","png"])if(o===!0||o.export===!0||o.export[$]){const M=s[`${$.toUpperCase()}_ACTION`],T=document.createElement("a"),L=ye(n.scaleFactor)?n.scaleFactor[$]:n.scaleFactor;T.text=M,T.href="#",T.target="_blank",T.download=`${c}.${$}`,T.addEventListener("mousedown",async function(O){O.preventDefault();const X=await E.toImageURL($,L);this.href=X}),D.append(T)}}if(o===!0||o.source!==!1){const $=document.createElement("a");$.text=s.SOURCE_ACTION,$.href="#",$.addEventListener("click",function(M){A4(iE(t),n.sourceHeader??"",n.sourceFooter??"",h),M.preventDefault()}),D.append($)}if(h==="vega-lite"&&(o===!0||o.compiled!==!1)){const $=document.createElement("a");$.text=s.COMPILED_ACTION,$.href="#",$.addEventListener("click",function(M){A4(iE(p),n.sourceHeader??"",n.sourceFooter??"","vega"),M.preventDefault()}),D.append($)}if(o===!0||o.editor!==!1){const $=n.editorUrl??"https://vega.github.io/editor/",M=document.createElement("a");M.text=s.EDITOR_ACTION,M.href="#",M.addEventListener("click",function(T){RSe(window,$,{config:i,mode:y?"vega":h,renderer:a,spec:iE(y?p:t)}),T.preventDefault()}),D.append(M)}}function C(){A&&document.removeEventListener("click",A),E.finalize()}return{view:E,spec:t,vgSpec:p,finalize:C,embedOptions:n}}function YSe(e){const t=JSON.parse(JSON.stringify(e)),n=t.customFormatterMaps||{};function r(o){const s=n[o];if(!s)return"datum.value";const a=Object.entries(s);let u="datum.value";for(let c=a.length-1;c>=0;c--){const[f,h]=a[c],p=h.replace(/'/g,"\\'");u=`datum.value === '${f}' ? '${p}' : ${u}`}return u}function i(o){var s,a,u,c,f,h,p,m,y;if(o){if((s=o.encoding)!=null&&s.tooltip&&Array.isArray(o.encoding.tooltip)&&(o.encoding.tooltip={field:"tooltipText",type:"nominal"}),(f=(c=(u=(a=o.encoding)==null?void 0:a.x)==null?void 0:u.axis)==null?void 0:c.format)!=null&&f.custom){const v=o.encoding.x.axis,w=v.format.mapName;delete v.format,v.labelExpr=r(w)}if((y=(m=(p=(h=o.encoding)==null?void 0:h.y)==null?void 0:p.axis)==null?void 0:m.format)!=null&&y.custom){const v=o.encoding.y.axis,w=v.format.mapName;delete v.format,v.labelExpr=r(w)}o.layer&&Array.isArray(o.layer)&&o.layer.forEach(i)}}return t.layer&&Array.isArray(t.layer)?t.layer.forEach(i):i(t),t}function XSe(){const[e,t]=Yc.useState(null),[n,r]=Yc.useState(null),[i,o]=Yc.useState("light");if(Yc.useEffect(()=>{const u=()=>{if(console.log("[Pulse Widget] window.openai:",window.openai),!window.openai){console.log("[Pulse Widget] window.openai not available yet");return}const f=window.openai.toolOutput;if(console.log("[Pulse Widget] toolOutput:",f),!f){console.log("[Pulse Widget] No toolOutput available yet");return}try{let h=null;if(console.log("[Pulse Widget] toolOutput type:",typeof f),console.log("[Pulse Widget] toolOutput keys:",Object.keys(f)),f.text&&typeof f.text=="string"){console.log("[Pulse Widget] Parsing MCP response from text property");const p=JSON.parse(f.text);if(console.log("[Pulse Widget] Parsed MCP response:",p),console.log("[Pulse Widget] MCP response keys:",Object.keys(p)),p.structuredContent)h=p.structuredContent,console.log("[Pulse Widget] Found structuredContent:",h);else{console.error("[Pulse Widget] No structuredContent in MCP response"),console.error("[Pulse Widget] Available keys:",Object.keys(p)),r("No metric data in response");return}}else if(f.insightBundle)console.log("[Pulse Widget] Using toolOutput directly as PulseMetricData"),h=f;else{console.error("[Pulse Widget] Unexpected toolOutput format"),console.error("[Pulse Widget] toolOutput:",f),r("Unexpected data format");return}if(!h){r("No metric data provided");return}t(h),console.log("[Pulse Widget] Data loaded successfully:",h)}catch(h){console.error("[Pulse Widget] Failed to load data:",h),r(`Failed to load metric data: ${h}`)}};u(),o("light"),document.body.classList.toggle("dark-mode",!1);const c=(f=>{var h,p;console.log("[Pulse Widget] set_globals event:",f.detail),((p=(h=f.detail)==null?void 0:h.globals)==null?void 0:p.toolOutput)!==void 0&&(console.log("[Pulse Widget] toolOutput updated, reloading..."),u())});return window.addEventListener("openai:set_globals",c),()=>window.removeEventListener("openai:set_globals",c)},[]),Yc.useEffect(()=>{var h;if(!e)return;console.log("[Pulse Widget] Rendering visualization, data:",e);const u=[];e.insightBundle.result.insight_groups.forEach(p=>{p.insights&&u.push(...p.insights)}),console.log("[Pulse Widget] All insights:",u);const c=u.filter(p=>{var m;return(m=p.result)==null?void 0:m.viz});console.log("[Pulse Widget] All insights with viz:",c.map(p=>{var m,y;return{insight_type:p.insight_type,result_type:(m=p.result)==null?void 0:m.type,has_viz:!!((y=p.result)!=null&&y.viz)}}));const f=c.find(p=>p.insight_type==="currenttrend")||c[0];if(console.log("[Pulse Widget] Selected viz insight:",f),(h=f==null?void 0:f.result)!=null&&h.viz){const p=f.result.viz;console.log("[Pulse Widget] Original viz spec:",p);const m=YSe(p);console.log("[Pulse Widget] Transformed viz spec:",m),HSe("#visualization",m,{actions:!1,renderer:"svg"}).then(y=>{console.log("[Pulse Widget] Vega embed success:",y)}).catch(y=>{console.error("[Pulse Widget] Vega embed error:",y),r(`Failed to render visualization: ${y.message}`)})}else console.warn("[Pulse Widget] No visualization found in insights")},[e,i]),n)return vi.jsxs("div",{style:Cs.error,children:[vi.jsx("strong",{children:"Error:"})," ",n]});if(!e)return vi.jsx("div",{style:Cs.loading,children:"Loading metric data..."});const s=[];e.insightBundle.result.insight_groups.forEach(u=>{u.insights&&s.push(...u.insights)});const a=s.filter(u=>{var c;return(c=u.result)==null?void 0:c.markup});return vi.jsxs("div",{style:Cs.container,children:[vi.jsxs("div",{style:Cs.header,children:[vi.jsx("h1",{style:Cs.title,children:e.metric.name||"Pulse Metric"}),e.metric.description&&vi.jsx("p",{style:Cs.description,children:e.metric.description})]}),vi.jsx("div",{id:"visualization",style:Cs.visualization}),a.length>0&&vi.jsx("div",{style:Cs.insights,children:a.map((u,c)=>vi.jsx("div",{style:Cs.insightItem,dangerouslySetInnerHTML:{__html:u.result.markup||""}},c))})]})}const Cs={container:{maxWidth:"800px",margin:"0 auto",padding:"16px",fontFamily:"-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif"},header:{marginBottom:"16px"},title:{fontSize:"24px",fontWeight:600,marginBottom:"8px",color:"var(--text-primary, #1a1a1a)"},description:{fontSize:"14px",color:"var(--text-secondary, #666)",marginBottom:"16px"},visualization:{margin:"24px 0",borderRadius:"8px",overflow:"hidden",height:"300px",width:"100%",background:"var(--bg-secondary, #f3f4f6)"},insights:{marginTop:"24px"},insightItem:{padding:"12px",marginBottom:"8px",background:"var(--bg-secondary, #f3f4f6)",borderRadius:"6px",fontSize:"14px",lineHeight:1.5},loading:{textAlign:"center",padding:"40px",color:"var(--text-secondary, #666)"},error:{padding:"16px",background:"#fee2e2",border:"1px solid #ef4444",borderRadius:"6px",color:"#991b1b",margin:"16px"}},$4=document.getElementById("root");$4&&NG.createRoot($4).render(vi.jsx(Yc.StrictMode,{children:vi.jsx(XSe,{})}));</script>
    <style rel="stylesheet" crossorigin>*{margin:0;padding:0;box-sizing:border-box}body{background:transparent;--text-primary: #1a1a1a;--text-secondary: #666;--bg-secondary: #f3f4f6}body.dark-mode{background:#1a1a1a;--text-primary: #ffffff;--text-secondary: #a3a3a3;--bg-secondary: #2a2a2a}#root{width:100%;height:100%}</style>
  </head>
  <body>
    <div id="root"></div>
  </body>
</html>
